!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.NGL=t.NGL||{})}(this,function(t){"use strict";function e(t){var e=new RegExp(t+"=([^&#=]*)"),i=e.exec(window.location.search);return i?decodeURIComponent(i[1]):void 0}function i(t){return t?"string"==typeof t?/^1|true|t|yes|y$/i.test(t):!0:!1}function r(t,e){return void 0!==t?t:e}function n(){var t=window.navigator.userAgent;return/Arora/i.test(t)?"Arora":/Opera|OPR/.test(t)?"Opera":/Chrome/i.test(t)?"Chrome":/Epiphany/i.test(t)?"Epiphany":/Firefox/i.test(t)?"Firefox":/Mobile(\/.*)? Safari/i.test(t)?"Mobile Safari":/MSIE/i.test(t)?"Internet Explorer":/Midori/i.test(t)?"Midori":/Safari/i.test(t)?"Safari":!1}function o(t){if("object"!=typeof t)return t;var e=Array.isArray(t)?[]:{};for(var i in t)e[i]=o(t[i]);return e}function s(t){var e,i,r,n=["gz"];e=self.File&&t instanceof File||self.Blob&&t instanceof self.Blob?t.name||"":t;var o=e.lastIndexOf("?");e=e.substring(0,-1===o?e.length:o);var s=e.replace(/^.*[\\\/]/,""),a=s.substring(0,s.lastIndexOf(".")),c=s.split("."),h=c.length>1?c.pop().toLowerCase():"",u=e.match(/^(.+):\/\/(.+)$/);u&&(r=u[1].toLowerCase(),e=u[2]);var l=e.substring(0,e.lastIndexOf("/")+1);if(-1!==n.indexOf(h)){i=h;var d=e.length-h.length-1;h=e.substr(0,d).split(".").pop().toLowerCase();var m=a.length-h.length-1;a=a.substr(0,m)}else i=!1;return{path:e,name:s,ext:h,base:a,dir:l,compressed:i,protocol:r,src:t}}function a(t){return(new NGL[t.metadata.type]).fromJSON(t)}function c(t){return t.sort().filter(function(t,e,i){return 0===e||t!==i[e-1]})}function h(t){var e=28672;if(t.length>e){for(var i=[],r=0;r<t.length;r+=e)i.push(String.fromCharCode.apply(null,t.subarray(r,r+e)));return i.join("")}return String.fromCharCode.apply(null,t)}function u(t,e,i){log.time("uint8ToLines"),e=void 0!==e?e:10485760,i=void 0!==i?i:"\n";for(var r="",n=[],o=0;o<t.length;o+=e){var s=h(t.subarray(o,o+e)),a=s.lastIndexOf(i);if(-1===a)r+=s;else{var c=r+s.substr(0,a);n=n.concat(c.split(i)),r=a===s.length-i.length?"":s.substr(a+i.length)}}return""!==r&&n.push(r),log.timeEnd("uint8ToLines"),n}function l(t){var e;Ir.time("decompress"),t instanceof ArrayBuffer&&(t=new Uint8Array(t));try{e=pako.ungzip(t)}catch(i){kr&&Ir.warn(i),e=t}return Ir.timeEnd("decompress"),e}function d(){var t={};this.add=function(e,i){t[e]=i},this.get=function(e){return t[e]}}function m(){}function f(){this.activeWorkerCount=0,this.funcDict={},this.add=function(t,e){this.funcDict[t]=e}}function p(t){var e=signals;this.signals={stringChanged:new e.Signal},this.setString(t)}function Y(){}function X(t){var e=t||{};this.scale=e.scale||"uniform",this.mode=e.mode||"hcl",this.domain=e.domain||[0,1],this.value=new THREE.Color(e.value||16777215).getHex(),this.structure=e.structure,this.volume=e.volume,this.surface=e.surface,this.structure&&(this.atomProxy=this.structure.getAtomProxy())}function Z(t){X.call(this,t);var e=this.getScale(),i=this.volume,r=i.inverseMatrix,n=i.__data,o=i.nx,s=i.ny,a=(i.nz,new THREE.Vector3);this.positionColor=function(t){a.copy(t),a.applyMatrix4(r),a.round();var i=(a.z*s+a.y)*o+a.x;return e(n[i])}}function g(t){X.call(this,t);var e=this.getScale();this.volumeColor=function(t){return e(this.volume.data[t])}}function v(t){X.call(this,t);var e;this.structure&&(e=this.structure.atomStore.count,t.backbone?e+=this.structure.bondStore.count:t.rung&&(e+=this.structure.bondStore.count,e+=this.structure.backboneBondStore.count)),this.atomColor=function(t){return Nr.getGid(this.structure,t.index)},this.bondColor=function(t,i){return Nr.getGid(this.structure,e+t.index)},this.volumeColor=function(t){return Nr.getGid(this.volume,t)}}function y(t){X.call(this,t),this.atomColor=function(t){return 16777215*Math.random()}}function b(t){X.call(this,t);var e=this.value;this.atomColor=function(){return e},this.bondColor=function(){return e},this.valueColor=function(){return e}}function x(t){if(X.call(this,t),t.scale||(this.scale="roygb"),t.domain){var e=this.getScale();this.atomColor=function(t){return e(t.index)}}else{var i={};this.structure.eachModel(function(t){this.domain=[t.atomOffset,t.atomEnd],i[t.index]=this.getScale()}.bind(this)),this.atomColor=function(t){return i[t.modelIndex](t.index)}}}function S(t){X.call(this,t),t.scale||(this.scale="roygb"),t.domain||(this.domain=[0,this.structure.residueStore.count]);var e=this.getScale();this.atomColor=function(t){return e(t.residueIndex)}}function w(t){X.call(this,t),t.scale||(this.scale="Spectral"),t.domain||(this.domain=[0,this.structure.chainStore.count]);var e=this.getScale();this.atomColor=function(t){return e(t.chainIndex)}}function A(t){X.call(this,t),t.scale||(this.scale="roygb"),t.domain||(this.domain=[0,this.structure.modelStore.count]);var e=this.getScale();this.atomColor=function(t){return e(t.modelIndex)}}function C(t){X.call(this,t);var e=this.structure.getResidueProxy();this.atomColor=function(t){var i=t.sstruc;return"h"===i?Pr.alphaHelix:"g"===i?Pr.threeTenHelix:"i"===i?Pr.piHelix:"e"===i||"b"===i?Pr.betaStrand:(e.index=t.residueIndex,e.isNucleic()?Pr.dna:e.isProtein()||"s"===i||"t"===i||"l"===i?Pr.coil:Er)}}function _(t){X.call(this,t);var e=this.value;void 0===t.value&&(e=wr.C),this.atomColor=function(t){var i=t.element;return"C"===i?e:wr[i]||Ar}}function P(t){X.call(this,t),this.atomColor=function(t){return Cr[t.resname]||_r}}function E(t){if(X.call(this,t),t.scale||(this.scale="OrRd"),!t.domain){var e,i=1/0,r=-(1/0);t.sele&&(e=new p(t.sele)),this.structure.eachSelectedAtom(function(t){var e=t.bfactor;i=Math.min(i,e),r=Math.max(r,e)},e),this.domain=[i,r]}var n=this.getScale();this.atomColor=function(t){return n(t.bfactor)}}function T(t){X.call(this,t),t.scale||(this.scale="PuBu"),t.domain||(this.domain=[0,1]);var e=this.getScale();this.atomColor=function(t){return e(t.occupancy)}}function O(t){X.call(this,t),t.scale||(this.scale="RdYlGn");var e,i=0,r={};for(e in dr)r[e]=dr[e][i];if(!t.domain){var n,o=1/0,s=-(1/0);for(e in r)n=r[e],o=Math.min(o,n),s=Math.max(s,n);this.domain=[o,0,s]}var a=this.getScale();this.atomColor=function(t){return a(r[t.resname]||mr)}}function R(){}function I(){var t="http://files.rcsb.org/download/",e="http://mmtf.rcsb.org/v0/full/",i="http://mmtf.rcsb.org/reduced/";this.getUrl=function(r){var n=s(r);return-1===["pdb","cif"].indexOf(n.ext)||n.compressed!==!1&&"gz"!==n.compressed?"mmtf"===n.ext?n.base.endsWith(".bb")?i+n.name:e+n.name:n.ext?(console.warn("unsupported ext",n.ext),e+n.name):t+n.name+".cif":t+n.path},this.getExt=function(t){var e=s(t);return"mmtf"!==e.ext&&e.ext?void 0:"mmtf"}}function k(t,e){this.type=t,this.scale=e||1,this.max=10}function N(t,e,i,r,n,o,s,a){this.a=t||1,this.b=e||1,this.c=i||1,this.alpha=r||90,this.beta=n||90,this.gamma=o||90,this.spacegroup=s||"P 1";var c=THREE.Math.degToRad(this.alpha),h=THREE.Math.degToRad(this.beta),u=THREE.Math.degToRad(this.gamma),l=Math.cos(c),d=Math.cos(h),m=Math.cos(u),f=(Math.sin(c),Math.sin(h)),p=Math.sin(u);if(this.volume=this.a*this.b*this.c*Math.sqrt(1-l*l-d*d-m*m+2*l*d*m),void 0===a){var Y=this.a*this.b*p/this.volume,X=(d*m-l)/(f*p);this.fracToCart=(new THREE.Matrix4).set(this.a,0,0,0,this.b*m,this.b*p,0,0,this.c*d,-this.c*f*X,1/Y,0,0,0,0,1).transpose(),this.cartToFrac=(new THREE.Matrix4).getInverse(this.fracToCart)}else this.cartToFrac=a,this.fracToCart=(new THREE.Matrix4).getInverse(this.cartToFrac)}function M(t){this.name=t||"",this.partList=[]}function L(t,e){this.matrixList=t||[],this.chainList=e||[]}function B(t){void 0===t?this.init(0):Number.isInteger(t)?this.init(t):this.fromJSON(t)}function F(t){B.call(this,t)}function D(t){B.call(this,t)}function j(t){B.call(this,t)}function z(t){B.call(this,t)}function H(t){B.call(this,t)}function V(t,e,i,r,n){i=i||1,r=r||0;var o,s,a,c=n?n.length:t.length,h=0,u=0;if(n)for(s=0;c>s;++s)a=(t[n[s]*i+r]+e)%e,o=a/e*zr-Math.PI,h+=Math.cos(o),u+=Math.sin(o);else for(s=r;c>s;s+=i)a=(t[s]+e)%e,o=a/e*zr-Math.PI,h+=Math.cos(o),u+=Math.sin(o);h/=c,u/=c;var l=Math.atan2(u,h),d=(l+Math.PI)/zr*e;return d}function U(t,e,i,r){var n=t.length;i=i||new Float32Array(n),r=r||0;for(var o=0;n>o;o+=3)i[r+o+0]=(t[o+0]+e[o+0])/2,i[r+o+1]=(t[o+1]+e[o+1])/2,i[r+o+2]=(t[o+2]+e[o+2])/2;return i}function G(t,e){for(var i=new Float32Array(t),r=0;t>r;++r)i[r]=e;return i}function q(t,e,i,r){for(var n,o=new Float32Array(3*t),s=0;t>s;++s)n=3*s,o[n+0]=e,o[n+1]=i,o[n+2]=r;return o}function W(t,e){for(var i=t.length,r=new Float32Array(i),n=0;i>n;n++)r[n]=Math.min(t[n],e[n]);return r}function J(t,e,i,r,n){var o,s=n;for(o=0;s>o;++o)e[r+o]=t[i+o]}function K(t){var e,i=t.length,r=t.length/3,n=0,o=0,s=0;for(e=0;i>e;e+=3)n+=t[e+0],o+=t[e+1],s+=t[e+2];return new THREE.Vector3(n/r,o/r,s/r)}function Q(t){this.polymer=t,this.size=t.residueCount}function $(t){this.polymer=t,this.helixorient=new Q(t),this.position=this.helixorient.getPosition()}function tt(t,e){if(kr&&Ir.time("Kdtree build"),e)var i=function(t,e){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return i*i+r*r+n*n};else var i=function(t,e){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(i*i+r*r+n*n)};var r=new Float32Array(4*t.atomCount),n=0,o=t.eachSelectedAtom?"eachSelectedAtom":"eachAtom";t[o](function(t){r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z,r[n+3]=t.index,n+=4}),this.points=r,this.kdtree=new THREE.TypedArrayUtils.Kdtree(r,i,4,3),kr&&Ir.timeEnd("Kdtree build")}function et(t){var e=Vr[t],i={};if(void 0===e)return console.warn("getSymmetryOperations: spacegroup '"+t+"' not found in symop library"),i;var r=/^[1-9]$/;return e.forEach(function(t){var e=t.split(","),n=0,o=(new THREE.Matrix4).set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1),s=o.elements;i[t]=o,e.forEach(function(t){for(var e=!1,i=!1,o=0,a=t.length;a>o;++o){var c=t[o];if("-"===c)e=!0;else if("+"===c)e=!1;else if("/"===c)i=!0;else if("X"===c)s[0+n]=e?-1:1;else if("Y"===c)s[4+n]=e?-1:1;else if("Z"===c)s[8+n]=e?-1:1;else if(r.test(c)){var h=parseInt(c);i?s[12+n]/=h:s[12+n]=h}else Log.warn("getSymmetryOperations: unknown token '"+c+"'")}n+=1})}),i}function it(t){function e(t,e){return i.index=t,r.index=e,i.modelindex<r.modelindex?-1:i.modelindex>r.modelindex?1:i.chainname<r.chainname?-1:i.chainname>r.chainname?1:i.resno<r.resno?-1:i.resno>r.resno?1:0}kr&&Ir.time("reorderAtoms");var i=t.getAtomProxy(),r=t.getAtomProxy();t.atomStore.sort(e),kr&&Ir.timeEnd("reorderAtoms")}function rt(t){kr&&Ir.time("assignSecondaryStructure");var e=[];t.eachModel(function(t){t.eachChain(function(t){e.push(t.chainname)})});var i=e.slice().sort(),r=[];i.forEach(function(t){r.push(e.indexOf(t))});var n=t.helices||[];n=n.filter(function(t){return Gi(i,t[0])>=0}),n.sort(function(t,e){var n=t[0],o=e[0],s=t[1],a=e[1];if(n===o)return s===a?0:a>s?-1:1;var c=Gi(i,n),h=Gi(i,o);return r[c]<r[h]?-1:1});var o=t.residueStore;t.eachModel(function(t){var e=0,i=n.length;if(0!==i){var r=n[e],s=!1,a=!1;t.eachChain(function(t){var c=!1;if(t.chainname===r[0])for(var h=t.residueCount,u=t.residueOffset,l=u+h,d=u;l>d;++d)if(o.resno[d]===r[1]&&o.getInscode(d)===r[2]&&(s=!0),s&&(o.sstruc[d]=r[6],o.resno[d]===r[4]&&o.getInscode(d)===r[5]&&(s=!1,e+=1,i>e?(d=u-1,r=n[e],c=t.chainname!==r[0]):a=!0)),c||a)return})}});var s=t.sheets||[];s=s.filter(function(t){return Gi(i,t[0])>=0}),s.sort(function(t,e){var n=t[0],o=e[0];if(n===o)return 0;var s=Gi(i,n),a=Gi(i,o);return r[s]<r[a]?-1:1});var a="e".charCodeAt(0);t.eachModel(function(t){var e=0,i=s.length;if(0!==i){var r=s[e],n=!1,c=!1;t.eachChain(function(t){var h=!1;if(t.chainname===r[0])for(var u=t.residueCount,l=t.residueOffset,d=l+u,m=l;d>m;++m)if(o.resno[m]===r[1]&&o.getInscode(m)===r[2]&&(n=!0),n&&(o.sstruc[m]=a,o.resno[m]===r[4]&&o.getInscode(m)===r[5]&&(n=!1,e+=1,i>e?(m=l-1,r=s[e],h=t.chainname!==r[0]):c=!0)),h||c)return})}}),kr&&Ir.timeEnd("assignSecondaryStructure")}function nt(t){kr&&Ir.time("calculateChainnames");var e=!0;if(t.eachChain(function(t){t.chainname&&(e=!1)}),e){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=i.length,n=t.modelStore,o=t.chainStore,s=t.residueStore,a=function(t,e,i,r){for(var a=o.count,c=0;r>c;++c)s.chainIndex[i+c]=a;o.growIfFull(),o.modelIndex[a]=t,o.setChainname(a,e),o.residueOffset[a]=i,o.residueCount[a]=r,o.count+=1,n.chainCount[t]+=1},c=t.getAtomProxy(),h=t.getAtomProxy(),u=0,l=0,d=0,m=0,f=[];1===t.residueStore.count?f.push({mIndex:0,chainname:"A",rStart:0,rCount:1}):t.eachResidueN(2,function(t,e){var n=!1,o=t.backboneType,a=e.backboneType,p=er;if(m=t.index,t.modelIndex!==e.modelIndex?n=!0:t.moleculeType!==e.moleculeType?n=!0:o!==p&&o===a&&(c.index=t.backboneEndAtomIndex,h.index=e.backboneStartAtomIndex,c.connectedTo(h)||(n=!0)),e.index===s.count-1&&(n=!0,m=e.index),n){for(var Y=u,X=0,Z=i[Y%r];Y>=r;)Y=Math.floor(Y/r),Z+=i[Y%r],X+=1;f.push({mIndex:l,chainname:Z,rStart:d,rCount:m-d+1}),u+=1,t.modelIndex!==e.modelIndex&&(u=0,l+=1),X>=5&&(Ir.warn("out of chain names"),u=0),d=e.index,m=e.index}}),o.count=0,f.forEach(function(t){a(t.mIndex,t.chainname,t.rStart,t.rCount)});var p=0;t.eachModel(function(t){n.chainOffset[t.index]=p,n.chainCount[t.index]-=1,p+=n.chainCount[t.index]})}kr&&Ir.timeEnd("calculateChainnames")}function ot(t){kr&&Ir.time("calculateBonds"),at(t),ct(t),kr&&Ir.timeEnd("calculateBonds")}function st(t){var e=t.structure,i=e.getAtomProxy(),r=e.getAtomProxy(),n=t.atomCount,o=t.atomOffset,s=o+n,a=s-1;if(n>500)return void(kr&&Ir.warn("more than 500 atoms, skip residue for auto-bonding",t.qualifiedName()));var c,h,u=[],l=[];if(n>50){var d=new tt(t,!0),m=t.isCg()?1.2:2.3;for(c=o;a>c;++c){i.index=c;var f=i.covalent+m+.3,p=d.nearest(i,1/0,f*f),Y=p.length;for(h=0;Y>h;++h)r.index=p[h].index,i.index<r.index&&i.connectedTo(r)&&(u.push(i.index-o),l.push(r.index-o))}}else for(c=o;a>c;++c)for(i.index=c,h=c+1;a>=h;++h)r.index=h,i.connectedTo(r)&&(u.push(c-o),l.push(h-o));return{atomIndices1:u,atomIndices2:l}}function at(t,e){kr&&Ir.time("calculateBondsWithin");var i=t.bondStore,r=t.rungBondStore,n=t.getAtomSet(!1),o=t.getAtomProxy(),s=t.getAtomProxy();t.eachResidue(function(t){if(!e){var a=t.atomCount,c=t.atomOffset;if(a>500)return void Ir.warn("more than 500 atoms, skip residue for auto-bonding",t.qualifiedName());for(var h=t.getBonds(),u=h.atomIndices1,l=h.atomIndices2,d=u.length,m=0;d>m;++m)o.index=u[m]+c,s.index=l[m]+c,i.addBond(o,s)}var f=t.residueType.traceAtomIndex,p=t.residueType.rungEndAtomIndex;-1!==f&&-1!==p&&(o.index=t.traceAtomIndex,s.index=t.rungEndAtomIndex,r.addBond(o,s),n.add_unsafe(o.index),n.add_unsafe(s.index))}),t.atomSetDict.rung=n,kr&&Ir.timeEnd("calculateBondsWithin")}function ct(t,e){function i(t,i){var c=t.backboneType,h=i.backboneType;c!==er&&c===h&&(s.index=t.backboneEndAtomIndex,a.index=i.backboneStartAtomIndex,s.connectedTo(a)&&(e||r.addBond(s,a),s.index=t.traceAtomIndex,a.index=i.traceAtomIndex,n.addBond(s,a),o.add_unsafe(s.index),o.add_unsafe(a.index)))}kr&&Ir.time("calculateBondsBetween");var r=t.bondStore,n=t.backboneBondStore,o=t.getAtomSet(!1),s=t.getAtomProxy(),a=t.getAtomProxy();0===n.count&&n.resize(t.residueStore.count),t.eachResidueN(2,i);var c=t.getResidueProxy(),h=t.getResidueProxy();t.eachChain(function(t){0!==t.residueCount&&(c.index=t.residueOffset,h.index=t.residueOffset+t.residueCount-1,i(h,c))}),t.atomSetDict.backbone=o,kr&&Ir.timeEnd("calculateBondsBetween")}function ht(t){function e(t){var e=[];return Object.keys(n).forEach(function(c){var h=n[c].clone();s.copy(r).applyMatrix4(h),a.setFromMatrixPosition(h),a.sub(o),s.x>1&&(a.x-=1),s.x<0&&(a.x+=1),s.y>1&&(a.y-=1),s.y<0&&(a.y+=1),s.z>1&&(a.z-=1),s.z<0&&(a.z+=1),t&&a.add(t),h.setPosition(a),h.multiplyMatrices(i.fracToCart,h),h.multiply(i.cartToFrac),e.push(h)}),e}kr&&Ir.time("buildUnitcellAssembly");var i=t.unitcell,r=t.center.clone().applyMatrix4(i.cartToFrac),n=et(i.spacegroup),o=new THREE.Vector3,s=new THREE.Vector3,a=new THREE.Vector3;r.x>1&&(o.x-=1),r.x<0&&(o.x+=1),r.y>1&&(o.y-=1),r.y<0&&(o.y+=1),r.z>1&&(o.z-=1),r.z<0&&(o.z+=1);var c,h=new M("UNITCELL"),u=e();if(t.biomolDict.NCS){c=t.biomolDict.NCS.partList[0].matrixList;var l=[];u.forEach(function(t){c.forEach(function(e){l.push(t.clone().multiply(e))})}),h.addPart(l)}else h.addPart(u);var d=new THREE.Vector3,m=new M("SUPERCELL"),f=Array.prototype.concat.call(e(),e(d.set(1,1,1)),e(d.set(-1,-1,-1)),e(d.set(1,0,0)),e(d.set(1,1,0)),e(d.set(1,0,1)),e(d.set(0,1,0)),e(d.set(0,1,1)),e(d.set(0,0,1)),e(d.set(-1,0,0)),e(d.set(-1,-1,0)),e(d.set(-1,0,-1)),e(d.set(0,-1,0)),e(d.set(0,-1,-1)),e(d.set(0,0,-1)),e(d.set(1,-1,-1)),e(d.set(1,1,-1)),e(d.set(1,-1,1)),e(d.set(-1,1,1)),e(d.set(-1,-1,1)),e(d.set(-1,1,-1)),e(d.set(0,1,-1)),e(d.set(0,-1,1)),e(d.set(1,0,-1)),e(d.set(-1,0,1)),e(d.set(1,-1,0)),e(d.set(-1,1,0)));if(t.biomolDict.NCS){var p=[];f.forEach(function(t){c.forEach(function(e){p.push(t.clone().multiply(e))})}),m.addPart(p)}else m.addPart(f);t.biomolDict.UNITCELL=h,t.biomolDict.SUPERCELL=m,kr&&Ir.timeEnd("buildUnitcellAssembly")}function ut(t,e,i){this.structure=t,i=i||Gr(e),this.atomname=e,this.element=i,this.vdw=cr[i],this.covalent=ur[i]}function lt(t){function e(t,e){return t+"|"+e}function i(i,r){r=r||Gr(i);var s=e(i,r),a=n[s];if(void 0===a){var c=new ut(t,i,r);a=o.length,n[s]=a,o.push(c)}return a}function r(t){return o[t]}var n={},o=[];this.add=i,this.get=r,this.list=o,this.dict=n,this.toJSON=function(){var t={metadata:{version:.1,type:"AtomMap",generator:"AtomMapExporter"},idDict:n,typeList:o.map(function(t){return t.toJSON()})};return t},this.fromJSON=function(e){n=e.idDict,o=e.typeList.map(function(e){return new ut(t,e.atomname,e.element)}),this.list=o,this.dict=n}}function dt(t,e,i,r){this.structure=t,this.resname=e,this.atomTypeIdList=i,this.hetero=r?1:0,this.atomCount=i.length,this.moleculeType=this.getMoleculeType(),this.backboneType=this.getBackboneType(0),this.backboneEndType=this.getBackboneType(-1),this.backboneStartType=this.getBackboneType(1),this.backboneIndexList=this.getBackboneIndexList();var n=Sr[this.backboneType],o=Sr[this.backboneStartType],s=Sr[this.backboneEndType],a=this.getAtomIndexByName(n.trace);this.traceAtomIndex=void 0!==a?a:-1;var c=this.getAtomIndexByName(n.direction1);this.direction1AtomIndex=void 0!==c?c:-1;var h=this.getAtomIndexByName(n.direction2);this.direction2AtomIndex=void 0!==h?h:-1;var u=this.getAtomIndexByName(o.backboneStart);this.backboneStartAtomIndex=void 0!==u?u:-1;var l=this.getAtomIndexByName(s.backboneEnd);this.backboneEndAtomIndex=void 0!==l?l:-1;var d;d=-1!==Zr.indexOf(e)?this.getAtomIndexByName("N1"):this.getAtomIndexByName("N3"),this.rungEndAtomIndex=void 0!==d?d:-1}function mt(t){function e(t,e,i){return t+"|"+e.join(",")+"|"+(i?1:0)}function i(i,r,s){var a=e(i,r,s),c=n[a];if(void 0===c){var h=new dt(t,i,r,s);c=o.length,n[a]=c,o.push(h)}return c}function r(t){return o[t]}var n={},o=[];this.add=i,this.get=r,this.list=o,this.dict=n,this.toJSON=function(){var t={metadata:{version:.1,type:"ResidueMap",generator:"ResidueMapExporter"},idDict:n,typeList:o.map(function(t){return t.toJSON()})};return t},this.fromJSON=function(e){n=e.idDict,o=e.typeList.map(function(e){return new dt(t,e.resname,e.atomTypeIdList,e.hetero)}),this.list=o,this.dict=n}}function ft(t,e){this.structure=t,this.bondStore=t.bondStore,this.index=e}function pt(t,e){this.structure=t,this.chainStore=t.chainStore,this.residueStore=t.residueStore,this.atomStore=t.atomStore,this.residueMap=t.residueMap,this.atomMap=t.atomMap,this.index=e}function Yt(t,e){this.structure=t,this.chainStore=t.chainStore,this.residueStore=t.residueStore,this.atomStore=t.atomStore,this.residueMap=t.residueMap,this.atomMap=t.atomMap,this.index=e}function Xt(t,e,i){this.structure=t,this.chainStore=t.chainStore,this.residueStore=t.residueStore,this.atomStore=t.atomStore,this.residueIndexStart=e,this.residueIndexEnd=i,this.residueCount=i-e+1;var r=this.structure.getResidueProxy(this.residueIndexStart),n=this.structure.getResidueProxy(this.residueIndexEnd);this.isPrevConnected=void 0!==r.getPreviousConnectedResidue();var o=n.getNextConnectedResidue();this.isNextConnected=void 0!==o,this.isNextNextConnected=this.isNextConnected&&void 0!==o.getNextConnectedResidue(),this.isCyclic=n.connectedTo(r),this.__residueProxy=this.structure.getResidueProxy()}function Zt(t,e){this.structure=t,this.chainStore=t.chainStore,this.residueStore=t.residueStore,this.index=e}function gt(t,e){this.structure=t,this.modelStore=t.modelStore,this.chainStore=t.chainStore,this.residueStore=t.residueStore,this.index=e}function vt(t,e){var i=signals;this.signals={refreshed:new i.Signal},this.name=t,this.path=e,this.title="",this.id="",this.atomSetCache={},this.atomSetDict={},this.biomolDict={},this.helices=[],this.sheets=[],this.unitcell=void 0,this.selection=void 0,this.frames=[],this.boxes=[],this.bondStore=new F(0),this.backboneBondStore=new F(0),this.rungBondStore=new F(0),this.atomStore=new D(0),this.residueStore=new j(0),this.chainStore=new z(0),this.modelStore=new H(0),this.atomMap=new lt(this),this.residueMap=new mt(this),this.atomSet=this.getAtomSet(this.selection),this.bondSet=this.getBondSet(),this.center=new THREE.Vector3,this.boundingBox=new THREE.Box3,Nr.addObject(this),this._ap=this.getAtomProxy(),this._rp=this.getResidueProxy(),this._cp=this.getChainProxy()}function yt(t,e){var i=signals;this.signals={refreshed:new i.Signal},this.structure=t,this.selection=e,this.center=new THREE.Vector3,this.boundingBox=new THREE.Box3,(t||e)&&(this.init(),this.refresh())}function bt(){var t=signals;this.count=0,this.signals={countChanged:new t.Signal}}function xt(t){if(void 0===t)return"";var e=[];for(var i in t){var r=t[i];r!==!1&&e.push("#define "+i+" "+r)}return e.join("\n")+"\n"}function St(t,e){e=e||{};var i=t+"|";for(var r in e)i+=r+":"+e[r];if(!gn[i]){var n=xt(e),o=Xn["shader/"+t];if(!o)throw"empty shader, '"+t+"'";o=o.replace(Zn,function(t,e){var i="shader/chunk/"+e+".glsl",r=Xn[i]||THREE.ShaderChunk[e];return r?r:""}),gn[i]=n+o}return gn[i]}function wt(t,e,i,r){var n=r||{};this.renderer=t,this.camera=e,this.viewer=i,this.factor=void 0!==n.factor?n.factor:2,this.antialias=void 0!==n.antialias?n.antialias:!1,this.onProgress=n.onProgress,this.onFinish=n.onFinish,this.init()}function At(t,e){function i(e){var i=a;c&&(i*=2),e&&(i=1/i),t.scene.traverse(function(t){var e=t.material;e&&e.linewidth&&(e.linewidth*=i),e&&e.uniforms&&e.uniforms.size&&void 0===e.uniforms.size.__seen&&(e.uniforms.size.value*=i,e.uniforms.size.__seen=!0)}),t.scene.traverse(function(t){var e=t.material;e&&e.uniforms&&e.uniforms.size&&delete e.uniforms.size.__seen})}function r(t){if(s){var e=m,i=0|(h?0:255*e.r),n=0|(h?0:255*e.g),o=0|(h?0:255*e.b),a=0|(h?0:255);return r(t,i,n,o,a)}return t}function n(t,e,i){"function"==typeof o.onProgress&&o.onProgress(t,e,i)}var o=e||{},s=void 0!==o.trim?o.trim:!1,a=void 0!==o.factor?o.factor:1,c=void 0!==o.antialias?o.antialias:!1,h=void 0!==o.transparent?o.transparent:!1,u=t.renderer,l=t.camera,d=u.getClearAlpha(),m=u.getClearColor();return new Promise(function(e,o){function s(o,s){var a=r(m.canvas);a.toBlob(function(r){u.setClearAlpha(d),i(!0),t.requestRender(),m.dispose(),n(s,s,!0),e(r)},"image/png")}var m=new wt(u,l,t,{factor:a,antialias:c,onProgress:n,onFinish:s});u.setClearAlpha(h?0:1),i(),m.renderAsync()})}function Ct(){var t=signals;this.signals={updated:new t.Signal},this.begin(),this.maxDuration=-(1/0),this.minDuration=1/0,this.avgDuration=14,this.lastDuration=1/0,this.prevFpsTime=0,this.lastFps=1/0,this.lastFrames=1,this.frames=0,this.count=0}function _t(t,e){var i=signals;if(this.signals={orientationChanged:new i.Signal},t?this.container=document.getElementById(t):this.container=document.createElement("div"),this.container===document)this.width=window.innerWidth,this.height=window.innerHeight;else{var r=this.container.getBoundingClientRect();this.width=r.width,this.height=r.height}this.initParams(),this.initStats(),this.initCamera(),this.initScene(),this.initRenderer()!==!1&&(this.initControls(),this.initHelper(),this._render=this.render.bind(this),this._animate=this.animate.bind(this),this.setBackground(),this.setFog(),this.boundingBox=new THREE.Box3,this.distVector=new THREE.Vector3,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}})}function Pt(t,e,i){this.name=t,this.path=e,this.info={},this.center=new THREE.Vector3,this.boundingBox=new THREE.Box3,i instanceof THREE.Geometry||i instanceof THREE.BufferGeometry||i instanceof THREE.Group?this.fromGeometry(i):i&&this.set(i.position,i.index,i.normal,i.color,i.atomindex)}function Et(t){var e=0,i=0,r={},n={},o=new self.Worker(Lr);Br.activeWorkerCount+=1,o.onmessage=function(i){e-=1;var s=i.data.__postId;Ir.timeEnd("Worker.postMessage "+t+" #"+s),r[s]&&r[s].call(o,i),delete r[s],delete n[s]},o.onerror=function(i){e-=1;var s=i.data.__postId;n[s]?n[s].call(o,i):Ir.error("Worker.onerror",s,t,i),delete r[s],delete n[s]},this.name=t,this.post=function(s,a,c,h){r[i]=c,n[i]=h,s=s||{},s.__name=t,s.__postId=i,s.__debug=kr,Ir.time("Worker.postMessage "+t+" #"+i);try{o.postMessage.call(o,s,a)}catch(u){Ir.error("worker.post:",u),o.postMessage.call(o,s)}return e+=1,i+=1,this},this.terminate=function(){o?(o.terminate(),Br.activeWorkerCount-=1):Ir.log("no worker to terminate")},Object.defineProperties(this,{postCount:{get:function(){return i}},pending:{get:function(){return e}}})}function Tt(t,e){e=Math.min(8,e||2);var i=[],r=0;this.name=t,this.maxCount=e,this.post=function(t,e,i,r){var n=this.getNextWorker();return n.post(t,e,i,r),this},this.terminate=function(){i.forEach(function(t){t.terminate()})},this.getNextWorker=function(){for(var n,o=1/0,s=0;e>s;++s){if(s>=r){n=new Et(t),i.push(n),r+=1;break}var a=i[s];if(0===a.pending){o=a.pending,n=a;break}a.pending<o&&(o=a.pending,n=a)}return n},Object.defineProperties(this,{count:{get:function(){return r}}})}function Ot(t,e,i,r,n){function o(t,e,i){return t+(e-t)*i}function s(t,e,i,r,s,a,c){if(m[t]<0){var h=(Y-a)/(c-a),u=d,l=3*f;if(b[l+0]=i+h,b[l+1]=r,b[l+2]=s,!X){var p=3*t;x[l]=-o(u[p],u[p+3],h),x[l+1]=-o(u[p+1],u[p+4],h),x[l+2]=-o(u[p+2],u[p+5],h)}n&&(w[f]=n[t+h]),m[t]=f,y[e]=f,f+=1}else y[e]=m[t]}function a(t,e,i,r,s,a,c){if(m[t]<0){var h=(Y-a)/(c-a),u=d,l=3*f;if(b[l]=i,b[l+1]=r+h,b[l+2]=s,!X){var p=3*t,Z=p+3*g;x[l]=-o(u[p],u[Z],h),x[l+1]=-o(u[p+1],u[Z+1],h),x[l+2]=-o(u[p+2],u[Z+2],h)}n&&(w[f]=n[t+h*g]),m[t]=f,y[e]=f,f+=1}else y[e]=m[t]}function c(t,e,i,r,s,a,c){if(m[t]<0){var h=(Y-a)/(c-a),u=d,l=3*f;if(b[l]=i,b[l+1]=r,b[l+2]=s+h,!X){var p=3*t,Z=p+3*v;x[l]=-o(u[p],u[Z],h),x[l+1]=-o(u[p+1],u[Z+1],h),x[l+2]=-o(u[p+2],u[Z+2],h)}n&&(w[f]=n[t+h*v]),m[t]=f,y[e]=f,f+=1}else y[e]=m[t]}function h(e){var i=3*e;0===d[i]&&(d[i]=t[e-1]-t[e+1],d[i+1]=t[e-g]-t[e+g],d[i+2]=t[e-v]-t[e+v])}function u(e,i,r,n){var o=n+1,u=n+g,l=n+v,d=o+g,m=o+v,f=n+g+v,Z=o+g+v,b=0,x=t[n],w=t[o],A=t[u],C=t[d],_=t[l],P=t[m],E=t[f],T=t[Z];Y>x&&(b|=1),Y>w&&(b|=2),Y>A&&(b|=8),Y>C&&(b|=4),Y>_&&(b|=16),Y>P&&(b|=32),Y>E&&(b|=128),Y>T&&(b|=64);var O=Sn[b];if(0===O)return 0;var R=e+1,I=i+1,k=r+1;1&O&&(X||(h(n),h(o)),s(n,0,e,i,r,x,w)),2&O&&(X||(h(o),h(d)),a(o,1,R,i,r,w,C)),4&O&&(X||(h(u),h(d)),s(u,2,e,I,r,A,C)),8&O&&(X||(h(n),h(u)),a(n,3,e,i,r,x,A)),16&O&&(X||(h(l),h(m)),s(l,4,e,i,k,_,P)),32&O&&(X||(h(m),h(Z)),a(m,5,R,i,k,P,T)),64&O&&(X||(h(f),h(Z)),s(f,6,e,I,k,E,T)),128&O&&(X||(h(l),h(f)),a(l,7,e,i,k,_,E)),256&O&&(X||(h(n),h(l)),c(n,8,e,i,r,x,_)),512&O&&(X||(h(o),h(m)),c(o,9,R,i,r,w,P)),1024&O&&(X||(h(d),h(Z)),c(d,10,R,I,r,C,T)),2048&O&&(X||(h(u),h(f)),c(u,11,e,I,r,A,E)),b<<=4;for(var N,M,L,B=0;-1!=wn[b+B];)N=b+B,M=N+1,L=N+2,S[p]=y[wn[M]],S[p+1]=y[wn[N]],S[p+2]=y[wn[L]],p+=3,B+=3}function l(n,o,s,a,c,h){var l,d,f,p,Z,y;n=void 0!==n?n:0,o=void 0!==o?o:0,s=void 0!==s?s:0,a=void 0!==a?a:e-1,c=void 0!==c?c:i-1,h=void 0!==h?h:r-1,X?(n=Math.max(0,n),o=Math.max(0,o),s=Math.max(0,s),a=Math.min(e-1,a),c=Math.min(i-1,c),h=Math.min(r-1,h)):(n=Math.max(1,n),o=Math.max(1,o),s=Math.max(1,s),a=Math.min(e-2,a),c=Math.min(i-2,c),h=Math.min(r-2,h));var b=Math.max(0,n-2),x=Math.max(0,o-2),S=Math.max(0,s-2),w=Math.min(e,a+2),A=Math.min(i,c+2),C=Math.min(r,h+2);for(p=S;C>p;++p)for(y=v*p,f=x;A>f;++f)for(Z=y+g*f,d=b;w>d;++d)l=Z+d,m[l]=-1;var _,P=n,E=o,T=s,O=a,R=c,I=h;for(_=!1,p=s;h>p;++p){for(f=o;c>f;++f){for(d=n;a>d;++d)if(l=e*i*p+e*f+d,t[l]>=Y){T=p,_=!0;break}if(_)break}if(_)break}for(_=!1,f=o;c>f;++f){for(p=T;h>p;++p){for(d=n;a>d;++d)if(l=e*i*p+e*f+d,t[l]>=Y){E=f,_=!0;break}if(_)break}if(_)break}for(_=!1,d=n;a>d;++d){for(f=E;c>f;++f){for(p=T;h>p;++p)if(l=e*i*p+e*f+d,t[l]>=Y){P=d,_=!0;break}if(_)break}if(_)break}for(_=!1,p=h;p>=s;--p){for(f=c;f>=o;--f){for(d=a;d>=n;--d)if(l=e*i*p+e*f+d,t[l]>=Y){I=p,_=!0;break}if(_)break}if(_)break}for(_=!1,f=c;f>=o;--f){for(p=I;p>=s;--p){for(d=a;d>=n;--d)if(l=e*i*p+e*f+d,t[l]>=Y){R=f,_=!0;break}if(_)break}if(_)break}for(_=!1,d=a;d>=n;--d){for(f=R;f>=o;--f){for(p=I;p>=s;--p)if(l=e*i*p+e*f+d,t[l]>=Y){O=d,_=!0;break}if(_)break}if(_)break}for(X?(n=Math.max(0,P-1),o=Math.max(0,E-1),s=Math.max(0,T-1),a=Math.min(e-1,O+1),c=Math.min(i-1,R+1),h=Math.min(r-1,I+1)):(n=Math.max(1,P-1),o=Math.max(1,E-1),s=Math.max(1,T-1),a=Math.min(e-2,O+1),c=Math.min(i-2,R+1),h=Math.min(r-2,I+1)),p=s;h>p;++p)for(y=v*p,f=o;c>f;++f)for(Z=y+g*f,d=n;a>d;++d)l=Z+d,u(d,f,p,l)}var d,m,f,p,Y=0,X=!1,Z=e*i*r,g=e,v=e*i,y=new Int32Array(12),b=[],x=[],S=[],w=[];this.triangulate=function(t,e,i){kr&&Ir.time("MarchingCubes.triangulate"),Y=t,X=e,X||d||(d=new Float32Array(3*Z)),m||(m=new Int32Array(Z)),f=0,p=0,void 0!==i?(i.min.round(),i.max.round(),l(i.min.x,i.min.y,i.min.z,i.max.x,i.max.y,i.max.z)):l(),b.length=3*f,X||(x.length=3*f),S.length=p,n&&(w.length=f),kr&&Ir.timeEnd("MarchingCubes.triangulate");var r=b.length/3>65535?Uint32Array:Uint16Array;return{position:new Float32Array(b),normal:X?void 0:new Float32Array(x),index:new r(S),atomindex:n?new Int32Array(w):void 0}}}function Rt(t,e,i,r){kr&&Ir.time("laplacianSmooth"),i=i||1,r=r||!0;var n,o=t.length/3,s=e.length/3;r&&(n=new THREE.BufferGeometry,n.addAttribute("position",new THREE.BufferAttribute(t,3)),n.setIndex(new THREE.BufferAttribute(e,1)));var a,c=new Float32Array(3*o),h=20,u=new Array(h);for(a=0;h>a;++a)u[a]=new Uint32Array(o);for(a=0;o>a;++a)u[0][a]=0;var l,d,m;for(a=0;s>a;++a){var f=3*a,p=3*a+1,Y=3*a+2;for(m=!0,l=0,d=u[0][e[f]];d>l;++l)if(e[p]==u[l+1][e[f]]){m=!1;break}for(m&&(u[0][e[f]]++,u[u[0][e[f]]][e[f]]=e[p]),m=!0,l=0,d=u[0][e[f]];d>l;++l)if(e[Y]==u[l+1][e[f]]){m=!1;break}for(m&&(u[0][e[f]]++,u[u[0][e[f]]][e[f]]=e[Y]),m=!0,l=0,d=u[0][e[p]];d>l;++l)if(e[f]==u[l+1][e[p]]){m=!1;break}for(m&&(u[0][e[p]]++,u[u[0][e[p]]][e[p]]=e[f]),m=!0,l=0,d=u[0][e[p]];d>l;++l)if(e[Y]==u[l+1][e[p]]){m=!1;break}for(m&&(u[0][e[p]]++,u[u[0][e[p]]][e[p]]=e[Y]),m=!0,l=0;l<u[0][e[Y]];++l)if(e[f]==u[l+1][e[Y]]){m=!1;break}for(m&&(u[0][e[Y]]++,u[u[0][e[Y]]][e[Y]]=e[f]),m=!0,l=0,d=u[0][e[Y]];d>l;++l)if(e[p]==u[l+1][e[Y]]){m=!1;break}m&&(u[0][e[Y]]++,u[u[0][e[Y]]][e[Y]]=e[p])}for(var X,Z,g,v,y,b=1,x=.5,S=-1,w=1,A=.75/(w+3.5),C=0;i>C;++C){for(a=0;o>a;++a)if(X=3*a,g=u[0][a],3>g)c[X]=t[X],c[X+1]=t[X+1],c[X+2]=t[X+2];else if(3===g||4===g){for(c[X]=0,c[X+1]=0,c[X+2]=0,l=0;g>l;++l)Z=3*u[l+1][a],c[X]+=t[Z],c[X+1]+=t[Z+1],c[X+2]+=t[Z+2];c[X]+=x*t[X],c[X+1]+=x*t[X+1],c[X+2]+=x*t[X+2],y=x+g,c[X]/=y,c[X+1]/=y,c[X+2]/=y}else{for(c[X]=0,c[X+1]=0,c[X+2]=0,l=0;g>l;++l)Z=3*u[l+1][a],c[X]+=t[Z],c[X+1]+=t[Z+1],c[X+2]+=t[Z+2];c[X]+=b*t[X],c[X+1]+=b*t[X+1],c[X+2]+=b*t[X+2],v=b+g,c[X]/=v,c[X+1]/=v,c[X+2]/=v}if(t.set(c),r){n.computeVertexNormals();var _=n.attributes.normal.array,P=3*o;for(X=0;P>X;X+=3)t[X]+=S*A*_[X],t[X+1]+=S*A*_[X+1],t[X+2]+=S*A*_[X+2]}}r&&n.dispose(),kr&&Ir.timeEnd("laplacianSmooth")}function It(t,e,i,r,n,o,s){this.name=t,this.path=e,this.matrix=new THREE.Matrix4,this.normalMatrix=new THREE.Matrix3,this.inverseMatrix=new THREE.Matrix4,this.center=new THREE.Vector3,this.boundingBox=new THREE.Box3,this.setData(i,r,n,o,s),this.__data.length<=Math.pow(10,7)&&Nr.addObject(this)}function kt(t,e){function i(e){t(e,r)}function r(){var t=n.shift();void 0!==t?(o=!0,setTimeout(function(){i(t)})):o=!1}var n=[],o=!1;if(e){for(var s=0,a=e.length;a>s;++s)n.push(e[s]);r()}this.push=function(t){n.push(t),o||r()},this.kill=function(t){n.length=0},this.length=function(){return n.length}}function Nt(t,e,i){this.viewer=e,
this.queue=new kt(this.make.bind(this)),this.tasks=new bt,this.bufferList=[],this.init(i)}function Mt(t,e,i){Nt.call(this,t,e,i),this.buffer=t,this.build()}function Lt(t,e,i,r,n){var o=n||{};this.pickable=!1,this.dynamic=!0,this.opaqueBack=void 0!==o.opaqueBack?o.opaqueBack:!1,this.dullInterior=void 0!==o.dullInterior?o.dullInterior:!1,this.side=void 0!==o.side?o.side:THREE.DoubleSide,this.opacity=void 0!==o.opacity?o.opacity:1,this.clipNear=void 0!==o.clipNear?o.clipNear:0,this.flatShaded=void 0!==o.flatShaded?o.flatShaded:!1,this.background=void 0!==o.background?o.background:!1,this.linewidth=void 0!==o.linewidth?o.linewidth:1,this.wireframe=void 0!==o.wireframe?o.wireframe:!1,this.wireframeLinewidth=o.wireframeLinewidth||1,this.roughness=void 0!==o.roughness?o.roughness:.4,this.metalness=void 0!==o.metalness?o.metalness:0,this.diffuse=void 0!==o.diffuse?o.diffuse:16777215,this.forceTransparent=void 0!==o.forceTransparent?o.forceTransparent:!1,this.geometry=new THREE.BufferGeometry,this.addAttributes({position:{type:"v3",value:t},color:{type:"c",value:e}}),this.indexVersion=0,this.wireframeIndexVersion=-1,i&&(this.geometry.setIndex(new THREE.BufferAttribute(i,1)),this.geometry.getIndex().setDynamic(this.dynamic)),r&&(this.addAttributes({pickingColor:{type:"c",value:r}}),this.pickable=!0),this.uniforms=THREE.UniformsUtils.merge([THREE.UniformsLib.common,{fogColor:{value:null},fogNear:{value:0},fogFar:{value:0},opacity:{value:this.opacity},nearClip:{value:0}},{emissive:{value:new THREE.Color(0)},roughness:{value:this.roughness},metalness:{value:this.metalness}},THREE.UniformsLib.ambient,THREE.UniformsLib.lights]),this.uniforms.diffuse.value.set(this.diffuse);var s=new THREE.Uniform(0).onUpdate(function(t,e){this.value=Or?t.id:t.id/255});this.pickingUniforms={nearClip:{value:0},objectId:s},this.group=new THREE.Group,this.wireframeGroup=new THREE.Group,this.pickingGroup=new THREE.Group,this.makeWireframeGeometry()}function Bt(t,e,i,r,n,o){var s=o||{};this.size=t?t.length/3:0,this.attributeSize=this.size,this.vertexShader="Mesh.vert",this.fragmentShader="Mesh.frag",Lt.call(this,t,e,i,n,s),this.addAttributes({normal:{type:"v3",value:r}}),void 0===r&&this.geometry.computeVertexNormals()}function Ft(){Bt.apply(this,arguments)}function Dt(t){this.size=t.size,this.side=t.side,this.wireframe=t.wireframe,this.visible=t.visible,this.geometry=t.geometry,this.pickable=t.pickable,this.background=t.background,this.group=new THREE.Group,this.wireframeGroup=new THREE.Group,this.pickingGroup=new THREE.Group;var e=[],i=[],r=t,n=new t.constructor;r.makeMaterial(),n.makeMaterial(),n.geometry=t.geometry,n.wireframeGeometry=t.wireframeGeometry,n.size=t.size,n.attributeSize=t.attributeSize,n.pickable=t.pickable,n.setParameters(t.getParameters()),n.updateShader(),r.setParameters({side:THREE.FrontSide}),n.setParameters({side:THREE.BackSide,opacity:n.opacity}),this.getMesh=function(t){var o,s;return t?(s=n.getPickingMesh(),o=r.getPickingMesh()):(s=n.getMesh(),o=r.getMesh()),e.push(o),i.push(s),this.setParameters({side:this.side}),(new THREE.Group).add(s,o)},this.getWireframeMesh=function(){return t.getWireframeMesh()},this.getPickingMesh=function(){return this.getMesh(!0)},this.setAttributes=function(e){t.setAttributes(e)},this.setParameters=function(t){t=Object.assign({},t),t.side===THREE.FrontSide?(e.forEach(function(t){t.visible=!0}),i.forEach(function(t){t.visible=!1})):t.side===THREE.BackSide?(e.forEach(function(t){t.visible=!1}),i.forEach(function(t){t.visible=!0})):t.side===THREE.DoubleSide&&(e.forEach(function(t){t.visible=!0}),i.forEach(function(t){t.visible=!0})),void 0!==t.side&&(this.side=t.side),delete t.side,r.setParameters(t),void 0!==t.wireframe&&(this.wireframe=t.wireframe,this.setVisibility(this.visible)),delete t.wireframe,n.setParameters(t)},this.setVisibility=Lt.prototype.setVisibility,this.dispose=function(){r.dispose(),n.dispose()}}function jt(t,e,i){Nt.call(this,t,e,i),t instanceof It?(this.surface=void 0,this.volume=t):(this.surface=t,this.volume=void 0),this.boxCenter=new THREE.Vector3,this.__boxCenter=new THREE.Vector3,this.box=new THREE.Box3,this.__box=new THREE.Box3,this.setBox=function(){var t=new THREE.Vector3;return function(){var i=e.controls.target,r=e.rotationGroup.position;t.copy(r).negate().add(i),this.setParameters({boxCenter:t})}.bind(this)}.bind(this)(),this.viewer.signals.orientationChanged.add(this.setBox),this.build()}function zt(t){for(var e,i,r=t.vertices,n=r.length,o=new Float32Array(3*n),s=0;n>s;s++)e=3*s,i=r[s],o[e+0]=i.x,o[e+1]=i.y,o[e+2]=i.z;return o}function Ht(t){for(var e,i,r=t.faces,n=r.length,o=3*n>65535?Uint32Array:Uint16Array,s=new o(3*n),a=0;n>a;a++)e=3*a,i=r[a],s[e+0]=i.a,s[e+1]=i.b,s[e+2]=i.c;return s}function Vt(t){for(var e,i,r,n,o,s,a=t.faces,c=t.vertices.length,h=a.length,u=new Float32Array(3*c),l=0;h>l;l++)i=a[l],r=i.vertexNormals,n=r[0],o=r[1],s=r[2],e=3*i.a,u[e+0]=n.x,u[e+1]=n.y,u[e+2]=n.z,e=3*i.b,u[e+0]=o.x,u[e+1]=o.y,u[e+2]=o.z,e=3*i.c,u[e+0]=s.x,u[e+1]=s.y,u[e+2]=s.z;return u}function Ut(t,e,i,r){var n=r||{},o=this.geo,s=t.length/3,a=o.vertices.length,c=o.faces.length;this.size=s*a,this.positionCount=s,this.geoPosition=zt(o),this.geoNormal=Vt(o),this.geoIndex=Ht(o),this.transformedGeoPosition=new Float32Array(3*a),this.transformedGeoNormal=new Float32Array(3*a),this.meshPosition=new Float32Array(3*this.size),this.meshNormal=new Float32Array(3*this.size),this.meshColor=new Float32Array(3*this.size),this.meshPickingColor=new Float32Array(3*this.size);var h=this.meshPosition.length/3>65535?Uint32Array:Uint16Array;this.meshIndex=new h(s*c*3),this.makeIndex(),Bt.call(this,this.meshPosition,this.meshColor,this.meshIndex,this.meshNormal,this.meshPickingColor,n),this.initNormals=!0,this.setAttributes({position:t,color:e,pickingColor:i}),this.initNormals=!1}function Gt(t,e,i,r,n){var o=void 0!==n.sphereDetail?n.sphereDetail:1;this.geo=new THREE.IcosahedronGeometry(1,o),this.setPositionTransform(i),Ut.call(this,t,e,r,n)}function qt(t){this.size=this.count,this.attributeSize=this.count*this.mappingSize;var e=this.count*this.mappingIndicesSize,i=this.attributeSize>65535?Uint32Array:Uint16Array;this.index=new i(e),this.makeIndex(),Lt.call(this,null,null,this.index,null,t),this.addAttributes({mapping:{type:this.mappingType,value:null}})}function Wt(t){this.mapping=new Float32Array([-1,1,-1,-1,1,1,1,-1]),this.mappingIndices=new Uint16Array([0,1,2,1,3,2]),this.mappingIndicesSize=6,this.mappingType="v2",this.mappingSize=4,this.mappingItemSize=2,qt.call(this,t)}function Jt(t,e,i,r,n){this.impostor=!0,this.count=t.length/3,this.vertexShader="SphereImpostor.vert",this.fragmentShader="SphereImpostor.frag",Wt.call(this,n),this.addUniforms({projectionMatrixInverse:{value:new THREE.Matrix4},ortho:{value:0}}),this.addAttributes({radius:{type:"f",value:null}}),this.setAttributes({position:t,color:e,radius:i}),r&&(this.addAttributes({pickingColor:{type:"c",value:null}}),this.setAttributes({pickingColor:r}),this.pickable=!0),this.makeMapping()}function Kt(t,e,i,r,n){var o=n||{};return!Rr||o.disableImpostor?new Gt(t,e,i,r,n):new Jt(t,e,i,r,n)}function Qt(t){function e(t,e,i){return Math.min(Math.max(t,e),i)}function i(t,e,i,r){var n=i-t,o=r-e;return Math.sqrt(n*n+o*o)}function n(t,i,r){return r=e((r-t)/(i-t),0,1),r*r*(3-2*r)}for(var o=Object.assign({},t),s=r(o.width,256),a=r(o.height,256),c=[s/2,a/2],h=Math.min(s/2,a/2),u=r(o.delta,1/(h+1))*h,l=0,d=0,m=new Uint8Array(s*a*4),f=0,p=m.length;p>f;f+=4){var Y=i(l,d,c[0],c[1]),X=1-n(h-u,h,Y);m[f]=255*X,m[f+1]=255*X,m[f+2]=255*X,m[f+3]=255*X,++l===s&&(l=0,d++)}var Z=new THREE.DataTexture(m,s,a);return Z.needsUpdate=!0,Z}function $t(t,e,i){var r=i||{};this.point=!0,this.pointSize=void 0!==r.pointSize?r.pointSize:1,this.sizeAttenuation=void 0!==r.sizeAttenuation?r.sizeAttenuation:!0,this.sortParticles=void 0!==r.sortParticles?r.sortParticles:!1,this.alphaTest=void 0!==r.alphaTest?r.alphaTest:.5,this.useTexture=void 0!==r.useTexture?r.useTexture:!1,this.forceTransparent=void 0!==r.forceTransparent?r.forceTransparent:!1,this.edgeBleach=void 0!==r.edgeBleach?r.edgeBleach:0,this.size=t.length/3,this.attributeSize=this.size,this.vertexShader="Point.vert",this.fragmentShader="Point.frag",Lt.call(this,t,e,void 0,void 0,r),this.addUniforms({size:{value:this.pointSize},canvasHeight:{value:1},pixelRatio:{value:1},map:{value:null}})}function te(t,e,i){Nt.call(this,t,e,i),t instanceof It?(this.surface=void 0,this.volume=t):(this.surface=t,this.volume=void 0),this.build()}function ee(t,e,i){var r=i||{};if(this.dataList=[],this.structure=t,this.selection=new p(r.sele),this.structureView=this.structure.getView(this.selection),Nt.call(this,t,e,r),t.biomolDict){var n={"default":"default","":t.unitcell?"AU":"FULL"};Object.keys(t.biomolDict).forEach(function(t){n[t]=t}),this.parameters.assembly={type:"select",options:n,rebuild:!0}}else this.parameters.assembly=null;this.selection.signals.stringChanged.add(function(){this.build()}.bind(this)),this.build()}function ie(t,e,i,r,n,o,s,a){var c=void 0!==a.radiusSegments?a.radiusSegments:10;this.updateNormals=!0;var h=(new THREE.Matrix4).makeRotationX(Math.PI/2);this.geo=new THREE.CylinderGeometry(1,1,1,c,1,!0),this.geo.applyMatrix(h);var u=t.length,l=n.length;this._position=new Float32Array(2*u),this._color=new Float32Array(2*u),this._pickingColor=new Float32Array(2*u),this._from=new Float32Array(2*u),this._to=new Float32Array(2*u),this._radius=new Float32Array(2*l),this.__center=new Float32Array(u),Ut.call(this,this._position,this._color,this._pickingColor,a),this.setPositionTransform(this._from,this._to,this._radius),this.setAttributes({position1:t,position2:e,color:i,color2:r,radius:n,pickingColor:o,pickingColor2:s})}function re(t){this.mapping=new Float32Array([-1,1,-1,-1,-1,-1,1,1,-1,1,1,1,1,-1,-1,1,-1,1]),this.mappingIndices=new Uint16Array([0,1,2,1,4,2,2,4,3,4,5,3]),this.mappingIndicesSize=12,this.mappingType="v3",this.mappingSize=6,this.mappingItemSize=3,qt.call(this,t)}function ne(t,e,i,r,n,o,s,a){var c=a||{};this.shift=void 0!==c.shift?c.shift:0,this.cap=void 0!==c.cap?c.cap:!0,this.impostor=!0,this.count=t.length/3,this.vertexShader="CylinderImpostor.vert",this.fragmentShader="CylinderImpostor.frag",re.call(this,c);var h=new THREE.Uniform(new THREE.Matrix4).onUpdate(function(t,e){this.value.getInverse(t.modelViewMatrix)});this.addUniforms({modelViewMatrixInverse:h,shift:{value:this.shift},ortho:{value:0}}),this.addAttributes({position1:{type:"v3",value:null},position2:{type:"v3",value:null},color2:{type:"c",value:null},radius:{type:"f",value:null}}),this.setAttributes({position:U(t,e),position1:t,position2:e,color:i,color2:r,radius:n}),o&&(this.addAttributes({pickingColor:{type:"c",value:null},pickingColor2:{type:"c",value:null}}),this.setAttributes({pickingColor:o,pickingColor2:s}),this.pickable=!0),this.makeMapping()}function oe(t,e,i,r,n,o,s,a){var c=a||{};return!Rr||c.disableImpostor?new ie(t,e,i,r,n,o,s,a):new ne(t,e,i,r,n,o,s,a)}function se(t,e,i,r,n){var o=n||{};this.size=t.length/3,this.vertexShader="Line.vert",this.fragmentShader="Line.frag",this.line=!0;var s=this.size,a=2*s*2;this.attributeSize=a,this.linePosition=new Float32Array(3*a),this.lineColor=new Float32Array(3*a),Lt.call(this,this.linePosition,this.lineColor,void 0,void 0,o),this.setAttributes({from:t,to:e,color:i,color2:r})}function ae(t,e,i){this.manualAttach=!0,this.trajectory=t,ee.call(this,t.structure,e,i)}function ce(t,e,i,r){kr&&Ir.time("makeRepresentation "+t);var n;if("buffer"===t)n=Mt;else if(e instanceof vt){if(n=jr.get(t),!n)return void Ir.error("makeRepresentation: representation type "+t+" unknown")}else if(e instanceof Pt||e instanceof It)if("surface"===t)n=jt;else{if("dot"!==t)return void Ir.error("makeRepresentation: representation type "+t+" unknown");n=te}else{if(!(e instanceof Trajectory))return void Ir.error("makeRepresentation: object "+e+" unknown");n=ae}var o=new n(e,i,r);return kr&&Ir.timeEnd("makeRepresentation "+t),o}function he(t,e,i,r){var n=i||{};n.name=void 0!==n.name?n.name:e.type,ue.call(this,t,n),this.parent=r,this.setRepresentation(e)}function ue(t,e){Object.defineProperty(this,"id",{value:Cn++});var i=e||{};this.name=i.name,this.uuid=THREE.Math.generateUUID(),this.visible=void 0!==i.visible?i.visible:!0;var r=Object.keys(this.signals);this.signals={},r.forEach(function(t){this.signals[t]=new signals.Signal},this),this.stage=t,this.viewer=t.viewer,this.reprList=[]}function le(t){this.list=t||[];for(var e=this.list.length,i=0;e>i;++i){var r=this.list[i];r.signals.disposed.add(function(){this._remove(r)},this)}}function de(t){le.call(this,t)}function me(t){NGL.Collection.call(this,t)}function fe(t,e,i,r){var n=i||{};n.name=void 0!==n.name?n.name:e.name,ue.call(this,t,n),this.trajectory=e,this.parent=r,this.status="loaded",e.signals.frameChanged.add(function(t){this.signals.frameChanged.dispatch(t)},this),e.signals.playerChanged.add(function(t){this.signals.playerChanged.dispatch(t)},this),e.signals.gotNumframes.add(function(t){this.signals.gotNumframes.dispatch(t)},this),void 0!==n.i&&this.setFrame(n.i)}function pe(t,e){var i=jsfeat.F32_t|jsfeat.C1_t;return new jsfeat.matrix_t(t,e,i)}function Ye(t,e){var i;"function"==typeof t.eachSelectedAtom?i=t.atomCount:t instanceof Float32Array&&(i=t.length/3);var r=new pe(3,i),n=new pe(3,i);this.coords1t=new pe(i,3),this.coords2t=new pe(i,3),this.A=new pe(3,3),this.W=new pe(1,3),this.U=new pe(3,3),this.V=new pe(3,3),this.VH=new pe(3,3),this.R=new pe(3,3),this.tmp=new pe(3,3),this.c=new pe(3,3),this.c.data.set([1,0,0,0,1,0,0,0,-1]),this.prepCoords(t,r),this.prepCoords(e,n),this._superpose(r,n)}function Xe(t,e,i){var r=signals;this.signals={gotNumframes:new r.Signal,frameChanged:new r.Signal,selectionChanged:new r.Signal,playerChanged:new r.Signal},this.params={centerPbc:!0,removePbc:!0,superpose:!0},this.name=t.replace(/^.*[\\\/]/,""),this.selection=new p(i||"backbone and not hydrogen"),this.selection.signals.stringChanged.add(function(t){this.makeIndices(),this.resetCache()},this),this.setStructure(e),this.trajPath=t,this.numframes=void 0,this.getNumframes()}function Ze(t,e,i){t instanceof Promise?t.then(function(t){this.setFrames(t),this.getNumframes()}.bind(this)):this.setFrames(t),Xe.call(this,"",e,i)}function ge(t,e,i){t="",Xe.call(this,t,e,i)}function ve(t,e,i){Xe.call(this,t,e,i)}function ye(t,e,i){var r;return r="frames"===t.type||t instanceof Promise?new Ze(t,e,i):!t&&e.frames?new ge(t,e,i):new ve(t,e,i)}function be(t){var e=signals;this.signals={stringChanged:new e.Signal},this.setString(t)}function xe(t,e,i,r,n){this.seq1=t,this.seq2=e,this.gapPenalty=i||-10,this.gapExtensionPenalty=r||-1,this.substMatrix=n||"blosum62",this.substMatrix&&(this.substMatrix=Pn[this.substMatrix])}function Se(t,e,i,r,n,o,s){i=i||!1,r=r||"",n=n||"",o=o||"",s=s||"";var a,c;if(i){var h=t,u=e;r&&n&&(h=new NGL.StructureSubset(t,new be(r)),u=new NGL.StructureSubset(e,new be(n)));var l=h.getSequence(),d=u.getSequence(),m=new xe(l.join(""),d.join(""));m.calc(),m.trace();var f,p,Y,X,Z,g=0,v=0,y=m.ali1.length,b=[],x=[];for(f=0;y>f;++f)X=m.ali1[f],Z=m.ali2[f],p=0,Y=0,"-"===X?x[v]=!1:(x[v]=!0,p=1),"-"===Z?b[g]=!1:(b[g]=!0,Y=1),g+=p,v+=Y;a=new NGL.AtomSet,c=new NGL.AtomSet,g=0,h.eachResidue(function(t){t.getResname1()&&t.getAtomByName("CA")&&(b[g]&&a.addAtom(t.getAtomByName("CA")),g+=1)}),g=0,u.eachResidue(function(t){t.getResname1()&&t.getAtomByName("CA")&&(x[g]&&c.addAtom(t.getAtomByName("CA")),g+=1)})}else a=new NGL.AtomSet(t,new NGL.Selection(r+" and .CA")),c=new NGL.AtomSet(e,new NGL.Selection(n+" and .CA"));if(o&&s){var g,S,w,A=new NGL.AtomSet,C=new NGL.AtomSet,_=new be(o),P=new be(s),E=_.test,T=P.test,y=a.atomCount;for(g=0;y>g;++g)S=a.atoms[g],w=c.atoms[g],E(S)&&T(w)&&(A.addAtom(S),C.addAtom(w));a=A,c=C}var O=new Ye(a,c),R=new NGL.AtomSet(t,new be("*"));O.transform(R),t.center=t.atomCenter()}function we(t,e,i){var r=i||{};r.name=void 0!==r.name?r.name:e.name,ue.call(this,t,r),this.structure=e,this.trajList=[],this.initSelection(r.sele),this.setDefaultAssembly(r.assembly||"")}function Ae(t,e,i){var r=i||{};r.name=void 0!==r.name?r.name:e.name,ue.call(this,t,r),this.surface=e}function Ce(t,e,i){var r=i||{};r.name=void 0!==r.name?r.name:e.name,ue.call(this,t,r),this.script=e,this.status="loaded",this.script.signals.nameChanged.add(function(t){this.setName(t)},this)}function _e(t,e,i){var r;return"Structure"===e.type?r=new we(t,e,i):"Surface"==e.type||"Volume"===e.type?r=new Ae(t,e,i):"Script"===e.type?r=new Ce(t,e,i):Ir.warn("makeComponent: object type unknown",e),r}function Pe(t,e){var i=e||{};this.compressed=void 0!==i.compressed?i.compressed:!1,this.binary=void 0!==i.binary?i.binary:!1,this.json=void 0!==i.json?i.json:!1,this.src=t,this.chunkSize=10485760,this.newline="\n",this.__pointer=0,this.__partialLine="",this.__srcName&&(this[this.__srcName]=t)}function Ee(t,e){Pe.call(this,t,e)}function Te(t,e){Pe.call(this,t,e)}function Oe(t,e){var i=Object.assign({},e),r=["mmtf","dcd","mrc","ccp4","map","dxbin"],n=-1!==r.indexOf(i.ext);this.compressed=i.compressed||!1,this.binary=void 0!==i.binary?i.binary:n,this.name=i.name||"",this.ext=i.ext||"",this.dir=i.dir||"",this.path=i.path||"",this.protocol=i.protocol||"",this.params=e;var o={compressed:this.compressed,binary:this.binary,json:"json"===this.ext};self.File&&t instanceof File||self.Blob&&t instanceof self.Blob?this.streamer=new Ee(t,o):this.streamer=new Te(t,o),"function"==typeof i.onProgress&&(this.streamer.onprogress=i.onprogress)}function Re(t,e){var i=e||{};this.streamer=t,this.name=i.name,this.path=i.path}function Ie(t){function e(t){for(var e=l.atomCount[t],n=l.atomOffset[t],o=new Array(e),s=0;e>s;++s)o[s]=u.atomTypeId[n+s];l.residueTypeId[t]=f.add(i,o,r)}var i,r,n=null,o=null,s=null,a=null,c=null,h=null,u=t.atomStore,l=t.residueStore,d=t.chainStore,m=t.modelStore,f=t.residueMap,p=-1,Y=-1,X=-1,Z=-1;this.addAtom=function(t,f,g,v,y,b,x){var S=!1,w=!1,A=!1;n!==t?(S=!0,w=!0,A=!0,Z+=1,X+=1,Y+=1):o!==f?(w=!0,A=!0,X+=1,Y+=1):a===v&&s===g&&c===x||(A=!0,Y+=1),p+=1,S&&(m.growIfFull(),m.chainOffset[Z]=X,m.chainCount[Z]=0,m.count+=1,d.modelIndex[X]=Z),w&&(d.growIfFull(),d.setChainname(X,f),d.residueOffset[X]=Y,d.residueCount[X]=0,d.count+=1,d.modelIndex[X]=Z,m.chainCount[Z]+=1,l.chainIndex[Y]=X),A&&(i=s,r=h,Y>0&&e(Y-1),l.growIfFull(),l.resno[Y]=v,void 0!==b&&(l.sstruc[Y]=b.charCodeAt(0)),void 0!==x&&(l.inscode[Y]=x.charCodeAt(0)),l.atomOffset[Y]=p,l.atomCount[Y]=0,l.count+=1,l.chainIndex[Y]=X,d.residueCount[X]+=1),u.count+=1,u.residueIndex[p]=Y,l.atomCount[Y]+=1,n=t,o=f,s=g,a=v,c=x,h=y},this.finalize=function(){i=s,r=h,Y>-1&&e(Y)}}function ke(t,e){var i=e||{};this.firstModelOnly=i.firstModelOnly||!1,this.asTrajectory=i.asTrajectory||!1,this.cAlphaOnly=i.cAlphaOnly||!1,this.reorderAtoms=i.reorderAtoms||!1,this.dontAutoBond=i.dontAutoBond||!1,this.doAutoSS=!0,Re.call(this,t,i),this.structure=new vt(this.name,this.path),this.structureBuilder=new Ie(this.structure)}function Ne(t,e){ke.call(this,t,e),this.structure._doAutoSS=!0,this.structure._doAutoChainName=!0}function Me(t,e){ke.call(this,t,e)}function Le(t,e){ke.call(this,t,e)}function Be(t,e){ke.call(this,t,e)}function Fe(t,e){ke.call(this,t,e)}function De(t,e){ke.call(this,t,e)}function je(t,e){ke.call(this,t,e),this.dontAutoBond=!0,this.autoBondBetween=!1,this.doAutoSS=!1}function ze(t,e){this.name=t,this.path=e,this.coordinates=[],this.boxes=[]}function He(t,e){var i=e||{};Re.call(this,t,i),this.frames=new ze(this.name,this.path)}function Ve(t,e){var i=e||{};He.call(this,t,i)}function Ue(t,e){Re.call(this,t,e)}function Ge(t,e){Re.call(this,t,e)}function qe(t,e){Re.call(this,t,e)}function We(t,e){qe.call(this,t,e)}function Je(t,e){var i=e||{};Re.call(this,t,i),this.loader=void 0,this.surface=new Pt(this.name,this.path)}function Ke(t,e){var i=e||{};Je.call(this,t,i),this.loader=new THREE.PLYLoader}function Qe(t,e){var i=e||{};Je.call(this,t,i),this.loader=new THREE.OBJLoader}function $e(t,e){var i=e||{};Re.call(this,t,i),this.text={name:this.name,path:this.path,data:""}}function ti(t,e){var i=e||{};Re.call(this,t,i),this.table={name:this.name,path:this.path,colNames:[],data:[]}}function ei(t,e){var i=e||{};Re.call(this,t,i),this.json={name:this.name,path:this.path,data:{}}}function ii(t,e){var i=e||{};Re.call(this,t,i),this.xml={name:this.name,path:this.path,data:{}}}function ri(t,e){Oe.call(this,t,e),this.useWorker=void 0===this.params.useWorker?!1:this.params.useWorker}function ni(t,e,i){var r=signals;this.signals={elementAdded:new r.Signal,elementRemoved:new r.Signal,nameChanged:new r.Signal},this.name=e,this.path=i,this.dir=i.substring(0,i.lastIndexOf("/")+1);try{this.fn=new Function("stage","panel","__name__","__path__","__dir__",t)}catch(n){Ir.error("Script compilation failed",n),this.fn=null}}function oi(t,e){Oe.call(this,t,e)}function si(t,e){Oe.call(this,t,e)}function ai(t){var e=s(t),i=Dr.get(e.protocol),r=i.getUrl(e.src),n=s(r);return!n.ext&&i.getExt&&(n.ext=i.getExt(t)),n}function ci(t,e){var i=Object.assign(ai(t),e),r=new Tn[i.ext](i.src,i);return r?r.load():Promise.reject("autoLoad: ext '"+i.ext+"' unknown")}function hi(t,e){if(this.signals={parametersChanged:new signals.Signal,fullscreenChanged:new signals.Signal,componentAdded:new signals.Signal,componentRemoved:new signals.Signal,atomPicked:new signals.Signal,bondPicked:new signals.Signal,volumePicked:new signals.Signal,nothingPicked:new signals.Signal,onPicking:new signals.Signal},this.tasks=new bt,this.compList=[],this.defaultFileParams={},this.viewer=new _t(t),this.viewer.renderer){var i=Object.assign({impostor:!0,quality:"medium",sampleLevel:0,backgroundColor:"black",rotateSpeed:2,zoomSpeed:1.2,panSpeed:.8,clipNear:0,clipFar:100,clipDist:10,fogNear:50,fogFar:100,cameraFov:40,cameraType:"perspective",lightColor:14540253,lightIntensity:1,ambientColor:14540253,ambientIntensity:.2},e);this.parameters=o(hi.prototype.parameters),this.setParameters(i),this.pickingControls=new xn(this.viewer,this),this.viewer.animate()}}function ui(t,e,i){ee.call(this,t,e,i)}function li(t,e,i){ui.call(this,t,e,i)}function di(t,e,i){ui.call(this,t,e,i)}function mi(t,e){function i(t,i,r,n,o){var s=(r-t)*e,a=(n-i)*e,c=o*o,h=o*c;return(2*i-2*r+s+a)*h+(-3*i+3*r-2*s-a)*c+s*o+i}function r(t,e,r,n,o,s,a){s[a+0]=i(t.x,e.x,r.x,n.x,o),s[a+1]=i(t.y,e.y,r.y,n.y,o),s[a+2]=i(t.z,e.z,r.z,n.z,o)}function n(t,e,r,n,o,s){s.x=i(t.x,e.x,r.x,n.x,o),s.y=i(t.y,e.y,r.y,n.y,o),s.z=i(t.z,e.z,r.z,n.z,o)}function o(e,i,n,o,s,a){for(var c=0;t>c;++c){var h=a+3*c,u=d*c;r(e,i,n,o,u,s,h)}}function s(e,i,r,o,s,a){for(var c=0;t>c;++c){var h=d*c,u=h-m,l=h+m,Y=a+3*c;0>u&&(u=0),l>1&&(l=1),n(e,i,r,o,u,f),n(e,i,r,o,l,p),p.sub(f).normalize(),p.toArray(s,Y)}}function a(e,i,r,n,o){for(var s,a=i.next(),c=i.next(),h=i.next(),u=i.size,l=u-1,d=n||0,m=0;l>m;++m)s=a,a=c,c=h,h=i.next(),e(s,a,c,h,r,d),d+=3*t;o&&(s=i.get(u-2),a=i.get(u-1),c=i.get(0),h=i.get(1),e(s,a,c,h,r,d),d+=3*t)}function c(e,i,r,o,s,a,c,h,u,l,m,y,b){for(var x=0;t>x;++x){var S=y+3*x;b&&(S+=3*v);var w=d*x;n(e,i,r,o,w,f),n(s,a,c,h,w,p),Y.subVectors(p,f).normalize(),X.fromArray(u,S),g.crossVectors(Y,X).normalize(),g.toArray(m,S),Z.crossVectors(X,g).normalize(),Z.toArray(l,S)}}function h(e,i,r,n,o){for(var s=0;t>s;++s){var a=o+3*s;e.copy(Z),X.fromArray(i,a),g.crossVectors(e,X).normalize(),g.toArray(n,a),Z.crossVectors(X,g).normalize(),Z.toArray(r,a)}}function u(e,i,r,n,o,s,a){for(var c=0;v>c;++c){var h=a+3*c;r(e,o,h),n(e,s,h)}for(var c=v;t>c;++c){var h=a+3*c;r(i,o,h),n(i,s,h)}}function l(e,i,r,n,o){for(var s=r(e),a=r(i),c=0;t>c;++c){var h=c/t;n[o+c]=(1-h)*s+h*a}}var d=1/t,m=1e-4,f=new THREE.Vector3,p=new THREE.Vector3;this.getPosition=function(e,i,r,n){e.reset(),a(o,e,i,r,n);var s=e.size-1,c=s*t*3;n&&(c+=3*t);var h=e.get(n?0:s);i[c]=h.x,i[c+1]=h.y,i[c+2]=h.z},this.getTangent=function(e,i,r,n){e.reset(),a(s,e,i,r,n);var o=e.size-1,c=o*t*3;n&&(c+=3*t),J(i,i,c-3,c,3)};var Y=new THREE.Vector3,X=new THREE.Vector3,Z=new THREE.Vector3,g=new THREE.Vector3,v=Math.ceil(t/2);this.getNormal=function(e,i,r,n,o,s,a){Z.set(0,0,1);for(var c=e,u=c-1,l=o||0,d=0;u>d;++d)h(Y,i,r,n,l),l+=3*t;s&&(h(Y,i,r,n,l),l+=3*t),g.toArray(n,l),Z.toArray(r,l)},this.getNormalDir=function(e,i,r,n,o,s,a,h){e.reset(),i.reset();var u=new THREE.Vector3,l=new THREE.Vector3,d=new THREE.Vector3,m=new THREE.Vector3,f=new THREE.Vector3,p=(new THREE.Vector3).copy(e.next()),Y=(new THREE.Vector3).copy(e.next()),X=(new THREE.Vector3).copy(e.next()),y=new THREE.Vector3,b=(new THREE.Vector3).copy(i.next()),x=(new THREE.Vector3).copy(i.next()),S=(new THREE.Vector3).copy(i.next());Z.set(0,0,1);for(var w=e.size,A=w-1,C=s||0,_=0;A>_;++_)f.copy(p),p.copy(Y),Y.copy(X),X.copy(e.next()),y.copy(b),b.copy(x),x.copy(S),S.copy(i.next()),0===_?(u.subVectors(y,f),l.subVectors(b,p),u.dot(l)<0&&(l.multiplyScalar(-1),b.addVectors(p,l)),d.subVectors(x,Y),l.dot(d)<0&&(d.multiplyScalar(-1),x.addVectors(Y,d))):d.copy(m),m.subVectors(S,X),d.dot(m)<0&&(m.multiplyScalar(-1),S.addVectors(X,m)),c(f,p,Y,X,y,b,x,S,r,n,o,C,h),C+=3*t;if(a&&(f.copy(e.get(w-2)),p.copy(e.get(w-1)),Y.copy(e.get(0)),X.copy(e.get(1)),y.copy(i.get(w-2)),b.copy(i.get(w-1)),x.copy(i.get(0)),S.copy(i.get(1)),d.copy(m),m.subVectors(S,X),d.dot(m)<0&&(m.multiplyScalar(-1),S.addVectors(X,m)),c(f,p,Y,X,y,b,x,S,r,n,o,C,h),C+=3*t),h){g.fromArray(o,3*v),Z.fromArray(n,3*v);for(var P=0;v>P;++P)g.toArray(o,3*P),Z.toArray(n,3*P)}else g.toArray(o,C),Z.toArray(n,C)},this.getColor=function(e,i,r,n,o,s,a){e.reset();for(var c=e.next(),h=e.next(),l=e.size,d=l-1,m=s||0,f=0;d>f;++f)c=h,h=e.next(),u(c,h,i,r,n,o,m),m+=3*t;a&&(c=e.get(l-1),h=e.get(0),u(c,h,i,r,n,o,m),m+=3*t),n[m]=n[m-3],n[m+1]=n[m-2],n[m+2]=n[m-1],o[m]=o[m-3],o[m+1]=o[m-2],o[m+2]=o[m-1]},this.getSize=function(e,i,r,n,o){e.reset();for(var s=e.next(),a=e.next(),c=e.size,h=c-1,u=n||0,d=0;h>d;++d)s=a,a=e.next(),l(s,a,i,r,u),u+=t;o&&(s=e.get(c-1),a=e.get(0),l(s,a,i,r,u),u+=t),r[u]=r[u-1]}}function fi(t,e){this.polymer=t,this.size=t.residueCount;var i=e||{};this.directional=i.directional||!1,this.positionIterator=i.positionIterator||!1,this.subdiv=i.subdiv||1,this.smoothSheet=i.smoothSheet||!1,isNaN(i.tension)?this.tension=this.polymer.isNucleic()?.5:.9:this.tension=i.tension||.5,this.interpolator=new mi(this.subdiv,this.tension)}function pi(t,e,i,r,n,o,s,a){var c=a||{};this.aspectRatio=void 0!==c.aspectRatio?c.aspectRatio:1,this.radialSegments=void 0!==c.radialSegments?c.radialSegments:4,this.capped=void 0!==c.capped?c.capped:!1,this.capVertices=this.capped?this.radialSegments:0,this.capTriangles=this.capped?this.radialSegments-2:0;var h=t.length/3,u=h-1,l=(this.radialSegments+1,h*this.radialSegments*3+2*this.capVertices*3);this.size2=h,this.meshPosition=new Float32Array(l),this.meshColor=new Float32Array(l),this.meshNormal=new Float32Array(l),this.meshPickingColor=s?new Float32Array(l):void 0;var d=2*u*this.radialSegments*3+2*this.capTriangles*3,m=this.meshPosition.length/3>65535?Uint32Array:Uint16Array;this.meshIndex=new m(d),this.makeIndex(),Bt.call(this,this.meshPosition,this.meshColor,this.meshIndex,this.meshNormal,this.meshPickingColor,c),this.setAttributes({position:t,normal:e,binormal:i,tangent:r,color:n,size:o,pickingColor:s})}function Yi(t,e,i){ee.call(this,t,e,i)}function Xi(t,e){this.sview1=t,this.sview2=e,this.kdtree2=new tt(e)}function Zi(t,e,i){e=e||3.5,i=i||40;for(var r=new p("( ARG and ( .NE or .NH1 or .NH2 ) ) or ( ASP and .ND2 ) or ( GLN and .NE2 ) or ( HIS and ( .ND1 or .NE2 ) ) or ( LYS and .NZ ) or ( SER and .OG ) or ( THR and .OG1 ) or ( TRP and .NE1 ) or ( TYR and .OH ) or ( PROTEIN and .N )"),n=new p("( ASN and .OD1 ) or ( ASP and ( OD1 or .OD2 ) ) or ( GLN and .OE1 ) or ( GLU and ( .OE1 or .OE2 ) ) or ( HIS and ( .ND1 or .NE2 ) ) or ( SER and .OG ) or ( THR and .OG1 ) or ( TYR and .OH ) or ( PROTEIN and .O )"),o=t.getView(r),s=t.getView(n),a=new Xi(o,s),c=a.within(e),h=c.bondStore,u=t.getAtomProxy(),l=t.getAtomProxy(),d=t.getAtomProxy(),m=t.getAtomProxy(),f=t.getResidueProxy(),Y=t.getResidueProxy(),X=new THREE.Vector3,Z=new THREE.Vector3,g=function(t,e,r,n){var o,s;t.atomname===r?(o=t,s=e):(o=e,s=t),f.index=o.residueIndex;var a=f.getAtomIndexByName(n)+f.atomOffset;return X.subVectors(a,o),Z.subVectors(a,s),THREE.Math.radToDeg(X.angleTo(Z))<i},v=0,y=h.count;y>v;++v)if(u.index=h.atomIndex1[v],l.index=h.atomIndex2[v],"O"===u.atomname&&"N"===l.atomname||"N"===u.atomname&&"O"===l.atomname)c.bondSet.flip_unsafe(v);else if("N"===u.atomname||"N"===l.atomname){var b,x;if("N"===u.atomname?(b=u,x=l):(b=l,x=u),f.index=b.residueIndex,d.index=f.getAtomIndexByName("CA")+f.atomOffset,void 0===d.index)continue;var S=f.getPreviousConnectedResidue(Y);if(void 0===S)continue;if(m.index=S.getAtomIndexByName("C")+S.atomOffset,void 0===m.index)continue;X.subVectors(b,m),Z.subVectors(b,d),X.add(Z).multiplyScalar(.5),Z.subVectors(x,b),THREE.Math.radToDeg(X.angleTo(Z))>i&&c.bondSet.flip_unsafe(v)}else("OH"===u.atomname&&"TYR"===u.resname||"OH"===l.atomname&&"TYR"===l.resname)&&(g(u,l,"OH","CZ")||c.bondSet.flip_unsafe(v));return{atomSet:c.atomSet,bondSet:c.bondSet,bondStore:c.bondStore}}function gi(t,e,i){e=e||3.5,i=i||40;for(var r=new p("( PROTEIN and .N )"),n=new p("( PROTEIN and .O )"),o=t.getView(r),s=t.getView(n),a=new Xi(o,s),c=a.within(e),h=c.bondStore,u=t.getAtomProxy(),l=t.getAtomProxy(),d=t.getAtomProxy(),m=t.getAtomProxy(),f=t.getResidueProxy(),Y=t.getResidueProxy(),X=new THREE.Vector3,Z=new THREE.Vector3,g=0,v=h.count;v>g;++g){u.index=h.atomIndex1[g],l.index=h.atomIndex2[g];var y,b;if("N"===u.atomname?(y=u,b=l):(y=l,b=u),f.index=y.residueIndex,d.index=f.getAtomIndexByName("CA")+f.atomOffset,void 0!==d.index){var x=f.getPreviousConnectedResidue(Y);void 0!==x&&(m.index=x.getAtomIndexByName("C")+x.atomOffset,void 0!==m.index&&(X.subVectors(y,m),Z.subVectors(y,d),X.add(Z).multiplyScalar(.5),Z.subVectors(b,y),THREE.Math.radToDeg(X.angleTo(Z))>i&&c.bondSet.flip_unsafe(g)))}}return{atomSet:c.atomSet,bondSet:c.bondSet,bondStore:c.bondStore}}function vi(t,e,i){ee.call(this,t,e,i)}function yi(t){var e=Object.assign({},t);if(this.font=void 0!==e.font?e.font:["sans-serif"],this.size=e.size||36,this.style=void 0!==e.style?e.style:"normal",this.variant=void 0!==e.variant?e.variant:"normal",this.weight=void 0!==e.weight?e.weight:"normal",this.outline=void 0!==e.outline?e.outline:0,this.width=e.width||1024,this.height=e.height||1024,this.gamma=1,"undefined"!=typeof navigator){var i=navigator.userAgent;i.match(/Chrome/)&&i.match(/OS X/)&&(this.gamma=.5)}this.mapped={},this.scratchW=0,this.scratchH=0,this.currentX=0,this.currentY=0,this.build(e)}function bi(t,e,i,r,n){var o=n||{};o.forceTransparent=!0,this.fontFamily=void 0!==o.fontFamily?o.fontFamily:"sans-serif",this.fontStyle=void 0!==o.fontStyle?o.fontStyle:"normal",this.fontWeight=void 0!==o.fontWeight?o.fontWeight:"bold",this.fontSize=void 0!==o.fontSize?o.fontSize:48,this.sdf=void 0!==o.sdf?o.sdf:!0,this.xOffset=void 0!==o.xOffset?o.xOffset:0,this.yOffset=void 0!==o.yOffset?o.yOffset:0,this.zOffset=void 0!==o.zOffset?o.zOffset:.5;for(var s=t.length/3,a=0,c=0;s>c;++c)a+=r[c].length;this.text=r,this.count=a,this.positionCount=s,this.vertexShader="SDFFont.vert",this.fragmentShader="SDFFont.frag",Wt.call(this,o),this.addUniforms({fontTexture:{value:null},xOffset:{value:this.xOffset},yOffset:{value:this.yOffset},zOffset:{value:this.zOffset},ortho:{value:0}}),this.addAttributes({inputTexCoord:{type:"v2",value:null},inputSize:{type:"f",value:null}}),this.setAttributes({position:t,size:e,color:i}),this.makeTexture(),this.makeMapping()}function xi(t,e,i){ee.call(this,t,e,i)}function Si(t,e,i){var r=i||{};this.size=t.length/3,this.vertexShader="Line.vert",this.fragmentShader="Line.frag",this.line=!0;var n=this.size,o=2*n;this.attributeSize=o,this.scale=r.scale||1;var s=new THREE.Color(r.color||"grey");this.linePosition=new Float32Array(3*o),this.lineColor=q(o,s.r,s.g,s.b),Lt.call(this,this.linePosition,this.lineColor,void 0,void 0,r),this.setAttributes({position:t,vector:e})}function wi(t,e,i){ee.call(this,t,e,i)}function Ai(t,e,i){ui.call(this,t,e,i)}function Ci(t,e,i,r,n,o,s,a,c){var h=c||{};return!Rr||h.disableImpostor?new ie(t,e,i,r,W(n,o),s,a,c):new HyperballStickImpostorBuffer(t,e,i,r,n,o,s,a,c);
}function _i(t,e,i){Ai.call(this,t,e,i),this.defaultScale.vdw=.2}function Pi(t,e){this.type=t,this.text=e||{}}function Ei(t,e,i){ee.call(this,t,e,i)}function Ti(t,e,i){ee.call(this,t,e,i)}function Oi(t,e,i,r,n){function o(t,r,o){return((t*e+r)*i+o)*n}r=r||Int32Array,n=n||1;var s,a=new r(t*e*i*n);this.data=a,this.index=o,this.set=function(t,e,i){var r=o(t,e,i);for(s=0;n>s;++s)a[r+s]=arguments[3+s]},this.toArray=function(t,e,i,r,c){var h=o(t,e,i);for(void 0===r&&(r=[]),void 0===c&&(c=0),s=0;n>s;++s)r[s]=a[h+s]},this.fromArray=function(t,e,i,r,c){var h=o(t,e,i);for(void 0===c&&(c=0),s=0;n>s;++s)a[h+s]=r[c+s]},this.copy=function(t){this.data.set(t.data)},this.clone=function(){return new Oi(t,e,i,r,n).copy(this)}}function Ri(t,e,i,r){var n=1/i*3;n+=e;var o=(new THREE.Vector3).copy(t.min),s=(new THREE.Vector3).copy(t.max);o.subScalar(r+n),s.addScalar(r+n),o.multiplyScalar(i).floor().divideScalar(i),s.multiplyScalar(i).ceil().divideScalar(i);var a=(new THREE.Vector3).subVectors(s,o).multiplyScalar(i).ceil().addScalar(1),c=256*Math.pow(10,6),h=a.x*a.y*a.z*3;h>=c&&(i*=Math.pow(c/h,1/3),o.multiplyScalar(i).floor().divideScalar(i),s.multiplyScalar(i).ceil().divideScalar(i),a.subVectors(s,o).multiplyScalar(i).ceil().addScalar(1));var u=(new THREE.Vector3).copy(o).negate(),l=new THREE.Matrix4;return l.multiply((new THREE.Matrix4).makeRotationY(THREE.Math.degToRad(90))),l.multiply((new THREE.Matrix4).makeScale(-1/i,1/i,1/i)),l.multiply((new THREE.Matrix4).makeTranslation(-i*u.z,-i*u.y,-i*u.x)),{dim:a,tran:u,matrix:l,scaleFactor:i}}function Ii(t){function e(t,e,r,n,o,s){l=e||1.4,d=r||2,f=o||!1,S=s||!0,f?(_="resname",P=ResidueRadii,E=new p(".CA")):(_="element",P=VdwRadii,E=void 0);var a=0;for(var c in P)a=Math.max(a,P[c]);var h=Ri(T,a,d,t?l:0);Y=h.dim.x,X=h.dim.y,Z=h.dim.z,g=h.matrix,v=h.tran,d=h.scaleFactor,y={},b={},i(t),x=l*d,m=n?n:Math.max(.1,-1.2+d*l),w=new Uint8Array(Y*X*Z),t&&(A=new Float64Array(Y*X*Z)),S&&(C=new Int32Array(Y*X*Z))}function i(t){var e,i,r,n,o,s,a,c,h,u;for(var m in P)if(e=P[m],!y[m]){for(a=t?(e+l)*d+.5:e*d+.5,s=a*a,c=Math.floor(a)+1,h=new Int32Array(c*c),u=0,i=0;c>i;++i)for(r=0;c>r;++r)n=i*i+r*r,n>s?h[u]=-1:(o=Math.sqrt(s-n),h[u]=Math.floor(o)),++u;b[m]=c,y[m]=h}}function r(t){var e,i,r,n,o,s,a,c,h,u,l,m,f,p,g,x,A,P;if(O.index=t,!E||E.test(O)){e=Math.floor(.5+d*(O.x+v.x)),i=Math.floor(.5+d*(O.y+v.y)),r=Math.floor(.5+d*(O.z+v.z));var T,k=O[_],N=y[k],M=0,L=X*Z,B=b[k];for(u=0;B>u;++u)for(l=0;B>l;++l){if(T=N[M],-1!=T)for(x=-1;2>x;++x)for(A=-1;2>A;++A)for(P=-1;2>P;++P)if(0!==x&&0!==A&&0!==P)for(a=x*u,h=P*l,m=0;T>=m;++m)if(c=m*A,f=e+a,p=i+c,g=r+h,!(0>f||0>p||0>g||f>=Y||p>=X||g>=Z)){var F=f*L+p*Z+g;S?w[F]&I?w[F]&I&&(R.index=C[F],R.index!==O.index&&(n=e+a-Math.floor(.5+d*(R.x+v.x)),o=i+c-Math.floor(.5+d*(R.y+v.y)),s=r+h-Math.floor(.5+d*(R.z+v.z)),n*n+o*o+s*s>a*a+c*c+h*h&&(C[F]=t))):(w[F]|=I,C[F]=t):w[F]|=I}M++}}}function n(e){kr&&Ir.time("EDTSurface fillvoxels");var i,n;for(i=0,n=w.length;n>i;++i)w[i]=0,e&&(A[i]=-1),S&&(C[i]=-1);for(t.eachSelectedAtom(function(t){r(t.index)}),i=0,n=w.length;n>i;++i)w[i]&I&&(w[i]|=k);kr&&Ir.timeEnd("EDTSurface fillvoxels")}function o(t){var e,i,r,n,o,s,a,c,h,u,l,m,f,p,g,x,A,P,T,I=0;if(O.index=t,!E||E.test(O)){e=Math.floor(.5+d*(O.x+v.x)),i=Math.floor(.5+d*(O.y+v.y)),r=Math.floor(.5+d*(O.z+v.z));var N=O[_],M=X*Z;for(f=0,T=b[N];T>f;++f)for(p=0;T>p;++p){if(-1!=y[N][I])for(x=-1;2>x;++x)for(A=-1;2>A;++A)for(P=-1;2>P;++P)if(0!==x&&0!==A&&0!==P)for(a=x*f,h=P*p,g=0;g<=y[N][I];++g)if(c=g*A,u=e+a,l=i+c,m=r+h,!(0>u||0>l||0>m||u>=Y||l>=X||m>=Z)){var L=u*M+l*Z+m;w[L]&k?S&&(R.index=C[L],n=Math.floor(.5+d*(R.x+v.x)),o=Math.floor(.5+d*(R.y+v.y)),s=Math.floor(.5+d*(R.z+v.z)),n*n+o*o+s*s>a*a+c*c+h*h&&(C[L]=O.index)):(w[L]|=k,S&&(C[L]=O.index))}I++}}}function s(){var e,i;for(e=0,i=w.length;i>e;++e)w[e]&=~k;t.eachSelectedAtom(function(t){o(t.index)})}function a(){var t,e,i,r=X*Z;for(t=0;Y>t;++t)for(e=0;Z>e;++e)for(i=0;X>i;++i){var n=t*r+i*Z+e;if(w[n]&I)for(var o=0;26>o;){var s=t+M[o][0],a=e+M[o][2],c=i+M[o][1];if(s>-1&&Y>s&&c>-1&&X>c&&a>-1&&Z>a&&!(w[s*r+c*Z+a]&I)){w[n]|=N;break}o++}}}function c(){kr&&Ir.time("EDTSurface fastdistancemap");var t,e,i,r,n,o=new Oi(Y,X,Z,Uint16Array,3),s=X*Z,a=x*x,c=0,u=0;for(kr&&console.log("l, w, h",Y,X,Z),t=0;Y>t;++t)for(e=0;X>e;++e)for(i=0;Z>i;++i)n=t*s+e*Z+i,w[n]&=~k,w[n]&I&&(w[n]&N?(o.set(t,e,i,t,e,i),A[n]=0,w[n]|=k,c+=1):u+=1);kr&&console.log("totalsurfacevox",c),kr&&console.log("totalinnervox",u);var l=new Int32Array(3*c),d=0,f=new Int32Array(3*c),p=0;for(t=0;Y>t;++t)for(e=0;X>e;++e)for(i=0;Z>i;++i)n=t*s+e*Z+i,w[n]&N&&(l[d]=t,l[d+1]=e,l[d+2]=i,d+=3,w[n]&=~N);do for(p=h(l,o,d,f),d=0,kr&&console.log("positout",p/3),t=0,r=p;r>t;t+=3)n=s*f[t]+Z*f[t+1]+f[t+2],w[n]&=~N,A[n]<=1.0404*a&&(l[d]=f[t],l[d+1]=f[t+1],l[d+2]=f[t+2],d+=3);while(d>0);var g,v=m*m,y=new Uint16Array(3);for(t=0;Y>t;++t)for(e=0;X>e;++e)for(i=0;Z>i;++i)n=t*s+e*Z+i,w[n]&=~N,w[n]&I&&(w[n]&k&&!(w[n]&k&&A[n]>=v)||(w[n]|=N,S&&w[n]&k&&(o.toArray(t,e,i,y),g=y[0]*s+y[1]*Z+y[2],C[n]=C[g])));kr&&Ir.timeEnd("EDTSurface fastdistancemap")}function h(t,e,i,r){kr&&console.log("positin",i/3);var n,o,s,a,c,h,u,l,d,m,f,p,g=new Uint16Array(3),v=0;if(0===i)return v;var y=-1,b=-1,x=-1,S=X*Z;for(u=0,d=i;d>u;u+=3)for(n=t[u],o=t[u+1],s=t[u+2],e.toArray(n,o,s,g),l=0;6>l;++l)p=M[l],y=n+p[0],b=o+p[1],x=s+p[2],Y>y&&y>-1&&X>b&&b>-1&&Z>x&&x>-1&&(f=y*S+Z*b+x,w[f]&I&&!(w[f]&k)?(e.fromArray(y,b,x,g),a=y-g[0],c=b-g[1],h=x-g[2],m=a*a+c*c+h*h,A[f]=m,w[f]|=k,w[f]|=N,r[v]=y,r[v+1]=b,r[v+2]=x,v+=3):w[f]&I&&w[f]&k&&(a=y-g[0],c=b-g[1],h=x-g[2],m=a*a+c*c+h*h,m<A[f]&&(e.fromArray(y,b,x,g),A[f]=m,w[f]&N||(w[f]|=N,r[v]=y,r[v+1]=b,r[v+2]=x,v+=3))));for(u=0,d=i;d>u;u+=3)for(n=t[u],o=t[u+1],s=t[u+2],e.toArray(n,o,s,g),l=6;18>l;l++)p=M[l],y=n+p[0],b=o+p[1],x=s+p[2],Y>y&&y>-1&&X>b&&b>-1&&Z>x&&x>-1&&(f=y*S+Z*b+x,w[f]&I&&!(w[f]&k)?(e.fromArray(y,b,x,g),a=y-g[0],c=b-g[1],h=x-g[2],m=a*a+c*c+h*h,A[f]=m,w[f]|=k,w[f]|=N,r[v]=y,r[v+1]=b,r[v+2]=x,v+=3):w[f]&I&&w[f]&k&&(a=y-g[0],c=b-g[1],h=x-g[2],m=a*a+c*c+h*h,m<A[f]&&(e.fromArray(y,b,x,g),A[f]=m,w[f]&N||(w[f]|=N,r[v]=y,r[v+1]=b,r[v+2]=x,v+=3))));for(u=0,d=i;d>u;u+=3)for(n=t[u],o=t[u+1],s=t[u+2],e.toArray(n,o,s,g),l=18;26>l;l++)p=M[l],y=n+p[0],b=o+p[1],x=s+p[2],Y>y&&y>-1&&X>b&&b>-1&&Z>x&&x>-1&&(f=y*S+Z*b+x,w[f]&I&&!(w[f]&k)?(e.fromArray(y,b,x,g),a=y-g[0],c=b-g[1],h=x-g[2],m=a*a+c*c+h*h,A[f]=m,w[f]|=k,w[f]|=N,r[v]=y,r[v+1]=b,r[v+2]=x,v+=3):w[f]&I&&w[f]&k&&(a=y-g[0],c=b-g[1],h=x-g[2],m=a*a+c*c+h*h,m<A[f]&&(e.fromArray(y,b,x,g),A[f]=m,w[f]&N||(w[f]|=N,r[v]=y,r[v+1]=b,r[v+2]=x,v+=3))));return v}function u(t){var e,i=w.length;if("vws"===t)for(e=0;i>e;++e)w[e]&=~N,w[e]=w[e]&k?1:0;else if("ms"===t)for(e=0;i>e;++e)w[e]&=~k,w[e]&N&&(w[e]|=k),w[e]&=~N,w[e]=w[e]&k?1:0;else if("ses"===t)for(e=0;i>e;++e)w[e]&N&&w[e]&k?w[e]&=~N:w[e]&N&&!(w[e]&k)&&(w[e]|=k),w[e]=w[e]&k?1:0;else if("sas"===t)for(e=0;i>e;++e)w[e]&=~N,w[e]=w[e]&k?1:0}var l,d,m,f,Y,X,Z,g,v,y,b,x,S,w,A,C,_,P,E,T=t.getBoundingBox(),O=t.getAtomProxy(),R=t.getAtomProxy(),I=1,k=2,N=4,M=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.getVolume=function(t,r,o,h,l,d){kr&&Ir.time("EDTSurface.getVolume");var m="vws"!==t;d=!0,e(m,r,o,l,h,d),n(m),a(),"ms"!==t&&"ses"!==t||c(),"ses"===t&&(i(!1),s()),u(t);var f=new It(t,"",w,Z,X,Y,C);return f.setMatrix(g),kr&&Ir.timeEnd("EDTSurface.getVolume"),f}}function ki(t){this.structure=t}function Ni(t,e,i){this.__infoList=[],ee.call(this,t,e,i),this.structure.signals.refreshed.add(function(){this.__forceNewMolsurf=!0},this)}function Mi(t,e,i){ee.call(this,t,e,i)}function Li(t,e,i,r,n,o,s){var a=s||{},c=t.length/3-1,h=4*c,u=3*h;this.meshPosition=new Float32Array(u),this.meshColor=new Float32Array(u),this.meshNormal=new Float32Array(u),this.meshPickingColor=o?new Float32Array(u):void 0;var l=this.meshPosition.length/3>65535?Uint32Array:Uint16Array;this.meshIndex=new l(u),this.makeIndex(),Bt.call(this,this.meshPosition,this.meshColor,this.meshIndex,this.meshNormal,this.meshPickingColor,a),this.vertexShader="Ribbon.vert",this.fragmentShader="Mesh.frag",this.geometry.addAttribute("dir",new THREE.BufferAttribute(new Float32Array(u),3)),this.geometry.addAttribute("size",new THREE.BufferAttribute(new Float32Array(h),1)),this.setAttributes({position:t,normal:e,dir:i,color:r,size:n,pickingColor:o})}function Bi(t,e,i){ee.call(this,t,e,i),this.defaultScale.sstruc*=3}function Fi(t,e,i){this.helixbundleList=[],ee.call(this,t,e,i)}function Di(t,e,i){Yi.call(this,t,e,i)}function ji(t,e,i){ee.call(this,t,e,i)}function zi(t,e,i){var r=i||{};this.size=t.length/3,this.vertexShader="Line.vert",this.fragmentShader="Line.frag",this.line=!0;var n=this.size,o=n-1;this.attributeSize=2*o,this.linePosition=new Float32Array(3*o*2),this.lineColor=new Float32Array(3*o*2),Lt.call(this,this.linePosition,this.lineColor,void 0,void 0,r),this.setAttributes({position:t,color:e})}function Hi(t,e,i){ee.call(this,t,e,i)}function Vi(t,e,i){Yi.call(this,t,e,i)}function Ui(t,e,i){ee.call(this,t,e,i)}var Gi=function(){function t(t,e){return e>t?-1:t>e?1:0}return function(e,i,r){var n=0,o=e.length-1;for(r||(r=t);o>=n;){var s=n+o>>1,a=r(i,e[s]);if(a>0)n=s+1;else{if(!(0>a))return s;o=s-1}}return-n-1}}();m.prototype={constructor:m,nextGid:1,objectList:[],rangeList:[],getBaseObject:function(t){return"StructureView"===t.type&&(t=t.getStructure()),t},addObject:function(t){return t=this.getBaseObject(t),this.objectList.push(t),this.rangeList.push(this.allocateGidRange(t)),this},removeObject:function(t){t=this.getBaseObject(t);var e=this.objectList.indexOf(t);return-1!==e&&(this.objectList.splice(e,1),this.rangeList.splice(e,1),0===this.objectList.length&&(this.nextGid=1)),this},updateObject:function(t,e){t=this.getBaseObject(t);var i=this.objectList.indexOf(t);if(-1!==i){var r=this.rangeList[i];if(r[1]===this.nextGid){var n=this.getGidCount(t);this.nextGid+=n-(r[1]-r[0]),r[1]=this.nextGid}else this.rangeList[i]=this.allocateGidRange(t)}else e||Ir.warn("GidPool.updateObject: object not found.");return this},getGidCount:function(t){t=this.getBaseObject(t);var e=0;return"Structure"===t.type?e=t.atomStore.count+t.bondStore.count+t.backboneBondStore.count+t.rungBondStore.count:"Volume"===t.type?e=t.__data.length:Ir.warn("GidPool.getGidCount: unknown object type"),e},allocateGidRange:function(t){t=this.getBaseObject(t);var e=this.nextGid;return this.nextGid+=this.getGidCount(t),this.nextGid>Math.pow(2,24)&&Ir.error("GidPool.allocateGidRange: GidPool overflown"),[e,this.nextGid]},freeGidRange:function(t){t=this.getBaseObject(t)},getNextGid:function(){return this.nextGid++},getGid:function(t,e){t=this.getBaseObject(t),e=e||0;var i=0,r=this.objectList.indexOf(t);if(-1!==r){var n=this.rangeList[r],o=n[0];i=o+e}else Ir.warn("GidPool.getGid: object not found.");return i},getByGid:function(t){var e;return this.objectList.forEach(function(i,r){var n=this.rangeList[r];if(!(t<n[0]||t>=n[1])){var o=t-n[0];"Structure"===i.type?o<=i.atomStore.count?e=i.getAtomProxy(o):o<=i.atomStore.count+i.bondStore.count?(o-=i.atomStore.count,e=i.getBondProxy(o)):o<=i.atomStore.count+i.bondStore.count+i.backboneBondStore.count?(o-=i.atomStore.count+i.bondStore.count,e=i.getBondProxy(o),e.bondStore=i.backboneBondStore):o<=i.atomStore.count+i.bondStore.count+i.backboneBondStore.count+i.rungBondStore.count?(o-=i.atomStore.count+i.bondStore.count+i.backboneBondStore.count,e=i.getBondProxy(o),e.bondStore=i.rungBondStore):Ir.warn("GidPool.getByGid: invalid Structure gid",t):"Volume"===i.type?e={volume:i,index:o,value:i.data[o],x:i.dataPosition[3*o],y:i.dataPosition[3*o+1],z:i.dataPosition[3*o+2]}:Ir.warn("GidPool.getByGid: unknown object type for gid",t)}}),e}};var qi={PROTEIN:1,NUCLEIC:2,RNA:3,DNA:4,POLYMER:5,WATER:6,HELIX:7,SHEET:8,BACKBONE:9,SIDECHAIN:10,ALL:11,HETERO:12,ION:13};p.prototype={constructor:p,setString:function(t,e){if(void 0===t&&(t=this.string||""),t!==this.string){try{this.parse(t)}catch(i){this.selection={error:i.message}}this.string=t,this.test=this.makeAtomTest(),this.residueTest=this.makeResidueTest(),this.chainTest=this.makeChainTest(),this.modelTest=this.makeModelTest(),this.atomOnlyTest=this.makeAtomTest(!0),this.residueOnlyTest=this.makeResidueTest(!0),this.chainOnlyTest=this.makeChainTest(!0),this.modelOnlyTest=this.makeModelTest(!0),e||this.signals.stringChanged.dispatch(this.string)}},parse:function(t){if(this.selection={operator:void 0,rules:[]},t){var e,i,r=this,n=this.selection,o=[];t=t.replace(/\(/g," ( ").replace(/\)/g," ) ").trim(),"("===t.charAt(0)&&")"===t.substr(-1)&&(t=t.slice(1,-1).trim());var s,a,c,h,u,l,d,m,f,p,Y=t.split(/\s+/),X=["*","","ALL"],Z=0,g=function(t){e={operator:t,rules:[]},void 0===n?(n=e,r.selection=e):(n.rules.push(e),o.push(n),n=e),Z=0},v=function(t){i=n,n=o.pop(),void 0===n?(g(t),y(i)):Z=n.rules.length},y=function(t){n.rules.push(t),Z+=1};for(c=0;c<Y.length;++c)if(s=Y[c],"("!==s)if(")"!==s){if(h>0)if("NOT"===s.toUpperCase())h=1;else if(1===h)h=2;else{if(2!==h)throw new Error("something went wrong with 'not'");h=!1,v()}if("AND"!==s.toUpperCase())if("OR"!==s.toUpperCase())if("NOT"!==s.toUpperCase())if(a={},"HETERO"!==s.toUpperCase())if("WATER"!==s.toUpperCase())if("PROTEIN"!==s.toUpperCase())if("NUCLEIC"!==s.toUpperCase())if("RNA"!==s.toUpperCase())if("DNA"!==s.toUpperCase())if("POLYMER"!==s.toUpperCase())if("ION"!==s.toUpperCase())if("HYDROGEN"!==s.toUpperCase())if("SMALL"!==s.toUpperCase())if("NUCLEOPHILIC"!==s.toUpperCase())if("HYDROPHOBIC"!==s.toUpperCase())if("AROMATIC"!==s.toUpperCase())if("AMIDE"!==s.toUpperCase())if("ACIDIC"!==s.toUpperCase())if("BASIC"!==s.toUpperCase())if("CHARGED"!==s.toUpperCase())if("POLAR"!==s.toUpperCase())if("NONPOLAR"!==s.toUpperCase())if("HELIX"!==s.toUpperCase())if("SHEET"!==s.toUpperCase())if("TURN"!==s.toUpperCase())if("BACKBONE"!==s.toUpperCase())if("SIDECHAIN"!==s.toUpperCase())if("SIDECHAINATTACHED"!==s.toUpperCase())if(-1===X.indexOf(s.toUpperCase()))if("@"!==s.charAt(0))if("#"!==s.charAt(0))if("["!==s[0]||"]"!==s[s.length-1])if(s.length>=1&&s.length<=4&&"^"!==s[0]&&":"!==s[0]&&"."!==s[0]&&"%"!==s[0]&&"/"!==s[0]&&isNaN(parseInt(s)))a.resname=s.toUpperCase(),y(a);else{if(a={operator:"AND",rules:[]},d=s.split("/"),d.length>1&&d[1]){if(isNaN(parseInt(d[1])))throw new Error("model must be an integer");a.rules.push({model:parseInt(d[1])})}if(f=d[0].split("%"),f.length>1&&a.rules.push({altloc:f[1]}),u=f[0].split("."),u.length>1&&u[1]){if(u[1].length>4)throw new Error("atomname must be one to four characters");a.rules.push({atomname:u[1].substring(0,4).toUpperCase()})}if(l=u[0].split(":"),l.length>1&&l[1]&&a.rules.push({chainname:l[1]}),p=l[0].split("^"),p.length>1&&a.rules.push({inscode:p[1]}),p[0])if(m=p[0].split("-"),1===m.length){if(m=parseInt(m[0]),isNaN(m))throw new Error("resi must be an integer");a.rules.push({resno:m})}else{if(2!==m.length)throw new Error("resi range must contain one '-'");a.rules.push({resno:[parseInt(m[0]),parseInt(m[1])]})}if(1===a.rules.length)y(a.rules[0]);else{if(!(a.rules.length>1))throw new Error("empty selection chunk");y(a)}}else a.resname=s.substr(1,s.length-2).toUpperCase(),y(a);else a.element=s.substr(1).toUpperCase(),y(a);else{for(var b=s.substr(1).split(","),x=0,S=b.length;S>x;++x)b[x]=parseInt(b[x]);b.sort(function(t,e){return t-e}),a.atomindex=b,y(a)}else a.keyword=qi.ALL,y(a);else a={operator:"OR",rules:[{keyword:qi.SIDECHAIN},{operator:"AND",negate:!1,rules:[{keyword:qi.PROTEIN},{operator:"OR",negate:!1,rules:[{atomname:"CA"},{atomname:"BB"}]}]},{operator:"AND",negate:!1,rules:[{resname:"PRO"},{atomname:"N"}]},{operator:"AND",negate:!1,rules:[{keyword:qi.NUCLEIC},{operator:"OR",negate:!0,rules:[{atomname:"P"},{atomname:"OP1"},{atomname:"OP2"},{atomname:"O3'"},{atomname:"O3*"},{atomname:"O5'"},{atomname:"O5*"},{atomname:"C5'"},{atomname:"C5*"}]}]}]},y(a);else a.keyword=qi.SIDECHAIN,y(a);else a.keyword=qi.BACKBONE,y(a);else a={operator:"AND",rules:[{operator:"OR",negate:!0,rules:[{keyword:qi.HELIX},{keyword:qi.SHEET}]},{operator:"OR",rules:[{keyword:qi.PROTEIN},{sstruc:"s"},{sstruc:"t"},{sstruc:"l"}]}]},y(a);else a.keyword=qi.SHEET,y(a);else a.keyword=qi.HELIX,y(a);else a={operator:"OR",rules:[{resname:"ALA"},{resname:"CYS"},{resname:"GLY"},{resname:"ILE"},{resname:"LEU"},{resname:"MET"},{resname:"PHE"},{resname:"PRO"},{resname:"VAL"},{resname:"TRP"}]},y(a);else a={operator:"OR",rules:[{resname:"ASP"},{resname:"GLU"},{resname:"HIS"},{resname:"LYS"},{resname:"ARG"},{resname:"ASN"},{resname:"GLN"},{resname:"SER"},{resname:"THR"},{resname:"TYR"}]},y(a);else a={operator:"OR",rules:[{resname:"ASP"},{resname:"GLU"},{resname:"HIS"},{resname:"LYS"},{resname:"ARG"}]},y(a);else a={operator:"OR",rules:[{resname:"HIS"},{resname:"LYS"},{resname:"ARG"}]},y(a);else a={operator:"OR",rules:[{resname:"ASP"},{resname:"GLU"}]},y(a);else a={operator:"OR",rules:[{resname:"ASN"},{resname:"GLN"}]},y(a);else a={operator:"OR",rules:[{resname:"PHE"},{resname:"TYR"},{resname:"TRP"}]},y(a);else a={operator:"OR",rules:[{resname:"VAL"},{resname:"LEU"},{resname:"ILE"},{resname:"MET"},{resname:"PRO"}]},y(a);else a={operator:"OR",rules:[{resname:"SER"},{resname:"THR"},{resname:"CYS"}]},y(a);else a={operator:"OR",rules:[{resname:"GLY"},{resname:"ALA"}]},y(a);else a.element="H",y(a);else a.keyword=qi.ION,y(a);else a.keyword=qi.POLYMER,y(a);else a.keyword=qi.DNA,y(a);else a.keyword=qi.RNA,y(a);else a.keyword=qi.NUCLEIC,y(a);else a.keyword=qi.PROTEIN,y(a);else a.keyword=qi.WATER,y(a);else a.keyword=qi.HETERO,y(a);else h=1,g(),n.negate=!0;else"AND"===n.operator?v("OR"):n.operator="OR";else if("OR"===n.operator){var w=n.rules.pop();g("AND"),y(w)}else n.operator="AND"}else v(),n.negate&&v();else h=!1,g();void 0===this.selection.operator&&1===this.selection.rules.length&&this.selection.rules[0].hasOwnProperty("operator")&&(this.selection=this.selection.rules[0])}},_makeTest:function(t,e){if(void 0===e&&(e=this.selection),null===e)return!1;if(e.error)return!1;var i=e.rules.length;if(0===i)return!1;for(var r,n,o,s,a=!e.negate,c=!!e.negate,h=[],u=0;i>u;++u)r=e.rules[u],r.hasOwnProperty("operator")&&(h[u]=this._makeTest(t,r));return function(u){n="AND"===e.operator,s=!1;for(var l=0;i>l;++l)if(r=e.rules[l],r.hasOwnProperty("operator")){if(o=h[l]?h[l](u):-1,-1===o){s=!0;continue}if(o===!0){if(n)continue;return a}if(n)return c}else{if(r.keyword===qi.ALL){if(n)continue;return a}if(o=t(u,r),-1!==o){if(o===!0){if(n)continue;return a}if(n)return c}else s=!0}return s?-1:n?a:c}},_filter:function(t,e){if(void 0===e&&(e=this.selection),e.error)return e;var i=e.rules.length;if(0===i)return e;var r={operator:e.operator,rules:[]};e.hasOwnProperty("negate")&&(r.negate=e.negate);for(var n=0;i>n;++n){var o=e.rules[n];if(o.hasOwnProperty("operator")){var s=this._filter(t,o);null!==s&&r.rules.push(s)}else t(o)||r.rules.push(o)}return r.rules.length>0?e:null},makeAtomTest:function(t){var e,i=["h","g","i"],r=["e","b"];e=t?this._filter(function(t){return void 0!==t.keyword&&t.keyword!==qi.BACKBONE&&t.keyword!==qi.SIDECHAIN?!0:void 0!==t.model?!0:void 0!==t.chainname?!0:void 0!==t.resname?!0:void 0!==t.resno?!0:void 0!==t.sstruc}):this.selection;var n=function(t,e){if(void 0===e.atomname&&void 0===e.element&&void 0===e.altloc&&void 0===e.atomindex&&void 0===e.keyword&&void 0===e.inscode&&void 0===e.resname&&void 0===e.sstruc&&void 0===e.resno&&void 0===e.chainname&&void 0===e.model)return-1;if(void 0!==e.keyword){if(e.keyword===qi.BACKBONE&&!t.isBackbone())return!1;if(e.keyword===qi.SIDECHAIN&&!t.isSidechain())return!1;if(e.keyword===qi.HETERO&&!t.isHetero())return!1;if(e.keyword===qi.PROTEIN&&!t.isProtein())return!1;if(e.keyword===qi.NUCLEIC&&!t.isNucleic())return!1;if(e.keyword===qi.RNA&&!t.isRna())return!1;if(e.keyword===qi.DNA&&!t.isDna())return!1;if(e.keyword===qi.POLYMER&&!t.isPolymer())return!1;if(e.keyword===qi.WATER&&!t.isWater())return!1;if(e.keyword===qi.HELIX&&-1===i.indexOf(t.sstruc))return!1;if(e.keyword===qi.SHEET&&-1===r.indexOf(t.sstruc))return!1;if(e.keyword===qi.ION&&!t.isIon())return!1}if(void 0!==e.atomname&&e.atomname!==t.atomname)return!1;if(void 0!==e.element&&e.element!==t.element)return!1;if(void 0!==e.altloc&&e.altloc!==t.altloc)return!1;if(void 0!==e.atomindex&&Gi(e.atomindex,t.index)<0)return!1;if(void 0!==e.resname&&e.resname!==t.resname)return!1;if(void 0!==e.sstruc&&e.sstruc!==t.sstruc)return!1;if(void 0!==e.resno)if(Array.isArray(e.resno)&&2===e.resno.length){if(e.resno[0]>t.resno||e.resno[1]<t.resno)return!1}else if(e.resno!==t.resno)return!1;return void 0!==e.inscode&&e.inscode!==t.inscode?!1:void 0!==e.chainname&&e.chainname!==t.chainname?!1:void 0===e.model||e.model===t.modelIndex};return this._makeTest(n,e)},makeResidueTest:function(t){var e,i=["h","g","i"],r=["e","b"];e=t?this._filter(function(t){return t.keyword===qi.BACKBONE||t.keyword===qi.SIDECHAIN?!0:void 0!==t.model?!0:void 0!==t.chainname?!0:void 0!==t.atomname?!0:void 0!==t.element?!0:void 0!==t.altloc?!0:void 0!==t.atomindex}):this.selection;var n=function(t,e){if(void 0===e.resname&&void 0===e.resno&&void 0===e.inscode&&void 0===e.sstruc&&void 0===e.model&&void 0===e.chainname&&(void 0===e.keyword||e.keyword===qi.BACKBONE||e.keyword===qi.SIDECHAIN))return-1;if(void 0!==e.keyword){if(e.keyword===qi.HETERO&&!t.isHetero())return!1;if(e.keyword===qi.PROTEIN&&!t.isProtein())return!1;if(e.keyword===qi.NUCLEIC&&!t.isNucleic())return!1;if(e.keyword===qi.RNA&&!t.isRna())return!1;if(e.keyword===qi.DNA&&!t.isDna())return!1;if(e.keyword===qi.POLYMER&&!t.isPolymer())return!1;if(e.keyword===qi.WATER&&!t.isWater())return!1;if(e.keyword===qi.HELIX&&-1===i.indexOf(t.sstruc))return!1;if(e.keyword===qi.SHEET&&-1===r.indexOf(t.sstruc))return!1;if(e.keyword===qi.ION&&!t.isIon())return!1}if(void 0!==e.resname&&e.resname!==t.resname)return!1;if(void 0!==e.sstruc&&e.sstruc!==t.sstruc)return!1;if(void 0!==e.resno)if(Array.isArray(e.resno)&&2===e.resno.length){if(e.resno[0]>t.resno||e.resno[1]<t.resno)return!1}else if(e.resno!==t.resno)return!1;return void 0!==e.inscode&&e.inscode!==t.inscode?!1:void 0!==e.chainname&&e.chainname!==t.chainname?!1:void 0===e.model||e.model===t.modelIndex};return this._makeTest(n,e)},makeChainTest:function(t){var e;e=t?this._filter(function(t){return void 0!==t.keyword?!0:void 0!==t.resname?!0:void 0!==t.resno?!0:void 0!==t.atomname?!0:void 0!==t.element?!0:void 0!==t.altloc?!0:void 0!==t.sstruc?!0:void 0!==t.inscode?!0:void 0!==t.atomindex}):this.selection;var i=function(t,e){return void 0===e.chainname&&void 0===e.model?-1:void 0!==e.chainname&&e.chainname!==t.chainname?!1:void 0===e.model||e.model===t.modelIndex};return this._makeTest(i,e)},makeModelTest:function(t){var e;e=t?this._filter(function(t){return void 0!==t.keyword?!0:void 0!==t.chainname?!0:void 0!==t.resname?!0:void 0!==t.resno?!0:void 0!==t.atomname?!0:void 0!==t.element?!0:void 0!==t.altloc?!0:void 0!==t.sstruc?!0:void 0!==t.inscode?!0:void 0!==t.atomindex}):this.selection;var i=function(t,e){return void 0===e.model?-1:void 0===e.model||e.model===t.index};return this._makeTest(i,e)}};var Wi=0,Ji=1,Ki=2,Qi=3,$i=4,tr=5,er=0,ir=1,rr=2,nr=3,or=4,sr=5,ar=6,cr={H:1.1,HE:1.4,LI:1.81,BE:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,NE:1.54,NA:2.27,MG:1.73,AL:1.84,SI:2.1,P:1.8,S:1.8,CL:1.75,AR:1.88,K:2.75,CA:2.31,SC:2.3,TI:2.15,V:2.05,CR:2.05,MN:2.05,FE:2.05,CO:2,NI:2,CU:2,ZN:2.1,GA:1.87,GE:2.11,AS:1.85,SE:1.9,BR:1.83,KR:2.02,RB:3.03,SR:2.49,Y:2.4,ZR:2.3,NB:2.15,MO:2.1,TC:2.05,RU:2.05,RH:2,PD:2.05,AG:2.1,CD:2.2,IN:2.2,SN:1.93,SB:2.17,TE:2.06,I:1.98,XE:2.16,CS:3.43,BA:2.68,LA:2.5,CE:2.48,PR:2.47,ND:2.45,PM:2.43,SM:2.42,EU:2.4,GD:2.38,TB:2.37,DY:2.35,HO:2.33,ER:2.32,TM:2.3,YB:2.28,LU:2.27,HF:2.25,TA:2.2,W:2.1,RE:2.05,OS:2,IR:2,PT:2.05,AU:2.1,HG:2.05,TL:1.96,PB:2.02,BI:2.07,PO:1.97,AT:2.02,RN:2.2,FR:3.48,RA:2.83,AC:2,TH:2.4,PA:2,U:2.3,NP:2,PU:2,AM:2,CM:2,BK:2,CF:2,ES:2,FM:2,MD:2,NO:2,LR:2,RF:2,DB:2,SG:2,BH:2,HS:2,MT:2,DS:2,RG:2,CN:2,UUT:2,FL:2,UUP:2,LV:2,UUH:2},hr=2,ur={H:.31,HE:.28,LI:1.28,BE:.96,B:.84,C:.76,N:.71,O:.66,F:.57,NE:.58,NA:1.66,MG:1.41,AL:1.21,SI:1.11,P:1.07,S:1.05,CL:1.02,AR:1.06,K:2.03,CA:1.76,SC:1.7,TI:1.6,V:1.53,CR:1.39,MN:1.39,FE:1.32,CO:1.26,NI:1.24,CU:1.32,ZN:1.22,GA:1.22,GE:1.2,AS:1.19,SE:1.2,BR:1.2,KR:1.16,RB:2.2,SR:1.95,Y:1.9,ZR:1.75,NB:1.64,MO:1.54,TC:1.47,RU:1.46,RH:1.42,PD:1.39,AG:1.45,CD:1.44,IN:1.42,SN:1.39,SB:1.39,TE:1.38,I:1.39,XE:1.4,CS:2.44,BA:2.15,LA:2.07,CE:2.04,PR:2.03,ND:2.01,PM:1.99,SM:1.98,EU:1.98,GD:1.96,TB:1.94,DY:1.92,HO:1.92,ER:1.89,TM:1.9,YB:1.87,LU:1.87,HF:1.75,TA:1.7,W:1.62,RE:1.51,OS:1.44,IR:1.41,PT:1.36,AU:1.36,HG:1.32,TL:1.45,PB:1.46,BI:1.48,PO:1.4,AT:1.5,RN:1.5,FR:2.6,RA:2.21,AC:2.15,TH:2.06,PA:2,U:1.96,NP:1.9,PU:1.87,AM:1.8,CM:1.69,BK:1.6,CF:1.6,ES:1.6,FM:1.6,MD:1.6,NO:1.6,LR:1.6,RF:1.6,DB:1.6,SG:1.6,BH:1.6,HS:1.6,MT:1.6,DS:1.6,RG:1.6,CN:1.6,UUT:1.6,FL:1.6,UUP:1.6,LV:1.6,UUH:1.6},lr=1.6,dr={ALA:[.17,.5,.33],ARG:[.81,1.81,1],ASN:[.42,.85,.43],ASP:[1.23,3.64,2.41],ASH:[-.07,.43,.5],CYS:[-.24,-.02,.22],GLN:[.58,.77,.19],GLU:[2.02,3.63,1.61],GLH:[-.01,.11,.12],GLY:[.01,1.15,1.14],HIS:[.17,.11,-.06],ILE:[-.31,-1.12,-.81],LEU:[-.56,-1.25,-.69],LYS:[.99,2.8,1.81],MET:[-.23,-.67,-.44],PHE:[-1.13,-1.71,-.58],PRO:[.45,.14,-.31],SER:[.13,.46,.33],THR:[.14,.25,.11],TRP:[-1.85,-2.09,-.24],TYR:[-.94,-.71,.23],VAL:[.07,-.46,-.53]},mr=[0,0,0],fr={HIS:"H",ARG:"R",LYS:"K",ILE:"I",PHE:"F",LEU:"L",TRP:"W",ALA:"A",MET:"M",PRO:"P",CYS:"C",ASN:"N",VAL:"V",GLY:"G",SER:"S",GLN:"Q",TYR:"Y",ASP:"D",GLU:"E",THR:"T",ASH:"D",GLH:"E",UNK:""},pr=Object.keys(fr),Yr=["A","C","T","G","U"],Xr=["DA","DC","DT","DG","DU","TCY","MCY","5CM"],Zr=["A","G","DA","DG"],gr=["SOL","WAT","HOH","H2O","W","DOD","D3O"],vr=["3CO","3NI","4MO","6MO","AG","AL","AU","AU3","BA","BR","CA","CD","CE","CL","CO","CR","CU","CU1","CU3","F","FE","FE2","GA","K","LI","MG","MN","MN3","NA","ND4","NH4","NI","OH","RB","SR","V","Y1","YT3","ZN"],yr=["FOL"],br=["CA","C","N","O","O1","O2","OC1","OC2","H","H1","H2","H3","HA","BB"],xr=["P","O3'","O5'","C5'","C4'","C3'","OP1","OP2","O3*","O5*","C5*","C4*","C3*"],Sr={};Sr[ir]={trace:"CA",direction1:"C",direction2:["O","OC1","O1","OX1"],backboneStart:"N",backboneEnd:"C"},Sr[rr]={trace:["C4'","C4*"],direction1:["C1'","C1*"],direction2:["C3'","C3*"],backboneStart:"P",backboneEnd:["O3'","O3*"]},Sr[nr]={trace:["C3'","C3*"],direction1:["C2'","C2*"],direction2:["O4'","O4*"],backboneStart:"P",backboneEnd:["O3'","O3*"]},Sr[or]={trace:["CA","BB"],backboneStart:["CA","BB"],backboneEnd:["CA","BB"]},Sr[sr]={trace:["C4'","C4*","P"],backboneStart:["C4'","C4*","P"],backboneEnd:["C4'","C4*","P"]},Sr[ar]={trace:["C3'","C3*","C2'","P"],backboneStart:["C3'","C3*","C2'","P"],backboneEnd:["C3'","C3*","C2'","P"]},Sr[er]={};var wr={H:16777215,HE:14286847,LI:13402367,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,NE:11789301,NA:11230450,MG:9109248,AL:12560038,SI:1578e4,P:16744448,S:16777008,CL:2093087,AR:8442339,K:9388244,CA:4062976,SC:15132390,TI:12567239,V:10921643,CR:9083335,MN:10255047,FE:14706227,CO:15765664,NI:5296208,CU:13140019,ZN:8224944,GA:12750735,GE:6721423,AS:12419299,SE:16752896,BR:10889513,KR:6076625,RB:7351984,SR:65280,Y:9764863,ZR:9756896,NB:7586505,MO:5551541,TC:3907230,RU:2396047,RH:687500,PD:27013,AG:12632256,CD:16767375,IN:10909043,SN:6717568,SB:10380213,TE:13924864,I:9699476,XE:9699476,CS:5707663,BA:51456,LA:7394559,CE:16777159,PR:14286791,ND:13107143,PM:10747847,SM:9437127,EU:6422471,GD:4587463,TB:3211207,DY:2097095,HO:65436,ER:58997,TM:54354,YB:48952,LU:43812,HF:5096191,TA:5089023,W:2200790,RE:2522539,OS:2516630,IR:1528967,PT:13684960,AU:16765219,HG:12105936,TL:10900557,PB:5724513,BI:10375093,PO:11230208,AT:7688005,RN:4358806,FR:4325478,RA:32e3,AC:7384058,TH:47871,PA:41471,U:36863,NP:33023,PU:27647,AM:5528818,CM:7888099,BK:9064419,CF:10565332,ES:11739092,FM:11739066,MD:11734438,NO:12389767,LR:13041766,RF:13369433,DB:13697103,SG:14221381,BH:14680120,HS:15073326,MT:15400998,DS:16777215,RG:16777215,CN:16777215,UUT:16777215,FL:16777215,UUP:16777215,LV:16777215,UUH:16777215,D:16777152,T:16777120},Ar=16777215,Cr={ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935,ASH:16711935,GLH:16711935,A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576,DA:10526975,DG:16740464,DI:8454143,DC:16747595,DT:10551200,DU:16744576},_r=16711935,Pr={alphaHelix:16711808,threeTenHelix:10485888,piHelix:6291584,betaStrand:16762880,betaTurn:6324479,coil:16777215,dna:11403518,rna:16580962,carbohydrate:10921722},Er=8421504;Y.prototype={signals:{},scales:{"":"",OrRd:"[S] Orange-Red",PuBu:"[S] Purple-Blue",BuPu:"[S] Blue-Purple",Oranges:"[S] Oranges",BuGn:"[S] Blue-Green",YlOrBr:"[S] Yellow-Orange-Brown",YlGn:"[S] Yellow-Green",Reds:"[S] Reds",RdPu:"[S] Red-Purple",Greens:"[S] Greens",YlGnBu:"[S] Yellow-Green-Blue",Purples:"[S] Purples",GnBu:"[S] Green-Blue",Greys:"[S] Greys",YlOrRd:"[S] Yellow-Orange-Red",PuRd:"[S] Purple-Red",Blues:"[S] Blues",PuBuGn:"[S] Purple-Blue-Green",Spectral:"[D] Spectral",RdYlGn:"[D] Red-Yellow-Green",RdBu:"[D] Red-Blue",PiYG:"[D] Pink-Yellowgreen",PRGn:"[D] Purplered-Green",RdYlBu:"[D] Red-Yellow-Blue",BrBG:"[D] Brown-Bluegreen",RdGy:"[D] Red-Grey",PuOr:"[D] Purple-Orange",Set1:"[Q] Set1",Set2:"[Q] Set2",Set3:"[Q] Set3",Dark2:"[Q] Dark2",Paired:"[Q] Paired",Pastel1:"[Q] Pastel1",Pastel2:"[Q] Pastel2",Accent:"[Q] Accent",roygb:"[?] Rainbow",rwb:"[?] Red-White-Blue"},modes:{"":"",rgb:"Red Green Blue",hsv:"Hue Saturation Value",hsl:"Hue Saturation Lightness",hsi:"Hue Saturation Intensity",lab:"CIE L*a*b*",hcl:"Hue Chroma Lightness"},userSchemes:{},getScheme:function(t){var e,i=t||{},r=i.scheme||"";return new(e=r in Y.types?Y.types[r]:r in this.userSchemes?this.userSchemes[r]:X)(t)},getPickingScheme:function(t){var e=Object.assign(t||{});return e.scheme="picking",this.getScheme(e)},getTypes:function(){var t={};return Object.keys(Y.types).forEach(function(e){t[e]=e}),Object.keys(this.userSchemes).forEach(function(e){t[e]=e.split("|")[1]}),t},getScales:function(){return this.scales},getModes:function(){return this.modes},addScheme:function(t,e){t instanceof X||(t=this.createScheme(t,e)),e=e||"";var i=""+THREE.Math.generateUUID()+"|"+e;return this.userSchemes[i]=t,i},removeScheme:function(t){delete this.userSchemes[t]},createScheme:function(t,e){var i=function(i){X.call(this,i),this.label=e||"",t.call(this,i)};return i.prototype=X.prototype,i.prototype.constructor=X,i},addSelectionScheme:function(t,e){return this.addScheme(function(e){var i=[],r=[];t.forEach(function(t){i.push(new THREE.Color(t[0]).getHex()),r.push(new p(t[1]))});var n=t.length;this.atomColor=function(t){for(var e=0;n>e;++e)if(r[e].test(t))return i[e];return 16777215}},e)}},X.prototype={constructor:X,getScale:function(t){var e=t||{},i=e.scale||this.scale;return"rainbow"===i||"roygb"===i?i=["red","orange","yellow","green","blue"]:"rwb"===i&&(i=["red","white","blue"]),chroma.scale(i).mode(e.mode||this.mode).domain(e.domain||this.domain).out("num")},colorToArray:function(t,e,i){return void 0===e&&(e=[]),void 0===i&&(i=0),e[i+0]=(t>>16&255)/255,e[i+1]=(t>>8&255)/255,e[i+2]=(255&t)/255,e},atomColor:function(t){return 16777215},atomColorToArray:function(t,e,i){return this.colorToArray(this.atomColor(t),e,i)},bondColor:function(t,e){return this.atomProxy.index=e?t.atomIndex1:t.atomIndex2,this.atomColor(this.atomProxy)},bondColorToArray:function(t,e,i,r){return this.colorToArray(this.bondColor(t,e),i,r)},volumeColor:function(t){return 16777215},volumeColorToArray:function(t,e,i){
return this.colorToArray(this.volumeColor(t),e,i)},positionColor:function(t){return 16777215},positionColorToArray:function(t,e,i){return this.colorToArray(this.positionColor(t),e,i)}},Z.prototype=X.prototype,Z.prototype.constructor=Z,g.prototype=X.prototype,g.prototype.constructor=g,v.prototype=X.prototype,v.prototype.constructor=v,y.prototype=X.prototype,y.prototype.constructor=y,b.prototype=X.prototype,b.prototype.constructor=b,x.prototype=X.prototype,x.prototype.constructor=x,S.prototype=X.prototype,S.prototype.constructor=S,w.prototype=X.prototype,w.prototype.constructor=w,A.prototype=X.prototype,A.prototype.constructor=A,C.prototype=X.prototype,C.prototype.constructor=C,_.prototype=X.prototype,_.prototype.constructor=_,P.prototype=X.prototype,P.prototype.constructor=P,E.prototype=X.prototype,E.prototype.constructor=E,T.prototype=X.prototype,T.prototype.constructor=T,O.prototype=X.prototype,O.prototype.constructor=O,Y.types={"":X,picking:v,random:y,uniform:b,atomindex:x,residueindex:S,chainindex:w,modelindex:A,sstruc:C,element:_,resname:P,bfactor:E,hydrophobicity:O,value:g,volume:Z,occupancy:T},R.prototype={sourceDict:{},listing:void 0,trajectory:void 0,__passThrough:{getUrl:function(t){return t}},add:function(t,e){t=t.toLowerCase(),t in this.sourceDict&&Ir.warn("overwriting datasource named '"+t+"'"),this.sourceDict[t]=e},get:function(t){return t=t||"",t=t.toLowerCase(),t in this.sourceDict?this.sourceDict[t]:-1!==["http","https","ftp"].indexOf(t)?this.__passThrough:t?void Ir.error("no datasource named '"+t+"' found"):this.__passThrough}},R.prototype.sourceDict.rcsb=new I;var Tr=n(),Or=!1,Rr=!1,Ir={log:Function.prototype.bind.call(console.log,console),info:Function.prototype.bind.call(console.info,console),warn:Function.prototype.bind.call(console.warn,console),error:Function.prototype.bind.call(console.error,console),time:Function.prototype.bind.call(console.time,console),timeEnd:Function.prototype.bind.call(console.timeEnd,console)},kr=i(e("debug")),Nr=new m,Mr='<div style="display:flex; align-items:center; justify-content:center; height:100%;"><p style="padding:15px; text-align:center;">Your browser/graphics card does not seem to support <a target="_blank" href="https://en.wikipedia.org/wiki/WebGL">WebGL</a>.<br /><br />Find out how to get it <a target="_blank" href="http://get.webgl.org/">here</a>.</p></div>',Lr="../js/build/ngl.full.min.js",Br=new f,Fr=new Y,Dr=new R,jr=new d;k.prototype={constructor:k,atomRadius:function(t){var e,i=this.type,r=this.scale;switch(i){case"vdw":e=cr[t.element]||hr;break;case"covalent":e=ur[t.element]||lr;break;case"bfactor":e=t.bfactor||1;break;case"sstruc":var n=t.sstruc;e="h"===n?.25:"g"===n?.25:"i"===n?.25:"e"===n?.25:"b"===n?.25:-1!==xr.indexOf(t.atomname)?.4:.1;break;default:e=i||1}return Math.min(e*r,this.max)}},k.types={"":"",vdw:"by vdW radius",covalent:"by covalent radius",sstruc:"by secondary structure",bfactor:"by bfactor",size:"size"},N.prototype={toJSON:function(){var t={metadata:{version:.1,type:"Unitcell",generator:"UnitcellExporter"},a:this.a,b:this.b,c:this.c,alpha:this.alpha,beta:this.beta,gamma:this.gamma,spacegroup:this.spacegroup,volume:this.volume,cartToFrac:this.cartToFrac.toArray(),fracToCart:this.fracToCart.toArray()};return t},fromJSON:function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.alpha=t.alpha,this.beta=t.beta,this.gamma=t.gamma,this.spacegroup=t.spacegroup,this.volume=t.volume,this.cartToFrac.fromArray(t.cartToFrac),this.fracToCart.fromArray(t.fracToCart),this}},M.prototype={constructor:M,type:"Assembly",addPart:function(t,e){var i=new L(t,e);return this.partList.push(i),i},getAtomCount:function(t){var e=0;return this.partList.forEach(function(i){e+=i.getAtomCount(t)}),e},getInstanceCount:function(){var t=0;return this.partList.forEach(function(e){t+=e.matrixList.length}),t},isIdentity:function(t){if(1!==this.partList.length)return!1;var e=this.partList[0];if(1!==e.matrixList.length)return!1;var i=new THREE.Matrix4;if(!i.equals(e.matrixList[0]))return!1;var r=[];return t.eachChain(function(t){r.push(t.chainname)}),r=c(r),e.chainList.length===r.length},toJSON:function(){var t={name:this.name,partList:new Array(this.partList.length)};return this.partList.forEach(function(e,i){t.partList[i]=e.toJSON()}),t},fromJSON:function(t){return this.name=t.name,this.partList=t.partList,this.partList.forEach(function(t,e){this.partList[e]=(new L).fromJSON(t)}.bind(this)),this}},L.prototype={constructor:L,type:"AssemblyPart",getAtomCount:function(t){var e=0,i=this.chainList;return t.eachChain(function(t){0!==i.length&&-1==i.indexOf(t.chainname)||(e+=t.atomCount)}),this.matrixList.length*e},getSelection:function(){if(this.chainList.length>0){var t=c(this.chainList),e=":"+t.join(" OR :");return new p(e)}return new p("")},getView:function(t){var e=this.getSelection();return e?t.getView(e):t},getInstanceList:function(){for(var t=[],e=0,i=this.matrixList.length;i>e;++e)t.push({id:e+1,name:e,matrix:this.matrixList[e]});return t},toJSON:function(){var t={matrixList:this.matrixList,chainList:this.chainList};return t},fromJSON:function(t){return this.matrixList=t.matrixList,this.chainList=t.chainList,this}},B.prototype={constructor:B,type:"Store",init:function(t){this.length=t,this.count=0;for(var e=0,i=this.__fields.length;i>e;++e){var r=this.__fields[e][0],n=this.__fields[e][1],o=this.__fields[e][2],s=this.length*n;switch(o){case"int8":this[r]=new Int8Array(s);break;case"int16":this[r]=new Int16Array(s);break;case"int32":this[r]=new Int32Array(s);break;case"uint8":this[r]=new Uint8Array(s);break;case"uint16":this[r]=new Uint16Array(s);break;case"uint32":this[r]=new Uint32Array(s);break;case"float32":this[r]=new Float32Array(s);break;default:Ir.warn("arrayType unknown: "+o)}}},resize:function(t){this.length=Math.round(t||0),this.count=Math.min(this.count,this.length);for(var e=0,i=this.__fields.length;i>e;++e){var r=this.__fields[e][0],n=this.__fields[e][1],o=this.length*n,s=new this[r].constructor(o);this[r].length>o?s.set(this[r].subarray(0,o)):s.set(this[r]),this[r]=s}},growIfFull:function(){if(this.count>=this.length){var t=Math.round(1.5*this.length);this.resize(Math.max(256,t))}},copyFrom:function(t,e,i,r){for(var n=0,o=this.__fields.length;o>n;++n)for(var s=this.__fields[n][0],a=this.__fields[n][1],c=this[s],h=t[s],u=0;r>u;++u)for(var l=a*(e+u),d=a*(i+u),m=0;a>m;++m)c[l+m]=h[d+m]},copyWithin:function(t,e,i){for(var r=0,n=this.__fields.length;n>r;++r)for(var o=this.__fields[r][0],s=this.__fields[r][1],a=this[o],c=0;i>c;++c)for(var h=s*(t+c),u=s*(e+c),l=0;s>l;++l)a[h+l]=a[u+l]},sort:function(t){function e(t,e){t!==e&&(n.copyFrom(r,0,t,1),r.copyWithin(t,e,1),r.copyFrom(n,e,0,1))}function i(r,n){if(n>r){var o=Math.floor((r+n)/2),s=r,a=n;do{for(;t(s,o)<0;)s+=1;for(;t(a,o)>0;)a-=1;a>=s&&(s===o?o=a:a===o&&(o=s),e(s,a),s+=1,a-=1)}while(a>=s);i(r,a),i(s,n)}}Ir.time("Store.sort");var r=this,n=new this.constructor(1);i(0,this.count-1),Ir.timeEnd("Store.sort")},toJSON:function(){for(var t={metadata:{version:.1,type:this.type,generator:this.type+"Exporter"},length:this.length,count:this.count},e=0,i=this.__fields.length;i>e;++e){var r=this.__fields[e][0];t[r]=this[r]}return t},fromJSON:function(t){this.length=t.length,this.count=t.count;for(var e=0,i=this.__fields.length;i>e;++e){var r=this.__fields[e][0];this[r]=t[r]}return this},getTransferable:function(){for(var t=[],e=0,i=this.__fields.length;i>e;++e){var r=this.__fields[e][0];t.push(this[r].buffer)}return t},clear:function(){this.count=0},dispose:function(){delete this.length,delete this.count;for(var t=0,e=this.__fields.length;e>t;++t){var i=this.__fields[t][0];delete this[i]}}},F.prototype=Object.assign(Object.create(B.prototype),{constructor:F,type:"BondStore",__fields:[["atomIndex1",1,"int32"],["atomIndex2",1,"int32"],["bondOrder",1,"int8"]],addBond:function(t,e,i){this.growIfFull();var r=this.count;this.atomIndex1[r]=t.index,this.atomIndex2[r]=e.index,this.bondOrder[r]=i,this.count+=1},addBondIfConnected:function(t,e,i){return t.connectedTo(e)?(this.addBond(t,e,i),!0):!1}}),D.prototype=Object.assign(Object.create(B.prototype),{constructor:D,type:"AtomStore",__fields:[["residueIndex",1,"uint32"],["atomTypeId",1,"uint16"],["x",1,"float32"],["y",1,"float32"],["z",1,"float32"],["serial",1,"int32"],["bfactor",1,"float32"],["altloc",1,"uint8"],["occupancy",1,"float32"]],setAltloc:function(t,e){this.altloc[t]=e.charCodeAt(0)},getAltloc:function(t){var e=this.altloc[t];return e?String.fromCharCode(e):""}}),j.prototype=Object.assign(Object.create(B.prototype),{constructor:j,type:"ResidueStore",__fields:[["chainIndex",1,"uint32"],["atomOffset",1,"uint32"],["atomCount",1,"uint16"],["residueTypeId",1,"uint16"],["resno",1,"int32"],["sstruc",1,"uint8"],["inscode",1,"uint8"]],setSstruc:function(t,e){this.sstruc[t]=e.charCodeAt(0)},getSstruc:function(t){var e=this.sstruc[t];return e?String.fromCharCode(e):""},setInscode:function(t,e){this.inscode[t]=e.charCodeAt(0)},getInscode:function(t){var e=this.inscode[t];return e?String.fromCharCode(e):""}}),z.prototype=Object.assign(Object.create(B.prototype),{constructor:z,type:"ChainStore",__fields:[["modelIndex",1,"uint16"],["residueOffset",1,"uint32"],["residueCount",1,"uint32"],["chainname",4,"uint8"]],setChainname:function(t,e){var i=4*t;this.chainname[i]=e.charCodeAt(0),this.chainname[i+1]=e.charCodeAt(1),this.chainname[i+2]=e.charCodeAt(2),this.chainname[i+3]=e.charCodeAt(3)},getChainname:function(t){for(var e="",i=0;4>i;++i){var r=this.chainname[4*t+i];if(!r)break;e+=String.fromCharCode(r)}return e}}),H.prototype=Object.assign(Object.create(B.prototype),{constructor:H,type:"ModelStore",__fields:[["chainOffset",1,"uint32"],["chainCount",1,"uint32"]]});var zr=2*Math.PI,Hr=function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i,r,n){t.copy(n),e.subVectors(i,r);var o=Math.cos(t.angleTo(e))*e.length(),s=t.normalize().multiplyScalar(o),a=(new THREE.Vector3).addVectors(s,r);return a}}();Q.prototype={constructor:Q,getCenterIterator:function(t){function e(){var t=this.get(a);return a+=1,t}function i(e){e=Math.min(o-1,Math.max(0,e));var i=c[s%4],r=3*e;if(i.fromArray(n,r),t){var a,h,u,l=Math.min(t,e,o-e-1);for(h=1;l>=h;++h)a=3*h,u=(l+1-h)/(l+1),i.x+=u*n[r-a+0]+u*n[r+a+0],i.y+=u*n[r-a+1]+u*n[r+a+1],i.z+=u*n[r-a+2]+u*n[r+a+2];i.x/=l+1,i.y/=l+1,i.z/=l+1}return s+=1,i}function r(){s=0,a=-1}var n=this.getPosition().center,o=n.length/3,s=0,a=-1,c=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return{size:o,next:e,get:i,reset:r}},getColor:function(t){var e=this.polymer,i=e.structure,r=e.residueCount,n=e.residueIndexStart,o=new Float32Array(3*r),s=new Float32Array(3*r),a=t||{};a.structure=i;for(var c=Fr.getScheme(a),h=Fr.getPickingScheme(a),u=i.getResidueProxy(),l=i.getAtomProxy(),d=0;r>d;++d){u.index=n+d,l.index=u.traceAtomIndex;var m=3*d;c.atomColorToArray(l,o,m),h.atomColorToArray(l,s,m)}return{color:o,pickingColor:s}},getSize:function(t,e){for(var i=this.polymer,r=i.structure,n=i.residueCount,o=i.residueIndexStart,s=new Float32Array(n),a=new k(t,e),c=r.getResidueProxy(),h=r.getAtomProxy(),u=0;n>u;++u)c.index=o+u,h.index=c.traceAtomIndex,s[u]=a.atomRadius(h);return{size:s}},getPosition:function(){for(var t,e,i,r,n=this.polymer,o=n.structure,s=n.residueCount,a=s-3,c=new Float32Array(3*s),h=new Float32Array(3*s),u=new Float32Array(s),l=new Float32Array(s),d=new Float32Array(s),m=new Float32Array(s),f=new Float32Array(3*s),p=new THREE.Vector3,Y=new THREE.Vector3,X=new THREE.Vector3,Z=new THREE.Vector3,g=new THREE.Vector3,v=new THREE.Vector3,y=new THREE.Vector3,b=new THREE.Vector3,x=new THREE.Vector3,S=new THREE.Vector3,w=(new THREE.Vector3,new THREE.Vector3(0,0,0)),A="trace",C=o.getAtomProxy(),_=o.getAtomProxy(n.getAtomIndexByType(0,A)),P=o.getAtomProxy(n.getAtomIndexByType(1,A)),E=o.getAtomProxy(n.getAtomIndexByType(2,A)),T=0;a>T;++T)C.index=_.index,_.index=P.index,P.index=E.index,E.index=n.getAtomIndexByType(T+3,A),e=3*T,p.subVectors(_,C),Y.subVectors(P,_),X.subVectors(E,P),Z.subVectors(p,Y),g.subVectors(Y,X),b.crossVectors(Z,g).normalize(),b.toArray(h,e),T>0&&(u[T]=b.angleTo(x)),t=Math.cos(Z.angleTo(g)),m[T]=180/Math.PI*Math.acos(t),i=Z.length(),r=g.length(),l[T]=Math.sqrt(r*i)/Math.max(2,2*(1-t)),d[T]=Math.abs(Y.dot(b)),v.copy(Z).multiplyScalar(l[T]/i),y.copy(g).multiplyScalar(l[T]/r),v.subVectors(_,v),y.subVectors(P,y),v.toArray(c,e+3),y.toArray(c,e+6),S.subVectors(C,w),S.toArray(f,e),x.copy(b),w.copy(v);v.fromArray(c,3),y.fromArray(c,6),b.subVectors(v,y).normalize(),C.index=n.getAtomIndexByType(0,A),w.copy(C),v=Hr(w,v,b),v.toArray(c,0),S.subVectors(w,v),S.toArray(f,0),v.fromArray(c,3*s-6),y.fromArray(c,3*s-9),b.subVectors(v,y).normalize(),C.index=n.getAtomIndexByType(s-1,A),w.copy(C),v=Hr(w,v,b),v.toArray(c,3*s-3);for(var T=s-3;s>T;++T)v.fromArray(c,3*T),C.index=n.getAtomIndexByType(T,A),w.copy(C),S.subVectors(w,v),S.toArray(f,3*T);var O=new Float32Array(s),R=new Float32Array(s),I=new Float32Array(s),k=new Float32Array(s);O[1]=l[0],R[1]=m[0],I[1]=l[0];for(var T=2;s-2>T;++T)O[T]=.5*(l[T-2]+l[T-1]),R[T]=.5*(m[T-2]+m[T-1]),I[T]=.5*(d[T-2]+d[T-1]),v.fromArray(h,3*(T-2)),y.fromArray(h,3*(T-1)),k[T]=180/Math.PI*Math.acos(Math.cos(v.angleTo(y)));O[s-2]=l[s-4],R[s-2]=m[s-4],I[s-2]=d[s-4];var N=new Float32Array(3*s);J(h,N,0,0,3),J(h,N,0,3,3);for(var T=2;s-2>T;++T)v.fromArray(h,3*(T-2)),y.fromArray(h,3*(T-1)),b.addVectors(y,v).multiplyScalar(.5).normalize(),b.toArray(N,3*T);return J(h,N,3*s-12,3*s-6,3),J(h,N,3*s-12,3*s-3,3),{center:c,axis:N,bending:k,radius:O,rise:I,twist:R,resdir:f}}},$.prototype={constructor:$,getAxis:function(t,e,i,r,n,o){t=t||30,e=e||2.5,i=void 0===i?!1:i;var s=this.polymer,a=s.structure,c=s.residueCount,h=s.residueIndexStart,u=this.position,l=r||{};l.structure=a;for(var d,m,f=Fr.getScheme(l),p=Fr.getPickingScheme(l),Y=new k(n,o),X=0,Z=0,g=[],v=[],y=[],b=[],x=[],S=[],w=[],A=[],C=[],_=[],P=[],E=new THREE.Vector3,T=new THREE.Vector3,O=a.getResidueProxy(),R=a.getResidueProxy(),I=a.getAtomProxy(),N=new THREE.Vector3,M=new THREE.Vector3,L=!1,B=0;c>B;++B)if(O.index=h+B,N.fromArray(u.center,3*B),B===c-1?L=!0:(R.index=h+B+1,M.fromArray(u.center,3*B+3),i&&O.sstruc!==R.sstruc?L=!0:N.distanceTo(M)>e?L=!0:u.bending[B]>t&&(L=!0)),L){if(4>B-X){X=B,L=!1;continue}I.index=O.traceAtomIndex,_=u.axis.subarray(3*X+3,3*B),P=u.center.subarray(3*X,3*B+3),d=K(_).normalize(),m=K(P),E.fromArray(P),E=Hr(E,m,d),T.fromArray(P,P.length-3),T=Hr(T,m,d),d.subVectors(T,E),d.toArray(g,Z),m.toArray(v,Z),E.toArray(y,Z),T.toArray(b,Z),f.atomColorToArray(I,x,Z),p.atomColorToArray(I,S,Z),w.push(Y.atomRadius(I)),A.push(h+X),C.push(h+B+1-X),Z+=3,X=B,L=!1}return{axis:new Float32Array(g),center:new Float32Array(v),begin:new Float32Array(y),end:new Float32Array(b),color:new Float32Array(x),pickingColor:new Float32Array(S),size:new Float32Array(w),residueOffset:A,residueCount:C}}},tt.prototype={nearest:function(){var t=new Float32Array(3);return function(e,i,r){e instanceof THREE.Vector3?e.toArray(t):"AtomProxy"===e.type&&e.positionToArray(t);for(var n=this.kdtree.nearest(t,i,r),o=this.points,s=[],a=0,c=n.length;c>a;++a){var h=n[a],u=h[0],l=h[1];s.push({index:o[u.pos+3],distance:l})}return s}}()};var Vr={"P 1":["X,Y,Z"],"P -1":["X,Y,Z","-X,-Y,-Z"],"P 1 2 1":["X,Y,Z","-X,Y,-Z"],"P 1 21 1":["X,Y,Z","-X,Y+1/2,-Z"],"C 1 2 1":["X,Y,Z","-X,Y,-Z","1/2+X,1/2+Y,Z","1/2-X,1/2+Y,-Z"],"P 1 m 1":["X,Y,Z","X,-Y,Z"],"P 1 c 1":["X,Y,Z","X,-Y,1/2+Z"],"C 1 m 1":["X,Y,Z","X,-Y,Z","1/2+X,1/2+Y,Z","1/2+X,1/2-Y,Z"],"C 1 c 1":["X,Y,Z","X,-Y,1/2+Z","1/2+X,1/2+Y,Z","1/2+X,1/2-Y,1/2+Z"],"P 1 2/m 1":["X,Y,Z","X,-Y,Z","-X,Y,-Z","-X,-Y,-Z"],"P 1 21/m 1":["X,Y,Z","-X,1/2+Y,-Z","-X,-Y,-Z","X,1/2-Y,Z"],"C 1 2/m 1":["X,Y,Z","X,-Y,Z","-X,Y,-Z","-X,-Y,-Z","1/2+X,1/2+Y,Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2-X,1/2-Y,-Z"],"P 1 2/c 1":["X,Y,Z","-X,Y,1/2-Z","-X,-Y,-Z","X,-Y,1/2+Z"],"P 1 21/c 1":["X,Y,Z","-X,-Y,-Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2+Z"],"C 1 2/c 1":["X,Y,Z","-X,Y,1/2-Z","-X,-Y,-Z","X,-Y,1/2+Z","1/2+X,1/2+Y,Z","1/2-X,1/2+Y,1/2-Z","1/2-X,1/2-Y,-Z","1/2+X,1/2-Y,1/2+Z"],"P 2 2 2":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z"],"P 2 2 21":["X,Y,Z","-X,-Y,1/2+Z","-X,Y,1/2-Z","X,-Y,-Z"],"P 21 21 2":["X,Y,Z","-X,-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z"],"P 21 21 21":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z"],"C 2 2 21":["X,Y,Z","-X,-Y,1/2+Z","-X,Y,1/2-Z","X,-Y,-Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z"],"C 2 2 2":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z"],"F 2 2 2":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z"],"I 2 2 2":["X,Y,Z","-X,-Y,Z","X,-Y,-Z","-X,Y,-Z","X+1/2,Y+1/2,Z+1/2","-X+1/2,-Y+1/2,Z+1/2","X+1/2,-Y+1/2,-Z+1/2","-X+1/2,Y+1/2,-Z+1/2"],"I 21 21 21":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","1/2+X,1/2+Y,1/2+Z","-X,1/2-Y,Z","1/2-X,Y,-Z","X,-Y,1/2-Z"],"P m m 2":["X,Y,Z","-X,-Y,Z","X,-Y,Z","-X,Y,Z"],"P m c 21":["X,Y,Z","-X,-Y,1/2+Z","X,-Y,1/2+Z","-X,Y,Z"],"P c c 2":["X,Y,Z","-X,-Y,Z","X,-Y,1/2+Z","-X,Y,1/2+Z"],"P m a 2":["X,Y,Z","-X,-Y,Z","1/2+X,-Y,Z","1/2-X,Y,Z"],"P c a 21":["X,Y,Z","-X,-Y,1/2+Z","1/2+X,-Y,Z","1/2-X,Y,1/2+Z"],"P n c 2":["X,Y,Z","-X,-Y,Z","X,1/2-Y,1/2+Z","-X,1/2+Y,1/2+Z"],"P m n 21":["X,Y,Z","1/2-X,-Y,1/2+Z","1/2+X,-Y,1/2+Z","-X,Y,Z"],"P b a 2":["X,Y,Z","-X,-Y,Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z"],"P n a 21":["X,Y,Z","-X,-Y,1/2+Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,1/2+Z"],"P n n 2":["X,Y,Z","-X,-Y,Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z"],"C m m 2":["X,Y,Z","-X,-Y,Z","X,-Y,Z","-X,Y,Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z"],"C m c 21":["X,Y,Z","-X,-Y,1/2+Z","X,-Y,1/2+Z","-X,Y,Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,1/2+Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,Z"],"C c c 2":["X,Y,Z","-X,-Y,Z","X,-Y,1/2+Z","-X,Y,1/2+Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z"],"A m m 2":["X,Y,Z","-X,-Y,Z","X,-Y,Z","-X,Y,Z","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","X,1/2-Y,1/2+Z","-X,1/2+Y,1/2+Z"],"A b m 2":["X,Y,Z","-X,-Y,Z","X,1/2-Y,Z","-X,1/2+Y,Z","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","X,-Y,1/2+Z","-X,Y,1/2+Z"],"A m a 2":["X,Y,Z","-X,-Y,Z","1/2+X,-Y,Z","1/2-X,Y,Z","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z"],"A b a 2":["X,Y,Z","-X,-Y,Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","1/2+X,-Y,1/2+Z","1/2-X,Y,1/2+Z"],"F m m 2":["X,Y,Z","-X,-Y,Z","X,-Y,Z","-X,Y,Z","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","X,1/2-Y,1/2+Z","-X,1/2+Y,1/2+Z","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2+X,-Y,1/2+Z","1/2-X,Y,1/2+Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z"],"F d d 2":["X,Y,Z","-X,-Y,Z","1/4+X,1/4-Y,1/4+Z","1/4-X,1/4+Y,1/4+Z","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","1/4+X,3/4-Y,3/4+Z","1/4-X,3/4+Y,3/4+Z","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","3/4+X,1/4-Y,3/4+Z","3/4-X,1/4+Y,3/4+Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","3/4+X,3/4-Y,1/4+Z","3/4-X,3/4+Y,1/4+Z"],"I m m 2":["X,Y,Z","-X,-Y,Z","X,-Y,Z","-X,Y,Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z"],"I b a 2":["X,Y,Z","-X,-Y,Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","X,-Y,1/2+Z","-X,Y,1/2+Z"],"I m a 2":["X,Y,Z","-X,-Y,Z","1/2+X,-Y,Z","1/2-X,Y,Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","X,1/2-Y,1/2+Z","-X,1/2+Y,1/2+Z"],"P 2/m 2/m 2/m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z"],"P 2/n 2/n 2/n":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z"],"P 2/c 2/c 2/m":["X,Y,Z","-X,-Y,Z","-X,Y,1/2-Z","X,-Y,1/2-Z","-X,-Y,-Z","X,Y,-Z","X,-Y,1/2+Z","-X,Y,1/2+Z"],"P 2/b 2/a 2/n":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z"],"P 21/m 2/m 2/a":["X,Y,Z","1/2-X,-Y,Z","-X,Y,-Z","1/2+X,-Y,-Z","-X,-Y,-Z","1/2+X,Y,-Z","X,-Y,Z","1/2-X,Y,Z"],"P 2/n 21/n 2/a":["X,Y,Z","1/2-X,-Y,Z","1/2-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","-X,-Y,-Z","1/2+X,Y,-Z","1/2+X,1/2-Y,1/2+Z","-X,1/2+Y,1/2+Z"],"P 2/m 2/n 21/a":["X,Y,Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","X,-Y,-Z","-X,-Y,-Z","1/2+X,Y,1/2-Z","1/2+X,-Y,1/2+Z","-X,Y,Z"],"P 21/c 2/c 2/a":["X,Y,Z","1/2-X,-Y,Z","-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","-X,-Y,-Z","1/2+X,Y,-Z","X,-Y,1/2+Z","1/2-X,Y,1/2+Z"],"P 21/b 21/a 2/m":["X,Y,Z","-X,-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","-X,-Y,-Z","X,Y,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z"],"P 21/c 21/c 2/n":["X,Y,Z","1/2-X,1/2-Y,Z","-X,1/2+Y,1/2-Z","1/2+X,-Y,1/2-Z","-X,-Y,-Z","1/2+X,1/2+Y,-Z","X,1/2-Y,1/2+Z","1/2-X,Y,1/2+Z"],"P 2/b 21/c 21/m":["X,Y,Z","-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,-Z","-X,-Y,-Z","X,Y,1/2-Z","X,1/2-Y,1/2+Z","-X,1/2+Y,Z"],"P 21/n 21/n 2/m":["X,Y,Z","-X,-Y,Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","-X,-Y,-Z","X,Y,-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z"],"P 21/m 21/m 2/n":["X,Y,Z","-X,-Y,Z","1/2-X,Y+1/2,-Z","X+1/2,1/2-Y,-Z","1/2-X,1/2-Y,-Z","X+1/2,Y+1/2,-Z","X,-Y,Z","-X,Y,Z"],"P 21/b 2/c 21/n":["X,Y,Z","1/2-X,1/2-Y,1/2+Z","-X,Y,1/2-Z","1/2+X,1/2-Y,-Z","-X,-Y,-Z","1/2+X,1/2+Y,1/2-Z","X,-Y,1/2+Z","1/2-X,1/2+Y,Z"],"P 21/b 21/c 21/a":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","-X,-Y,-Z","1/2+X,Y,1/2-Z","X,1/2-Y,1/2+Z","1/2-X,1/2+Y,Z"],"P 21/n 21/m 21/a":["X,Y,Z","-X+1/2,-Y,Z+1/2","-X,Y+1/2,-Z","X+1/2,-Y+1/2,-Z+1/2","-X,-Y,-Z","X+1/2,Y,-Z+1/2","X,-Y+1/2,Z","-X+1/2,Y+1/2,Z+1/2"],"C 2/m 2/c 21/m":["X,Y,Z","-X,-Y,1/2+Z","-X,Y,1/2-Z","X,-Y,-Z","-X,-Y,-Z","X,Y,1/2-Z","X,-Y,1/2+Z","-X,Y,Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,Z"],"C 2/m 2/c 21/a":["X,Y,Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,-Y,-Z","-X,-Y,-Z","X,1/2+Y,1/2-Z","X,1/2-Y,1/2+Z","-X,Y,Z","1/2+X,1/2+Y,Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,1/2-Y,-Z","1/2-X,1/2-Y,-Z","1/2+X,Y,1/2-Z","1/2+X,-Y,1/2+Z","1/2-X,1/2+Y,Z"],"C 2/m 2/m 2/m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z"],"C 2/c 2/c 2/m":["X,Y,Z","-X,-Y,Z","-X,Y,1/2-Z","X,-Y,1/2-Z","-X,-Y,-Z","X,Y,-Z","X,-Y,1/2+Z","-X,Y,1/2+Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z"],"C 2/m 2/m 2/a":["X,Y,Z","-X,1/2-Y,Z","-X,1/2+Y,-Z","X,-Y,-Z","-X,-Y,-Z","X,1/2+Y,-Z","X,1/2-Y,Z","-X,Y,Z","1/2+X,1/2+Y,Z","1/2-X,-Y,Z","1/2-X,Y,-Z","1/2+X,1/2-Y,-Z","1/2-X,1/2-Y,-Z","1/2+X,Y,-Z","1/2+X,-Y,Z","1/2-X,1/2+Y,Z"],"C 2/c 2/c 2/a":["X,Y,Z","1/2-X,1/2-Y,Z","-X,Y,-Z","1/2+X,1/2-Y,-Z","-X,1/2-Y,1/2-Z","1/2+X,Y,1/2-Z","X,1/2-Y,1/2+Z","1/2-X,Y,1/2+Z","1/2+X,1/2+Y,Z","-X,-Y,Z","1/2-X,1/2+Y,-Z","X,-Y,-Z","1/2-X,-Y,1/2-Z","X,1/2+Y,1/2-Z","1/2+X,-Y,1/2+Z","-X,1/2+Y,1/2+Z"],"F 2/m 2/m 2/m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","-X,1/2-Y,1/2-Z","X,1/2+Y,1/2-Z","X,1/2-Y,1/2+Z","-X,1/2+Y,1/2+Z","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","1/2-X,-Y,1/2-Z","1/2+X,Y,1/2-Z","1/2+X,-Y,1/2+Z","1/2-X,Y,1/2+Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z"],"F 2/d 2/d 2/d":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","1/4-X,1/4-Y,1/4-Z","1/4+X,1/4+Y,1/4-Z","1/4+X,1/4-Y,1/4+Z","1/4-X,1/4+Y,1/4+Z","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","1/4-X,3/4-Y,3/4-Z","1/4+X,3/4+Y,3/4-Z","1/4+X,3/4-Y,3/4+Z","1/4-X,3/4+Y,3/4+Z","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","3/4-X,1/4-Y,3/4-Z","3/4+X,1/4+Y,3/4-Z","3/4+X,1/4-Y,3/4+Z","3/4-X,1/4+Y,3/4+Z","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","3/4-X,3/4-Y,1/4-Z","3/4+X,3/4+Y,1/4-Z","3/4+X,3/4-Y,1/4+Z","3/4-X,3/4+Y,1/4+Z"],"I 2/m 2/m 2/m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z"],"I 2/b 2/a 2/m":["X,Y,Z","-X,-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","-X,-Y,-Z","X,Y,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","-X,Y,1/2-Z","X,-Y,1/2-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","X,-Y,1/2+Z","-X,Y,1/2+Z"],"I 21/b 21/c 21/a":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","-X,-Y,-Z","1/2+X,Y,1/2-Z","X,1/2-Y,1/2+Z","1/2-X,1/2+Y,Z","1/2+X,1/2+Y,1/2+Z","-X,1/2-Y,Z","1/2-X,Y,-Z","X,-Y,1/2-Z","1/2-X,1/2-Y,1/2-Z","X,1/2+Y,-Z","1/2+X,-Y,Z","-X,Y,1/2+Z"],"I 21/m 21/m 21/a":["X,Y,Z","-X,1/2-Y,Z","-X,1/2+Y,-Z","X,-Y,-Z","-X,-Y,-Z","X,1/2+Y,-Z","X,1/2-Y,Z","-X,Y,Z","1/2+X,1/2+Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,Y,1/2-Z","1/2+X,-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z"],"P 4":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z"],"P 41":["X,Y,Z","-X,-Y,1/2+Z","-Y,X,1/4+Z","Y,-X,3/4+Z"],"P 42":["X,Y,Z","-X,-Y,Z","-Y,X,1/2+Z","Y,-X,1/2+Z"],"P 43":["X,Y,Z","-X,-Y,1/2+Z","-Y,X,3/4+Z","Y,-X,1/4+Z"],"I 4":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z"],"I 41":["X,Y,Z","1/2-X,1/2-Y,1/2+Z","-Y,1/2+X,1/4+Z","1/2+Y,-X,3/4+Z","1/2+X,1/2+Y,1/2+Z","-X,-Y,Z","1/2-Y,X,3/4+Z","Y,1/2-X,1/4+Z"],"P -4":["X,Y,Z","-X,-Y,Z","Y,-X,-Z","-Y,X,-Z"],"I -4":["X,Y,Z","-X,-Y,Z","Y,-X,-Z","-Y,X,-Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2+Y,1/2-X,1/2-Z","1/2-Y,1/2+X,1/2-Z"],"P 4/m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","-X,-Y,-Z","X,Y,-Z","Y,-X,-Z","-Y,X,-Z"],"P 42/m":["X,Y,Z","-X,-Y,Z","-Y,X,1/2+Z","Y,-X,1/2+Z","-X,-Y,-Z","X,Y,-Z","Y,-X,1/2-Z","-Y,X,1/2-Z"],"P 4/n":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,Z","1/2+Y,1/2-X,Z","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","Y,-X,-Z","-Y,X,-Z"],"P 42/n":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","Y,-X,-Z","-Y,X,-Z"],"I 4/m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","-X,-Y,-Z","X,Y,-Z","Y,-X,-Z","-Y,X,-Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2-Y,1/2+X,1/2-Z"],"I 41/a":["X,Y,Z","1/2-X,1/2-Y,1/2+Z","-Y,1/2+X,1/4+Z","1/2+Y,-X,3/4+Z","-X,1/2-Y,1/4-Z","1/2+X,Y,3/4-Z","Y,-X,-Z","1/2-Y,1/2+X,1/2-Z","1/2+X,1/2+Y,1/2+Z","-X,-Y,Z","1/2-Y,X,3/4+Z","Y,1/2-X,1/4+Z","1/2-X,-Y,3/4-Z","X,1/2+Y,1/4-Z","1/2+Y,1/2-X,1/2-Z","-Y,X,-Z"],"P 4 2 2":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","-X,Y,-Z","X,-Y,-Z","Y,X,-Z","-Y,-X,-Z"],"P 4 21 2":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,Z","1/2+Y,1/2-X,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","Y,X,-Z","-Y,-X,-Z"],"P 41 2 2":["X,Y,Z","-X,-Y,1/2+Z","-Y,X,1/4+Z","Y,-X,3/4+Z","-X,Y,-Z","X,-Y,1/2-Z","Y,X,3/4-Z","-Y,-X,1/4-Z"],"P 41 21 2":["X,Y,Z","-X,-Y,1/2+Z","1/2-Y,1/2+X,1/4+Z","1/2+Y,1/2-X,3/4+Z","1/2-X,1/2+Y,1/4-Z","1/2+X,1/2-Y,3/4-Z","Y,X,-Z","-Y,-X,1/2-Z"],"P 42 2 2":["X,Y,Z","-X,-Y,Z","-Y,X,1/2+Z","Y,-X,1/2+Z","-X,Y,-Z","X,-Y,-Z","Y,X,1/2-Z","-Y,-X,1/2-Z"],"P 42 21 2":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","Y,X,-Z","-Y,-X,-Z"],"P 43 2 2":["X,Y,Z","-X,-Y,1/2+Z","-Y,X,3/4+Z","Y,-X,1/4+Z","-X,Y,-Z","X,-Y,1/2-Z","Y,X,1/4-Z","-Y,-X,3/4-Z"],"P 43 21 2":["X,Y,Z","-X,-Y,1/2+Z","1/2-Y,1/2+X,3/4+Z","1/2+Y,1/2-X,1/4+Z","1/2-X,1/2+Y,3/4-Z","1/2+X,1/2-Y,1/4-Z","Y,X,-Z","-Y,-X,1/2-Z"],"I 4 2 2":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","-X,Y,-Z","X,-Y,-Z","Y,X,-Z","-Y,-X,-Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z"],"I 41 2 2":["X,Y,Z","1/2-X,1/2-Y,1/2+Z","-Y,1/2+X,1/4+Z","1/2+Y,-X,3/4+Z","1/2-X,Y,3/4-Z","X,1/2-Y,1/4-Z","1/2+Y,1/2+X,1/2-Z","-Y,-X,-Z","1/2+X,1/2+Y,1/2+Z","-X,-Y,Z","1/2-Y,X,3/4+Z","Y,1/2-X,1/4+Z","-X,1/2+Y,1/4-Z","1/2+X,-Y,3/4-Z","Y,X,-Z","1/2-Y,1/2-X,1/2-Z"],"P 4 m m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","X,-Y,Z","-X,Y,Z","-Y,-X,Z","Y,X,Z"],"P 4 b m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2-Y,1/2-X,Z","1/2+Y,1/2+X,Z"],"P 42 c m":["X,Y,Z","-X,-Y,Z","-Y,X,1/2+Z","Y,-X,1/2+Z","X,-Y,1/2+Z","-X,Y,1/2+Z","-Y,-X,Z","Y,X,Z"],"P 42 n m":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","-Y,-X,Z","Y,X,Z"],"P 4 c c":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","X,-Y,1/2+Z","-X,Y,1/2+Z","-Y,-X,1/2+Z","Y,X,1/2+Z"],"P 4 n c":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"P 42 m c":["X,Y,Z","-X,-Y,Z","-Y,X,1/2+Z","Y,-X,1/2+Z","X,-Y,Z","-X,Y,Z","-Y,-X,1/2+Z","Y,X,1/2+Z"],"P 42 b c":["X,Y,Z","-X,-Y,Z","-Y,X,1/2+Z","Y,-X,1/2+Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"I 4 m m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","X,-Y,Z","-X,Y,Z","-Y,-X,Z","Y,X,Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"I 4 c m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","X,-Y,1/2+Z","-X,Y,1/2+Z","-Y,-X,1/2+Z","Y,X,1/2+Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2-Y,1/2-X,Z","1/2+Y,1/2+X,Z"],"I 41 m d":["X,Y,Z","1/2-X,1/2-Y,1/2+Z","-Y,1/2+X,1/4+Z","1/2+Y,-X,3/4+Z","X,-Y,Z","1/2-X,1/2+Y,1/2+Z","-Y,1/2-X,1/4+Z","1/2+Y,X,3/4+Z","1/2+X,1/2+Y,1/2+Z","-X,-Y,Z","1/2-Y,X,3/4+Z","Y,1/2-X,1/4+Z","1/2+X,1/2-Y,1/2+Z","-X,Y,Z","1/2-Y,-X,3/4+Z","Y,1/2+X,1/4+Z"],"I 41 c d":["X,Y,Z","1/2-X,1/2-Y,1/2+Z","-Y,1/2+X,1/4+Z","1/2+Y,-X,3/4+Z","X,-Y,1/2+Z","1/2-X,1/2+Y,Z","-Y,1/2-X,3/4+Z","1/2+Y,X,1/4+Z","1/2+X,1/2+Y,1/2+Z","-X,-Y,Z","1/2-Y,X,3/4+Z","Y,1/2-X,1/4+Z","1/2+X,1/2-Y,Z","-X,Y,1/2+Z","1/2-Y,-X,1/4+Z","Y,1/2+X,3/4+Z"],"P -4 2 m":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","-X,Y,-Z","X,-Y,-Z","-Y,-X,Z","Y,X,Z"],"P -4 2 c":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","-X,Y,1/2-Z","X,-Y,1/2-Z","-Y,-X,1/2+Z","Y,X,1/2+Z"],"P -4 21 m":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2-Y,1/2-X,Z","1/2+Y,1/2+X,Z"],"P -4 21 c":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"P -4 m 2":["X,Y,Z","-X,-Y,Z","Y,-X,-Z","-Y,X,-Z","X,-Y,Z","-X,Y,Z","Y,X,-Z","-Y,-X,-Z"],"P -4 c 2":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","X,-Y,1/2+Z","-X,Y,1/2+Z","Y,X,1/2-Z","-Y,-X,1/2-Z"],"P -4 b 2":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2+Y,1/2+X,-Z","1/2-Y,1/2-X,-Z"],"P -4 n 2":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z"],"I -4 m 2":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","X,-Y,Z","-X,Y,Z","Y,X,-Z","-Y,-X,-Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z"],"I -4 c 2":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","X,-Y,1/2+Z","-X,Y,1/2+Z","Y,X,1/2-Z","-Y,-X,1/2-Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2+Y,1/2+X,-Z","1/2-Y,1/2-X,-Z"],"I -4 2 m":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","-X,Y,-Z","X,-Y,-Z","-Y,-X,Z","Y,X,Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"I -4 2 d":["X,Y,Z","-X,-Y,Z","-Y,X,-Z","Y,-X,-Z","1/2-X,Y,3/4-Z","1/2+X,-Y,3/4-Z","1/2-Y,-X,3/4+Z","1/2+Y,X,3/4+Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2-Z","1/2+Y,1/2-X,1/2-Z","-X,1/2+Y,1/4-Z","X,1/2-Y,1/4-Z","-Y,1/2-X,1/4+Z","Y,1/2+X,1/4+Z"],"P 4/m 2/m 2/m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","-X,Y,-Z","X,-Y,-Z","Y,X,-Z","-Y,-X,-Z","-X,-Y,-Z","X,Y,-Z","Y,-X,-Z","-Y,X,-Z","X,-Y,Z","-X,Y,Z","-Y,-X,Z","Y,X,Z"],"P 4/m 2/c 2/c":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","-X,Y,1/2-Z","X,-Y,1/2-Z","Y,X,1/2-Z","-Y,-X,1/2-Z","-X,-Y,-Z","X,Y,-Z","Y,-X,-Z","-Y,X,-Z","X,-Y,1/2+Z","-X,Y,1/2+Z","-Y,-X,1/2+Z","Y,X,1/2+Z"],
"P 4/n 2/b 2/m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","-X,Y,-Z","X,-Y,-Z","Y,X,-Z","-Y,-X,-Z","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","1/2+Y,1/2-X,-Z","1/2-Y,1/2+X,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2-Y,1/2-X,Z","1/2+Y,1/2+X,Z"],"P 4/n 2/n 2/c":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","-X,Y,-Z","X,-Y,-Z","Y,X,-Z","-Y,-X,-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2-Y,1/2+X,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"P 4/m 21/b 2/m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Y,1/2+X,-Z","1/2-Y,1/2-X,-Z","-X,-Y,-Z","X,Y,-Z","Y,-X,-Z","-Y,X,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2-Y,1/2-X,Z","1/2+Y,1/2+X,Z"],"P 4/m 21/n 2/c":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z","-X,-Y,-Z","X,Y,-Z","Y,-X,-Z","-Y,X,-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"P 4/n 21/m 2/m":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,Z","1/2+Y,1/2-X,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","Y,X,-Z","-Y,-X,-Z","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","Y,-X,-Z","-Y,X,-Z","X,-Y,Z","-X,Y,Z","1/2-Y,1/2-X,Z","1/2+Y,1/2+X,Z"],"P 4/n 2/c 2/c":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,Z","1/2+Y,1/2-X,Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","Y,X,1/2-Z","-Y,-X,1/2-Z","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","Y,-X,-Z","-Y,X,-Z","X,-Y,1/2+Z","-X,Y,1/2+Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"P 42/m 2/m 2/c":["X,Y,Z","-X,-Y,Z","-Y,X,1/2+Z","Y,-X,1/2+Z","-X,Y,-Z","X,-Y,-Z","Y,X,1/2-Z","-Y,-X,1/2-Z","-X,-Y,-Z","X,Y,-Z","Y,-X,1/2-Z","-Y,X,1/2-Z","X,-Y,Z","-X,Y,Z","-Y,-X,1/2+Z","Y,X,1/2+Z"],"P 42/m 2/c 2/m":["X,Y,Z","-X,-Y,Z","-Y,X,1/2+Z","Y,-X,1/2+Z","-X,Y,1/2-Z","X,-Y,1/2-Z","Y,X,-Z","-Y,-X,-Z","-X,-Y,-Z","X,Y,-Z","Y,-X,1/2-Z","-Y,X,1/2-Z","X,-Y,1/2+Z","-X,Y,1/2+Z","-Y,-X,Z","Y,X,Z"],"P 42/n 2/b 2/c":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","-X,Y,1/2-Z","X,-Y,1/2-Z","1/2+Y,1/2+X,-Z","1/2-Y,1/2-X,-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","Y,-X,-Z","-Y,X,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","-Y,-X,1/2+Z","Y,X,1/2+Z"],"P 42/n 2/n 2/m":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","-X,Y,-Z","X,-Y,-Z","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","Y,-X,-Z","-Y,X,-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","-Y,-X,Z","Y,X,Z"],"P 42/m 21/b 2/c":["X,Y,Z","-X,-Y,Z","-Y,X,1/2+Z","Y,-X,1/2+Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z","-X,-Y,-Z","X,Y,-Z","Y,-X,1/2-Z","-Y,X,1/2-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"P 42/m 21/n 2/m":["X,Y,Z","-X,-Y,Z","1/2-Y,X+1/2,Z+1/2","Y+1/2,1/2-X,Z+1/2","1/2-X,Y+1/2,1/2-Z","X+1/2,1/2-Y,1/2-Z","Y,X,-Z","-Y,-X,-Z","-X,-Y,-Z","X,Y,-Z","Y+1/2,1/2-X,1/2-Z","1/2-Y,X+1/2,1/2-Z","X+1/2,1/2-Y,Z+1/2","1/2-X,Y+1/2,Z+1/2","-Y,-X,Z","Y,X,Z"],"P 42/n 21/m 2/c":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","Y,X,-Z","-Y,-X,-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","Y,-X,-Z","-Y,X,-Z","X,-Y,Z","-X,Y,Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"P 42/n 21/c 2/m":["X,Y,Z","-X,-Y,Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","Y,X,1/2-Z","-Y,-X,1/2-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","Y,-X,-Z","-Y,X,-Z","X,-Y,1/2+Z","-X,Y,1/2+Z","1/2-Y,1/2-X,Z","1/2+Y,1/2+X,Z"],"I 4/m 2/m 2/m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","-X,Y,-Z","X,-Y,-Z","Y,X,-Z","-Y,-X,-Z","-X,-Y,-Z","X,Y,-Z","Y,-X,-Z","-Y,X,-Z","X,-Y,Z","-X,Y,Z","-Y,-X,Z","Y,X,Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2-Y,1/2+X,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z"],"I 4/m 2/c 2/m":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z","-X,Y,1/2-Z","X,-Y,1/2-Z","Y,X,1/2-Z","-Y,-X,1/2-Z","-X,-Y,-Z","X,Y,-Z","Y,-X,-Z","-Y,X,-Z","X,-Y,1/2+Z","-X,Y,1/2+Z","-Y,-X,1/2+Z","Y,X,1/2+Z","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+Y,1/2-X,1/2+Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Y,1/2+X,-Z","1/2-Y,1/2-X,-Z","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2-Y,1/2+X,1/2-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2-Y,1/2-X,Z","1/2+Y,1/2+X,Z"],"I 41/a 2/m 2/d":["X,Y,Z","1/2-X,1/2-Y,1/2+Z","-Y,1/2+X,1/4+Z","1/2+Y,-X,3/4+Z","1/2-X,Y,3/4-Z","X,1/2-Y,1/4-Z","1/2+Y,1/2+X,1/2-Z","-Y,-X,-Z","-X,1/2-Y,1/4-Z","1/2+X,Y,3/4-Z","Y,-X,-Z","1/2-Y,1/2+X,1/2-Z","1/2+X,1/2-Y,1/2+Z","-X,Y,Z","1/2-Y,-X,3/4+Z","Y,1/2+X,1/4+Z","1/2+X,1/2+Y,1/2+Z","-X,-Y,Z","1/2-Y,X,3/4+Z","Y,1/2-X,1/4+Z","-X,1/2+Y,1/4-Z","1/2+X,-Y,3/4-Z","Y,X,-Z","1/2-Y,1/2-X,1/2-Z","1/2-X,-Y,3/4-Z","X,1/2+Y,1/4-Z","1/2+Y,1/2-X,1/2-Z","-Y,X,-Z","X,-Y,Z","1/2-X,1/2+Y,1/2+Z","-Y,1/2-X,1/4+Z","1/2+Y,X,3/4+Z"],"I 41/a 2/c 2/d":["X,Y,Z","1/2-X,1/2-Y,1/2+Z","-Y,1/2+X,1/4+Z","1/2+Y,-X,3/4+Z","1/2-X,Y,1/4-Z","X,1/2-Y,3/4-Z","1/2+Y,1/2+X,-Z","-Y,-X,1/2-Z","-X,1/2-Y,1/4-Z","1/2+X,Y,3/4-Z","Y,-X,-Z","1/2-Y,1/2+X,1/2-Z","1/2+X,1/2-Y,Z","-X,Y,1/2+Z","1/2-Y,-X,1/4+Z","Y,1/2+X,3/4+Z","1/2+X,1/2+Y,1/2+Z","-X,-Y,Z","1/2-Y,X,3/4+Z","Y,1/2-X,1/4+Z","-X,1/2+Y,3/4-Z","1/2+X,-Y,1/4-Z","Y,X,1/2-Z","1/2-Y,1/2-X,-Z","1/2-X,-Y,3/4-Z","X,1/2+Y,1/4-Z","1/2+Y,1/2-X,1/2-Z","-Y,X,-Z","X,-Y,1/2+Z","1/2-X,1/2+Y,Z","-Y,1/2-X,3/4+Z","1/2+Y,X,1/4+Z"],"P 3":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z"],"P 31":["X,Y,Z","-Y,X-Y,Z+1/3","Y-X,-X,Z+2/3"],"P 32":["X,Y,Z","-Y,X-Y,Z+2/3","Y-X,-X,Z+1/3"],"H 3":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","X+2/3,Y+1/3,Z+1/3","-Y+2/3,X-Y+1/3,Z+1/3","Y-X+2/3,-X+1/3,Z+1/3","X+1/3,Y+2/3,Z+2/3","-Y+1/3,X-Y+2/3,Z+2/3","Y-X+1/3,-X+2/3,Z+2/3"],"R 3":["X,Y,Z","Z,X,Y","Y,Z,X"],"P -3":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z"],"H -3":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","2/3+X,1/3+Y,1/3+Z","2/3-Y,1/3+X-Y,1/3+Z","2/3+Y-X,1/3-X,1/3+Z","2/3-X,1/3-Y,1/3-Z","2/3+Y,1/3+Y-X,1/3-Z","2/3+X-Y,1/3+X,1/3-Z","1/3+X,2/3+Y,2/3+Z","1/3-Y,2/3+X-Y,2/3+Z","1/3+Y-X,2/3-X,2/3+Z","1/3-X,2/3-Y,2/3-Z","1/3+Y,2/3+Y-X,2/3-Z","1/3+X-Y,2/3+X,2/3-Z"],"R -3":["X,Y,Z","Z,X,Y","Y,Z,X","-X,-Y,-Z","-Z,-X,-Y","-Y,-Z,-X"],"P 3 1 2":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-Y,-X,-Z","Y-X,Y,-Z","X,X-Y,-Z"],"P 3 2 1":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","Y,X,-Z","X-Y,-Y,-Z","-X,Y-X,-Z"],"P 31 1 2":["X,Y,Z","-Y,X-Y,1/3+Z","Y-X,-X,2/3+Z","-Y,-X,2/3-Z","Y-X,Y,1/3-Z","X,X-Y,-Z"],"P 31 2 1":["X,Y,Z","-Y,X-Y,Z+1/3","Y-X,-X,Z+2/3","Y,X,-Z","X-Y,-Y,2/3-Z","-X,Y-X,1/3-Z"],"P 32 1 2":["X,Y,Z","-Y,X-Y,2/3+Z","Y-X,-X,1/3+Z","-Y,-X,1/3-Z","Y-X,Y,2/3-Z","X,X-Y,-Z"],"P 32 2 1":["X,Y,Z","-Y,X-Y,Z+2/3","Y-X,-X,Z+1/3","Y,X,-Z","X-Y,-Y,1/3-Z","-X,Y-X,2/3-Z"],"H 3 2":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","Y,X,-Z","X-Y,-Y,-Z","-X,Y-X,-Z","2/3+X,1/3+Y,1/3+Z","2/3-Y,1/3+X-Y,1/3+Z","2/3+Y-X,1/3-X,1/3+Z","2/3+Y,1/3+X,1/3-Z","2/3+X-Y,1/3-Y,1/3-Z","2/3-X,1/3+Y-X,1/3-Z","1/3+X,2/3+Y,2/3+Z","1/3-Y,2/3+X-Y,2/3+Z","1/3+Y-X,2/3-X,2/3+Z","1/3+Y,2/3+X,2/3-Z","1/3+X-Y,2/3-Y,2/3-Z","1/3-X,2/3+Y-X,2/3-Z"],"R 3 2":["X,Y,Z","Z,X,Y","Y,Z,X","-Y,-X,-Z","-X,-Z,-Y","-Z,-Y,-X"],"P 3 m 1":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-Y,-X,Z","Y-X,Y,Z","X,X-Y,Z"],"P 3 1 m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","Y,X,Z","X-Y,-Y,Z","-X,Y-X,Z"],"P 3 c 1":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-Y,-X,1/2+Z","Y-X,Y,1/2+Z","X,X-Y,1/2+Z"],"P 3 1 c":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","Y,X,1/2+Z","X-Y,-Y,1/2+Z","-X,Y-X,1/2+Z"],"H 3 m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-Y,-X,Z","Y-X,Y,Z","X,X-Y,Z","2/3+X,1/3+Y,1/3+Z","2/3-Y,1/3+X-Y,1/3+Z","2/3+Y-X,1/3-X,1/3+Z","2/3-Y,1/3-X,1/3+Z","2/3+Y-X,1/3+Y,1/3+Z","2/3+X,1/3+X-Y,1/3+Z","1/3+X,2/3+Y,2/3+Z","1/3-Y,2/3+X-Y,2/3+Z","1/3+Y-X,2/3-X,2/3+Z","1/3-Y,2/3-X,2/3+Z","1/3+Y-X,2/3+Y,2/3+Z","1/3+X,2/3+X-Y,2/3+Z"],"R 3 m":["X,Y,Z","Z,X,Y","Y,Z,X","Y,X,Z","X,Z,Y","Z,Y,X"],"H 3 c":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-Y,-X,1/2+Z","Y-X,Y,1/2+Z","X,X-Y,1/2+Z","2/3+X,1/3+Y,1/3+Z","2/3-Y,1/3+X-Y,1/3+Z","2/3+Y-X,1/3-X,1/3+Z","2/3-Y,1/3-X,5/6+Z","2/3+Y-X,1/3+Y,5/6+Z","2/3+X,1/3+X-Y,5/6+Z","1/3+X,2/3+Y,2/3+Z","1/3-Y,2/3+X-Y,2/3+Z","1/3+Y-X,2/3-X,2/3+Z","1/3-Y,2/3-X,1/6+Z","1/3+Y-X,2/3+Y,1/6+Z","1/3+X,2/3+X-Y,1/6+Z"],"R 3 c":["X,Y,Z","Z,X,Y","Y,Z,X","Y+1/2,X+1/2,Z+1/2","X+1/2,Z+1/2,Y+1/2","Z+1/2,Y+1/2,X+1/2"],"P -3 1 2/m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-Y,-X,-Z","Y-X,Y,-Z","X,X-Y,-Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","Y,X,Z","X-Y,-Y,Z","-X,Y-X,Z"],"P -3 1 2/c":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-Y,-X,1/2-Z","Y-X,Y,1/2-Z","X,X-Y,1/2-Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","Y,X,1/2+Z","X-Y,-Y,1/2+Z","-X,Y-X,1/2+Z"],"P -3 2/m 1":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","Y,X,-Z","X-Y,-Y,-Z","-X,Y-X,-Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","-Y,-X,Z","Y-X,Y,Z","X,X-Y,Z"],"P -3 2/c 1":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","Y,X,1/2-Z","X-Y,-Y,1/2-Z","-X,Y-X,1/2-Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","-Y,-X,1/2+Z","Y-X,Y,1/2+Z","X,X-Y,1/2+Z"],"H -3 2/m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","Y,X,-Z","X-Y,-Y,-Z","-X,Y-X,-Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","-Y,-X,Z","Y-X,Y,Z","X,X-Y,Z","2/3+X,1/3+Y,1/3+Z","2/3-Y,1/3+X-Y,1/3+Z","2/3+Y-X,1/3-X,1/3+Z","2/3+Y,1/3+X,1/3-Z","2/3+X-Y,1/3-Y,1/3-Z","2/3-X,1/3+Y-X,1/3-Z","2/3-X,1/3-Y,1/3-Z","2/3+Y,1/3+Y-X,1/3-Z","2/3+X-Y,1/3+X,1/3-Z","2/3-Y,1/3-X,1/3+Z","2/3+Y-X,1/3+Y,1/3+Z","2/3+X,1/3+X-Y,1/3+Z","1/3+X,2/3+Y,2/3+Z","1/3-Y,2/3+X-Y,2/3+Z","1/3+Y-X,2/3-X,2/3+Z","1/3+Y,2/3+X,2/3-Z","1/3+X-Y,2/3-Y,2/3-Z","1/3-X,2/3+Y-X,2/3-Z","1/3-X,2/3-Y,2/3-Z","1/3+Y,2/3+Y-X,2/3-Z","1/3+X-Y,2/3+X,2/3-Z","1/3-Y,2/3-X,2/3+Z","1/3+Y-X,2/3+Y,2/3+Z","1/3+X,2/3+X-Y,2/3+Z"],"R -3 2/m":["X,Y,Z","Z,X,Y","Y,Z,X","-Y,-X,-Z","-X,-Z,-Y","-Z,-Y,-X","-X,-Y,-Z","-Z,-X,-Y","-Y,-Z,-X","Y,X,Z","X,Z,Y","Z,Y,X"],"H -3 2/c":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","Y,X,1/2-Z","X-Y,-Y,1/2-Z","-X,Y-X,1/2-Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","-Y,-X,1/2+Z","Y-X,Y,1/2+Z","X,X-Y,1/2+Z","2/3+X,1/3+Y,1/3+Z","2/3-Y,1/3+X-Y,1/3+Z","2/3+Y-X,1/3-X,1/3+Z","2/3+Y,1/3+X,5/6-Z","2/3+X-Y,1/3-Y,5/6-Z","2/3-X,1/3+Y-X,5/6-Z","2/3-X,1/3-Y,1/3-Z","2/3+Y,1/3+Y-X,1/3-Z","2/3+X-Y,1/3+X,1/3-Z","2/3-Y,1/3-X,5/6+Z","2/3+Y-X,1/3+Y,5/6+Z","2/3+X,1/3+X-Y,5/6+Z","1/3+X,2/3+Y,2/3+Z","1/3-Y,2/3+X-Y,2/3+Z","1/3+Y-X,2/3-X,2/3+Z","1/3+Y,2/3+X,1/6-Z","1/3+X-Y,2/3-Y,1/6-Z","1/3-X,2/3+Y-X,1/6-Z","1/3-X,2/3-Y,2/3-Z","1/3+Y,2/3+Y-X,2/3-Z","1/3+X-Y,2/3+X,2/3-Z","1/3-Y,2/3-X,1/6+Z","1/3+Y-X,2/3+Y,1/6+Z","1/3+X,2/3+X-Y,1/6+Z"],"R -3 2/c":["X,Y,Z","Z,X,Y","Y,Z,X","-Y+1/2,-X+1/2,-Z+1/2","-X+1/2,-Z+1/2,-Y+1/2","-Z+1/2,-Y+1/2,-X+1/2","-X,-Y,-Z","-Z,-X,-Y","-Y,-Z,-X","Y+1/2,X+1/2,Z+1/2","X+1/2,Z+1/2,Y+1/2","Z+1/2,Y+1/2,X+1/2"],"P 6":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,Z","Y,Y-X,Z","X-Y,X,Z"],"P 61":["X,Y,Z","-Y,X-Y,Z+1/3","Y-X,-X,Z+2/3","-X,-Y,Z+1/2","Y,Y-X,Z+5/6","X-Y,X,Z+1/6"],"P 65":["X,Y,Z","-Y,X-Y,Z+2/3","Y-X,-X,Z+1/3","-X,-Y,Z+1/2","Y,Y-X,Z+1/6","X-Y,X,Z+5/6"],"P 62":["X,Y,Z","-Y,X-Y,2/3+Z","Y-X,-X,1/3+Z","-X,-Y,Z","Y,Y-X,2/3+Z","X-Y,X,1/3+Z"],"P 64":["X,Y,Z","-Y,X-Y,1/3+Z","Y-X,-X,2/3+Z","-X,-Y,Z","Y,Y-X,1/3+Z","X-Y,X,2/3+Z"],"P 63":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,1/2+Z","Y,Y-X,1/2+Z","X-Y,X,1/2+Z"],"P -6":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","X,Y,-Z","-Y,X-Y,-Z","Y-X,-X,-Z"],"P 6/m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,Z","Y,Y-X,Z","X-Y,X,Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","X,Y,-Z","-Y,X-Y,-Z","Y-X,-X,-Z"],"P 63/m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,1/2+Z","Y,Y-X,1/2+Z","X-Y,X,1/2+Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","X,Y,1/2-Z","-Y,X-Y,1/2-Z","Y-X,-X,1/2-Z"],"P 6 2 2":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,Z","Y,Y-X,Z","X-Y,X,Z","Y,X,-Z","X-Y,-Y,-Z","-X,Y-X,-Z","-Y,-X,-Z","Y-X,Y,-Z","X,X-Y,-Z"],"P 61 2 2":["X,Y,Z","-Y,X-Y,1/3+Z","Y-X,-X,2/3+Z","-X,-Y,1/2+Z","Y,Y-X,5/6+Z","X-Y,X,1/6+Z","Y,X,1/3-Z","X-Y,-Y,-Z","-X,Y-X,2/3-Z","-Y,-X,5/6-Z","Y-X,Y,1/2-Z","X,X-Y,1/6-Z"],"P 65 2 2":["X,Y,Z","-Y,X-Y,2/3+Z","Y-X,-X,1/3+Z","-X,-Y,1/2+Z","Y,Y-X,1/6+Z","X-Y,X,5/6+Z","Y,X,2/3-Z","X-Y,-Y,-Z","-X,Y-X,1/3-Z","-Y,-X,1/6-Z","Y-X,Y,1/2-Z","X,X-Y,5/6-Z"],"P 62 2 2":["X,Y,Z","-Y,X-Y,2/3+Z","Y-X,-X,1/3+Z","-X,-Y,Z","Y,Y-X,2/3+Z","X-Y,X,1/3+Z","Y,X,2/3-Z","X-Y,-Y,-Z","-X,Y-X,1/3-Z","-Y,-X,2/3-Z","Y-X,Y,-Z","X,X-Y,1/3-Z"],"P 64 2 2":["X,Y,Z","-Y,X-Y,1/3+Z","Y-X,-X,2/3+Z","-X,-Y,Z","Y,Y-X,1/3+Z","X-Y,X,2/3+Z","Y,X,1/3-Z","X-Y,-Y,-Z","-X,Y-X,2/3-Z","-Y,-X,1/3-Z","Y-X,Y,-Z","X,X-Y,2/3-Z"],"P 63 2 2":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,1/2+Z","Y,Y-X,1/2+Z","X-Y,X,1/2+Z","Y,X,-Z","X-Y,-Y,-Z","-X,Y-X,-Z","-Y,-X,1/2-Z","Y-X,Y,1/2-Z","X,X-Y,1/2-Z"],"P 6 m m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,Z","Y,Y-X,Z","X-Y,X,Z","-Y,-X,Z","Y-X,Y,Z","X,X-Y,Z","Y,X,Z","X-Y,-Y,Z","-X,Y-X,Z"],"P 6 c c":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,Z","Y,Y-X,Z","X-Y,X,Z","-Y,-X,1/2+Z","Y-X,Y,1/2+Z","X,X-Y,1/2+Z","Y,X,1/2+Z","X-Y,-Y,1/2+Z","-X,Y-X,1/2+Z"],"P 63 c m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,1/2+Z","Y,Y-X,1/2+Z","X-Y,X,1/2+Z","-Y,-X,1/2+Z","Y-X,Y,1/2+Z","X,X-Y,1/2+Z","Y,X,Z","X-Y,-Y,Z","-X,Y-X,Z"],"P 63 m c":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,1/2+Z","Y,Y-X,1/2+Z","X-Y,X,1/2+Z","-Y,-X,Z","Y-X,Y,Z","X,X-Y,Z","Y,X,1/2+Z","X-Y,-Y,1/2+Z","-X,Y-X,1/2+Z"],"P -6 m 2":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","X,Y,-Z","-Y,X-Y,-Z","Y-X,-X,-Z","-Y,-X,Z","Y-X,Y,Z","X,X-Y,Z","-Y,-X,-Z","Y-X,Y,-Z","X,X-Y,-Z"],"P -6 c 2":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","X,Y,1/2-Z","-Y,X-Y,1/2-Z","Y-X,-X,1/2-Z","-Y,-X,1/2+Z","Y-X,Y,1/2+Z","X,X-Y,1/2+Z","-Y,-X,-Z","Y-X,Y,-Z","X,X-Y,-Z"],"P -6 2 m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","X,Y,-Z","-Y,X-Y,-Z","Y-X,-X,-Z","Y,X,-Z","X-Y,-Y,-Z","-X,Y-X,-Z","Y,X,Z","X-Y,-Y,Z","-X,Y-X,Z"],"P -6 2 c":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","X,Y,1/2-Z","-Y,X-Y,1/2-Z","Y-X,-X,1/2-Z","Y,X,-Z","X-Y,-Y,-Z","-X,Y-X,-Z","Y,X,1/2+Z","X-Y,-Y,1/2+Z","-X,Y-X,1/2+Z"],"P 6/m 2/m 2/m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,Z","Y,Y-X,Z","X-Y,X,Z","Y,X,-Z","X-Y,-Y,-Z","-X,Y-X,-Z","-Y,-X,-Z","Y-X,Y,-Z","X,X-Y,-Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","X,Y,-Z","Y-X,-X,-Z","-Y,X-Y,-Z","-Y,-X,Z","Y-X,Y,Z","X,X-Y,Z","Y,X,Z","X-Y,-Y,Z","-X,Y-X,Z"],"P 6/m 2/c 2/c":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,Z","Y,Y-X,Z","X-Y,X,Z","Y,X,1/2-Z","X-Y,-Y,1/2-Z","-X,Y-X,1/2-Z","-Y,-X,1/2-Z","Y-X,Y,1/2-Z","X,X-Y,1/2-Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","X,Y,-Z","Y-X,-X,-Z","-Y,X-Y,-Z","-Y,-X,1/2+Z","Y-X,Y,1/2+Z","X,X-Y,1/2+Z","Y,X,1/2+Z","X-Y,-Y,1/2+Z","-X,Y-X,1/2+Z"],"P 63/m 2/c 2/m":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,1/2+Z","Y,Y-X,1/2+Z","X-Y,X,1/2+Z","Y,X,1/2-Z","X-Y,-Y,1/2-Z","-X,Y-X,1/2-Z","-Y,-X,-Z","Y-X,Y,-Z","X,X-Y,-Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","X,Y,1/2-Z","Y-X,-X,1/2-Z","-Y,X-Y,1/2-Z","-Y,-X,1/2+Z","Y-X,Y,1/2+Z","X,X-Y,1/2+Z","Y,X,Z","X-Y,-Y,Z","-X,Y-X,Z"],"P 63/m 2/m 2/c":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z","-X,-Y,1/2+Z","Y,Y-X,1/2+Z","X-Y,X,1/2+Z","Y,X,-Z","X-Y,-Y,-Z","-X,Y-X,-Z","-Y,-X,1/2-Z","Y-X,Y,1/2-Z","X,X-Y,1/2-Z","-X,-Y,-Z","Y,Y-X,-Z","X-Y,X,-Z","X,Y,1/2-Z","Y-X,-X,1/2-Z","-Y,X-Y,1/2-Z","-Y,-X,Z","Y-X,Y,Z","X,X-Y,Z","Y,X,1/2+Z","X-Y,-Y,1/2+Z","-X,Y-X,1/2+Z"],"P 2 3":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X"],"F 2 3":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","Z,1/2+X,1/2+Y","Z,1/2-X,1/2-Y","-Z,1/2-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,1/2+Z,1/2+X","-Y,1/2+Z,1/2-X","Y,1/2-Z,1/2-X","-Y,1/2-Z,1/2+X","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","1/2+Z,X,1/2+Y","1/2+Z,-X,1/2-Y","1/2-Z,-X,1/2+Y","1/2-Z,X,1/2-Y","1/2+Y,Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,-Z,1/2-X","1/2-Y,-Z,1/2+X","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Z,1/2+X,Y","1/2+Z,1/2-X,-Y","1/2-Z,1/2-X,Y","1/2-Z,1/2+X,-Y","1/2+Y,1/2+Z,X","1/2-Y,1/2+Z,-X","1/2+Y,1/2-Z,-X","1/2-Y,1/2-Z,X"],"I 2 3":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2+Z,1/2+X,1/2+Y","1/2+Z,1/2-X,1/2-Y","1/2-Z,1/2-X,1/2+Y","1/2-Z,1/2+X,1/2-Y","1/2+Y,1/2+Z,1/2+X","1/2-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,1/2-X","1/2-Y,1/2-Z,1/2+X"],"P 21 3":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,X,Y","1/2+Z,1/2-X,-Y","1/2-Z,-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,Z,X","-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,-X","1/2-Y,-Z,1/2+X"],"I 21 3":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,X,Y","1/2+Z,1/2-X,-Y","1/2-Z,-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,Z,X","-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,-X","1/2-Y,-Z,1/2+X","1/2+X,1/2+Y,1/2+Z","-X,1/2-Y,Z","1/2-X,Y,-Z","X,-Y,1/2-Z","1/2+Z,1/2+X,1/2+Y","Z,-X,1/2-Y","-Z,1/2-X,Y","1/2-Z,X,-Y","1/2+Y,1/2+Z,1/2+X","1/2-Y,Z,-X","Y,-Z,1/2-X","-Y,1/2-Z,X"],"P 2/m -3":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","-Z,-X,-Y","-Z,X,Y","Z,X,-Y","Z,-X,Y","-Y,-Z,-X","Y,-Z,X","-Y,Z,X","Y,Z,-X"],"P 2/n -3":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2-Z,1/2-X,1/2-Y","1/2-Z,1/2+X,1/2+Y","1/2+Z,1/2+X,1/2-Y","1/2+Z,1/2-X,1/2+Y","1/2-Y,1/2-Z,1/2-X","1/2+Y,1/2-Z,1/2+X","1/2-Y,1/2+Z,1/2+X","1/2+Y,1/2+Z,1/2-X"],"F 2/m -3":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","-Z,-X,-Y","-Z,X,Y","Z,X,-Y","Z,-X,Y","-Y,-Z,-X","Y,-Z,X","-Y,Z,X","Y,Z,-X","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","Z,1/2+X,1/2+Y","Z,1/2-X,1/2-Y","-Z,1/2-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,1/2+Z,1/2+X","-Y,1/2+Z,1/2-X","Y,1/2-Z,1/2-X","-Y,1/2-Z,1/2+X","-X,1/2-Y,1/2-Z","X,1/2+Y,1/2-Z","X,1/2-Y,1/2+Z","-X,1/2+Y,1/2+Z","-Z,1/2-X,1/2-Y","-Z,1/2+X,1/2+Y","Z,1/2+X,1/2-Y","Z,1/2-X,1/2+Y","-Y,1/2-Z,1/2-X","Y,1/2-Z,1/2+X","-Y,1/2+Z,1/2+X","Y,1/2+Z,1/2-X","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","1/2+Z,X,1/2+Y","1/2+Z,-X,1/2-Y","1/2-Z,-X,1/2+Y","1/2-Z,X,1/2-Y","1/2+Y,Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,-Z,1/2-X","1/2-Y,-Z,1/2+X","1/2-X,-Y,1/2-Z","1/2+X,Y,1/2-Z","1/2+X,-Y,1/2+Z","1/2-X,Y,1/2+Z","1/2-Z,-X,1/2-Y","1/2-Z,X,1/2+Y","1/2+Z,X,1/2-Y","1/2+Z,-X,1/2+Y","1/2-Y,-Z,1/2-X","1/2+Y,-Z,1/2+X","1/2-Y,Z,1/2+X","1/2+Y,Z,1/2-X","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Z,1/2+X,Y","1/2+Z,1/2-X,-Y","1/2-Z,1/2-X,Y","1/2-Z,1/2+X,-Y","1/2+Y,1/2+Z,X","1/2-Y,1/2+Z,-X","1/2+Y,1/2-Z,-X","1/2-Y,1/2-Z,X","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2-Z,1/2-X,-Y","1/2-Z,1/2+X,Y","1/2+Z,1/2+X,-Y","1/2+Z,1/2-X,Y","1/2-Y,1/2-Z,-X","1/2+Y,1/2-Z,X","1/2-Y,1/2+Z,X","1/2+Y,1/2+Z,-X"],"F 2/d -3":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","1/4-X,1/4-Y,1/4-Z","1/4+X,1/4+Y,1/4-Z","1/4+X,1/4-Y,1/4+Z","1/4-X,1/4+Y,1/4+Z","1/4-Z,1/4-X,1/4-Y","1/4-Z,1/4+X,1/4+Y","1/4+Z,1/4+X,1/4-Y","1/4+Z,1/4-X,1/4+Y","1/4-Y,1/4-Z,1/4-X","1/4+Y,1/4-Z,1/4+X","1/4-Y,1/4+Z,1/4+X","1/4+Y,1/4+Z,1/4-X","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","Z,1/2+X,1/2+Y","Z,1/2-X,1/2-Y","-Z,1/2-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,1/2+Z,1/2+X","-Y,1/2+Z,1/2-X","Y,1/2-Z,1/2-X","-Y,1/2-Z,1/2+X","1/4-X,3/4-Y,3/4-Z","1/4+X,3/4+Y,3/4-Z","1/4+X,3/4-Y,3/4+Z","1/4-X,3/4+Y,3/4+Z","1/4-Z,3/4-X,3/4-Y","1/4-Z,3/4+X,3/4+Y","1/4+Z,3/4+X,3/4-Y","1/4+Z,3/4-X,3/4+Y","1/4-Y,3/4-Z,3/4-X","1/4+Y,3/4-Z,3/4+X","1/4-Y,3/4+Z,3/4+X","1/4+Y,3/4+Z,3/4-X","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","1/2+Z,X,1/2+Y","1/2+Z,-X,1/2-Y","1/2-Z,-X,1/2+Y","1/2-Z,X,1/2-Y","1/2+Y,Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,-Z,1/2-X","1/2-Y,-Z,1/2+X","3/4-X,1/4-Y,3/4-Z","3/4+X,1/4+Y,3/4-Z","3/4+X,1/4-Y,3/4+Z","3/4-X,1/4+Y,3/4+Z","3/4-Z,1/4-X,3/4-Y","3/4-Z,1/4+X,3/4+Y","3/4+Z,1/4+X,3/4-Y","3/4+Z,1/4-X,3/4+Y","3/4-Y,1/4-Z,3/4-X","3/4+Y,1/4-Z,3/4+X","3/4-Y,1/4+Z,3/4+X","3/4+Y,1/4+Z,3/4-X","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Z,1/2+X,Y","1/2+Z,1/2-X,-Y","1/2-Z,1/2-X,Y","1/2-Z,1/2+X,-Y","1/2+Y,1/2+Z,X","1/2-Y,1/2+Z,-X","1/2+Y,1/2-Z,-X","1/2-Y,1/2-Z,X","3/4-X,3/4-Y,1/4-Z","3/4+X,3/4+Y,1/4-Z","3/4+X,3/4-Y,Z+1/4","3/4-X,3/4+Y,Z+1/4","3/4-Z,3/4-X,1/4-Y","3/4-Z,3/4+X,1/4+Y","3/4+Z,3/4+X,1/4-Y","3/4+Z,3/4-X,1/4+Y","3/4-Y,3/4-Z,1/4-X","3/4+Y,3/4-Z,1/4+X","3/4-Y,3/4+Z,1/4+X","3/4+Y,3/4+Z,1/4-X"],"I 2/m -3":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","-Z,-X,-Y","-Z,X,Y","Z,X,-Y","Z,-X,Y","-Y,-Z,-X","Y,-Z,X","-Y,Z,X","Y,Z,-X","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2+Z,1/2+X,1/2+Y","1/2+Z,1/2-X,1/2-Y","1/2-Z,1/2-X,1/2+Y","1/2-Z,1/2+X,1/2-Y","1/2+Y,1/2+Z,1/2+X","1/2-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,1/2-X","1/2-Y,1/2-Z,1/2+X","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2-Z,1/2-X,1/2-Y","1/2-Z,1/2+X,1/2+Y","1/2+Z,1/2+X,1/2-Y","1/2+Z,1/2-X,1/2+Y","1/2-Y,1/2-Z,1/2-X","1/2+Y,1/2-Z,1/2+X","1/2-Y,1/2+Z,1/2+X","1/2+Y,1/2+Z,1/2-X"],"P 21/a -3":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,X,Y","1/2+Z,1/2-X,-Y","1/2-Z,-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,Z,X","-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,-X","1/2-Y,-Z,1/2+X","-X,-Y,-Z","1/2+X,Y,1/2-Z","X,1/2-Y,1/2+Z","1/2-X,1/2+Y,Z","-Z,-X,-Y","1/2-Z,1/2+X,Y","1/2+Z,X,1/2-Y","Z,1/2-X,1/2+Y","-Y,-Z,-X","Y,1/2-Z,1/2+X","1/2-Y,1/2+Z,X","1/2+Y,Z,1/2-X"],"I 21/a -3":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,X,Y","1/2+Z,1/2-X,-Y","1/2-Z,-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,Z,X","-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,-X","1/2-Y,-Z,1/2+X","-X,-Y,-Z","1/2+X,Y,1/2-Z","X,1/2-Y,1/2+Z","1/2-X,1/2+Y,Z","-Z,-X,-Y","1/2-Z,1/2+X,Y","1/2+Z,X,1/2-Y","Z,1/2-X,1/2+Y","-Y,-Z,-X","Y,1/2-Z,1/2+X","1/2-Y,1/2+Z,X","1/2+Y,Z,1/2-X","1/2+X,1/2+Y,1/2+Z","-X,1/2-Y,Z","1/2-X,+Y,-Z","X,-Y,1/2-Z","1/2+Z,1/2+X,1/2+Y","Z,-X,1/2-Y","-Z,1/2-X,Y","1/2-Z,X,-Y","1/2+Y,1/2+Z,1/2+X","1/2-Y,Z,-X","Y,-Z,1/2-X","-Y,1/2-Z,X","1/2-X,1/2-Y,1/2-Z","X,1/2+Y,-Z","1/2+X,-Y,Z","-X,Y,1/2+Z","1/2-Z,1/2-X,1/2-Y","-Z,X,1/2+Y","Z,1/2+X,-Y","1/2+Z,-X,Y","1/2-Y,1/2-Z,1/2-X","1/2+Y,-Z,X","-Y,Z,1/2+X","Y,1/2+Z,-X"],"P 4 3 2":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","Y,X,-Z","-Y,-X,-Z","Y,-X,Z","-Y,X,Z","X,Z,-Y","-X,Z,Y","-X,-Z,-Y","X,-Z,Y","Z,Y,-X","Z,-Y,X","-Z,Y,X","-Z,-Y,-X"],"P 42 3 2":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z","1/2+Y,1/2-X,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+X,1/2+Z,1/2-Y","1/2-X,1/2+Z,1/2+Y","1/2-X,1/2-Z,1/2-Y","1/2+X,1/2-Z,1/2+Y","1/2+Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,1/2+X","1/2-Z,1/2+Y,1/2+X","1/2-Z,1/2-Y,1/2-X"],"F 4 3 2":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","Y,X,-Z","-Y,-X,-Z","Y,-X,Z","-Y,X,Z","X,Z,-Y","-X,Z,Y","-X,-Z,-Y","X,-Z,Y","Z,Y,-X","Z,-Y,X","-Z,Y,X","-Z,-Y,-X","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","Z,1/2+X,1/2+Y","Z,1/2-X,1/2-Y","-Z,1/2-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,1/2+Z,1/2+X","-Y,1/2+Z,1/2-X","Y,1/2-Z,1/2-X","-Y,1/2-Z,1/2+X","Y,1/2+X,1/2-Z","-Y,1/2-X,1/2-Z","Y,1/2-X,1/2+Z","-Y,1/2+X,1/2+Z","X,1/2+Z,1/2-Y","-X,1/2+Z,1/2+Y","-X,1/2-Z,1/2-Y","X,1/2-Z,1/2+Y","Z,1/2+Y,1/2-X","Z,1/2-Y,1/2+X","-Z,1/2+Y,1/2+X","-Z,1/2-Y,1/2-X","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","1/2+Z,X,1/2+Y","1/2+Z,-X,1/2-Y","1/2-Z,-X,1/2+Y","1/2-Z,X,1/2-Y","1/2+Y,Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,-Z,1/2-X","1/2-Y,-Z,1/2+X","1/2+Y,X,1/2-Z","1/2-Y,-X,1/2-Z","1/2+Y,-X,1/2+Z","1/2-Y,X,1/2+Z","1/2+X,Z,1/2-Y","1/2-X,Z,1/2+Y","1/2-X,-Z,1/2-Y","1/2+X,-Z,1/2+Y","1/2+Z,Y,1/2-X","1/2+Z,-Y,1/2+X","1/2-Z,Y,1/2+X","1/2-Z,-Y,1/2-X","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Z,1/2+X,Y","1/2+Z,1/2-X,-Y","1/2-Z,1/2-X,Y","1/2-Z,1/2+X,-Y","1/2+Y,1/2+Z,X","1/2-Y,1/2+Z,-X","1/2+Y,1/2-Z,-X","1/2-Y,1/2-Z,X","1/2+Y,1/2+X,-Z","1/2-Y,1/2-X,-Z","1/2+Y,1/2-X,Z","1/2-Y,1/2+X,Z","1/2+X,1/2+Z,-Y","1/2-X,1/2+Z,Y","1/2-X,1/2-Z,-Y","1/2+X,1/2-Z,Y","1/2+Z,1/2+Y,-X","1/2+Z,1/2-Y,X","1/2-Z,1/2+Y,X","1/2-Z,1/2-Y,-X"],"F 41 3 2":["X,Y,Z","-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,-Z","1/2+X,-Y,1/2-Z","Z,X,Y","1/2+Z,-X,1/2-Y","-Z,1/2-X,1/2+Y","1/2-Z,1/2+X,-Y","Y,Z,X","1/2-Y,1/2+Z,-X","1/2+Y,-Z,1/2-X","-Y,1/2-Z,1/2+X","3/4+Y,1/4+X,3/4-Z","1/4-Y,1/4-X,1/4-Z","1/4+Y,3/4-X,3/4+Z","3/4-Y,3/4+X,1/4+Z","3/4+X,1/4+Z,3/4-Y","3/4-X,3/4+Z,1/4+Y","1/4-X,1/4-Z,1/4-Y","1/4+X,3/4-Z,3/4+Y","3/4+Z,1/4+Y,3/4-X","1/4+Z,3/4-Y,3/4+X","3/4-Z,3/4+Y,1/4+X","1/4-Z,1/4-Y,1/4-X","X,1/2+Y,1/2+Z","-X,-Y,Z","1/2-X,Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,1/2+X,1/2+Y","1/2+Z,1/2-X,-Y","-Z,-X,Y","1/2-Z,X,1/2-Y","Y,1/2+Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,1/2-Z,-X","-Y,-Z,X","3/4+Y,3/4+X,1/4-Z","1/4-Y,3/4-X,3/4-Z","1/4+Y,1/4-X,1/4+Z","3/4-Y,1/4+X,3/4+Z","3/4+X,3/4+Z,1/4-Y","3/4-X,1/4+Z,3/4+Y","1/4-X,3/4-Z,3/4-Y","1/4+X,1/4-Z,1/4+Y","3/4+Z,3/4+Y,1/4-X","1/4+Z,1/4-Y,1/4+X","3/4-Z,1/4+Y,3/4+X","1/4-Z,3/4-Y,3/4-X","1/2+X,Y,1/2+Z","1/2-X,1/2-Y,Z","-X,1/2+Y,1/2-Z","X,-Y,-Z","1/2+Z,X,1/2+Y","Z,-X,-Y","1/2-Z,1/2-X,Y","-Z,1/2+X,1/2-Y","1/2+Y,Z,1/2+X","-Y,1/2+Z,1/2-X","Y,-Z,-X","1/2-Y,1/2-Z,X","1/4+Y,1/4+X,1/4-Z","3/4-Y,1/4-X,3/4-Z","3/4+Y,3/4-X,1/4+Z","1/4-Y,3/4+X,3/4+Z","1/4+X,1/4+Z,1/4-Y","1/4-X,3/4+Z,3/4+Y","3/4-X,1/4-Z,3/4-Y","3/4+X,3/4-Z,1/4+Y","1/4+Z,1/4+Y,1/4-X","3/4+Z,3/4-Y,1/4+X","1/4-Z,3/4+Y,3/4+X","3/4-Z,1/4-Y,3/4-X","1/2+X,1/2+Y,Z","1/2-X,-Y,1/2+Z","-X,Y,-Z","X,1/2-Y,1/2-Z","1/2+Z,1/2+X,Y","Z,1/2-X,1/2-Y","1/2-Z,-X,1/2+Y","-Z,X,-Y","1/2+Y,1/2+Z,X","-Y,Z,-X","Y,1/2-Z,1/2-X","1/2-Y,-Z,1/2+X","1/4+Y,3/4+X,3/4-Z","3/4-Y,3/4-X,1/4-Z","3/4+Y,1/4-X,3/4+Z","1/4-Y,1/4+X,1/4+Z","1/4+X,3/4+Z,3/4-Y","1/4-X,1/4+Z,1/4+Y","3/4-X,3/4-Z,1/4-Y","3/4+X,1/4-Z,3/4+Y","1/4+Z,3/4+Y,3/4-X","3/4+Z,1/4-Y,3/4+X","1/4-Z,1/4+Y,1/4+X","3/4-Z,3/4-Y,1/4-X"],"I 4 3 2":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","Y,X,-Z","-Y,-X,-Z","Y,-X,Z","-Y,X,Z","X,Z,-Y","-X,Z,Y","-X,-Z,-Y","X,-Z,Y","Z,Y,-X","Z,-Y,X","-Z,Y,X","-Z,-Y,-X","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2+Z,1/2+X,1/2+Y","1/2+Z,1/2-X,1/2-Y","1/2-Z,1/2-X,1/2+Y","1/2-Z,1/2+X,1/2-Y","1/2+Y,1/2+Z,1/2+X","1/2-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,1/2-X","1/2-Y,1/2-Z,1/2+X","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z","1/2+Y,1/2-X,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+X,1/2+Z,1/2-Y","1/2-X,1/2+Z,1/2+Y","1/2-X,1/2-Z,1/2-Y","1/2+X,1/2-Z,1/2+Y","1/2+Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,1/2+X","1/2-Z,1/2+Y,1/2+X","1/2-Z,1/2-Y,1/2-X"],"P 43 3 2":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,X,Y","1/2+Z,1/2-X,-Y","1/2-Z,-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,Z,X","-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,-X","1/2-Y,-Z,1/2+X","1/4+Y,3/4+X,3/4-Z","1/4-Y,1/4-X,1/4-Z","3/4+Y,3/4-X,1/4+Z","3/4-Y,1/4+X,3/4+Z","1/4+X,3/4+Z,3/4-Y","3/4-X,1/4+Z,3/4+Y","1/4-X,1/4-Z,1/4-Y","3/4+X,3/4-Z,1/4+Y","1/4+Z,3/4+Y,3/4-X","3/4+Z,3/4-Y,1/4+X","3/4-Z,1/4+Y,3/4+X","1/4-Z,1/4-Y,1/4-X"],"P 41 3 2":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,X,Y","1/2+Z,1/2-X,-Y","1/2-Z,-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,Z,X","-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,-X","1/2-Y,-Z,1/2+X","3/4+Y,1/4+X,1/4-Z","3/4-Y,3/4-X,3/4-Z","1/4+Y,1/4-X,3/4+Z","1/4-Y,3/4+X,1/4+Z","3/4+X,1/4+Z,1/4-Y","1/4-X,3/4+Z,1/4+Y","3/4-X,3/4-Z,3/4-Y","1/4+X,1/4-Z,3/4+Y","3/4+Z,1/4+Y,1/4-X","1/4+Z,1/4-Y,3/4+X","1/4-Z,3/4+Y,1/4+X","3/4-Z,3/4-Y,3/4-X"],"I 41 3 2":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,X,Y","1/2+Z,1/2-X,-Y","1/2-Z,-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,Z,X","-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,-X","1/2-Y,-Z,1/2+X","3/4+Y,1/4+X,1/4-Z","3/4-Y,3/4-X,3/4-Z","1/4+Y,1/4-X,3/4+Z","1/4-Y,3/4+X,1/4+Z","3/4+X,1/4+Z,1/4-Y","1/4-X,3/4+Z,1/4+Y","3/4-X,3/4-Z,3/4-Y","1/4+X,1/4-Z,3/4+Y","3/4+Z,1/4+Y,1/4-X","1/4+Z,1/4-Y,3/4+X","1/4-Z,3/4+Y,1/4+X","3/4-Z,3/4-Y,3/4-X","1/2+X,1/2+Y,1/2+Z","-X,1/2-Y,Z","1/2-X,Y,-Z","X,-Y,1/2-Z","1/2+Z,1/2+X,1/2+Y","Z,-X,1/2-Y","-Z,1/2-X,Y","1/2-Z,X,-Y","1/2+Y,1/2+Z,1/2+X","1/2-Y,Z,-X","Y,-Z,1/2-X","-Y,1/2-Z,X","1/4+Y,3/4+X,3/4-Z","1/4-Y,1/4-X,1/4-Z","3/4+Y,3/4-X,1/4+Z","3/4-Y,1/4+X,3/4+Z","1/4+X,3/4+Z,3/4-Y","3/4-X,1/4+Z,3/4+Y","1/4-X,1/4-Z,1/4-Y","3/4+X,3/4-Z,1/4+Y","1/4+Z,3/4+Y,3/4-X","3/4+Z,3/4-Y,1/4+X","3/4-Z,1/4+Y,3/4+X","1/4-Z,1/4-Y,1/4-X"],"P -4 3 m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","Y,X,Z","-Y,-X,Z","Y,-X,-Z","-Y,X,-Z","X,Z,Y","-X,Z,-Y","-X,-Z,Y","X,-Z,-Y","Z,Y,X","Z,-Y,-X","-Z,Y,-X","-Z,-Y,X"],"F -4 3 m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","Y,X,Z","-Y,-X,Z","Y,-X,-Z","-Y,X,-Z","X,Z,Y","-X,Z,-Y","-X,-Z,Y","X,-Z,-Y","Z,Y,X","Z,-Y,-X","-Z,Y,-X","-Z,-Y,X","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","Z,1/2+X,1/2+Y","Z,1/2-X,1/2-Y","-Z,1/2-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,1/2+Z,1/2+X","-Y,1/2+Z,1/2-X","Y,1/2-Z,1/2-X","-Y,1/2-Z,1/2+X","Y,1/2+X,1/2+Z","-Y,1/2-X,1/2+Z","Y,1/2-X,1/2-Z","-Y,1/2+X,1/2-Z","X,1/2+Z,1/2+Y","-X,1/2+Z,1/2-Y","-X,1/2-Z,1/2+Y","X,1/2-Z,1/2-Y","Z,1/2+Y,1/2+X","Z,1/2-Y,1/2-X","-Z,1/2+Y,1/2-X","-Z,1/2-Y,1/2+X","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","1/2+Z,X,1/2+Y","1/2+Z,-X,1/2-Y","1/2-Z,-X,1/2+Y","1/2-Z,X,1/2-Y","1/2+Y,Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,-Z,1/2-X","1/2-Y,-Z,1/2+X","1/2+Y,X,1/2+Z","1/2-Y,-X,1/2+Z","1/2+Y,-X,1/2-Z","1/2-Y,X,1/2-Z","1/2+X,Z,1/2+Y","1/2-X,Z,1/2-Y","1/2-X,-Z,1/2+Y","1/2+X,-Z,1/2-Y","1/2+Z,Y,1/2+X","1/2+Z,-Y,1/2-X","1/2-Z,Y,1/2-X","1/2-Z,-Y,1/2+X","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Z,1/2+X,Y","1/2+Z,1/2-X,-Y","1/2-Z,1/2-X,Y","1/2-Z,1/2+X,-Y","1/2+Y,1/2+Z,X","1/2-Y,1/2+Z,-X","1/2+Y,1/2-Z,-X","1/2-Y,1/2-Z,X","1/2+Y,1/2+X,Z","1/2-Y,1/2-X,Z","1/2+Y,1/2-X,-Z","1/2-Y,1/2+X,-Z","1/2+X,1/2+Z,Y","1/2-X,1/2+Z,-Y","1/2-X,1/2-Z,Y","1/2+X,1/2-Z,-Y","1/2+Z,1/2+Y,X","1/2+Z,1/2-Y,-X","1/2-Z,1/2+Y,-X","1/2-Z,1/2-Y,X"],"I -4 3 m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","Y,X,Z","-Y,-X,Z","Y,-X,-Z","-Y,X,-Z","X,Z,Y","-X,Z,-Y","-X,-Z,Y","X,-Z,-Y","Z,Y,X","Z,-Y,-X","-Z,Y,-X","-Z,-Y,X","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2+Z,1/2+X,1/2+Y","1/2+Z,1/2-X,1/2-Y","1/2-Z,1/2-X,1/2+Y","1/2-Z,1/2+X,1/2-Y","1/2+Y,1/2+Z,1/2+X","1/2-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,1/2-X","1/2-Y,1/2-Z,1/2+X","1/2+Y,1/2+X,1/2+Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2-X,1/2-Z","1/2-Y,1/2+X,1/2-Z","1/2+X,1/2+Z,1/2+Y","1/2-X,1/2+Z,1/2-Y","1/2-X,1/2-Z,1/2+Y","1/2+X,1/2-Z,1/2-Y","1/2+Z,1/2+Y,1/2+X","1/2+Z,1/2-Y,1/2-X","1/2-Z,1/2+Y,1/2-X","1/2-Z,1/2-Y,1/2+X"],"P -4 3 n":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","1/2+Y,1/2+X,1/2+Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2-X,1/2-Z","1/2-Y,1/2+X,1/2-Z","1/2+X,1/2+Z,1/2+Y","1/2-X,1/2+Z,1/2-Y","1/2-X,1/2-Z,1/2+Y","1/2+X,1/2-Z,1/2-Y","1/2+Z,1/2+Y,1/2+X","1/2+Z,1/2-Y,1/2-X","1/2-Z,1/2+Y,1/2-X","1/2-Z,1/2-Y,1/2+X"],"F -4 3 c":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","1/2+Y,1/2+X,1/2+Z","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2-X,1/2-Z","1/2-Y,1/2+X,1/2-Z","1/2+X,1/2+Z,1/2+Y","1/2-X,1/2+Z,1/2-Y","1/2-X,1/2-Z,1/2+Y","1/2+X,1/2-Z,1/2-Y","1/2+Z,1/2+Y,1/2+X","1/2+Z,1/2-Y,1/2-X","1/2-Z,1/2+Y,1/2-X","1/2-Z,1/2-Y,1/2+X","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","Z,1/2+X,1/2+Y","Z,1/2-X,1/2-Y","-Z,1/2-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,1/2+Z,1/2+X","-Y,1/2+Z,1/2-X","Y,1/2-Z,1/2-X","-Y,1/2-Z,1/2+X","1/2+Y,X,Z","1/2-Y,-X,Z","1/2+Y,-X,-Z","1/2-Y,X,-Z","1/2+X,Z,Y","1/2-X,Z,-Y","1/2-X,-Z,Y","1/2+X,-Z,-Y","1/2+Z,Y,X","1/2+Z,-Y,-X","1/2-Z,Y,-X","1/2-Z,-Y,X","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","1/2+Z,X,1/2+Y","1/2+Z,-X,1/2-Y","1/2-Z,-X,1/2+Y","1/2-Z,X,1/2-Y","1/2+Y,Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,-Z,1/2-X","1/2-Y,-Z,1/2+X","Y,1/2+X,Z","-Y,1/2-X,Z","Y,1/2-X,-Z","-Y,1/2+X,-Z","X,1/2+Z,Y","-X,1/2+Z,-Y","-X,1/2-Z,Y","X,1/2-Z,-Y","Z,1/2+Y,X","Z,1/2-Y,-X","-Z,1/2+Y,-X","-Z,1/2-Y,X","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Z,1/2+X,Y","1/2+Z,1/2-X,-Y","1/2-Z,1/2-X,Y","1/2-Z,1/2+X,-Y","1/2+Y,1/2+Z,X","1/2-Y,1/2+Z,-X","1/2+Y,1/2-Z,-X","1/2-Y,1/2-Z,X","Y,X,1/2+Z","-Y,-X,1/2+Z","Y,-X,1/2-Z","-Y,X,1/2-Z","X,Z,1/2+Y","-X,Z,1/2-Y","-X,-Z,1/2+Y","X,-Z,1/2-Y","Z,Y,1/2+X","Z,-Y,1/2-X","-Z,Y,1/2-X","-Z,-Y,1/2+X"],
"I -4 3 d":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,X,Y","1/2+Z,1/2-X,-Y","1/2-Z,-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,Z,X","-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,-X","1/2-Y,-Z,1/2+X","1/4+Y,1/4+X,1/4+Z","1/4-Y,3/4-X,3/4+Z","3/4+Y,1/4-X,3/4-Z","3/4-Y,3/4+X,1/4-Z","1/4+X,1/4+Z,1/4+Y","3/4-X,3/4+Z,1/4-Y","1/4-X,3/4-Z,3/4+Y","3/4+X,1/4-Z,3/4-Y","1/4+Z,1/4+Y,1/4+X","3/4+Z,1/4-Y,3/4-X","3/4-Z,3/4+Y,1/4-X","1/4-Z,3/4-Y,3/4+X","1/2+X,1/2+Y,1/2+Z","-X,1/2-Y,Z","1/2-X,Y,-Z","X,-Y,1/2-Z","1/2+Z,1/2+X,1/2+Y","Z,-X,1/2-Y","-Z,1/2-X,Y","1/2-Z,X,-Y","1/2+Y,1/2+Z,1/2+X","1/2-Y,Z,-X","Y,-Z,1/2-X","-Y,1/2-Z,X","3/4+Y,3/4+X,3/4+Z","3/4-Y,1/4-X,1/4+Z","1/4+Y,3/4-X,1/4-Z","1/4-Y,1/4+X,3/4-Z","3/4+X,3/4+Z,3/4+Y","1/4-X,1/4+Z,3/4-Y","3/4-X,1/4-Z,1/4+Y","1/4+X,3/4-Z,1/4-Y","3/4+Z,3/4+Y,3/4+X","1/4+Z,3/4-Y,1/4-X","1/4-Z,1/4+Y,3/4-X","3/4-Z,1/4-Y,1/4+X"],"P 4/m -3 2/m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","Y,X,-Z","-Y,-X,-Z","Y,-X,Z","-Y,X,Z","X,Z,-Y","-X,Z,Y","-X,-Z,-Y","X,-Z,Y","Z,Y,-X","Z,-Y,X","-Z,Y,X","-Z,-Y,-X","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","-Z,-X,-Y","-Z,X,Y","Z,X,-Y","Z,-X,Y","-Y,-Z,-X","Y,-Z,X","-Y,Z,X","Y,Z,-X","-Y,-X,Z","Y,X,Z","-Y,X,-Z","Y,-X,-Z","-X,-Z,Y","X,-Z,-Y","X,Z,Y","-X,Z,-Y","-Z,-Y,X","-Z,Y,-X","Z,-Y,-X","Z,Y,X"],"P 4/n -3 2/n":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","Y,X,-Z","-Y,-X,-Z","Y,-X,Z","-Y,X,Z","X,Z,-Y","-X,Z,Y","-X,-Z,-Y","X,-Z,Y","Z,Y,-X","Z,-Y,X","-Z,Y,X","-Z,-Y,-X","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2-Z,1/2-X,1/2-Y","1/2-Z,1/2+X,1/2+Y","1/2+Z,1/2+X,1/2-Y","1/2+Z,1/2-X,1/2+Y","1/2-Y,1/2-Z,1/2-X","1/2+Y,1/2-Z,1/2+X","1/2-Y,1/2+Z,1/2+X","1/2+Y,1/2+Z,1/2-X","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z","1/2-Y,1/2+X,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2-X,1/2-Z,1/2+Y","1/2+X,1/2-Z,1/2-Y","1/2+X,1/2+Z,1/2+Y","1/2-X,1/2+Z,1/2-Y","1/2-Z,1/2-Y,1/2+X","1/2-Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,1/2-X","1/2+Z,1/2+Y,1/2+X"],"P 42/m -3 2/n":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z","1/2+Y,1/2-X,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+X,1/2+Z,1/2-Y","1/2-X,1/2+Z,1/2+Y","1/2-X,1/2-Z,1/2-Y","1/2+X,1/2-Z,1/2+Y","1/2+Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,1/2+X","1/2-Z,1/2+Y,1/2+X","1/2-Z,1/2-Y,1/2-X","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","-Z,-X,-Y","-Z,X,Y","Z,X,-Y","Z,-X,Y","-Y,-Z,-X","Y,-Z,X","-Y,Z,X","Y,Z,-X","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z","1/2-Y,1/2+X,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2-X,1/2-Z,1/2+Y","1/2+X,1/2-Z,1/2-Y","1/2+X,1/2+Z,1/2+Y","1/2-X,1/2+Z,1/2-Y","1/2-Z,1/2-Y,1/2+X","1/2-Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,1/2-X","1/2+Z,1/2+Y,1/2+X"],"P 42/n -3 2/m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z","1/2+Y,1/2-X,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+X,1/2+Z,1/2-Y","1/2-X,1/2+Z,1/2+Y","1/2-X,1/2-Z,1/2-Y","1/2+X,1/2-Z,1/2+Y","1/2+Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,1/2+X","1/2-Z,1/2+Y,1/2+X","1/2-Z,1/2-Y,1/2-X","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2-Z,1/2-X,1/2-Y","1/2-Z,1/2+X,1/2+Y","1/2+Z,1/2+X,1/2-Y","1/2+Z,1/2-X,1/2+Y","1/2-Y,1/2-Z,1/2-X","1/2+Y,1/2-Z,1/2+X","1/2-Y,1/2+Z,1/2+X","1/2+Y,1/2+Z,1/2-X","-Y,-X,Z","Y,X,Z","-Y,X,-Z","Y,-X,-Z","-X,-Z,Y","X,-Z,-Y","X,Z,Y","-X,Z,-Y","-Z,-Y,X","-Z,Y,-X","Z,-Y,-X","Z,Y,X"],"F 4/m -3 2/m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","Y,X,-Z","-Y,-X,-Z","Y,-X,Z","-Y,X,Z","X,Z,-Y","-X,Z,Y","-X,-Z,-Y","X,-Z,Y","Z,Y,-X","Z,-Y,X","-Z,Y,X","-Z,-Y,-X","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","-Z,-X,-Y","-Z,X,Y","Z,X,-Y","Z,-X,Y","-Y,-Z,-X","Y,-Z,X","-Y,Z,X","Y,Z,-X","-Y,-X,Z","Y,X,Z","-Y,X,-Z","Y,-X,-Z","-X,-Z,Y","X,-Z,-Y","X,Z,Y","-X,Z,-Y","-Z,-Y,X","-Z,Y,-X","Z,-Y,-X","Z,Y,X","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","Z,1/2+X,1/2+Y","Z,1/2-X,1/2-Y","-Z,1/2-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,1/2+Z,1/2+X","-Y,1/2+Z,1/2-X","Y,1/2-Z,1/2-X","-Y,1/2-Z,1/2+X","Y,1/2+X,1/2-Z","-Y,1/2-X,1/2-Z","Y,1/2-X,1/2+Z","-Y,1/2+X,1/2+Z","X,1/2+Z,1/2-Y","-X,1/2+Z,1/2+Y","-X,1/2-Z,1/2-Y","X,1/2-Z,1/2+Y","Z,1/2+Y,1/2-X","Z,1/2-Y,1/2+X","-Z,1/2+Y,1/2+X","-Z,1/2-Y,1/2-X","-X,1/2-Y,1/2-Z","X,1/2+Y,1/2-Z","X,1/2-Y,1/2+Z","-X,1/2+Y,1/2+Z","-Z,1/2-X,1/2-Y","-Z,1/2+X,1/2+Y","Z,1/2+X,1/2-Y","Z,1/2-X,1/2+Y","-Y,1/2-Z,1/2-X","Y,1/2-Z,1/2+X","-Y,1/2+Z,1/2+X","Y,1/2+Z,1/2-X","-Y,1/2-X,1/2+Z","Y,1/2+X,1/2+Z","-Y,1/2+X,1/2-Z","Y,1/2-X,1/2-Z","-X,1/2-Z,1/2+Y","X,1/2-Z,1/2-Y","X,1/2+Z,1/2+Y","-X,1/2+Z,1/2-Y","-Z,1/2-Y,1/2+X","-Z,1/2+Y,1/2-X","Z,1/2-Y,1/2-X","Z,1/2+Y,1/2+X","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","1/2+Z,X,1/2+Y","1/2+Z,-X,1/2-Y","1/2-Z,-X,1/2+Y","1/2-Z,X,1/2-Y","1/2+Y,Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,-Z,1/2-X","1/2-Y,-Z,1/2+X","1/2+Y,X,1/2-Z","1/2-Y,-X,1/2-Z","1/2+Y,-X,1/2+Z","1/2-Y,X,1/2+Z","1/2+X,Z,1/2-Y","1/2-X,Z,1/2+Y","1/2-X,-Z,1/2-Y","1/2+X,-Z,1/2+Y","1/2+Z,Y,1/2-X","1/2+Z,-Y,1/2+X","1/2-Z,Y,1/2+X","1/2-Z,-Y,1/2-X","1/2-X,-Y,1/2-Z","1/2+X,Y,1/2-Z","1/2+X,-Y,1/2+Z","1/2-X,Y,1/2+Z","1/2-Z,-X,1/2-Y","1/2-Z,X,1/2+Y","1/2+Z,X,1/2-Y","1/2+Z,-X,1/2+Y","1/2-Y,-Z,1/2-X","1/2+Y,-Z,1/2+X","1/2-Y,Z,1/2+X","1/2+Y,Z,1/2-X","1/2-Y,-X,1/2+Z","1/2+Y,X,1/2+Z","1/2-Y,X,1/2-Z","1/2+Y,-X,1/2-Z","1/2-X,-Z,1/2+Y","1/2+X,-Z,1/2-Y","1/2+X,Z,1/2+Y","1/2-X,Z,1/2-Y","1/2-Z,-Y,1/2+X","1/2-Z,Y,1/2-X","1/2+Z,-Y,1/2-X","1/2+Z,Y,1/2+X","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Z,1/2+X,Y","1/2+Z,1/2-X,-Y","1/2-Z,1/2-X,Y","1/2-Z,1/2+X,-Y","1/2+Y,1/2+Z,X","1/2-Y,1/2+Z,-X","1/2+Y,1/2-Z,-X","1/2-Y,1/2-Z,X","1/2+Y,1/2+X,-Z","1/2-Y,1/2-X,-Z","1/2+Y,1/2-X,Z","1/2-Y,1/2+X,Z","1/2+X,1/2+Z,-Y","1/2-X,1/2+Z,Y","1/2-X,1/2-Z,-Y","1/2+X,1/2-Z,Y","1/2+Z,1/2+Y,-X","1/2+Z,1/2-Y,X","1/2-Z,1/2+Y,X","1/2-Z,1/2-Y,-X","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2-Z,1/2-X,-Y","1/2-Z,1/2+X,Y","1/2+Z,1/2+X,-Y","1/2+Z,1/2-X,Y","1/2-Y,1/2-Z,-X","1/2+Y,1/2-Z,X","1/2-Y,1/2+Z,X","1/2+Y,1/2+Z,-X","1/2-Y,1/2-X,Z","1/2+Y,1/2+X,Z","1/2-Y,1/2+X,-Z","1/2+Y,1/2-X,-Z","1/2-X,1/2-Z,Y","1/2+X,1/2-Z,-Y","1/2+X,1/2+Z,Y","1/2-X,1/2+Z,-Y","1/2-Z,1/2-Y,X","1/2-Z,1/2+Y,-X","1/2+Z,1/2-Y,-X","1/2+Z,1/2+Y,X"],"F 4/m -3 2/c":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z","1/2+Y,1/2-X,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+X,1/2+Z,1/2-Y","1/2-X,1/2+Z,1/2+Y","1/2-X,1/2-Z,1/2-Y","1/2+X,1/2-Z,1/2+Y","1/2+Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,1/2+X","1/2-Z,1/2+Y,1/2+X","1/2-Z,1/2-Y,1/2-X","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","-Z,-X,-Y","-Z,X,Y","Z,X,-Y","Z,-X,Y","-Y,-Z,-X","Y,-Z,X","-Y,Z,X","Y,Z,-X","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z","1/2-Y,1/2+X,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2-X,1/2-Z,1/2+Y","1/2+X,1/2-Z,1/2-Y","1/2+X,1/2+Z,1/2+Y","1/2-X,1/2+Z,1/2-Y","1/2-Z,1/2-Y,1/2+X","1/2-Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,1/2-X","1/2+Z,1/2+Y,1/2+X","X,1/2+Y,1/2+Z","-X,1/2-Y,1/2+Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2-Z","Z,1/2+X,1/2+Y","Z,1/2-X,1/2-Y","-Z,1/2-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,1/2+Z,1/2+X","-Y,1/2+Z,1/2-X","Y,1/2-Z,1/2-X","-Y,1/2-Z,1/2+X","1/2+Y,X,-Z","1/2-Y,-X,-Z","1/2+Y,-X,Z","1/2-Y,X,Z","1/2+X,Z,-Y","1/2-X,Z,Y","1/2-X,-Z,-Y","1/2+X,-Z,Y","1/2+Z,Y,-X","1/2+Z,-Y,X","1/2-Z,Y,X","1/2-Z,-Y,-X","-X,1/2-Y,1/2-Z","X,1/2+Y,1/2-Z","X,1/2-Y,1/2+Z","-X,1/2+Y,1/2+Z","-Z,1/2-X,1/2-Y","-Z,1/2+X,1/2+Y","Z,1/2+X,1/2-Y","Z,1/2-X,1/2+Y","-Y,1/2-Z,1/2-X","Y,1/2-Z,1/2+X","-Y,1/2+Z,1/2+X","Y,1/2+Z,1/2-X","1/2-Y,-X,Z","1/2+Y,X,Z","1/2-Y,X,-Z","1/2+Y,-X,-Z","1/2-X,-Z,Y","1/2+X,-Z,-Y","1/2+X,Z,Y","1/2-X,Z,-Y","1/2-Z,-Y,X","1/2-Z,Y,-X","1/2+Z,-Y,-X","1/2+Z,Y,X","1/2+X,Y,1/2+Z","1/2-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","1/2+X,-Y,1/2-Z","1/2+Z,X,1/2+Y","1/2+Z,-X,1/2-Y","1/2-Z,-X,1/2+Y","1/2-Z,X,1/2-Y","1/2+Y,Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,-Z,1/2-X","1/2-Y,-Z,1/2+X","Y,1/2+X,-Z","-Y,1/2-X,-Z","Y,1/2-X,Z","-Y,1/2+X,Z","X,1/2+Z,-Y","-X,1/2+Z,Y","-X,1/2-Z,-Y","X,1/2-Z,Y","Z,1/2+Y,-X","Z,1/2-Y,X","-Z,1/2+Y,X","-Z,1/2-Y,-X","1/2-X,-Y,1/2-Z","1/2+X,Y,1/2-Z","1/2+X,-Y,1/2+Z","1/2-X,Y,1/2+Z","1/2-Z,-X,1/2-Y","1/2-Z,X,1/2+Y","1/2+Z,X,1/2-Y","1/2+Z,-X,1/2+Y","1/2-Y,-Z,1/2-X","1/2+Y,-Z,1/2+X","1/2-Y,Z,1/2+X","1/2+Y,Z,1/2-X","-Y,1/2-X,Z","Y,1/2+X,Z","-Y,1/2+X,-Z","Y,1/2-X,-Z","-X,1/2-Z,Y","X,1/2-Z,-Y","X,1/2+Z,Y","-X,1/2+Z,-Y","-Z,1/2-Y,X","-Z,1/2+Y,-X","Z,1/2-Y,-X","Z,1/2+Y,X","1/2+X,1/2+Y,Z","1/2-X,1/2-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z","1/2+Z,1/2+X,Y","1/2+Z,1/2-X,-Y","1/2-Z,1/2-X,Y","1/2-Z,1/2+X,-Y","1/2+Y,1/2+Z,X","1/2-Y,1/2+Z,-X","1/2+Y,1/2-Z,-X","1/2-Y,1/2-Z,X","Y,X,1/2-Z","-Y,-X,1/2-Z","Y,-X,1/2+Z","-Y,X,1/2+Z","X,Z,1/2-Y","-X,Z,1/2+Y","-X,-Z,1/2-Y","X,-Z,1/2+Y","Z,Y,1/2-X","Z,-Y,1/2+X","-Z,Y,1/2+X","-Z,-Y,1/2-X","1/2-X,1/2-Y,-Z","1/2+X,1/2+Y,-Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z","1/2-Z,1/2-X,-Y","1/2-Z,1/2+X,Y","1/2+Z,1/2+X,-Y","1/2+Z,1/2-X,Y","1/2-Y,1/2-Z,-X","1/2+Y,1/2-Z,X","1/2-Y,1/2+Z,X","1/2+Y,1/2+Z,-X","-Y,-X,1/2+Z","Y,X,1/2+Z","-Y,X,1/2-Z","Y,-X,1/2-Z","-X,-Z,1/2+Y","X,-Z,1/2-Y","X,Z,1/2+Y","-X,Z,1/2-Y","-Z,-Y,1/2+X","-Z,Y,1/2-X","Z,-Y,1/2-X","Z,Y,1/2+X"],"F 41/d -3 2/m":["X,Y,Z","-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,-Z","1/2+X,-Y,1/2-Z","Z,X,Y","1/2+Z,-X,1/2-Y","-Z,1/2-X,1/2+Y","1/2-Z,1/2+X,-Y","Y,Z,X","1/2-Y,1/2+Z,-X","1/2+Y,-Z,1/2-X","-Y,1/2-Z,1/2+X","3/4+Y,1/4+X,3/4-Z","1/4-Y,1/4-X,1/4-Z","1/4+Y,3/4-X,3/4+Z","3/4-Y,3/4+X,1/4+Z","3/4+X,1/4+Z,3/4-Y","3/4-X,3/4+Z,1/4+Y","1/4-X,1/4-Z,1/4-Y","1/4+X,3/4-Z,3/4+Y","3/4+Z,1/4+Y,3/4-X","1/4+Z,3/4-Y,3/4+X","3/4-Z,3/4+Y,1/4+X","1/4-Z,1/4-Y,1/4-X","1/4-X,1/4-Y,1/4-Z","1/4+X,3/4+Y,3/4-Z","3/4+X,3/4-Y,1/4+Z","3/4-X,1/4+Y,3/4+Z","1/4-Z,1/4-X,1/4-Y","3/4-Z,1/4+X,3/4+Y","1/4+Z,3/4+X,3/4-Y","3/4+Z,3/4-X,1/4+Y","1/4-Y,1/4-Z,1/4-X","3/4+Y,3/4-Z,1/4+X","3/4-Y,1/4+Z,3/4+X","1/4+Y,3/4+Z,3/4-X","1/2-Y,-X,1/2+Z","Y,X,Z","-Y,1/2+X,1/2-Z","1/2+Y,1/2-X,-Z","1/2-X,-Z,1/2+Y","1/2+X,1/2-Z,-Y","X,Z,Y","-X,1/2+Z,1/2-Y","1/2-Z,-Y,1/2+X","-Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,-X","Z,Y,X","X,1/2+Y,1/2+Z","-X,-Y,Z","1/2-X,Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,1/2+X,1/2+Y","1/2+Z,1/2-X,-Y","-Z,-X,Y","1/2-Z,X,1/2-Y","Y,1/2+Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,1/2-Z,-X","-Y,-Z,X","3/4+Y,3/4+X,1/4-Z","1/4-Y,3/4-X,3/4-Z","1/4+Y,1/4-X,1/4+Z","3/4-Y,1/4+X,3/4+Z","3/4+X,3/4+Z,1/4-Y","3/4-X,1/4+Z,3/4+Y","1/4-X,3/4-Z,3/4-Y","1/4+X,1/4-Z,1/4+Y","3/4+Z,3/4+Y,1/4-X","1/4+Z,1/4-Y,1/4+X","3/4-Z,1/4+Y,3/4+X","1/4-Z,3/4-Y,3/4-X","1/4-X,3/4-Y,3/4-Z","1/4+X,1/4+Y,1/4-Z","3/4+X,1/4-Y,3/4+Z","3/4-X,3/4+Y,1/4+Z","1/4-Z,3/4-X,3/4-Y","3/4-Z,3/4+X,1/4+Y","1/4+Z,1/4+X,1/4-Y","3/4+Z,1/4-X,3/4+Y","1/4-Y,3/4-Z,3/4-X","3/4+Y,1/4-Z,3/4+X","3/4-Y,3/4+Z,1/4+X","1/4+Y,1/4+Z,1/4-X","1/2-Y,1/2-X,Z","Y,1/2+X,1/2+Z","-Y,X,-Z","1/2+Y,-X,1/2-Z","1/2-X,1/2-Z,Y","1/2+X,-Z,1/2-Y","X,1/2+Z,1/2+Y","-X,Z,-Y","1/2-Z,1/2-Y,X","-Z,Y,-X","1/2+Z,-Y,1/2-X","Z,1/2+Y,1/2+X","1/2+X,Y,1/2+Z","1/2-X,1/2-Y,Z","-X,1/2+Y,1/2-Z","X,-Y,-Z","1/2+Z,X,1/2+Y","Z,-X,-Y","1/2-Z,1/2-X,Y","-Z,1/2+X,1/2-Y","1/2+Y,Z,1/2+X","-Y,1/2+Z,1/2-X","Y,-Z,-X","1/2-Y,1/2-Z,X","1/4+Y,1/4+X,1/4-Z","3/4-Y,1/4-X,3/4-Z","3/4+Y,3/4-X,1/4+Z","1/4-Y,3/4+X,3/4+Z","1/4+X,1/4+Z,1/4-Y","1/4-X,3/4+Z,3/4+Y","3/4-X,1/4-Z,3/4-Y","3/4+X,3/4-Z,1/4+Y","1/4+Z,1/4+Y,1/4-X","3/4+Z,3/4-Y,1/4+X","1/4-Z,3/4+Y,3/4+X","3/4-Z,1/4-Y,3/4-X","3/4-X,1/4-Y,3/4-Z","3/4+X,3/4+Y,1/4-Z","1/4+X,3/4-Y,3/4+Z","1/4-X,1/4+Y,1/4+Z","3/4-Z,1/4-X,3/4-Y","1/4-Z,1/4+X,1/4+Y","3/4+Z,3/4+X,1/4-Y","1/4+Z,3/4-X,3/4+Y","3/4-Y,1/4-Z,3/4-X","1/4+Y,3/4-Z,3/4+X","1/4-Y,1/4+Z,1/4+X","3/4+Y,3/4+Z,1/4-X","-Y,-X,Z","1/2+Y,X,1/2+Z","1/2-Y,1/2+X,-Z","Y,1/2-X,1/2-Z","-X,-Z,Y","X,1/2-Z,1/2-Y","1/2+X,Z,1/2+Y","1/2-X,1/2+Z,-Y","-Z,-Y,X","1/2-Z,1/2+Y,-X","Z,1/2-Y,1/2-X","1/2+Z,Y,1/2+X","1/2+X,1/2+Y,Z","1/2-X,-Y,1/2+Z","-X,Y,-Z","X,1/2-Y,1/2-Z","1/2+Z,1/2+X,Y","Z,1/2-X,1/2-Y","1/2-Z,-X,1/2+Y","-Z,X,-Y","1/2+Y,1/2+Z,X","-Y,Z,-X","Y,1/2-Z,1/2-X","1/2-Y,-Z,1/2+X","1/4+Y,3/4+X,3/4-Z","3/4-Y,3/4-X,1/4-Z","3/4+Y,1/4-X,3/4+Z","1/4-Y,1/4+X,1/4+Z","1/4+X,3/4+Z,3/4-Y","1/4-X,1/4+Z,1/4+Y","3/4-X,3/4-Z,1/4-Y","3/4+X,1/4-Z,3/4+Y","1/4+Z,3/4+Y,3/4-X","3/4+Z,1/4-Y,3/4+X","1/4-Z,1/4+Y,1/4+X","3/4-Z,3/4-Y,1/4-X","3/4-X,3/4-Y,1/4-Z","3/4+X,1/4+Y,3/4-Z","1/4+X,1/4-Y,1/4+Z","1/4-X,3/4+Y,3/4+Z","3/4-Z,3/4-X,1/4-Y","1/4-Z,3/4+X,3/4+Y","3/4+Z,1/4+X,3/4-Y","1/4+Z,1/4-X,1/4+Y","3/4-Y,3/4-Z,1/4-X","1/4+Y,1/4-Z,1/4+X","1/4-Y,3/4+Z,3/4+X","3/4+Y,1/4+Z,3/4-X","-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,Z","1/2-Y,X,1/2-Z","Y,-X,-Z","-X,1/2-Z,1/2+Y","X,-Z,-Y","1/2+X,1/2+Z,Y","1/2-X,Z,1/2-Y","-Z,1/2-Y,1/2+X","1/2-Z,Y,1/2-X","Z,-Y,-X","1/2+Z,1/2+Y,X"],"F 41/d -3 2/c":["X,Y,Z","-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,-Z","1/2+X,-Y,1/2-Z","Z,X,Y","1/2+Z,-X,1/2-Y","-Z,1/2-X,1/2+Y","1/2-Z,1/2+X,-Y","Y,Z,X","1/2-Y,1/2+Z,-X","1/2+Y,-Z,1/2-X","-Y,1/2-Z,1/2+X","3/4+Y,1/4+X,3/4-Z","1/4-Y,1/4-X,1/4-Z","1/4+Y,3/4-X,3/4+Z","3/4-Y,3/4+X,1/4+Z","3/4+X,1/4+Z,3/4-Y","3/4-X,3/4+Z,1/4+Y","1/4-X,1/4-Z,1/4-Y","1/4+X,3/4-Z,3/4+Y","3/4+Z,1/4+Y,3/4-X","1/4+Z,3/4-Y,3/4+X","3/4-Z,3/4+Y,1/4+X","1/4-Z,1/4-Y,1/4-X","3/4-X,3/4-Y,3/4-Z","3/4+X,1/4+Y,1/4-Z","1/4+X,1/4-Y,3/4+Z","1/4-X,3/4+Y,1/4+Z","3/4-Z,3/4-X,3/4-Y","1/4-Z,3/4+X,1/4+Y","3/4+Z,1/4+X,1/4-Y","1/4+Z,1/4-X,3/4+Y","3/4-Y,3/4-Z,3/4-X","1/4+Y,1/4-Z,3/4+X","1/4-Y,3/4+Z,1/4+X","3/4+Y,1/4+Z,1/4-X","-Y,1/2-X,Z","1/2+Y,1/2+X,1/2+Z","1/2-Y,X,-Z","Y,-X,1/2-Z","-X,1/2-Z,Y","X,-Z,1/2-Y","1/2+X,1/2+Z,1/2+Y","1/2-X,Z,-Y","-Z,1/2-Y,X","1/2-Z,Y,-X","Z,-Y,1/2-X","1/2+Z,1/2+Y,1/2+X","X,1/2+Y,1/2+Z","-X,-Y,Z","1/2-X,Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,1/2+X,1/2+Y","1/2+Z,1/2-X,-Y","-Z,-X,Y","1/2-Z,X,1/2-Y","Y,1/2+Z,1/2+X","1/2-Y,Z,1/2-X","1/2+Y,1/2-Z,-X","-Y,-Z,X","3/4+Y,3/4+X,1/4-Z","1/4-Y,3/4-X,3/4-Z","1/4+Y,1/4-X,1/4+Z","3/4-Y,1/4+X,3/4+Z","3/4+X,3/4+Z,1/4-Y","3/4-X,1/4+Z,3/4+Y","1/4-X,3/4-Z,3/4-Y","1/4+X,1/4-Z,1/4+Y","3/4+Z,3/4+Y,1/4-X","1/4+Z,1/4-Y,1/4+X","3/4-Z,1/4+Y,3/4+X","1/4-Z,3/4-Y,3/4-X","3/4-X,1/4-Y,1/4-Z","3/4+X,3/4+Y,3/4-Z","1/4+X,3/4-Y,1/4+Z","1/4-X,1/4+Y,3/4+Z","3/4-Z,1/4-X,1/4-Y","1/4-Z,1/4+X,3/4+Y","3/4+Z,3/4+X,3/4-Y","1/4+Z,3/4-X,1/4+Y","3/4-Y,1/4-Z,1/4-X","1/4+Y,3/4-Z,1/4+X","1/4-Y,1/4+Z,3/4+X","3/4+Y,3/4+Z,3/4-X","-Y,-X,1/2+Z","1/2+Y,X,Z","1/2-Y,1/2+X,1/2-Z","Y,1/2-X,-Z","-X,-Z,1/2+Y","X,1/2-Z,-Y","1/2+X,Z,Y","1/2-X,1/2+Z,1/2-Y","-Z,-Y,1/2+X","1/2-Z,1/2+Y,1/2-X","Z,1/2-Y,-X","1/2+Z,Y,X","1/2+X,Y,1/2+Z","1/2-X,1/2-Y,Z","-X,1/2+Y,1/2-Z","X,-Y,-Z","1/2+Z,X,1/2+Y","Z,-X,-Y","1/2-Z,1/2-X,Y","-Z,1/2+X,1/2-Y","1/2+Y,Z,1/2+X","-Y,1/2+Z,1/2-X","Y,-Z,-X","1/2-Y,1/2-Z,X","1/4+Y,1/4+X,1/4-Z","3/4-Y,1/4-X,3/4-Z","3/4+Y,3/4-X,1/4+Z","1/4-Y,3/4+X,3/4+Z","1/4+X,1/4+Z,1/4-Y","1/4-X,3/4+Z,3/4+Y","3/4-X,1/4-Z,3/4-Y","3/4+X,3/4-Z,1/4+Y","1/4+Z,1/4+Y,1/4-X","3/4+Z,3/4-Y,1/4+X","1/4-Z,3/4+Y,3/4+X","3/4-Z,1/4-Y,3/4-X","1/4-X,3/4-Y,1/4-Z","1/4+X,1/4+Y,3/4-Z","3/4+X,1/4-Y,1/4+Z","3/4-X,3/4+Y,3/4+Z","1/4-Z,3/4-X,1/4-Y","3/4-Z,3/4+X,3/4+Y","1/4+Z,1/4+X,3/4-Y","3/4+Z,1/4-X,1/4+Y","1/4-Y,3/4-Z,1/4-X","3/4+Y,1/4-Z,1/4+X","3/4-Y,3/4+Z,3/4+X","1/4+Y,1/4+Z,3/4-X","1/2-Y,1/2-X,1/2+Z","Y,1/2+X,Z","-Y,X,1/2-Z","1/2+Y,-X,-Z","1/2-X,1/2-Z,1/2+Y","1/2+X,-Z,-Y","X,1/2+Z,Y","-X,Z,1/2-Y","1/2-Z,1/2-Y,1/2+X","-Z,Y,1/2-X","1/2+Z,-Y,-X","Z,1/2+Y,X","1/2+X,1/2+Y,Z","1/2-X,-Y,1/2+Z","-X,Y,-Z","X,1/2-Y,1/2-Z","1/2+Z,1/2+X,Y","Z,1/2-X,1/2-Y","1/2-Z,-X,1/2+Y","-Z,X,-Y","1/2+Y,1/2+Z,X","-Y,Z,-X","Y,1/2-Z,1/2-X","1/2-Y,-Z,1/2+X","1/4+Y,3/4+X,3/4-Z","3/4-Y,3/4-X,1/4-Z","3/4+Y,1/4-X,3/4+Z","1/4-Y,1/4+X,1/4+Z","1/4+X,3/4+Z,3/4-Y","1/4-X,1/4+Z,1/4+Y","3/4-X,3/4-Z,1/4-Y","3/4+X,1/4-Z,3/4+Y","1/4+Z,3/4+Y,3/4-X","3/4+Z,1/4-Y,3/4+X","1/4-Z,1/4+Y,1/4+X","3/4-Z,3/4-Y,1/4-X","1/4-X,1/4-Y,3/4-Z","1/4+X,3/4+Y,1/4-Z","3/4+X,3/4-Y,3/4+Z","3/4-X,1/4+Y,1/4+Z","1/4-Z,1/4-X,3/4-Y","3/4-Z,1/4+X,1/4+Y","1/4+Z,3/4+X,1/4-Y","3/4+Z,3/4-X,3/4+Y","1/4-Y,1/4-Z,3/4-X","3/4+Y,3/4-Z,3/4+X","3/4-Y,1/4+Z,1/4+X","1/4+Y,3/4+Z,1/4-X","1/2-Y,-X,Z","Y,X,1/2+Z","-Y,1/2+X,-Z","1/2+Y,1/2-X,1/2-Z","1/2-X,-Z,Y","1/2+X,1/2-Z,1/2-Y","X,Z,1/2+Y","-X,1/2+Z,-Y","1/2-Z,-Y,X","-Z,1/2+Y,-X","1/2+Z,1/2-Y,1/2-X","Z,Y,1/2+X"],"I 4/m -3 2/m":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z","Z,X,Y","Z,-X,-Y","-Z,-X,Y","-Z,X,-Y","Y,Z,X","-Y,Z,-X","Y,-Z,-X","-Y,-Z,X","Y,X,-Z","-Y,-X,-Z","Y,-X,Z","-Y,X,Z","X,Z,-Y","-X,Z,Y","-X,-Z,-Y","X,-Z,Y","Z,Y,-X","Z,-Y,X","-Z,Y,X","-Z,-Y,-X","-X,-Y,-Z","X,Y,-Z","X,-Y,Z","-X,Y,Z","-Z,-X,-Y","-Z,X,Y","Z,X,-Y","Z,-X,Y","-Y,-Z,-X","Y,-Z,X","-Y,Z,X","Y,Z,-X","-Y,-X,Z","Y,X,Z","-Y,X,-Z","Y,-X,-Z","-X,-Z,Y","X,-Z,-Y","X,Z,Y","-X,Z,-Y","-Z,-Y,X","-Z,Y,-X","Z,-Y,-X","Z,Y,X","1/2+X,1/2+Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2-Z","1/2+Z,1/2+X,1/2+Y","1/2+Z,1/2-X,1/2-Y","1/2-Z,1/2-X,1/2+Y","1/2-Z,1/2+X,1/2-Y","1/2+Y,1/2+Z,1/2+X","1/2-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,1/2-X","1/2-Y,1/2-Z,1/2+X","1/2+Y,1/2+X,1/2-Z","1/2-Y,1/2-X,1/2-Z","1/2+Y,1/2-X,1/2+Z","1/2-Y,1/2+X,1/2+Z","1/2+X,1/2+Z,1/2-Y","1/2-X,1/2+Z,1/2+Y","1/2-X,1/2-Z,1/2-Y","1/2+X,1/2-Z,1/2+Y","1/2+Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,1/2+X","1/2-Z,1/2+Y,1/2+X","1/2-Z,1/2-Y,1/2-X","1/2-X,1/2-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z","1/2-Z,1/2-X,1/2-Y","1/2-Z,1/2+X,1/2+Y","1/2+Z,1/2+X,1/2-Y","1/2+Z,1/2-X,1/2+Y","1/2-Y,1/2-Z,1/2-X","1/2+Y,1/2-Z,1/2+X","1/2-Y,1/2+Z,1/2+X","1/2+Y,1/2+Z,1/2-X","1/2-Y,1/2-X,1/2+Z","1/2+Y,1/2+X,1/2+Z","1/2-Y,1/2+X,1/2-Z","1/2+Y,1/2-X,1/2-Z","1/2-X,1/2-Z,1/2+Y","1/2+X,1/2-Z,1/2-Y","1/2+X,1/2+Z,1/2+Y","1/2-X,1/2+Z,1/2-Y","1/2-Z,1/2-Y,1/2+X","1/2-Z,1/2+Y,1/2-X","1/2+Z,1/2-Y,1/2-X","1/2+Z,1/2+Y,1/2+X"],"I 41/a -3 2/d":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z","Z,X,Y","1/2+Z,1/2-X,-Y","1/2-Z,-X,1/2+Y","-Z,1/2+X,1/2-Y","Y,Z,X","-Y,1/2+Z,1/2-X","1/2+Y,1/2-Z,-X","1/2-Y,-Z,1/2+X","3/4+Y,1/4+X,1/4-Z","3/4-Y,3/4-X,3/4-Z","1/4+Y,1/4-X,3/4+Z","1/4-Y,3/4+X,1/4+Z","3/4+X,1/4+Z,1/4-Y","1/4-X,3/4+Z,1/4+Y","3/4-X,3/4-Z,3/4-Y","1/4+X,1/4-Z,3/4+Y","3/4+Z,1/4+Y,1/4-X","1/4+Z,1/4-Y,3/4+X","1/4-Z,3/4+Y,1/4+X","3/4-Z,3/4-Y,3/4-X","-X,-Y,-Z","1/2+X,Y,1/2-Z","X,1/2-Y,1/2+Z","1/2-X,1/2+Y,Z","-Z,-X,-Y","1/2-Z,1/2+X,Y","1/2+Z,X,1/2-Y","Z,1/2-X,1/2+Y","-Y,-Z,-X","Y,1/2-Z,1/2+X","1/2-Y,1/2+Z,X","1/2+Y,Z,1/2-X","1/4-Y,3/4-X,3/4+Z","1/4+Y,1/4+X,1/4+Z","3/4-Y,3/4+X,1/4-Z","3/4+Y,1/4-X,3/4-Z","1/4-X,3/4-Z,3/4+Y","3/4+X,1/4-Z,3/4-Y","1/4+X,1/4+Z,1/4+Y","3/4-X,3/4+Z,1/4-Y","1/4-Z,3/4-Y,3/4+X","3/4-Z,3/4+Y,1/4-X","3/4+Z,1/4-Y,3/4-X","1/4+Z,1/4+Y,1/4+X","1/2+X,1/2+Y,1/2+Z","-X,1/2-Y,Z","1/2-X,Y,-Z","X,-Y,1/2-Z","1/2+Z,1/2+X,1/2+Y","Z,-X,1/2-Y","-Z,1/2-X,Y","1/2-Z,X,-Y","1/2+Y,1/2+Z,1/2+X","1/2-Y,Z,-X","Y,-Z,1/2-X","-Y,1/2-Z,X","1/4+Y,3/4+X,3/4-Z","1/4-Y,1/4-X,1/4-Z","3/4+Y,3/4-X,1/4+Z","3/4-Y,1/4+X,3/4+Z","1/4+X,3/4+Z,3/4-Y","3/4-X,1/4+Z,3/4+Y","1/4-X,1/4-Z,1/4-Y","3/4+X,3/4-Z,1/4+Y","1/4+Z,3/4+Y,3/4-X","3/4+Z,3/4-Y,1/4+X","3/4-Z,1/4+Y,3/4+X","1/4-Z,1/4-Y,1/4-X","1/2-X,1/2-Y,1/2-Z","X,1/2+Y,-Z","1/2+X,-Y,Z","-X,Y,1/2+Z","1/2-Z,1/2-X,1/2-Y","-Z,X,1/2+Y","Z,1/2+X,-Y","1/2+Z,-X,Y","1/2-Y,1/2-Z,1/2-X","1/2+Y,-Z,X","-Y,Z,1/2+X","Y,1/2+Z,-X","3/4-Y,1/4-X,1/4+Z","3/4+Y,3/4+X,3/4+Z","1/4-Y,1/4+X,3/4-Z","1/4+Y,3/4-X,1/4-Z","3/4-X,1/4-Z,1/4+Y","1/4+X,3/4-Z,1/4-Y","3/4+X,3/4+Z,3/4+Y","1/4-X,1/4+Z,3/4-Y","3/4-Z,1/4-Y,1/4+X","1/4-Z,1/4+Y,3/4-X","1/4+Z,3/4-Y,1/4-X","3/4+Z,3/4+Y,3/4+X"],"P 1 1 2":["X,Y,Z","-X,-Y,Z"],"P 1 1 21":["X,Y,Z","-X,-Y,1/2+Z"],"B 1 1 2":["X,Y,Z","-X,-Y,Z","1/2+X,+Y,1/2+Z","1/2-X,-Y,1/2+Z"],"A 1 2 1":["X,Y,Z","-X,Y,-Z","X,1/2+Y,1/2+Z","-X,1/2+Y,1/2-Z"],"C 1 21 1":["X,Y,Z","-X,1/2+Y,-Z","1/2+X,1/2+Y,Z","1/2-X,Y,-Z"],"I 1 2 1":["X,Y,Z","-X,Y,-Z","X+1/2,Y+1/2,Z+1/2","-X+1/2,Y+1/2,-Z+1/2"],"I 1 21 1":["X,Y,Z","-X,1/2+Y,-Z","X+1/2,Y+1/2,Z+1/2","-X+1/2,Y,1/2-Z"],"P 1 1 m":["X,Y,Z","X,Y,-Z"],"P 1 1 b":["X,Y,Z","X,1/2+Y,-Z"],"B 1 1 m":["X,Y,Z","X,Y,-Z","1/2+X,Y,1/2+Z","1/2+X,Y,1/2-Z"],"B 1 1 b":["X,Y,Z","X,1/2+Y,-Z","1/2+X,Y,1/2+Z","1/2+X,1/2+Y,1/2-Z"],"P 1 1 2/m":["X,Y,Z","X,Y,-Z","-X,-Y,Z","-X,-Y,-Z"],"P 1 1 21/m":["X,Y,Z","-X,-Y,1/2+Z","-X,-Y,-Z","X,Y,1/2-Z"],"B 1 1 2/m":["X,Y,Z","X,Y,-Z","-X,-Y,Z","-X,-Y,-Z","1/2+X,Y,1/2+Z","1/2+X,Y,1/2-Z","1/2-X,-Y,1/2+Z","1/2-X,-Y,1/2-Z"],"P 1 1 2/b":["X,Y,Z","-X,1/2-Y,Z","-X,-Y,-Z","X,1/2+Y,-Z"],"P 1 1 21/b":["X,Y,Z","-X,-Y,-Z","-X,1/2-Y,1/2+Z","X,1/2+Y,1/2-Z"],"B 1 1 2/b":["X,Y,Z","-X,1/2-Y,Z","-X,-Y,-Z","X,1/2+Y,-Z","1/2+X,Y,1/2+Z","1/2-X,1/2-Y,1/2+Z","1/2-X,-Y,1/2-Z","1/2+X,1/2+Y,1/2-Z"],"P 21 2 2":["X,Y,Z","-X,Y,-Z","1/2+X,-Y,-Z","1/2-X,-Y,Z"],"P 2 21 2":["X,Y,Z","X,1/2-Y,-Z","-X,1/2+Y,-Z","-X,-Y,Z"],"P 21 21 2 (a)":["X,Y,Z","1/2-X,1/2-Y,Z","X+1/2,-Y,-Z","-X,Y+1/2,-Z"],"P 21 2 21":["X,Y,Z","-X,Y,-Z","1/2+X,-Y,1/2-Z","1/2-X,-Y,1/2+Z"],"P 2 21 21":["X,Y,Z","X,-Y,-Z","-X,1/2+Y,1/2-Z","-X,1/2-Y,1/2+Z"],"C 2 2 21a)":["X,Y,Z","1/2-X,-Y,1/2+Z","1/2+X,1/2-Y,-Z","-X,1/2+Y,1/2-Z","1/2+X,1/2+Y,Z","-X,1/2-Y,1/2+Z","X,-Y,-Z","1/2-X,Y,1/2-Z"],"C 2 2 2a":["X,Y,Z","1/2-X,1/2-Y,Z","X+1/2,-Y,-Z","-X,Y+1/2,-Z","1/2+ X,1/2+Y,Z","-X,-Y,Z","X,1/2-Y,-Z","1/2-X,Y,-Z"],"F 2 2 2a":["X,Y,Z","1/2-X,1/2-Y,Z","X+1/2,-Y,-Z","-X,Y+1/2,-Z","X,Y+1/2,Z+1/2","1/2-X,-Y,Z+1/2","X+1/2,-Y+1/2,-Z+1/2","-X,Y,-Z+1/2","X+1/2,Y,Z+1/2","-X,1/2-Y,Z+1/2","X,-Y,-Z+1/2","-X+1/2,Y+1/2,-Z+1/2","X+1/2,Y+1/2,Z","-X,-Y,Z","X,-Y+1/2,-Z","-X+1/2,Y,-Z"],"I 2 2 2a":["X,Y,Z","1/2-X,1/2-Y,Z","X+1/2,-Y,-Z","-X,Y+1/2,-Z","1/2+X,1/2+Y,1/2+Z","-X,-Y,1/2+Z","1/2-X,Y,1/2-Z","X,1/2-Y,1/2-Z"],"P 21/m 21/m 2/n a":["X,Y,Z","1/2-X,1/2-Y,Z","-X,1/2+Y,-Z","1/2+X,-Y,-Z","-X,-Y,-Z","X+1/2,Y+1/2,-Z","X,1/2-Y,Z","1/2-X,Y,Z"],"P 42 21 2a":["X,Y,Z","1/2-X,1/2-Y,Z","-Y,X+1/2,1/2+Z","Y+1/2,-X,1/2+Z","-X,Y+1/2,-Z","X+1/2,-Y,-Z","Y,X,1/2-Z","1/2-Y,1/2-X,1/2-Z"],"I 2 3a":["X,Y,Z","1/2-X,1/2-Y,Z","X+1/2,-Y,-Z","-X,Y+1/2,-Z","Y,Z,X","1/2-Y,1/2-Z,X","Y+1/2,-Z,-X","-Y,Z+1/2,-X","Z,X,Y","1/2-Z,1/2-X,Y","Z+1/2,-X,-Y","-Z,X+1/2,-Y","1/2+X,1/2+Y,1/2+Z","-X,-Y,1/2+Z","X,1/2-Y,1/2-Z","1/2-X,Y,1/2-Z","1/2+Y,1/2+Z,1/2+X","-Y,-Z,1/2+X","Y,1/2-Z,1/2-X","1/2-Y,Z,1/2-X","1/2+Z,1/2+X,1/2+Y","-Z,-X,1/2+Y","Z,1/2-X,1/2-Y","1/2-Z,X,1/2-Y"]},Ur=function(){var t=function(t,e,i,r){for(var n=t.structure,o=t.residueIndexStart,s=n.getResidueProxy(),a=n.getResidueProxy(),c=n.getAtomProxy(),h=n.getAtomProxy(),u=Math.max(0,e-2);e>=u;++u)for(var l=2;5>l;++l)if(!(u+l>=t.residueCount)){s.index=o+u,a.index=o+u+l,c.index=s.traceAtomIndex,h.index=a.traceAtomIndex;var d=c.distanceTo(h);if(Math.abs(d-i[l-2])>r)return!1}return!0},e=function(e,i){var r=[5.45,5.18,6.37],n=2.1;return t(e,i,r,n)},i=function(e,i){var r=[6.1,10.4,13],n=1.42;return t(e,i,r,n)},r=function(t){for(var r=t.residueStore,n=t.residueIndexStart,o=0,s=t.residueCount;s>o;++o){var a="c";e(t,o)?a="h":i(t,o)&&(a="s"),r.sstruc[n+o]=a.charCodeAt(0)}},n=function(t){for(var e=20,i=2,r=t.residueStore,n=t.residueIndexStart,o=new $(t),s=o.position,a=new THREE.Vector3,c=new THREE.Vector3,h=0,u=t.residueCount;u>h;++h){a.fromArray(s.center,3*h),c.fromArray(s.center,3*h+3);var l=a.distanceTo(c);i>l&&l>1&&s.bending[h]<e&&(r.sstruc[n+h]="h".charCodeAt(0),r.sstruc[n+h+1]="h".charCodeAt(0))}};return function(t){kr&&Ir.time("calculateSecondaryStructure"),t.eachPolymer(function(t){if(!(t.residueCount<4)){if(t.isCg())n(t);else{if(!t.isProtein())return;r(t)}var e,i=0;t.eachResidue(function(t){t.sstruc===e?i+=1:(1===i&&(t.index-=1,t.sstruc="c"),i=1,e=t.sstruc)})}}),kr&&Ir.timeEnd("calculateSecondaryStructure")}}(),Gr=function(){var t=["H","C","O","N","S","P"],e=["NA","CL"];return function(i){var r=i.trim().toUpperCase();parseInt(r.charAt(0))&&(r=r.substr(1)),parseInt(r.charAt(0))&&(r=r.substr(1));var n=r.length;if(0===n)return"";if(1===n)return r;if(2===n){if(-1!==e.indexOf(r))return r;if(-1!==t.indexOf(r[0]))return r[0]}return n>=3&&-1!==t.indexOf(r[0])?r[0]:""}}();ut.prototype={constructor:ut,type:"AtomType",atomname:void 0,element:void 0,vdw:void 0,covalent:void 0,toJSON:function(){var t={atomname:this.atomname,element:this.element};return t}},dt.prototype={constructor:dt,type:"ResidueType",resname:void 0,atomTypeIdList:void 0,atomCount:void 0,getBackboneIndexList:function(){var t,e=[];switch(this.moleculeType){case Qi:t=br;break;case $i:case tr:t=xr;break;default:return e}for(var i=this.structure.atomMap,r=this.atomTypeIdList,n=0,o=this.atomCount;o>n;++n){var s=i.get(r[n]);-1!==t.indexOf(s.atomname)&&e.push(n)}return e},getMoleculeType:function(){return this.isProtein()?Qi:this.isRna()?$i:this.isDna()?tr:this.isWater()?Ji:this.isIon()?Ki:Wi},getBackboneType:function(t){return this.hasProteinBackbone(t)?ir:this.hasRnaBackbone(t)?rr:this.hasDnaBackbone(t)?nr:this.hasCgProteinBackbone(t)?or:this.hasCgRnaBackbone(t)?sr:this.hasCgDnaBackbone(t)?ar:er},isProtein:function(){return this.hasAtomWithName("CA","C","N")&&-1===yr.indexOf(this.resname)||-1!==pr.indexOf(this.resname)},isCg:function(){var t=this.backboneType;return t===or||t===sr||t===ar},isNucleic:function(){return this.isRna()||this.isDna()},isRna:function(){return this.hasAtomWithName(["P","O3'","O3*"],["C4'","C4*"],["O2'","O2*"])&&-1===yr.indexOf(this.resname)||-1!==Yr.indexOf(this.resname)},isDna:function(){return this.hasAtomWithName(["P","O3'","O3*"],["C3'","C3*"])&&!this.hasAtomWithName(["O2'","O2*"])&&-1===yr.indexOf(this.resname)||-1!==Xr.indexOf(this.resname)},isPolymer:function(){return this.isProtein()||this.isNucleic()},isHetero:function(){return 1===this.hetero},isIon:function(){return-1!==vr.indexOf(this.resname)},isWater:function(){return-1!==gr.indexOf(this.resname)},hasBackboneAtoms:function(t,e){var i=Sr[e];return-1===t?this.hasAtomWithName(i.trace,i.backboneEnd,i.direction1,i.direction2):0===t?this.hasAtomWithName(i.trace,i.direction1,i.direction2):1===t?this.hasAtomWithName(i.trace,i.backboneStart,i.direction1,i.direction2):this.hasAtomWithName(i.trace,i.backboneStart,i.backboneEnd,i.direction1,i.direction2)},hasProteinBackbone:function(t){return this.isProtein()&&this.hasBackboneAtoms(t,ir)},hasRnaBackbone:function(t){return this.isRna()&&this.hasBackboneAtoms(t,rr)},hasDnaBackbone:function(t){return this.isDna()&&this.hasBackboneAtoms(t,nr)},hasCgProteinBackbone:function(t){return this.isProtein()&&this.hasBackboneAtoms(t,or)},hasCgRnaBackbone:function(t){return this.isRna()&&this.hasBackboneAtoms(t,sr)},hasCgDnaBackbone:function(t){return this.isDna()&&this.hasBackboneAtoms(t,ar)},hasBackbone:function(t){return this.hasProteinBackbone(t)||this.hasRnaBackbone(t)||this.hasDnaBackbone(t)||this.hasCgProteinBackbone(t)||this.hasCgRnaBackbone(t)||this.hasCgDnaBackbone(t)},getAtomIndexByName:function(t){var e,i,r=this.atomCount,n=this.structure.atomMap,o=this.atomTypeIdList;if(Array.isArray(t)){for(e=0;r>e;++e)if(i=o[e],-1!==t.indexOf(n.get(i).atomname))return e}else for(e=0;r>e;++e)if(i=o[e],t===n.get(i).atomname)return e},hasAtomWithName:function(t){for(var e=arguments.length,i=0;e>i;++i)if(void 0!==arguments[i]&&void 0===this.getAtomIndexByName(arguments[i]))return!1;return!0},getBonds:function(t){return this.bonds||(this.bonds=st(t)),this.bonds},toJSON:function(){var t={resname:this.resname,atomTypeIdList:this.atomTypeIdList,hetero:this.hetero};return t}},ft.prototype={constructor:ft,type:"BondProxy",structure:void 0,bondStore:void 0,index:void 0,get atom1(){return this.structure.getAtomProxy(this.atomIndex1)},get atom2(){return this.structure.getAtomProxy(this.atomIndex2)},get atomIndex1(){return this.bondStore.atomIndex1[this.index]},set atomIndex1(t){this.bondStore.atomIndex1[this.index]=t},get atomIndex2(){return this.bondStore.atomIndex2[this.index]},set atomIndex2(t){this.bondStore.atomIndex2[this.index]=t},get bondOrder(){return this.bondStore.bondOrder[this.index]},set bondOrder(t){this.bondStore.bondOrder[this.index]=t},qualifiedName:function(){return this.atomIndex1+"="+this.atomIndex2},clone:function(){return new this.constructor(this.structure,this.index)},toObject:function(){return{atomIndex1:this.atomIndex1,atomIndex2:this.atomIndex2,bondOrder:this.bondOrder}}},pt.prototype={constructor:pt,type:"AtomProxy",structure:void 0,chainStore:void 0,residueStore:void 0,atomStore:void 0,index:void 0,get modelIndex(){return this.chainStore.modelIndex[this.chainIndex]},get chainIndex(){return this.residueStore.chainIndex[this.residueIndex]},get residue(){return console.warn("residue - might be expensive"),this.structure.getResidueProxy(this.residueIndex,!1)},get residueIndex(){return this.atomStore.residueIndex[this.index]},set residueIndex(t){this.atomStore.residueIndex[this.index]=t},get sstruc(){return this.residueStore.getSstruc(this.residueIndex)},get inscode(){return this.residueStore.getInscode(this.residueIndex)},get resno(){return this.residueStore.resno[this.residueIndex]},get chainname(){return this.chainStore.getChainname(this.chainIndex)},get residueType(){return this.residueMap.get(this.residueStore.residueTypeId[this.residueIndex])},get atomType(){return this.atomMap.get(this.atomStore.atomTypeId[this.index])},get resname(){return this.residueType.resname},get hetero(){return this.residueType.hetero},get atomname(){return this.atomType.atomname},get element(){return this.atomType.element},get vdw(){return this.atomType.vdw},get covalent(){return this.atomType.covalent},get x(){return this.atomStore.x[this.index]},set x(t){this.atomStore.x[this.index]=t},get y(){return this.atomStore.y[this.index]},set y(t){this.atomStore.y[this.index]=t},get z(){return this.atomStore.z[this.index]},set z(t){this.atomStore.z[this.index]=t},get serial(){return this.atomStore.serial[this.index]},set serial(t){this.atomStore.serial[this.index]=t},get bfactor(){return this.atomStore.bfactor[this.index]},set bfactor(t){this.atomStore.bfactor[this.index]=t},get occupancy(){return this.atomStore.occupancy[this.index]},set occupancy(t){this.atomStore.occupancy[this.index]=t},get altloc(){return this.atomStore.getAltloc(this.index)},set altloc(t){this.atomStore.setAltloc(this.index,t)},isBackbone:function(){var t=this.residueType.backboneIndexList;if(t.length>0){var e=this.residueStore.atomOffset[this.residueIndex];return-1!==t.indexOf(this.index-e)}return!1},isPolymer:function(){var t=this.residueType.moleculeType;return t===Qi||t===$i||t===tr||t===CgType},isSidechain:function(){return this.isPolymer()&&!this.isBackbone()},isCg:function(){var t=this.residueType.backboneType;return t===or||t===sr||t===ar},isHetero:function(){return 1===this.residueType.hetero},isProtein:function(){return this.residueType.moleculeType===Qi},isNucleic:function(){var t=this.residueType.moleculeType;return t===$i||t===tr},isRna:function(){return this.residueType.moleculeType===$i},isDna:function(){return this.residueType.moleculeType===tr},isWater:function(){return this.residueType.moleculeType===Ji},isIon:function(){return this.residueType.moleculeType===Ki},distanceTo:function(t){var e=this.atomStore,i=t.atomStore,r=this.index,n=t.index,o=e.x[r]-i.x[n],s=e.y[r]-i.y[n],a=e.z[r]-i.z[n],c=o*o+s*s+a*a;return Math.sqrt(c)},connectedTo:function(t){var e=this.atomStore,i=t.atomStore,r=this.index,n=t.index;if(e.altloc&&i.altloc){var o=e.altloc[r],s=i.altloc[n];if(0!==o&&0!==s&&32!==o&&32!==s&&o!==s)return!1}var a=e.x[r]-i.x[n],c=e.y[r]-i.y[n],h=e.z[r]-i.z[n],u=a*a+c*c+h*h;if(64>u&&this.isCg())return!0;if(isNaN(u))return!1;var l=this.covalent+t.covalent,d=l+.3,m=l-.5;return d*d>u&&u>m*m},positionFromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e+0],this.y=t[e+1],this.z=t[e+2],this},positionToArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e+0]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},positionToVector3:function(t){return void 0===t&&(t=new THREE.Vector3),t.x=this.x,t.y=this.y,t.z=this.z,t},positionFromVector3:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},qualifiedName:function(t){var e="";return this.resname&&!t&&(e+="["+this.resname+"]"),void 0!==this.resno&&(e+=this.resno),this.inscode&&(e+="^"+this.inscode),this.chainname&&(e+=":"+this.chainname),this.atomname&&(e+="."+this.atomname),this.altloc&&(e+="%"+this.altloc),e+="/"+this.modelIndex},clone:function(){return new this.constructor(this.structure,this.index)},toObject:function(){return{index:this.index,residueIndex:this.residueIndex,atomno:this.atomno,resname:this.resname,x:this.x,y:this.y,z:this.z,element:this.element,chainname:this.chainname,resno:this.resno,serial:this.serial,vdw:this.vdw,covalent:this.covalent,hetero:this.hetero,bfactor:this.bfactor,altloc:this.altloc,atomname:this.atomname,modelindex:this.modelindex
}}},Yt.prototype={constructor:Yt,type:"ResidueProxy",structure:void 0,chainStore:void 0,residueStore:void 0,atomStore:void 0,index:void 0,get chain(){return this.structure.getChainProxy(this.chainIndex)},get chainIndex(){return this.residueStore.chainIndex[this.index]},set chainIndex(t){this.residueStore.chainIndex[this.index]=t},get atomOffset(){return this.residueStore.atomOffset[this.index]},set atomOffset(t){this.residueStore.atomOffset[this.index]=t},get atomCount(){return this.residueStore.atomCount[this.index]},set atomCount(t){this.residueStore.atomCount[this.index]=t},get modelIndex(){return this.chainStore.modelIndex[this.chainIndex]},get chainname(){return this.chainStore.getChainname(this.chainIndex)},get resno(){return this.residueStore.resno[this.index]},set resno(t){this.residueStore.resno[this.index]=t},get sstruc(){return this.residueStore.getSstruc(this.index)},set sstruc(t){this.residueStore.setSstruc(this.index,t)},get inscode(){return this.residueStore.getInscode(this.index)},set inscode(t){this.residueStore.getInscode(this.index,t)},get residueType(){return this.residueMap.get(this.residueStore.residueTypeId[this.index])},get resname(){return this.residueType.resname},get hetero(){return this.residueType.hetero},get moleculeType(){return this.residueType.moleculeType},get backboneType(){return this.residueType.backboneType},get backboneStartType(){return this.residueType.backboneStartType},get backboneEndType(){return this.residueType.backboneEndType},get traceAtomIndex(){return this.residueType.traceAtomIndex+this.atomOffset},get direction1AtomIndex(){return this.residueType.direction1AtomIndex+this.atomOffset},get direction2AtomIndex(){return this.residueType.direction2AtomIndex+this.atomOffset},get backboneStartAtomIndex(){return this.residueType.backboneStartAtomIndex+this.atomOffset},get backboneEndAtomIndex(){return this.residueType.backboneEndAtomIndex+this.atomOffset},get rungEndAtomIndex(){return this.residueType.rungEndAtomIndex+this.atomOffset},eachAtom:function(t,e){var i,r=this.atomCount,n=this.atomOffset,o=this.structure._ap,s=n+r;if(e&&e.atomOnlyTest){var a=e.atomOnlyTest;for(i=n;s>i;++i)o.index=i,a(o)&&t(o)}else for(i=n;s>i;++i)o.index=i,t(o)},isProtein:function(){return this.residueType.moleculeType===Qi},isNucleic:function(){var t=this.residueType.moleculeType;return t===$i||t===tr},isRna:function(){return this.residueType.moleculeType===$i},isDna:function(){return this.residueType.moleculeType===tr},isCg:function(){var t=this.residueType.backboneType;return t===or||t===sr||t===ar},isPolymer:function(){var t=this.residueType.moleculeType;return t===Qi||t===$i||t===tr},isHetero:function(){return 1===this.residueType.hetero},isWater:function(){return this.residueType.moleculeType===Ji},isIon:function(){return this.residueType.moleculeType===Ki},getAtomType:function(t){return this.atomMap.get(this.atomStore.atomTypeId[t])},getResname1:function(){return fr[this.resname.toUpperCase()]||"X"},getBackboneType:function(t){switch(t){case-1:return this.residueType.backboneStartType;case 1:return this.residueType.backboneEndType;default:return this.residueType.backboneType}},getAtomIndexByName:function(t){return this.residueType.getAtomIndexByName(t)},getAtomByName:function(t){return this.residueType.getAtomByName(t)},hasAtomWithName:function(t){return this.residueType.hasAtomWithName(t)},getAtomnameList:function(){console.warn("getAtomnameList - might be expensive");for(var t=this.atomCount,e=this.atomOffset,i=new Array(t),r=0;t>r;++r)i[r]=this.getAtomType(e+r).atomname;return i},connectedTo:function(t){var e=this.structure.getAtomProxy(this.backboneEndAtomIndex),i=this.structure.getAtomProxy(t.backboneStartAtomIndex);return e&&i?e.connectedTo(i):!1},getNextConnectedResidue:function(){var t=this.chainStore.residueOffset[this.chainIndex],e=this.chainStore.residueCount[this.chainIndex],i=this.index+1;if(t+e>i){var r=this.structure.getResidueProxy(i);if(this.connectedTo(r))return r}else if(i===t+e){var n=this.structure.getResidueProxy(t);if(this.connectedTo(n))return n}},getPreviousConnectedResidue:function(t){var e=this.chainStore.residueOffset[this.chainIndex],i=this.index-1;if(i>=e){if(void 0===t&&(t=this.structure.getResidueProxy()),t.index=i,t.connectedTo(this))return t}else if(i===e-1){void 0===t&&(t=this.structure.getResidueProxy());var r=this.chainStore.residueCount[this.chainIndex];if(t.index=e+r-1,t.connectedTo(this))return t}},getBonds:function(){return this.residueType.getBonds(this)},qualifiedName:function(t){var e="";return this.resname&&!t&&(e+="["+this.resname+"]"),void 0!==this.resno&&(e+=this.resno),this.inscode&&(e+="^"+this.inscode),this.chain&&(e+=":"+this.chainname),e+="/"+this.modelIndex},clone:function(){return new this.constructor(this.structure,this.index)},toObject:function(){return{index:this.index,chainIndex:this.chainIndex,atomOffset:this.atomOffset,atomCount:this.atomCount,resno:this.resno,resname:this.resname,sstruc:this.sstruc}}},Xt.prototype={constructor:Xt,type:"Polymer",structure:void 0,residueStore:void 0,atomStore:void 0,residueIndexStart:void 0,residueIndexEnd:void 0,residueCount:void 0,get chainIndex(){return this.residueStore.chainIndex[this.residueIndexStart]},get modelIndex(){return this.chainStore.modelIndex[this.chainIndex]},get chainname(){return this.chainStore.getChainname(this.chainIndex)},isProtein:function(){return this.__residueProxy.index=this.residueIndexStart,this.__residueProxy.isProtein()},isCg:function(){return this.__residueProxy.index=this.residueIndexStart,this.__residueProxy.isCg()},isNucleic:function(){return this.__residueProxy.index=this.residueIndexStart,this.__residueProxy.isNucleic()},getMoleculeType:function(){return this.__residueProxy.index=this.residueIndexStart,this.__residueProxy.moleculeType},getBackboneType:function(t){return this.__residueProxy.index=this.residueIndexStart,this.__residueProxy.getBackboneType(t)},getAtomIndexByType:function(t,e){this.isCyclic?-1===t?t=this.residueCount-1:t===this.residueCount&&(t=0):(-1!==t||this.isPrevConnected||(t+=1),t!==this.residueCount||this.isNextNextConnected||(t-=1));var i=this.__residueProxy;i.index=this.residueIndexStart+t;var r;switch(e){case"trace":r=i.traceAtomIndex;break;case"direction1":r=i.direction1AtomIndex;break;case"direction2":r=i.direction2AtomIndex;break;default:var n=i.getAtomByName(e);r=n?n.index:void 0}return r},eachAtom:function(t,e){this.eachResidue(function(i){i.eachAtom(t,e)},e)},eachAtomN:function(t,e,i){var r,n=this.residueCount,o=new Array(t);for(r=0;t>r;++r)o[r]=this.structure.getAtomProxy(this.getAtomIndexByType(r,i));e.apply(this,o);for(var s=t;n>s;++s){for(r=1;t>r;++r)o[r-1].index=o[r].index;o[t-1].index=this.getAtomIndexByType(s,i),e.apply(this,o)}},eachAtomN2:function(t,e,i){var r=this.atomOffset,n=this.atomCount,o=r+n;if(!(t>n)){for(var s=new Array(t),a=0;t>a;++a)s[a]=this.structure.getAtomProxy();var c=this.structure.atomSetCache["__"+i];void 0===c&&(Ir.warn("no precomputed atomSet for: "+i),c=this.structure.getAtomSet(!1),this.eachResidue(function(t){var e=t.getAtomByName(i);c.add_unsafe(e.index)}));var h=0;c.forEach(function(i){if(i>=r&&o>i){for(var n=1;t>n;++n)s[n-1].index=s[n].index;s[t-1].index=i,h+=1,h>=t&&e.apply(this,s)}})}},eachDirectionAtomsN:function(t,e){var i=2*t,r=this.atomOffset,n=this.atomCount,o=r+n;if(!(t>n)){for(var s=new Array(i),a=0;i>a;++a)s[a]=this.structure.getAtomProxy();var c=this.structure.atomSetCache.__direction1,h=this.structure.atomSetCache.__direction2;if(void 0===c||void 0===h)return void Ir.error("no precomputed atomSet for direction1 or direction2");var u=0;TypedFastBitSet.forEach(function(i,n){if(i>=r&&o>i&&n>=r&&o>n){for(var a=1;t>a;++a)s[a-1].index=s[a].index,s[a-1+t].index=s[a+t].index;s[t-1].index=i,s[t-1+t].index=n,u+=1,u>=t&&e.apply(this,s)}},c,h)}},eachResidue:function(t){for(var e=this.structure.getResidueProxy(),i=this.residueCount,r=this.residueIndexStart,n=0;i>n;++n)e.index=r+n,t(e)},qualifiedName:function(){var t=this.structure.getResidueProxy(this.residueIndexStart),e=this.structure.getResidueProxy(this.residueIndexEnd);return t.qualifiedName()+" - "+e.qualifiedName()}},Zt.prototype={constructor:Zt,type:"ChainProxy",structure:void 0,chainStore:void 0,index:void 0,get model(){return this.structure.getModelProxy(this.modelIndex)},get modelIndex(){return this.chainStore.modelIndex[this.index]},set modelIndex(t){this.chainStore.modelIndex[this.index]=t},get residueOffset(){return this.chainStore.residueOffset[this.index]},set residueOffset(t){this.chainStore.residueOffset[this.index]=t},get residueCount(){return this.chainStore.residueCount[this.index]},set residueCount(t){this.chainStore.residueCount[this.index]=t},get residueEnd(){return this.residueOffset+this.residueCount-1},get atomOffset(){return this.residueStore.atomOffset[this.residueOffset]},get atomEnd(){return this.residueStore.atomOffset[this.residueEnd]+this.residueStore.atomCount[this.residueEnd]-1},get atomCount(){return this.atomEnd-this.atomOffset+1},get chainname(){return this.chainStore.getChainname(this.index)},set chainname(t){this.chainStore.setChainname(this.index,t)},eachAtom:function(t,e){this.eachResidue(function(i){i.eachAtom(t,e)},e)},eachResidue:function(t,e){var i,r=this.residueCount,n=this.residueOffset,o=this.structure._rp,s=n+r;if(e&&e.test){var a=e.residueOnlyTest;if(a)for(i=n;s>i;++i)o.index=i,a(o)&&t(o,e);else for(i=n;s>i;++i)o.index=i,t(o,e)}else for(i=n;s>i;++i)o.index=i,t(o)},eachResidueN:function(t,e){var i,r=this.residueCount,n=this.residueOffset,o=n+r;if(!(t>r)){var s=new Array(t);for(i=0;t>i;++i)s[i]=this.structure.getResidueProxy(n+i);e.apply(this,s);for(var a=n+t;o>a;++a){for(i=0;t>i;++i)s[i].index+=1;e.apply(this,s)}}},eachPolymer:function(t,e){for(var i,r,n=e?e.residueOnlyTest:void 0,o=this.model.structure,s=this.residueCount,a=this.residueOffset,c=a+s,h=this.structure.getResidueProxy(),u=this.structure.getResidueProxy(a),l=this.structure.getAtomProxy(),d=this.structure.getAtomProxy(),m=!0,f=a+1;c>f;++f){h.index=u.index,u.index=f,m&&(i=h.index,m=!1),r=u.index;var p=m?h.backboneEndType:h.backboneType,Y=u.backboneType;p!==er&&p===Y?(l.index=h.backboneEndAtomIndex,d.index=u.backboneStartAtomIndex,l&&d&&l.connectedTo(d)&&(!n||n(h)&&n(u))||(h.index-i>1&&t(new Xt(o,i,h.index)),i=r)):(p!==er&&h.index-i>1&&t(new Xt(o,i,h.index)),i=r)}r-i>1&&this.structure.getResidueProxy(i).backboneStartType&&t(new Xt(o,i,r))},qualifiedName:function(){var t=":"+this.chainname+"/"+this.modelIndex;return t},clone:function(){return new this.constructor(this.structure,this.index)},toObject:function(){return{index:this.index,residueOffset:this.residueOffset,residueCount:this.residueCount,chainname:this.chainname}}},gt.prototype={constructor:gt,type:"ModelProxy",structure:void 0,modelStore:void 0,index:void 0,get chainOffset(){return this.modelStore.chainOffset[this.index]},set chainOffset(t){this.modelStore.chainOffset[this.index]=t},get chainCount(){return this.modelStore.chainCount[this.index]},set chainCount(t){this.modelStore.chainCount[this.index]=t},get residueOffset(){return this.chainStore.residueOffset[this.chainOffset]},get atomOffset(){return this.residueStore.atomOffset[this.residueOffset]},get chainEnd(){return this.chainOffset+this.chainCount-1},get residueEnd(){return this.chainStore.residueOffset[this.chainEnd]+this.chainStore.residueCount[this.chainEnd]-1},get atomEnd(){return this.residueStore.atomOffset[this.residueEnd]+this.residueStore.atomCount[this.residueEnd]-1},get residueCount(){return this.residueEnd-this.residueOffset+1},get atomCount(){return this.atomEnd-this.atomOffset+1},eachAtom:function(t,e){this.eachChain(function(i){i.eachAtom(t,e)},e)},eachResidue:function(t,e){var i,r,n=this.chainCount;if(e&&e.chainOnlyTest){var o=e.chainOnlyTest;for(i=0;n>i;++i)r=this.chains[i],o(r)&&r.eachResidue(t,e)}else for(i=0;n>i;++i)r=this.chains[i],r.eachResidue(t,e)},eachPolymer:function(t,e){if(e&&e.chainOnlyTest){var i=e.chainOnlyTest;this.eachChain(function(r){i(r)&&r.eachPolymer(t,e)})}else this.eachChain(function(i){i.eachPolymer(t,e)})},eachChain:function(t,e){var i,r=this.chainCount,n=this.chainOffset,o=this.structure._cp,s=n+r;if(e&&e.test){var a=e.chainOnlyTest;if(a)for(i=n;s>i;++i)o.index=i,a(o)&&t(o,e);else for(i=n;s>i;++i)o.index=i,t(o,e)}else for(i=n;s>i;++i)o.index=i,t(o)},qualifiedName:function(){var t="/"+this.index;return t},clone:function(){return new this.constructor(this.structure,this.index)},toObject:function(){return{index:this.index,chainOffset:this.chainOffset,chainCount:this.chainCount}}},vt.prototype={constructor:vt,type:"Structure",refresh:function(){kr&&Ir.time("Structure.refresh"),this.atomSetCache={},this.atomSet=this.getAtomSet2(this.selection),this.bondSet=this.getBondSet();for(var t in this.atomSetDict){var e=this.atomSetDict[t],i=this.getAtomSet2(!1);this.atomSetCache["__"+t]=i.intersection(e)}this.boundingBox=this.getBoundingBox(),this.center=this.boundingBox.center(),Nr.updateObject(this),kr&&Ir.timeEnd("Structure.refresh"),this.signals.refreshed.dispatch()},getBondProxy:function(t){return new ft(this,t)},getAtomProxy:function(t,e){return e?(void 0===this.__tmpAtomProxy&&(this.__tmpAtomProxy=new pt(this,t)),this.__tmpAtomProxy):new pt(this,t)},getResidueProxy:function(t,e){return e?(void 0===this.__tmpResidueProxy&&(this.__tmpResidueProxy=new Yt(this,t)),this.__tmpResidueProxy):new Yt(this,t)},getChainProxy:function(t){return new Zt(this,t)},getModelProxy:function(t){return new gt(this,t)},getBondSet:function(t){kr&&Ir.time("Structure.getBondSet");var e=this.bondStore.count,i=new TypedFastBitSet(e),r=this.atomSet;if(r)for(var n=this.getBondProxy(),o=0;e>o;++o)n.index=o,r.has(n.atomIndex1)&&r.has(n.atomIndex2)&&i.add_unsafe(n.index);else i.set_all(!0);return kr&&Ir.timeEnd("Structure.getBondSet"),i},getBackboneBondSet:function(t){kr&&Ir.time("Structure.getBackboneBondSet");var e=this.backboneBondStore.count,i=new TypedFastBitSet(e),r=this.atomSetCache.__backbone;if(r){var n=this.getBondProxy();n.bondStore=this.backboneBondStore;for(var o=0;e>o;++o)n.index=o,r.has(n.atomIndex1)&&r.has(n.atomIndex2)&&i.add_unsafe(n.index)}else i.set_all(!0);return kr&&Ir.timeEnd("Structure.getBackboneBondSet"),i},getRungBondSet:function(t){kr&&Ir.time("Structure.getRungBondSet");var e=this.rungBondStore.count,i=new TypedFastBitSet(e),r=this.atomSetCache.__rung;if(r){var n=this.getBondProxy();n.bondStore=this.rungBondStore;for(var o=0;e>o;++o)n.index=o,r.has(n.atomIndex1)&&r.has(n.atomIndex2)&&i.add_unsafe(n.index)}else i.set_all(!0);return kr&&Ir.timeEnd("Structure.getRungBondSet"),i},getAtomSet:function(t){kr&&Ir.time("Structure.getAtomSet");var e,i=this.atomStore.count;if(t===!1)e=new TypedFastBitSet(i);else if(t===!0)e=new TypedFastBitSet(i),e.set_all(!0);else if(t&&t.test){var r=t.string;if(e=this.atomSetCache[r],r||console.warn("empty seleString"),void 0===e){e=new TypedFastBitSet(i);for(var n=this.getAtomProxy(),o=t.test,s=0;i>s;++s)n.index=s,o(n)&&e.add_unsafe(n.index);this.atomSetCache[r]=e}}else e=new TypedFastBitSet(i),e.set_all(!0);return kr&&Ir.timeEnd("Structure.getAtomSet"),e},getAtomSet2:function(t){kr&&Ir.time("Structure.getAtomSet2");var e,i=this.atomStore.count;if(t===!1)e=new TypedFastBitSet(i);else if(t===!0)e=new TypedFastBitSet(i),e.set_all(!0);else if(t&&t.test){var r=t.string;e=this.atomSetCache[r],r||console.warn("empty seleString"),void 0===e&&(e=new TypedFastBitSet(i),this.eachAtom(function(t){e.add_unsafe(t.index)},t),this.atomSetCache[r]=e)}else e=new TypedFastBitSet(i),e.set_all(!0);return kr&&Ir.timeEnd("Structure.getAtomSet2"),e},setSelection:function(t){this.selection=t,this.refresh()},getSelection:function(){return this.selection},getStructure:function(){return this},eachBond:function(t,e){var i=this.getBondProxy(),r=this.bondSet;if(e&&e.test&&(r=r?r.new_intersection(this.getBondSet(e)):this.getBondSet(e)),r)r.forEach(function(e){i.index=e,t(i)});else for(var n=this.bondStore.count,o=0;n>o;++o)i.index=o,t(i)},getAtomSet3:function(t){kr&&Ir.time("Structure.getAtomSet3");var e=this.atomSet;return t&&t.test&&(e=e?e.new_intersection(this.getAtomSet2(t)):this.getAtomSet2(t)),kr&&Ir.timeEnd("Structure.getAtomSet3"),e},eachSelectedAtom:function(t,e){var i=this.getAtomProxy(),r=this.getAtomSet3(e),n=this.atomStore.count;if(r&&r.size()<n)r.forEach(function(e){i.index=e,t(i)});else for(var o=0;n>o;++o)i.index=o,t(i)},eachAtom:function(t,e){if(e&&e.test)this.eachModel(function(i){i.eachAtom(t,e)},e);else for(var i=this.atomStore.count,r=this.getAtomProxy(),n=0;i>n;++n)r.index=n,t(r)},eachResidue:function(t,e){var i;if(e&&e.test){var r=this.modelStore.count,n=this.getModelProxy();if(e.modelOnlyTest){var o=e.modelOnlyTest;for(i=0;r>i;++i)n.index=i,o(n)&&n.eachResidue(t,e)}else for(i=0;r>i;++i)n.index=i,n.eachResidue(t,e)}else{var s=this.residueStore.count,a=this.getResidueProxy();for(i=0;s>i;++i)a.index=i,t(a)}},eachResidueN:function(t,e){var i,r,n=this.residueStore.count;if(!(t>n)){var o=new Array(t);for(i=0;t>i;++i)o[i]=this.getResidueProxy(i);for(e.apply(this,o),r=t;n>r;++r){for(i=0;t>i;++i)o[i].index+=1;e.apply(this,o)}}},eachPolymer:function(t,e){if(e&&e.modelOnlyTest){var i=e.modelOnlyTest;this.eachModel(function(r){i(r)&&r.eachPolymer(t,e)})}else this.eachModel(function(i){i.eachPolymer(t,e)})},eachChain:function(t,e){if(e&&e.test)this.eachModel(function(i){i.eachChain(t,e)});else for(var i=this.chainStore.count,r=this.getChainProxy(),n=0;i>n;++n)r.index=n,t(r)},eachModel:function(t,e){var i,r=this.modelStore.count,n=this.getModelProxy();if(e&&e.test){var o=e.modelOnlyTest;if(o)for(i=0;r>i;++i)n.index=i,o(n)&&t(n,e);else for(i=0;r>i;++i)n.index=i,t(n,e)}else for(i=0;r>i;++i)n.index=i,t(n)},getAtomData:function(t){var e=Object.assign({},t);e.colorParams&&(e.colorParams.structure=this.getStructure());var i,r,n,o,s,a,c,h=e.what,u=e.atomSet||this.atomSet,l={},d=this.getAtomProxy(),m=u.size();if(h&&!h.position||(o=new Float32Array(3*m),l.position=o),h&&!h.color||(s=new Float32Array(3*m),l.color=s,r=Fr.getScheme(e.colorParams)),!h||h.pickingColor){a=new Float32Array(3*m),l.pickingColor=a;var f=Object.assign(e.colorParams,{scheme:"picking"});n=Fr.getScheme(f)}return h&&!h.radius||(c=new Float32Array(m),l.radius=c,i=new k(e.radiusParams.radius,e.radiusParams.scale)),u.forEach(function(t,e){var h=3*e;d.index=t,o&&d.positionToArray(o,h),s&&r.atomColorToArray(d,s,h),a&&n.atomColorToArray(d,a,h),c&&(c[e]=i.atomRadius(d))}),l},getBondData:function(t){var e=Object.assign({},t);e.colorParams&&(e.colorParams.structure=this.getStructure());var i,r,n,o,s,a,c,h,u,l,d,m=e.what,f=e.bondSet||this.bondSet,p={},Y=this.getBondProxy();e.bondStore&&(Y.bondStore=e.bondStore);var X=this.getAtomProxy(),Z=this.getAtomProxy(),g=f.size();if(m&&!m.position||(o=new Float32Array(3*g),s=new Float32Array(3*g),p.position1=o,p.position2=s),m&&!m.color||(a=new Float32Array(3*g),c=new Float32Array(3*g),p.color1=a,p.color2=c,r=Fr.getScheme(e.colorParams)),!m||m.pickingColor){h=new Float32Array(3*g),u=new Float32Array(3*g),p.pickingColor1=h,p.pickingColor2=u;var v=Object.assign(e.colorParams,{scheme:"picking"});n=Fr.getScheme(v)}return m&&!m.radius||(i=new k(e.radiusParams.radius,e.radiusParams.scale)),m&&!m.radius||(l=new Float32Array(g),e.radius2?(d=new Float32Array(g),p.radius1=l,p.radius2=d):p.radius=l),f.forEach(function(t,e){var m=3*e;Y.index=t,X.index=Y.atomIndex1,Z.index=Y.atomIndex2,o&&(X.positionToArray(o,m),Z.positionToArray(s,m)),a&&(r.bondColorToArray(Y,1,a,m),r.bondColorToArray(Y,0,c,m)),h&&(n.bondColorToArray(Y,1,h,m),n.bondColorToArray(Y,0,u,m)),l&&(l[e]=i.atomRadius(X)),d&&(d[e]=i.atomRadius(Z))}),p},getBackboneAtomData:function(t){return t=Object.assign({atomSet:this.atomSetCache.__backbone},t),this.getAtomData(t)},getBackboneBondData:function(t){return t=Object.assign({bondSet:this.getBackboneBondSet(),bondStore:this.backboneBondStore},t),this.getBondData(t)},getRungAtomData:function(t){return t=Object.assign({atomSet:this.atomSetCache.__rung},t),this.getAtomData(t)},getRungBondData:function(t){return t=Object.assign({bondSet:this.getRungBondSet(),bondStore:this.rungBondStore},t),this.getBondData(t)},getBoundingBox:function(t){kr&&Ir.time("getBoundingBox");var e=new THREE.Box3,i=+(1/0),r=+(1/0),n=+(1/0),o=-(1/0),s=-(1/0),a=-(1/0);return this.eachSelectedAtom(function(t){var e=t.x,c=t.y,h=t.z;i>e&&(i=e),r>c&&(r=c),n>h&&(n=h),e>o&&(o=e),c>s&&(s=c),h>a&&(a=h)},t),e.min.set(i,r,n),e.max.set(o,s,a),kr&&Ir.timeEnd("getBoundingBox"),e},atomCenter:function(t){return t?this.getBoundingBox(t).center():this.center.clone()},getSequence:function(){var t=[],e=this.getResidueProxy();return this.eachSelectedAtom(function(i){e.index=i.residueIndex,i.index===e.traceAtomIndex&&t.push(e.getResname1())}),t},getAtomIndices:function(t){var e=[];return this.eachAtom(function(t){e.push(t.index)},t),e},atomIndex:function(){var t=0,e=new Float32Array(this.atomCount);return this.eachSelectedAtom(function(i){e[t]=i.index}),e},updatePosition:function(t){var e=0;this.eachSelectedAtom(function(i){i.positionFromArray(t,e),e+=3})},toJSON:function(){kr&&Ir.time("Structure.toJSON");var t,e={metadata:{version:.1,type:"Structure",generator:"StructureExporter"},name:this.name,path:this.path,title:this.title,id:this.id,biomolDict:{},helices:this.helices,sheets:this.sheets,unitcell:this.unitcell?this.unitcell.toJSON():void 0,frames:this.frames,boxes:this.boxes,center:this.center.toArray(),boundingBox:[this.boundingBox.min.toArray(),this.boundingBox.max.toArray()],bondStore:this.bondStore.toJSON(),backboneBondStore:this.backboneBondStore.toJSON(),rungBondStore:this.rungBondStore.toJSON(),atomStore:this.atomStore.toJSON(),residueStore:this.residueStore.toJSON(),chainStore:this.chainStore.toJSON(),modelStore:this.modelStore.toJSON(),bondSet:this.bondSet.toJSON(),atomSet:this.atomSet.toJSON(),atomSetDict:{},atomSetCache:{},atomMap:this.atomMap.toJSON(),residueMap:this.residueMap.toJSON()};for(t in this.biomolDict)e.biomolDict[t]=this.biomolDict[t].toJSON();for(t in this.atomSetDict)e.atomSetDict[t]=this.atomSetDict[t].toJSON();for(t in this.atomSetCache)e.atomSetCache[t]=this.atomSetCache[t].toJSON();return kr&&Ir.timeEnd("Structure.toJSON"),e},fromJSON:function(t){kr&&Ir.time("Structure.fromJSON"),this.name=t.name,this.path=t.path,this.title=t.title,this.id=t.id,this.biomolDict=t.biomolDict,this.helices=t.helices,this.sheets=t.sheets,t.unitcell&&(this.unitcell=(new N).fromJSON(t.unitcell)),this.frames=t.frames,this.boxes=t.boxes,this.center=(new THREE.Vector3).fromArray(t.center),this.boundingBox=new THREE.Box3((new THREE.Vector3).fromArray(t.boundingBox[0]),(new THREE.Vector3).fromArray(t.boundingBox[1])),this.bondStore.fromJSON(t.bondStore),this.backboneBondStore.fromJSON(t.backboneBondStore),this.rungBondStore.fromJSON(t.rungBondStore),this.atomStore.fromJSON(t.atomStore),this.residueStore.fromJSON(t.residueStore),this.chainStore.fromJSON(t.chainStore),this.modelStore.fromJSON(t.modelStore),this.bondSet.fromJSON(t.bondSet),this.atomSet.fromJSON(t.atomSet);var e,i;this.biomolDict={};for(e in t.biomolDict){var r=new M;this.biomolDict[e]=r.fromJSON(t.biomolDict[e])}this.atomSetDict={};for(e in t.atomSetDict)i=new TypedFastBitSet,this.atomSetDict[e]=i.fromJSON(t.atomSetDict[e]);this.atomSetCache={};for(e in t.atomSetCache)i=new TypedFastBitSet,this.atomSetCache[e]=i.fromJSON(t.atomSetCache[e]);return this.atomMap.fromJSON(t.atomMap),this.residueMap.fromJSON(t.residueMap),Nr.updateObject(this),kr&&Ir.timeEnd("Structure.fromJSON"),this},getTransferable:function(){var t=[];t.concat(this.bondStore.getTransferable()),t.concat(this.backboneBondStore.getTransferable()),t.concat(this.rungBondStore.getTransferable()),t.concat(this.atomStore.getTransferable()),t.concat(this.residueStore.getTransferable()),t.concat(this.chainStore.getTransferable()),t.concat(this.modelStore.getTransferable());var e,i,r;if(this.frames){var n=this.frames;for(i=this.frames.length,e=0;i>e;++e)t.push(n[e].buffer)}if(this.boxes){var o=this.boxes;for(i=this.boxes.length,e=0;i>e;++e)t.push(o[e].buffer)}t.concat(this.bondSet.getTransferable()),t.concat(this.atomSet.getTransferable());for(r in this.atomSetDict)t.concat(this.atomSetDict[r].getTransferable());for(r in this.atomSetCache)t.concat(this.atomSetCache[r].getTransferable());return t},dispose:function(){Nr.removeObject(this),this.frames&&(this.frames.length=0),this.boxes&&(this.boxes.length=0),this.bondStore.dispose(),this.backboneBondStore.dispose(),this.rungBondStore.dispose(),this.atomStore.dispose(),this.residueStore.dispose(),this.chainStore.dispose(),this.modelStore.dispose(),delete this.bondStore,delete this.atomStore,delete this.residueStore,delete this.chainStore,delete this.modelStore,delete this.frames,delete this.boxes,delete this.cif,delete this.bondSet,delete this.atomSet}},vt.prototype.getView=function(t){return new yt(this,t)},yt.prototype=Object.assign(Object.create(vt.prototype),{constructor:yt,type:"StructureView",init:function(){Object.defineProperties(this,{atomSetDict:{get:function(){return this.structure.atomSetDict}},bondStore:{get:function(){return this.structure.bondStore}},backboneBondStore:{get:function(){return this.structure.backboneBondStore}},rungBondStore:{get:function(){return this.structure.rungBondStore}},atomStore:{get:function(){return this.structure.atomStore}},residueStore:{get:function(){return this.structure.residueStore}},chainStore:{get:function(){return this.structure.chainStore}},modelStore:{get:function(){return this.structure.modelStore}},atomMap:{get:function(){return this.structure.atomMap}},residueMap:{get:function(){return this.structure.residueMap}}}),this._ap=this.getAtomProxy(),this._rp=this.getResidueProxy(),this._cp=this.getChainProxy(),this.selection&&this.selection.signals.stringChanged.add(function(t){this.refresh()},this),this.structure.signals.refreshed.add(this.refresh,this)},refresh:function(){kr&&Ir.time("StructureView.refresh"),this.atomSetCache={},this.atomSet=this.getAtomSet2(this.selection),this.structure.atomSet&&(kr&&Ir.time("StructureView.refresh#atomSet.intersection"),this.atomSet=this.atomSet.intersection(this.structure.atomSet),kr&&Ir.timeEnd("StructureView.refresh#atomSet.intersection")),this.bondSet=this.getBondSet(),kr&&Ir.time("StructureView.refresh#atomSetDict.new_intersection");for(var t in this.atomSetDict){var e=this.atomSetDict[t];this.atomSetCache["__"+t]=e.new_intersection(this.atomSet)}kr&&Ir.timeEnd("StructureView.refresh#atomSetDict.new_intersection"),kr&&Ir.time("StructureView.refresh#size"),this.atomCount=this.atomSet.size(),this.bondCount=this.bondSet.size(),kr&&Ir.timeEnd("StructureView.refresh#size"),this.boundingBox=this.getBoundingBox(),this.center=this.boundingBox.center(),kr&&Ir.timeEnd("StructureView.refresh"),this.signals.refreshed.dispatch()},getSelection:function(){var t=this.structure.getSelection();return t?new p(t.string&&this.selection.string?"( "+t.string+" ) AND ( "+this.selection.string+" )":t.string?t.string:this.selection.string?this.selection.string:""):this.selection},getStructure:function(){return this.structure.getStructure()},toJSON:function(){var t={metadata:{version:.1,type:"StructureView",generator:"StructureViewExporter"},structure:this.structure.toJSON(),atomSet:this.atomSet.toJSON(),bondSet:this.bondSet.toJSON(),atomCount:this.atomCount,bondCount:this.bondCount,atomSetCache:{}};for(var e in this.atomSetCache)t.atomSetCache[e]=this.atomSetCache[e].toJSON();return t},fromJSON:function(t){"Structure"===t.structure.metadata.type?this.structure=(new vt).fromJSON(t.structure):"StructureView"===t.structure.metadata.type&&(this.structure=(new yt).fromJSON(t.structure)),this.atomSet=(new TypedFastBitSet).fromJSON(t.atomSet),this.bondSet=(new TypedFastBitSet).fromJSON(t.bondSet),this.atomCount=t.atomCount,this.bondCount=t.bondCount,this.atomSetCache={};for(var e in t.atomSetCache){var i=new TypedFastBitSet;this.atomSetCache[e]=i.fromJSON(t.atomSetCache[e])}return this.init(),this},getTransferable:function(){var t=[];t.concat(this.structure.getTransferable()),t.concat(this.bondSet.getTransferable()),t.concat(this.atomSet.getTransferable());for(var e in this.atomSetCache)t.concat(this.atomSetCache[e].getTransferable());return t},dispose:function(){delete this.structure,delete this.atomSet,delete this.bondSet,delete this.atomCount,delete this.bondCount}}),bt.prototype={clear:function(){this.change(-this.count)},change:function(t){this.count+=t,this.signals.countChanged.dispatch(t,this.count),this.count<0&&Ir.warn("Counter.count below zero",this.count)},increment:function(){this.change(1)},decrement:function(){this.change(-1)},listen:function(t){this.change(t.count),t.signals.countChanged.add(function(t,e){this.change(t)}.bind(this))},onZeroOnce:function(t,e){if(0===this.count)t.call(e,0,0);else{var i=function(){0===this.count&&(this.signals.countChanged.remove(i,this),t.apply(e,arguments))};this.signals.countChanged.add(i,this)}},dispose:function(){this.clear()}};var qr="// Open-Source PyMOL is Copyright (C) Schrodinger, LLC.\n//\n//  All Rights Reserved\n//\n//  Permission to use, copy, modify, distribute, and distribute modified\n//  versions of this software and its built-in documentation for any\n//  purpose and without fee is hereby granted, provided that the above\n//  copyright notice appears in all copies and that both the copyright\n//  notice and this permission notice appear in supporting documentation,\n//  and that the name of Schrodinger, LLC not be used in advertising or\n//  publicity pertaining to distribution of the software without specific,\n//  written prior permission.\n//\n//  SCHRODINGER, LLC DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,\n//  INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN\n//  NO EVENT SHALL SCHRODINGER, LLC BE LIABLE FOR ANY SPECIAL, INDIRECT OR\n//  CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n//  OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n//  OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE\n//  USE OR PERFORMANCE OF THIS SOFTWARE.\n\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - dual color\n// - picking color\n// - shift\n\nattribute vec3 mapping;\nattribute vec3 position1;\nattribute vec3 position2;\nattribute float radius;\n\nvarying vec3 axis;\nvarying vec4 base_radius;\nvarying vec4 end_b;\nvarying vec3 U;\nvarying vec3 V;\nvarying vec4 w;\n\n#ifdef PICKING\n    attribute vec3 pickingColor;\n    attribute vec3 pickingColor2;\n    varying vec3 vPickingColor;\n    varying vec3 vPickingColor2;\n#else\n    // attribute vec3 color;\n    attribute vec3 color2;\n    varying vec3 vColor1;\n    varying vec3 vColor2;\n#endif\n\nuniform mat4 modelViewMatrixInverse;\nuniform float shift;\nuniform float ortho;\n\nvoid main(){\n\n    #ifdef PICKING\n        vPickingColor = pickingColor;\n        vPickingColor2 = pickingColor2;\n    #else\n        vColor1 = color;\n        vColor2 = color2;\n    #endif\n\n    // vRadius = radius;\n    base_radius.w = radius;\n\n    vec3 center = position;\n    vec3 dir = normalize( position2 - position1 );\n    float ext = length( position2 - position1 ) / 2.0;\n\n    // using cameraPosition fails on some machines, not sure why\n    // vec3 cam_dir = normalize( cameraPosition - mix( center, vec3( 0.0 ), ortho ) );\n    vec3 cam_dir;\n    if( ortho == 0.0 ){\n        cam_dir = ( modelViewMatrixInverse * vec4( 0, 0, 0, 1 ) ).xyz - center;\n    }else{\n        cam_dir = ( modelViewMatrixInverse * vec4( 0, 0, 1, 0 ) ).xyz;\n    }\n    cam_dir = normalize( cam_dir );\n\n    vec3 ldir;\n\n    float b = dot( cam_dir, dir );\n    end_b.w = b;\n    if( b < 0.0 ) // direction vector looks away, so flip\n        ldir = -ext * dir;\n    else // direction vector already looks in my direction\n        ldir = ext * dir;\n\n    vec3 left = normalize( cross( cam_dir, ldir ) );\n    vec3 leftShift = shift * left * radius;\n    if( b < 0.0 )\n        leftShift *= -1.0;\n    left = radius * left;\n    vec3 up = radius * normalize( cross( left, ldir ) );\n\n    // transform to modelview coordinates\n    axis = normalize( normalMatrix * ldir );\n    U = normalize( normalMatrix * up );\n    V = normalize( normalMatrix * left );\n\n    vec4 base4 = modelViewMatrix * vec4( center - ldir + leftShift, 1.0 );\n    base_radius.xyz = base4.xyz / base4.w;\n\n    vec4 top_position = modelViewMatrix * vec4( center + ldir + leftShift, 1.0 );\n    vec4 end4 = top_position;\n    end_b.xyz = end4.xyz / end4.w;\n\n    w = modelViewMatrix * vec4(\n        center + leftShift + mapping.x*ldir + mapping.y*left + mapping.z*up, 1.0\n    );\n\n    gl_Position = projectionMatrix * w;\n\n    // avoid clipping (1.0 seems to induce flickering with some drivers)\n    gl_Position.z = 0.99;\n\n}",Wr="#define STANDARD\n#define IMPOSTOR\n\n// Open-Source PyMOL is Copyright (C) Schrodinger, LLC.\n//\n//  All Rights Reserved\n//\n//  Permission to use, copy, modify, distribute, and distribute modified\n//  versions of this software and its built-in documentation for any\n//  purpose and without fee is hereby granted, provided that the above\n//  copyright notice appears in all copies and that both the copyright\n//  notice and this permission notice appear in supporting documentation,\n//  and that the name of Schrodinger, LLC not be used in advertising or\n//  publicity pertaining to distribution of the software without specific,\n//  written prior permission.\n//\n//  SCHRODINGER, LLC DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,\n//  INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN\n//  NO EVENT SHALL SCHRODINGER, LLC BE LIABLE FOR ANY SPECIAL, INDIRECT OR\n//  CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n//  OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n//  OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE\n//  USE OR PERFORMANCE OF THIS SOFTWARE.\n\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - dual color\n// - picking color\n// - custom clipping\n// - three.js lighting\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float nearClip;\nuniform mat4 projectionMatrix;\nuniform float ortho;\n\nvarying vec3 axis;\nvarying vec4 base_radius;\nvarying vec4 end_b;\nvarying vec3 U;\nvarying vec3 V;\nvarying vec4 w;\n\n#ifdef PICKING\n    uniform float objectId;\n    varying vec3 vPickingColor;\n    varying vec3 vPickingColor2;\n#else\n    varying vec3 vColor1;\n    varying vec3 vColor2;\n    #include common\n    #include fog_pars_fragment\n    #include bsdfs\n    #include ambient_pars\n    #include lights_pars\n    #include lights_physical_pars_fragment\n#endif\n\nbool interior = false;\n\nfloat distSq3( vec3 v3a, vec3 v3b ){\n\n    return (\n        ( v3a.x - v3b.x ) * ( v3a.x - v3b.x ) +\n        ( v3a.y - v3b.y ) * ( v3a.y - v3b.y ) +\n        ( v3a.z - v3b.z ) * ( v3a.z - v3b.z )\n    );\n\n}\n\n// round caps\n// http://sourceforge.net/p/pymol/code/HEAD/tree/trunk/pymol/data/shaders/cylinder.fs\n\n// void main2(void)\n// {\n//     #ifdef PICKING\n//         gl_FragColor = vec4( vPickingColor, 1.0 );\n//     #else\n//         gl_FragColor = vec4( vColor, 1.0 );\n//     #endif\n// }\n\n// Calculate depth based on the given camera position.\nfloat calcDepth( in vec3 cameraPos ){\n    vec2 clipZW = cameraPos.z * projectionMatrix[2].zw + projectionMatrix[3].zw;\n    return 0.5 + 0.5 * clipZW.x / clipZW.y;\n}\n\nfloat calcClip( vec3 cameraPos ){\n    return dot( vec4( cameraPos, 1.0 ), vec4( 0.0, 0.0, 1.0, nearClip - 0.5 ) );\n}\n\nvoid main(){\n\n    vec3 point = w.xyz / w.w;\n\n    // unpacking\n    vec3 base = base_radius.xyz;\n    float vRadius = base_radius.w;\n    vec3 end = end_b.xyz;\n    float b = end_b.w;\n\n    vec3 end_cyl = end;\n    vec3 surface_point = point;\n\n    vec3 ray_target = surface_point;\n    vec3 ray_origin = vec3(0.0);\n    vec3 ray_direction = mix(normalize(ray_origin - ray_target), vec3(0.0, 0.0, 1.0), ortho);\n    mat3 basis = mat3( U, V, axis );\n\n    vec3 diff = ray_target - 0.5 * (base + end_cyl);\n    vec3 P = diff * basis;\n\n    // angle (cos) between cylinder cylinder_axis and ray direction\n    float dz = dot( axis, ray_direction );\n\n    float radius2 = vRadius*vRadius;\n\n    // calculate distance to the cylinder from ray origin\n    vec3 D = vec3(dot(U, ray_direction),\n                dot(V, ray_direction),\n                dz);\n    float a0 = P.x*P.x + P.y*P.y - radius2;\n    float a1 = P.x*D.x + P.y*D.y;\n    float a2 = D.x*D.x + D.y*D.y;\n\n    // calculate a dicriminant of the above quadratic equation\n    float d = a1*a1 - a0*a2;\n    if (d < 0.0)\n        // outside of the cylinder\n        discard;\n\n    float dist = (-a1 + sqrt(d)) / a2;\n\n    // point of intersection on cylinder surface\n    vec3 new_point = ray_target + dist * ray_direction;\n\n    vec3 tmp_point = new_point - base;\n    vec3 _normal = normalize( tmp_point - axis * dot(tmp_point, axis) );\n\n    ray_origin = mix( ray_origin, surface_point, ortho );\n\n    // test front cap\n    float cap_test = dot( new_point - base, axis );\n\n    // to calculate caps, simply check the angle between\n    // the point of intersection - cylinder end vector\n    // and a cap plane normal (which is the cylinder cylinder_axis)\n    // if the angle < 0, the point is outside of cylinder\n    // test front cap\n\n    #ifndef CAP\n        vec3 new_point2 = ray_target + ( (-a1 - sqrt(d)) / a2 ) * ray_direction;\n        vec3 tmp_point2 = new_point2 - base;\n    #endif\n\n    // flat\n    if (cap_test < 0.0)\n    {\n        // ray-plane intersection\n        float dNV = dot(-axis, ray_direction);\n        if (dNV < 0.0)\n            discard;\n        float near = dot(-axis, (base)) / dNV;\n        new_point = ray_direction * near + ray_origin;\n        // within the cap radius?\n        if (dot(new_point - base, new_point-base) > radius2)\n            discard;\n\n        #ifdef CAP\n            _normal = axis;\n        #else\n            _normal = -normalize( tmp_point2 - axis * dot(tmp_point2, axis) );\n        #endif\n    }\n\n    // test end cap\n    cap_test = dot((new_point - end_cyl), axis);\n\n    // flat\n    if( cap_test > 0.0 )\n    {\n        // ray-plane intersection\n        float dNV = dot(axis, ray_direction);\n        if (dNV < 0.0)\n            discard;\n        float near = dot(axis, end_cyl) / dNV;\n        new_point = ray_direction * near + ray_origin;\n        // within the cap radius?\n        if( dot(new_point - end_cyl, new_point-base) > radius2 )\n            discard;\n\n        #ifdef CAP\n            _normal = axis;\n        #else\n            _normal = -normalize( tmp_point2 - axis * dot(tmp_point2, axis) );\n        #endif\n    }\n\n    gl_FragDepthEXT = calcDepth( new_point );\n\n    #ifdef NEAR_CLIP\n        if( calcClip( new_point ) > 0.0 ){\n            dist = (-a1 - sqrt(d)) / a2;\n            new_point = ray_target + dist * ray_direction;\n            if( calcClip( new_point ) > 0.0 )\n                discard;\n            interior = true;\n            gl_FragDepthEXT = calcDepth( new_point );\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = max( 0.0, calcDepth( vec3( - ( nearClip - 0.5 ) ) ) + ( 0.0000001 / vRadius ) );\n            }\n        }else if( gl_FragDepthEXT <= 0.0 ){\n            dist = (-a1 - sqrt(d)) / a2;\n            new_point = ray_target + dist * ray_direction;\n            interior = true;\n            gl_FragDepthEXT = calcDepth( new_point );\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / vRadius );\n            }\n        }\n    #else\n        if( gl_FragDepthEXT <= 0.0 ){\n            dist = (-a1 - sqrt(d)) / a2;\n            new_point = ray_target + dist * ray_direction;\n            interior = true;\n            gl_FragDepthEXT = calcDepth( new_point );\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / vRadius );\n            }\n        }\n    #endif\n\n    // this is a workaround necessary for Mac\n    // otherwise the modified fragment won't clip properly\n    if (gl_FragDepthEXT < 0.0)\n        discard;\n    if (gl_FragDepthEXT > 1.0)\n        discard;\n\n    #ifdef PICKING\n\n        if( distSq3( new_point, end_cyl ) < distSq3( new_point, base ) ){\n            if( b < 0.0 ){\n                gl_FragColor = vec4( vPickingColor, objectId );\n            }else{\n                gl_FragColor = vec4( vPickingColor2, objectId );\n            }\n        }else{\n            if( b > 0.0 ){\n                gl_FragColor = vec4( vPickingColor, objectId );\n            }else{\n                gl_FragColor = vec4( vPickingColor2, objectId );\n            }\n        }\n\n    #else\n\n        vec3 vViewPosition = -new_point;\n        vec3 vNormal = _normal;\n        vec3 vColor;\n\n        if( distSq3( new_point, end_cyl ) < distSq3( new_point, base ) ){\n            if( b < 0.0 ){\n                vColor = vColor1;\n            }else{\n                vColor = vColor2;\n            }\n        }else{\n            if( b > 0.0 ){\n                vColor = vColor1;\n            }else{\n                vColor = vColor2;\n            }\n        }\n\n        vec4 diffuseColor = vec4( diffuse, opacity );\n        ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n        vec3 totalEmissiveLight = emissive;\n\n        #include color_fragment\n        #include roughnessmap_fragment\n        #include metalnessmap_fragment\n\n        vec3 normal = normalize( vNormal );  // don't use #include normal_fragment\n        if( interior ){\n            normal = vec3( 0.0, 0.0, 0.4 );\n        }\n\n        #include lights_physical_fragment\n        #include lights_template\n\n        vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;\n\n        gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n        #include premultiplied_alpha_fragment\n        #include tonemapping_fragment\n        #include encodings_fragment\n        #include fog_fragment\n\n    #endif\n\n}",Jr="// Copyright (C) 2010-2011 by\n// Laboratoire de Biochimie Theorique (CNRS),\n// Laboratoire d'Informatique Fondamentale d'Orleans (Universite d'Orleans), (INRIA) and\n// Departement des Sciences de la Simulation et de l'Information (CEA).\n//\n// License: CeCILL-C license (http://www.cecill.info/)\n//\n// Contact: Marc Baaden\n// E-mail: baaden@smplinux.de\n// Webpage: http://hyperballs.sourceforge.net\n\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - dual color\n// - picking color\n\nattribute vec3 mapping;\nattribute float radius;\nattribute float radius2;\nattribute vec3 position1;\nattribute vec3 position2;\n\nvarying mat4 matrix_near;\nvarying vec4 prime1;\nvarying vec4 prime2;\nvarying float vRadius;\nvarying float vRadius2;\n\n#ifdef PICKING\n    attribute vec3 pickingColor;\n    attribute vec3 pickingColor2;\n    varying vec3 vPickingColor;\n    varying vec3 vPickingColor2;\n#else\n    // attribute vec3 color;\n    attribute vec3 color2;\n    varying vec3 vColor1;\n    varying vec3 vColor2;\n#endif\n\nuniform float shrink;\nuniform mat4 modelViewProjectionMatrix;\nuniform mat4 modelViewProjectionMatrixInverse;\n\nvoid main(){\n\n    vRadius = radius;\n    vRadius2 = radius2;\n\n    vec4 spaceposition;\n    vec3 position_atom1;\n    vec3 position_atom2;\n    vec4 vertex_position;\n\n    #ifdef PICKING\n        vPickingColor = pickingColor;\n        vPickingColor2 = pickingColor2;\n    #else\n        vColor1 = color;\n        vColor2 = color2;\n    #endif\n\n    float radius1 = radius;\n\n    position_atom1 = position1;\n    position_atom2 = position2;\n\n    float distance = distance( position_atom1, position_atom2 );\n\n    spaceposition.z = mapping.z * distance;\n\n    if (radius1 > radius2) {\n        spaceposition.y = mapping.y * 1.5 * radius1;\n        spaceposition.x = mapping.x * 1.5 * radius1;\n    } else {\n        spaceposition.y = mapping.y * 1.5 * radius2;\n        spaceposition.x = mapping.x * 1.5 * radius2;\n    }\n    spaceposition.w = 1.0;\n\n    vec4 e3 = vec4( 1.0 );\n    vec3 e1, e1_temp, e2, e2_temp;\n\n    // Calculation of bond direction: e3\n    e3.xyz = normalize(position_atom1-position_atom2);\n\n    // little hack to avoid some problems of precision due to graphic card limitation using float: To improve soon\n    if (e3.z == 0.0) { e3.z = 0.0000000000001;}\n    if ( (position_atom1.x - position_atom2.x) == 0.0) { position_atom1.x += 0.001;}\n    if ( (position_atom1.y - position_atom2.y) == 0.0) { position_atom1.y += 0.001;}\n    if ( (position_atom1.z - position_atom2.z) == 0.0) { position_atom1.z += 0.001;}\n\n    // Focus calculation\n    vec4 focus = vec4( 1.0 );\n    focus.x = ( position_atom1.x*position_atom1.x - position_atom2.x*position_atom2.x +\n        ( radius2*radius2 - radius1*radius1 )*e3.x*e3.x/shrink )/(2.0*(position_atom1.x - position_atom2.x));\n    focus.y = ( position_atom1.y*position_atom1.y - position_atom2.y*position_atom2.y +\n        ( radius2*radius2 - radius1*radius1 )*e3.y*e3.y/shrink )/(2.0*(position_atom1.y - position_atom2.y));\n    focus.z = ( position_atom1.z*position_atom1.z - position_atom2.z*position_atom2.z +\n        ( radius2*radius2 - radius1*radius1 )*e3.z*e3.z/shrink )/(2.0*(position_atom1.z - position_atom2.z));\n\n    // e1 calculation\n    e1.x = 1.0;\n    e1.y = 1.0;\n    e1.z = ( (e3.x*focus.x + e3.y*focus.y + e3.z*focus.z) - e1.x*e3.x - e1.y*e3.y)/e3.z;\n    e1_temp = e1 - focus.xyz;\n    e1 = normalize(e1_temp);\n\n    // e2 calculation\n    e2_temp = e1.yzx * e3.zxy - e1.zxy * e3.yzx;\n    e2 = normalize(e2_temp);\n\n    //ROTATION:\n    // final form of change of basis matrix:\n    mat3 R= mat3( e1.xyz, e2.xyz, e3.xyz );\n    // Apply rotation and translation to the bond primitive\n    vertex_position.xyz = R * spaceposition.xyz;\n    vertex_position.w = 1.0;\n\n    // TRANSLATION:\n    vertex_position.x += (position_atom1.x+position_atom2.x) / 2.0;\n    vertex_position.y += (position_atom1.y+position_atom2.y) / 2.0;\n    vertex_position.z += (position_atom1.z+position_atom2.z) / 2.0;\n\n    // New position\n    gl_Position = modelViewProjectionMatrix * vertex_position;\n\n    vec4 i_near, i_far;\n\n    // Calculate near from position\n    vec4 near = gl_Position;\n    near.z = 0.0 ;\n    near = modelViewProjectionMatrixInverse * near;\n    i_near = near;\n\n    // Calculate far from position\n    vec4 far = gl_Position;\n    far.z = far.w ;\n    i_far = modelViewProjectionMatrixInverse * far;\n\n    prime1 = vec4( position_atom1 - (position_atom1 - focus.xyz)*shrink, 1.0 );\n    prime2 = vec4( position_atom2 - (position_atom2 - focus.xyz)*shrink, 1.0 );\n\n    float Rsquare = (radius1*radius1/shrink) - (\n                        (position_atom1.x - focus.x)*(position_atom1.x - focus.x) +\n                        (position_atom1.y - focus.y)*(position_atom1.y - focus.y) +\n                        (position_atom1.z - focus.z)*(position_atom1.z - focus.z)\n                    );\n\n    focus.w = Rsquare;\n\n    matrix_near = mat4( i_near, i_far, focus, e3 );\n\n    // avoid clipping\n    gl_Position.z = 1.0;\n\n}",Kr="#define STANDARD\n#define IMPOSTOR\n\n// Copyright (C) 2010-2011 by\n// Laboratoire de Biochimie Theorique (CNRS),\n// Laboratoire d'Informatique Fondamentale d'Orleans (Universite d'Orleans), (INRIA) and\n// Departement des Sciences de la Simulation et de l'Information (CEA).\n//\n// License: CeCILL-C license (http://www.cecill.info/)\n//\n// Contact: Marc Baaden\n// E-mail: baaden@smplinux.de\n// Webpage: http://hyperballs.sourceforge.net\n\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - dual color\n// - picking color\n// - custom clipping\n// - three.js lighting\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float nearClip;\nuniform float shrink;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelViewProjectionMatrix;\nuniform mat4 modelViewMatrixInverseTranspose;\nuniform mat4 projectionMatrix;\n\nvarying mat4 matrix_near;\nvarying vec4 prime1;\nvarying vec4 prime2;\nvarying float vRadius;\nvarying float vRadius2;\n\n#ifdef PICKING\n    uniform float objectId;\n    varying vec3 vPickingColor;\n    varying vec3 vPickingColor2;\n#else\n    varying vec3 vColor1;\n    varying vec3 vColor2;\n    #include common\n    #include fog_pars_fragment\n    #include bsdfs\n    #include ambient_pars\n    #include lights_pars\n    #include lights_physical_pars_fragment\n#endif\n\nbool interior = false;\n\nfloat calcClip( vec4 cameraPos ){\n    return dot( cameraPos, vec4( 0.0, 0.0, 1.0, nearClip - 0.5 ) );\n}\n\nfloat calcClip( vec3 cameraPos ){\n    return calcClip( vec4( cameraPos, 1.0 ) );\n}\n\nfloat calcDepth( in vec3 cameraPos ){\n    vec2 clipZW = cameraPos.z * projectionMatrix[2].zw + projectionMatrix[3].zw;\n    return 0.5 + 0.5 * clipZW.x / clipZW.y;\n}\n\nstruct Ray {\n    vec3 origin ;\n    vec3 direction ;\n};\n\nbool cutoff_plane (vec3 M, vec3 cutoff, vec3 x3){\n    float a = x3.x;\n    float b = x3.y;\n    float c = x3.z;\n    float d = -x3.x*cutoff.x-x3.y*cutoff.y-x3.z*cutoff.z;\n    float l = a*M.x+b*M.y+c*M.z+d;\n    if (l<0.0) {return true;}\n    else{return false;}\n}\n\nvec3 isect_surf(Ray r, mat4 matrix_coef){\n    vec4 direction = vec4(r.direction, 0.0);\n    vec4 origin = vec4(r.origin, 1.0);\n    float a = dot(direction,(matrix_coef*direction));\n    float b = dot(origin,(matrix_coef*direction));\n    float c = dot(origin,(matrix_coef*origin));\n    float delta =b*b-a*c;\n    gl_FragColor.a = 1.0;\n    if (delta<0.0){\n        discard;\n        // gl_FragColor.a = 0.5;\n    }\n    float t1 =(-b-sqrt(delta))/a;\n\n    // Second solution not necessary if you don't want\n    // to see inside spheres and cylinders, save some fps\n    //float t2 = (-b+sqrt(delta)) / a  ;\n    //float t =(t1<t2) ? t1 : t2;\n\n    return r.origin+t1*r.direction;\n}\n\nvec3 isect_surf2(Ray r, mat4 matrix_coef){\n    vec4 direction = vec4(r.direction, 0.0);\n    vec4 origin = vec4(r.origin, 1.0);\n    float a = dot(direction,(matrix_coef*direction));\n    float b = dot(origin,(matrix_coef*direction));\n    float c = dot(origin,(matrix_coef*origin));\n    float delta =b*b-a*c;\n    gl_FragColor.a = 1.0;\n    if (delta<0.0){\n        discard;\n        // gl_FragColor.a = 0.5;\n    }\n    float t2 =(-b+sqrt(delta))/a;\n\n    return r.origin+t2*r.direction;\n}\n\nRay primary_ray(vec4 near1, vec4 far1){\n    vec3 near=near1.xyz/near1.w;\n    vec3 far=far1.xyz/far1.w;\n    return Ray(near,far-near);\n}\n\nfloat update_z_buffer(vec3 M, mat4 ModelViewP){\n    float  depth1;\n    vec4 Ms=(ModelViewP*vec4(M,1.0));\n    return depth1=(1.0+Ms.z/Ms.w)/2.0;\n}\n\nvoid main(){\n\n    float radius = max( vRadius, vRadius2 );\n\n    vec4 i_near, i_far, focus;\n    vec3 e3, e1, e1_temp, e2;\n\n    i_near = vec4(matrix_near[0][0],matrix_near[0][1],matrix_near[0][2],matrix_near[0][3]);\n    i_far  = vec4(matrix_near[1][0],matrix_near[1][1],matrix_near[1][2],matrix_near[1][3]);\n    focus = vec4(matrix_near[2][0],matrix_near[2][1],matrix_near[2][2],matrix_near[2][3]);\n    e3 = vec3(matrix_near[3][0],matrix_near[3][1],matrix_near[3][2]);\n\n    e1.x = 1.0;\n    e1.y = 1.0;\n    e1.z = ( (e3.x*focus.x + e3.y*focus.y + e3.z*focus.z) - e1.x*e3.x - e1.y*e3.y)/e3.z;\n    e1_temp = e1 - focus.xyz;\n    e1 = normalize(e1_temp);\n\n    e2 = normalize(cross(e1,e3));\n\n    vec4 equation = focus;\n\n    float shrinkfactor = shrink;\n    float t1 = -1.0/(1.0-shrinkfactor);\n    float t2 = 1.0/(shrinkfactor);\n    // float t3 = 2.0/(shrinkfactor);\n\n    vec4 colonne1, colonne2, colonne3, colonne4;\n    mat4 mat;\n\n    vec3 equation1 = vec3(t2,t2,t1);\n\n    float A1 = - e1.x*equation.x - e1.y*equation.y - e1.z*equation.z;\n    float A2 = - e2.x*equation.x - e2.y*equation.y - e2.z*equation.z;\n    float A3 = - e3.x*equation.x - e3.y*equation.y - e3.z*equation.z;\n\n    float A11 = equation1.x*e1.x*e1.x +  equation1.y*e2.x*e2.x + equation1.z*e3.x*e3.x;\n    float A21 = equation1.x*e1.x*e1.y +  equation1.y*e2.x*e2.y + equation1.z*e3.x*e3.y;\n    float A31 = equation1.x*e1.x*e1.z +  equation1.y*e2.x*e2.z + equation1.z*e3.x*e3.z;\n    float A41 = equation1.x*e1.x*A1   +  equation1.y*e2.x*A2   + equation1.z*e3.x*A3;\n\n    float A22 = equation1.x*e1.y*e1.y +  equation1.y*e2.y*e2.y + equation1.z*e3.y*e3.y;\n    float A32 = equation1.x*e1.y*e1.z +  equation1.y*e2.y*e2.z + equation1.z*e3.y*e3.z;\n    float A42 = equation1.x*e1.y*A1   +  equation1.y*e2.y*A2   + equation1.z*e3.y*A3;\n\n    float A33 = equation1.x*e1.z*e1.z +  equation1.y*e2.z*e2.z + equation1.z*e3.z*e3.z;\n    float A43 = equation1.x*e1.z*A1   +  equation1.y*e2.z*A2   + equation1.z*e3.z*A3;\n\n    float A44 = equation1.x*A1*A1 +  equation1.y*A2*A2 + equation1.z*A3*A3 - equation.w;\n\n    colonne1 = vec4(A11,A21,A31,A41);\n    colonne2 = vec4(A21,A22,A32,A42);\n    colonne3 = vec4(A31,A32,A33,A43);\n    colonne4 = vec4(A41,A42,A43,A44);\n\n    mat = mat4(colonne1,colonne2,colonne3,colonne4);\n\n    // Ray calculation using near and far\n    Ray ray = primary_ray(i_near,i_far) ;\n\n    // Intersection between ray and surface for each pixel\n    vec3 M;\n    M = isect_surf(ray, mat);\n\n    // cut the extremities of bonds to superimpose bond and spheres surfaces\n    if (cutoff_plane(M, prime1.xyz, -e3) || cutoff_plane(M, prime2.xyz, e3)){ discard; }\n\n    // Transform normal to model space to view-space\n    vec4 M1 = vec4(M,1.0);\n    vec4 M2 =  mat*M1;\n    // vec3 _normal = normalize( ( modelViewMatrixInverseTranspose * M2 ).xyz );\n    vec3 _normal = ( modelViewMatrixInverseTranspose * M2 ).xyz;\n\n    // Recalculate the depth in function of the new pixel position\n    gl_FragDepthEXT = update_z_buffer(M, modelViewProjectionMatrix) ;\n\n    #ifdef NEAR_CLIP\n        if( calcClip( modelViewMatrix * vec4( M, 1.0 ) ) > 0.0 ){\n            M = isect_surf2(ray, mat);\n            if( calcClip( modelViewMatrix * vec4( M, 1.0 ) ) > 0.0 )\n                discard;\n            interior = true;\n            gl_FragDepthEXT = update_z_buffer(M, modelViewProjectionMatrix) ;\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = max( 0.0, calcDepth( vec3( - ( nearClip - 0.5 ) ) ) + ( 0.0000001 / radius ) );\n            }\n        }else if( gl_FragDepthEXT <= 0.0 ){\n            M = isect_surf2(ray, mat);\n            interior = true;\n            gl_FragDepthEXT = update_z_buffer(M, modelViewProjectionMatrix);\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / radius );\n            }\n        }\n    #else\n        if( gl_FragDepthEXT <= 0.0 ){\n            M = isect_surf2(ray, mat);\n            interior = true;\n            gl_FragDepthEXT = update_z_buffer(M, modelViewProjectionMatrix) ;\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / radius );\n            }\n        }\n    #endif\n\n    // cut the extremities of bonds to superimpose bond and spheres surfaces\n    if (cutoff_plane(M, prime1.xyz, -e3) || cutoff_plane(M, prime2.xyz, e3)){ discard; }\n\n    if (gl_FragDepthEXT < 0.0)\n        discard;\n    if (gl_FragDepthEXT > 1.0)\n        discard;\n\n    // Mix the color bond in function of the two atom colors\n    float distance_ratio = ((M.x-prime2.x)*e3.x + (M.y-prime2.y)*e3.y +(M.z-prime2.z)*e3.z) /\n                                distance(prime2.xyz,prime1.xyz);\n\n    #ifdef PICKING\n\n        if( distance_ratio > 0.5 ){\n            gl_FragColor = vec4( vPickingColor, objectId );\n        }else{\n            gl_FragColor = vec4( vPickingColor2, objectId );\n        }\n\n    #else\n\n        vec3 vViewPosition = -( modelViewMatrix * vec4( M, 1.0 ) ).xyz;\n        vec3 vNormal = _normal;\n        vec3 vColor;\n\n        if( distance_ratio>0.5 ){\n            vColor = vColor1;\n        }else{\n            vColor = vColor2;\n        }\n\n        vec4 diffuseColor = vec4( diffuse, opacity );\n        ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n        vec3 totalEmissiveLight = emissive;\n\n        #include color_fragment\n        #include roughnessmap_fragment\n        #include metalnessmap_fragment\n\n        vec3 normal = normalize( vNormal );  // don't use #include normal_fragment\n        if( interior ){\n            normal = vec3( 0.0, 0.0, 0.4 );\n        }\n\n        #include lights_physical_fragment\n        #include lights_template\n\n        vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;\n\n        gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n        #include premultiplied_alpha_fragment\n        #include tonemapping_fragment\n        #include encodings_fragment\n        #include fog_fragment\n\n    #endif\n\n}",Qr="uniform float nearClip;\n\nvarying vec3 vViewPosition;\n\n#include color_pars_vertex\n\nvoid main(){\n\n    #include color_vertex\n    #include begin_vertex\n    #include project_vertex\n\n    vViewPosition = -mvPosition.xyz;\n\n    #include nearclip_vertex\n\n}",$r="uniform float opacity;\nuniform float nearClip;\n\nvarying vec3 vViewPosition;\n\n#include common\n#include color_pars_fragment\n#include fog_pars_fragment\n\nvoid main(){\n\n    #include nearclip_fragment\n\n    gl_FragColor = vec4( vColor, opacity );\n\n    #include premultiplied_alpha_fragment\n    #include tonemapping_fragment\n    #include encodings_fragment\n    #include fog_fragment\n\n}",tn="#define STANDARD\n\nuniform float nearClip;\n\n#if defined( NEAR_CLIP ) || ( !defined( PICKING ) && !defined( NOLIGHT ) )\n    varying vec3 vViewPosition;\n#endif\n\n#if defined( PICKING )\n    attribute vec3 pickingColor;\n    varying vec3 vPickingColor;\n#elif defined( NOLIGHT )\n    varying vec3 vColor;\n#else\n    #include color_pars_vertex\n    #ifndef FLAT_SHADED\n        varying vec3 vNormal;\n    #endif\n#endif\n\n#include common\n\nvoid main(){\n\n    #if defined( PICKING )\n        vPickingColor = pickingColor;\n    #elif defined( NOLIGHT )\n        vColor = color;\n    #else\n        #include color_vertex\n        #include beginnormal_vertex\n        #include defaultnormal_vertex\n        #ifndef FLAT_SHADED  // Normal computed with derivatives when FLAT_SHADED\n            vNormal = normalize( transformedNormal );\n        #endif\n    #endif\n\n    #include begin_vertex\n    #include project_vertex\n\n    #if defined( NEAR_CLIP ) || ( !defined( PICKING ) && !defined( NOLIGHT ) )\n        vViewPosition = -mvPosition.xyz;\n    #endif\n\n    #include nearclip_vertex\n\n}",en="#define STANDARD\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float nearClip;\n\n#if defined( NEAR_CLIP ) || ( !defined( PICKING ) && !defined( NOLIGHT ) )\n    varying vec3 vViewPosition;\n#endif\n\n#if defined( PICKING )\n    uniform float objectId;\n    varying vec3 vPickingColor;\n#elif defined( NOLIGHT )\n    varying vec3 vColor;\n#else\n    #ifndef FLAT_SHADED\n        varying vec3 vNormal;\n    #endif\n    #include common\n    #include color_pars_fragment\n    #include fog_pars_fragment\n    #include bsdfs\n    #include ambient_pars\n    #include lights_pars\n    #include lights_physical_pars_fragment\n#endif\n\nvoid main(){\n\n    #include nearclip_fragment\n\n    #if defined( PICKING )\n\n        gl_FragColor = vec4( vPickingColor, objectId );\n\n    #elif defined( NOLIGHT )\n\n        gl_FragColor = vec4( vColor, opacity );\n\n    #else\n\n        vec4 diffuseColor = vec4( diffuse, opacity );\n        ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n        vec3 totalEmissiveLight = emissive;\n\n        #include color_fragment\n        #include roughnessmap_fragment\n        #include metalnessmap_fragment\n        #include normal_fragment\n\n        #include dull_interior_fragment\n\n        #include lights_physical_fragment\n        #include lights_template\n\n        vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;\n\n        gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n        #include premultiplied_alpha_fragment\n        #include tonemapping_fragment\n        #include encodings_fragment\n        #include fog_fragment\n\n        #include opaque_back_fragment\n\n    #endif\n\n}",rn="uniform float nearClip;\nuniform float size;\nuniform float canvasHeight;\nuniform float pixelRatio;\n\nvarying vec3 vViewPosition;\n\n#include color_pars_vertex\n#include common\n\nvoid main(){\n\n    #include color_vertex\n    #include begin_vertex\n    #include project_vertex\n\n    #ifdef USE_SIZEATTENUATION\n        gl_PointSize = size * pixelRatio * ( ( canvasHeight / 2.0 ) / -mvPosition.z );\n    #else\n        gl_PointSize = size * pixelRatio;\n    #endif\n\n    vViewPosition = -mvPosition.xyz;\n\n    #include nearclip_vertex\n\n}",nn="uniform vec3 diffuse;\nuniform float opacity;\n\nvarying vec3 vViewPosition;\n\n#ifdef USE_MAP\n    uniform sampler2D map;\n#endif\n\n#include common\n#include color_pars_fragment\n#include fog_pars_fragment\n\nvoid main(){\n\n    vec3 outgoingLight = vec3( 0.0 );\n    vec4 diffuseColor = vec4( diffuse, 1.0 );\n\n    #ifdef USE_MAP\n        diffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n    #endif\n\n    #include color_fragment\n    #include alphatest_fragment\n\n    outgoingLight = diffuseColor.rgb;\n\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a * opacity );\n\n    #include premultiplied_alpha_fragment\n    #include tonemapping_fragment\n    #include encodings_fragment\n    #include fog_fragment\n\n}",on="varying vec2 vUv;\n\nvoid main() {\n\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}",sn="varying vec2 vUv;\n\nuniform sampler2D tForeground;\nuniform float scale;\n\nvoid main() {\n\n    vec4 foreground = texture2D( tForeground, vUv );\n    gl_FragColor = foreground * scale;\n\n}",an="#define STANDARD\n\nuniform float nearClip;\n\n#if defined( NEAR_CLIP ) || !defined( PICKING )\n    varying vec3 vViewPosition;\n#endif\n\nattribute vec3 dir;\nattribute float size;\n\n#ifdef PICKING\n    attribute vec3 pickingColor;\n    varying vec3 vPickingColor;\n#else\n    #include color_pars_vertex\n    #ifndef FLAT_SHADED\n        varying vec3 vNormal;\n    #endif\n#endif\n\n#include common\n\nvoid main(void){\n\n    #ifdef PICKING\n        vPickingColor = pickingColor;\n    #else\n        #include color_vertex\n        #include beginnormal_vertex\n        #include defaultnormal_vertex\n        #ifndef FLAT_SHADED  // Normal computed with derivatives when FLAT_SHADED\n            vNormal = normalize( transformedNormal );\n        #endif\n    #endif\n\n    #include begin_vertex\n\n    transformed += normalize( dir ) * size;\n\n    #include project_vertex\n\n    #if defined( NEAR_CLIP ) || !defined( PICKING )\n        vViewPosition = -mvPosition.xyz;\n    #endif\n\n    #include nearclip_vertex\n\n}",cn="uniform float nearClip;\nuniform float xOffset;\nuniform float yOffset;\nuniform float zOffset;\nuniform float ortho;\n\nvarying vec3 vViewPosition;\nvarying vec2 texCoord;\n\nattribute vec2 mapping;\nattribute vec2 inputTexCoord;\nattribute float inputSize;\n\n#include color_pars_vertex\n#include common\n\nvoid main(void){\n\n    #include color_vertex\n    texCoord = inputTexCoord;\n\n    vec3 pos = position;\n    if( ortho != 0.0 ){\n        pos += normalize( cameraPosition ) * zOffset;\n    }\n    vec4 cameraPos = modelViewMatrix * vec4( pos, 1.0 );\n    vec4 cameraCornerPos = vec4( cameraPos.xyz, 1.0 );\n    cameraCornerPos.xy += mapping * inputSize * 0.01;\n    cameraCornerPos.x += xOffset;\n    cameraCornerPos.y += yOffset;\n    if( ortho == 0.0 ){\n        cameraCornerPos.xyz += normalize( -cameraCornerPos.xyz ) * zOffset;\n    }\n\n    gl_Position = projectionMatrix * cameraCornerPos;\n\n    vViewPosition = -cameraCornerPos.xyz;\n\n    #include nearclip_vertex\n\n}",hn="uniform sampler2D fontTexture;\nuniform float opacity;\n\nvarying vec3 vViewPosition;\nvarying vec2 texCoord;\n\n#include common\n#include color_pars_fragment\n#include fog_pars_fragment\n\n#ifdef SDF\n    const float smoothness = 16.0;\n#else\n    const float smoothness = 256.0;\n#endif\nconst float gamma = 2.2;\n\nvoid main(){\n\n    // retrieve signed distance\n    float sdf = texture2D( fontTexture, texCoord ).a;\n\n    // perform adaptive anti-aliasing of the edges\n    float w = clamp(\n        smoothness * ( abs( dFdx( texCoord.x ) ) + abs( dFdy( texCoord.y ) ) ),\n        0.0,\n        0.5\n    );\n    float a = smoothstep( 0.5 - w, 0.5 + w, sdf );\n\n    // gamma correction for linear attenuation\n    a = pow( a, 1.0 / gamma );\n    if( a < 0.2 ) discard;\n    a *= opacity;\n\n    vec3 outgoingLight = vColor;\n\n    gl_FragColor = vec4( outgoingLight, a );\n\n    #include premultiplied_alpha_fragment\n    #include tonemapping_fragment\n    #include encodings_fragment\n    #include fog_fragment\n\n}",un='uniform mat4 projectionMatrixInverse;\nuniform float nearClip;\n\nvarying float vRadius;\nvarying float vRadiusSq;\nvarying vec3 vPoint;\nvarying vec3 vPointViewPosition;\n\nattribute vec2 mapping;\nattribute float radius;\n\n#ifdef PICKING\n    attribute vec3 pickingColor;\n    varying vec3 vPickingColor;\n#else\n    #include color_pars_vertex\n#endif\n\nconst mat4 D = mat4(\n    1.0, 0.0, 0.0, 0.0,\n    0.0, 1.0, 0.0, 0.0,\n    0.0, 0.0, 1.0, 0.0,\n    0.0, 0.0, 0.0, -1.0\n);\n\nmat4 transpose( in mat4 inMatrix ) {\n    vec4 i0 = inMatrix[0];\n    vec4 i1 = inMatrix[1];\n    vec4 i2 = inMatrix[2];\n    vec4 i3 = inMatrix[3];\n\n    mat4 outMatrix = mat4(\n        vec4(i0.x, i1.x, i2.x, i3.x),\n        vec4(i0.y, i1.y, i2.y, i3.y),\n        vec4(i0.z, i1.z, i2.z, i3.z),\n        vec4(i0.w, i1.w, i2.w, i3.w)\n    );\n    return outMatrix;\n}\n\n//------------------------------------------------------------------------------\n// Compute point size and center using the technique described in:\n// "GPU-Based Ray-Casting of Quadratic Surfaces"\n// by Christian Sigg, Tim Weyrich, Mario Botsch, Markus Gross.\n//\n// Code based on\n/*=========================================================================\n\n Program:   Visualization Toolkit\n Module:    Quadrics_fs.glsl and Quadrics_vs.glsl\n\n Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n All rights reserved.\n See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n This software is distributed WITHOUT ANY WARRANTY; without even\n the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n PURPOSE.  See the above copyright notice for more information.\n\n =========================================================================*/\n\n// .NAME Quadrics_fs.glsl and Quadrics_vs.glsl\n// .SECTION Thanks\n// <verbatim>\n//\n//  This file is part of the PointSprites plugin developed and contributed by\n//\n//  Copyright (c) CSCS - Swiss National Supercomputing Centre\n//                EDF - Electricite de France\n//\n//  John Biddiscombe, Ugo Varetto (CSCS)\n//  Stephane Ploix (EDF)\n//\n// </verbatim>\n//\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - adapted to work with quads\nvoid ComputePointSizeAndPositionInClipCoordSphere(){\n\n    vec2 xbc;\n    vec2 ybc;\n\n    mat4 T = mat4(\n        radius, 0.0, 0.0, 0.0,\n        0.0, radius, 0.0, 0.0,\n        0.0, 0.0, radius, 0.0,\n        position.x, position.y, position.z, 1.0\n    );\n\n    mat4 R = transpose( projectionMatrix * modelViewMatrix * T );\n    float A = dot( R[ 3 ], D * R[ 3 ] );\n    float B = -2.0 * dot( R[ 0 ], D * R[ 3 ] );\n    float C = dot( R[ 0 ], D * R[ 0 ] );\n    xbc[ 0 ] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    xbc[ 1 ] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    float sx = abs( xbc[ 0 ] - xbc[ 1 ] ) * 0.5;\n\n    A = dot( R[ 3 ], D * R[ 3 ] );\n    B = -2.0 * dot( R[ 1 ], D * R[ 3 ] );\n    C = dot( R[ 1 ], D * R[ 1 ] );\n    ybc[ 0 ] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    ybc[ 1 ] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    float sy = abs( ybc[ 0 ] - ybc[ 1 ]  ) * 0.5;\n\n    gl_Position.xy = vec2( 0.5 * ( xbc.x + xbc.y ), 0.5 * ( ybc.x + ybc.y ) );\n    gl_Position.xy -= mapping * vec2( sx, sy );\n    gl_Position.xy *= gl_Position.w;\n\n}\n\nvoid main(void){\n\n    #ifdef PICKING\n        vPickingColor = pickingColor;\n    #else\n        #include color_vertex\n    #endif\n\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    mvPosition.z -= radius;  // avoid clipping, added again in fragment shader\n\n    gl_Position = projectionMatrix * vec4( mvPosition.xyz, 1.0 );\n    ComputePointSizeAndPositionInClipCoordSphere();\n\n    vRadius = radius;\n    vRadiusSq = radius * radius;\n    vec4 vPoint4 = projectionMatrixInverse * gl_Position;\n    vPoint = vPoint4.xyz / vPoint4.w;\n    vPointViewPosition = -mvPosition.xyz / mvPosition.w;\n\n}',ln='#define STANDARD\n#define IMPOSTOR\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float nearClip;\nuniform mat4 projectionMatrix;\nuniform float ortho;\n\n// uniform vec3 specular;\n// uniform float shininess;\n\nvarying float vRadius;\nvarying float vRadiusSq;\nvarying vec3 vPoint;\nvarying vec3 vPointViewPosition;\n\n#ifdef PICKING\n    uniform float objectId;\n    varying vec3 vPickingColor;\n#else\n    #include common\n    #include color_pars_fragment\n    #include fog_pars_fragment\n    #include bsdfs\n    #include ambient_pars\n    #include lights_pars\n    // #include lights_phong_pars_fragment\n    #include lights_physical_pars_fragment\n#endif\n\nbool flag2 = false;\nbool interior = false;\nvec3 cameraPos;\nvec3 cameraNormal;\n\n// vec4 poly_color = gl_Color;\n//   if(uf_use_border_hinting == 1.0)\n//   {\n//     vec3 wc_eye_dir = normalize(wc_sp_pt);\n//     float n_dot_e   = abs(dot(wc_sp_nrml,wc_eye_dir));\n//     float alpha     = max(uf_border_color_start_cosine - n_dot_e,0.0)/uf_border_color_start_cosine;\n//     poly_color      = mix(gl_Color,uf_border_color,0.75*alpha);\n//   }\n//   color += (diff + amb)*poly_color + spec*gl_FrontMaterial.specular;\n\n// Calculate depth based on the given camera position.\nfloat calcDepth( in vec3 cameraPos ){\n    vec2 clipZW = cameraPos.z * projectionMatrix[2].zw + projectionMatrix[3].zw;\n    return 0.5 + 0.5 * clipZW.x / clipZW.y;\n}\n\nfloat calcClip( vec3 cameraPos ){\n    return dot( vec4( cameraPos, 1.0 ), vec4( 0.0, 0.0, 1.0, nearClip - 0.5 ) );\n}\n\nbool Impostor( out vec3 cameraPos, out vec3 cameraNormal ){\n\n    vec3 cameraSpherePos = -vPointViewPosition;\n    cameraSpherePos.z += vRadius;\n\n    vec3 rayOrigin = mix( vec3( 0.0, 0.0, 0.0 ), vPoint, ortho );\n    vec3 rayDirection = mix( normalize( vPoint ), vec3( 0.0, 0.0, 1.0 ), ortho );\n    vec3 cameraSphereDir = mix( cameraSpherePos, rayOrigin - cameraSpherePos, ortho );\n\n    float B = dot( rayDirection, cameraSphereDir );\n    float det = B * B + vRadiusSq - dot( cameraSphereDir, cameraSphereDir );\n\n    if( det < 0.0 ){\n        discard;\n        return false;\n    }else{\n        float sqrtDet = sqrt( det );\n        float posT = mix( B + sqrtDet, B + sqrtDet, ortho );\n        float negT = mix( B - sqrtDet, sqrtDet - B, ortho );\n\n        cameraPos = rayDirection * negT + rayOrigin;\n\n        #ifdef NEAR_CLIP\n            if( calcDepth( cameraPos ) <= 0.0 ){\n                cameraPos = rayDirection * posT + rayOrigin;\n                interior = true;\n                return false;\n            }else if( calcClip( cameraPos ) > 0.0 ){\n                cameraPos = rayDirection * posT + rayOrigin;\n                interior = true;\n                flag2 = true;\n                return false;\n            }else{\n                cameraNormal = normalize( -cameraPos - cameraSpherePos );\n            }\n        #else\n            if( calcDepth( cameraPos ) <= 0.0 ){\n                cameraPos = rayDirection * posT + rayOrigin;\n                interior = true;\n                return false;\n            }else{\n                cameraNormal = normalize( cameraPos - cameraSpherePos );\n            }\n        #endif\n\n        return true;\n    }\n\n    return false; // ensure that each control flow has a return\n\n}\n\nvoid main(void){\n\n    // vec3 specular = vec3( 1.0, 1.0, 1.0 );\n    // float specularStrength = 1.0;\n    // float shininess = 1.0;\n\n    bool flag = Impostor( cameraPos, cameraNormal );\n\n    #ifdef NEAR_CLIP\n        if( calcClip( cameraPos ) > 0.0 )\n            discard;\n    #endif\n\n    // FIXME not compatible with custom clipping plane\n    //Set the depth based on the new cameraPos.\n    gl_FragDepthEXT = calcDepth( cameraPos );\n    if( !flag ){\n\n        // clamp to near clipping plane and add a tiny value to\n        // make spheres with a greater radius occlude smaller ones\n        #ifdef NEAR_CLIP\n            if( flag2 ){\n                gl_FragDepthEXT = max( 0.0, calcDepth( vec3( - ( nearClip - 0.5 ) ) ) + ( 0.0000001 / vRadius ) );\n            }else if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / vRadius );\n            }\n        #else\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / vRadius );\n            }\n        #endif\n\n    }\n\n    // bugfix (mac only?)\n    if (gl_FragDepthEXT < 0.0)\n        discard;\n    if (gl_FragDepthEXT > 1.0)\n        discard;\n\n    #ifdef PICKING\n\n        gl_FragColor = vec4( vPickingColor, objectId );\n\n    #else\n\n        // vec3 specColor = vColor;  // vec3( 1.0, 1.0, 1.0 );\n        // vec3 lightDir = vec3( 0.0, 0.0, 1.0 );\n        // vec3 vNormal = cameraNormal;\n\n        // float lambertian = max(dot(lightDir,vNormal), 0.0);\n        // float specular = 0.0;\n\n        // if(lambertian > 0.0) {\n\n        //     vec3 reflectDir = reflect(-lightDir, vNormal);\n        //     vec3 viewDir = normalize(-cameraPos);\n\n        //     float specAngle = max(dot(reflectDir, viewDir), 0.0);\n        //     specular = pow(specAngle, 4.0);\n\n        //     // the exponent controls the shininess (try mode 2)\n        //     specular = pow(specAngle, 16.0);\n\n        //     // according to the rendering equation we would need to multiply\n        //     // with the the "lambertian", but this has little visual effect\n        //     specular *= lambertian;\n\n\n        // }\n\n        // gl_FragColor = vec4( lambertian*vColor + specular*specColor, opacity );\n\n        //\n\n        vec3 vNormal = cameraNormal;\n        vec3 vViewPosition = -cameraPos;\n\n        vec4 diffuseColor = vec4( diffuse, opacity );\n        ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n        vec3 totalEmissiveLight = emissive;\n\n        #include color_fragment\n        #include roughnessmap_fragment\n        #include metalnessmap_fragment\n        #include normal_fragment\n        if( interior ){\n            normal = vec3( 0.0, 0.0, 0.4 );\n        }\n\n        // #include lights_phong_fragment\n        #include lights_physical_fragment\n        #include lights_template\n\n        vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;\n\n        gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n        #include premultiplied_alpha_fragment\n        #include tonemapping_fragment\n        #include encodings_fragment\n        #include fog_fragment\n\n    #endif\n\n}',dn="#ifdef DULL_INTERIOR\n    if( gl_FrontFacing == false ){\n        normal = vec3( 0.0, 0.0, 0.4 );\n    }\n#endif",mn="#ifdef USE_FOG\n\n	// #if defined( USE_LOGDEPTHBUF_EXT ) || defined( IMPOSTOR )\n	//\n	// 	float depth = gl_FragDepthEXT / gl_FragCoord.w;\n	//\n	// #else\n	//\n	// 	float depth = gl_FragCoord.z / gl_FragCoord.w;\n	//\n	// #endif\n\n	float depth = length( vViewPosition );\n\n	#ifdef FOG_EXP2\n\n		float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\n	#else\n\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n	#endif\n\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\n#endif",fn="#ifdef NEAR_CLIP\n    if( vViewPosition.z < nearClip )\n        discard;\n#endif",pn="#ifdef NEAR_CLIP\n    if( vViewPosition.z < nearClip )\n        gl_Position.z = 2.0 * gl_Position.w;  // move out of [ -w, +w ]\n#endif",Yn="#ifdef OPAQUE_BACK\n    #ifdef FLIP_SIDED\n        if( gl_FrontFacing == true ){\n            gl_FragColor.a = 1.0;\n        }\n    #else\n        if( gl_FrontFacing == false ){\n            gl_FragColor.a = 1.0;\n        }\n    #endif\n#endif",Xn={
"shader/CylinderImpostor.vert":qr,"shader/CylinderImpostor.frag":Wr,"shader/HyperballStickImpostor.vert":Jr,"shader/HyperballStickImpostor.frag":Kr,"shader/Line.vert":Qr,"shader/Line.frag":$r,"shader/Mesh.vert":tn,"shader/Mesh.frag":en,"shader/Point.vert":rn,"shader/Point.frag":nn,"shader/Quad.vert":on,"shader/Quad.frag":sn,"shader/Ribbon.vert":an,"shader/SDFFont.vert":cn,"shader/SDFFont.frag":hn,"shader/SphereImpostor.vert":un,"shader/SphereImpostor.frag":ln,"shader/chunk/dull_interior_fragment.glsl":dn,"shader/chunk/fog_fragment.glsl":mn,"shader/chunk/nearclip_fragment.glsl":fn,"shader/chunk/nearclip_vertex.glsl":pn,"shader/chunk/opaque_back_fragment.glsl":Yn},Zn=/^(?!\/\/)\s*#include\s+(\S+)/gim,gn={};wt.prototype={init:function(){this.antialias&&(this.factor*=2),this.n=this.factor*this.factor;var t=document.createElement("canvas");t.style.display="hidden",document.body.appendChild(t),this.antialias?(t.width=this.viewer.width*this.factor/2,t.height=this.viewer.height*this.factor/2):(t.width=this.viewer.width*this.factor,t.height=this.viewer.height*this.factor),this.ctx=t.getContext("2d"),this.canvas=t,this.viewerSampleLevel=this.viewer.sampleLevel,this.viewer.sampleLevel=-1},renderTile:function(t){var e=this.factor,i=t%e,r=Math.floor(t/e),n=this.viewer.width,o=this.viewer.height,s=i*n,a=r*o;this.viewer.camera.setViewOffset(n*e,o*e,s,a,n,o),this.viewer.render(),this.antialias?this.ctx.drawImage(this.renderer.domElement,Math.floor(s/2),Math.floor(a/2),Math.ceil(n/2),Math.ceil(o/2)):this.ctx.drawImage(this.renderer.domElement,Math.floor(s),Math.floor(a),Math.ceil(n),Math.ceil(o)),"function"==typeof this.onProgress&&this.onProgress(t+1,this.n,!1)},finalize:function(){this.viewer.sampleLevel=this.viewerSampleLevel,this.viewer.camera.view=null,"function"==typeof this.onFinish&&this.onFinish(this.n+1,this.n,!1)},render:function(){for(var t=this.n,e=0;t>=e;++e)e===t?this.finalize():this.renderTile(e)},renderAsync:function(){function t(){n===e?r():i(n),n+=1}for(var e=this.n,i=this.renderTile.bind(this),r=this.finalize.bind(this),n=0,o=0;e>=o;++o)setTimeout(t,0,o)},dispose:function(){document.body.removeChild(this.canvas)}};var vn=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];vn.forEach(function(t){t.forEach(function(t){t[0]*=.0625,t[1]*=.0625})}),THREE.OrthographicCamera.prototype.setViewOffset=function(t,e,i,r,n,o){this.view={fullWidth:t,fullHeight:e,offsetX:i,offsetY:r,width:n,height:o},this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,n=i-t,o=i+t,s=r+e,a=r-e;if(this.view){var c=this.zoom/(this.view.width/this.view.fullWidth),h=this.zoom/(this.view.height/this.view.fullHeight);n+=this.view.offsetX/c,o=n+this.view.width/c,s-=this.view.offsetY/h,a=s-this.view.height/h}this.projectionMatrix.makeOrthographic(n,o,s,a,this.near,this.far)},Ct.prototype={update:function(){this.startTime=this.end(),this.signals.updated.dispatch()},begin:function(){this.startTime=performance.now(),this.lastFrames=this.frames},end:function(){var t=performance.now();return this.count+=1,this.frames+=1,this.lastDuration=t-this.startTime,this.minDuration=Math.min(this.minDuration,this.lastDuration),this.maxDuration=Math.max(this.maxDuration,this.lastDuration),this.avgDuration-=this.avgDuration/30,this.avgDuration+=this.lastDuration/30,t>this.prevFpsTime+1e3&&(this.lastFps=this.frames,this.prevFpsTime=t,this.frames=0),t}},_t.prototype={constructor:_t,initParams:function(){this.params={fogColor:new THREE.Color(0),fogNear:50,fogFar:100,backgroundColor:new THREE.Color(0),cameraType:"perspective",cameraFov:40,cameraZ:-80,clipNear:0,clipFar:100,clipDist:10,spinAxis:null,spinAngle:.01,lightColor:new THREE.Color(14540253),lightIntensity:1,ambientColor:new THREE.Color(14540253),ambientIntensity:.2,holdRendering:!1,sampleLevel:0}},initCamera:function(){var t=this.params,e=new THREE.Vector3(0,0,0);this.perspectiveCamera=new THREE.PerspectiveCamera(t.cameraFov,this.width/this.height,.1,1e4),this.perspectiveCamera.position.z=t.cameraZ,this.perspectiveCamera.lookAt(e),this.orthographicCamera=new THREE.OrthographicCamera(this.width/-2,this.width/2,this.height/2,this.height/-2,.1,1e4),this.orthographicCamera.position.z=t.cameraZ,this.orthographicCamera.lookAt(e),"orthographic"===t.cameraType?this.camera=this.orthographicCamera:this.camera=this.perspectiveCamera,this.camera.updateProjectionMatrix()},initRenderer:function(){try{this.renderer=new THREE.WebGLRenderer({preserveDrawingBuffer:!0,alpha:!0,antialias:!0})}catch(t){return this.container.innerHTML=Mr,!1}this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.autoClear=!1,this.renderer.sortObjects=!0,this.extensionFragDepth=this.renderer.extensions.get("EXT_frag_depth"),this.indexUint16=!this.renderer.extensions.get("OES_element_index_uint"),this.supportsReadPixelsFloat="Chrome"===Tr&&this.renderer.extensions.get("OES_texture_float")||this.renderer.extensions.get("OES_texture_float")&&this.renderer.extensions.get("WEBGL_color_buffer_float"),this.container.appendChild(this.renderer.domElement),this.renderer.extensions.get("OES_texture_float"),this.supportsHalfFloat=this.renderer.extensions.get("OES_texture_half_float"),this.renderer.extensions.get("WEBGL_color_buffer_float"),this.pickingTarget=new THREE.WebGLRenderTarget(this.width*window.devicePixelRatio,this.height*window.devicePixelRatio,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,stencilBuffer:!1,format:THREE.RGBAFormat,type:this.supportsReadPixelsFloat?THREE.FloatType:THREE.UnsignedByteType}),this.pickingTarget.texture.generateMipmaps=!1,this.sampleTarget=new THREE.WebGLRenderTarget(this.width*window.devicePixelRatio,this.height*window.devicePixelRatio,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat}),this.holdTarget=new THREE.WebGLRenderTarget(this.width*window.devicePixelRatio,this.height*window.devicePixelRatio,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,type:this.supportsHalfFloat?THREE.HalfFloatType:THREE.FloatType}),this.compositeUniforms={tForeground:{type:"t",value:null},scale:{type:"f",value:1}},this.compositeMaterial=new THREE.ShaderMaterial({uniforms:this.compositeUniforms,vertexShader:St("Quad.vert"),fragmentShader:St("Quad.frag"),premultipliedAlpha:!0,transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1}),this.compositeCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.compositeScene=(new THREE.Scene).add(new THREE.Mesh(new THREE.PlaneGeometry(2,2),this.compositeMaterial))},initScene:function(){this.scene||(this.scene=new THREE.Scene),this.rotationGroup=new THREE.Group,this.rotationGroup.name="rotationGroup",this.scene.add(this.rotationGroup),this.modelGroup=new THREE.Group,this.modelGroup.name="modelGroup",this.rotationGroup.add(this.modelGroup),this.pickingGroup=new THREE.Group,this.pickingGroup.name="pickingGroup",this.rotationGroup.add(this.pickingGroup),this.backgroundGroup=new THREE.Group,this.backgroundGroup.name="backgroundGroup",this.rotationGroup.add(this.backgroundGroup),this.helperGroup=new THREE.Group,this.helperGroup.name="helperGroup",this.rotationGroup.add(this.helperGroup),this.modelGroup.fog=new THREE.Fog,this.pointLight=new THREE.SpotLight(this.params.lightColor,this.params.lightIntensity),this.modelGroup.add(this.pointLight),this.ambientLight=new THREE.AmbientLight(this.params.ambientLight,this.params.ambientIntensity),this.modelGroup.add(this.ambientLight)},initHelper:function(){var t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),e=new Float32Array(24),i=new THREE.BufferGeometry;i.setIndex(new THREE.BufferAttribute(t,1)),i.addAttribute("position",new THREE.BufferAttribute(e,3));var r=new THREE.LineBasicMaterial({color:"skyblue",linewidth:2});this.boundingBoxMesh=new THREE.LineSegments(i,r),this.helperGroup.add(this.boundingBoxMesh)},updateHelper:function(){var t=this.boundingBoxMesh.geometry.attributes.position,e=t.array,i=this.boundingBox,r=i.min,n=i.max;e[0]=n.x,e[1]=n.y,e[2]=n.z,e[3]=r.x,e[4]=n.y,e[5]=n.z,e[6]=r.x,e[7]=r.y,e[8]=n.z,e[9]=n.x,e[10]=r.y,e[11]=n.z,e[12]=n.x,e[13]=n.y,e[14]=r.z,e[15]=r.x,e[16]=n.y,e[17]=r.z,e[18]=r.x,e[19]=r.y,e[20]=r.z,e[21]=n.x,e[22]=r.y,e[23]=r.z,t.needsUpdate=!0,i.isEmpty()||this.boundingBoxMesh.geometry.computeBoundingSphere()},initControls:function(){function t(t){t.preventDefault()}this.renderer.domElement.addEventListener("mousewheel",t,!1),this.renderer.domElement.addEventListener("MozMousePixelScroll",t,!1),this.renderer.domElement.addEventListener("touchmove",t,!1),this.controls=new THREE.TrackballControls(this.camera,this.renderer.domElement),this.controls.rotateSpeed=2,this.controls.zoomSpeed=1.2,this.controls.panSpeed=.8,this.controls.staticMoving=!0,this.controls.keys=[65,83,68],this.controls.addEventListener("change",this.requestRender.bind(this)),document.addEventListener("mousemove",this.controls.update.bind(this.controls),!1),document.addEventListener("touchmove",this.controls.update.bind(this.controls),!1),this.controls.addEventListener("change",function(){this.signals.orientationChanged.dispatch()}.bind(this),!1)},initStats:function(){this.stats=new Ct},add:function(t,e){e?e.forEach(function(e){this.addBuffer(t,e)},this):this.addBuffer(t),t.background?(this.backgroundGroup.add(t.group),this.backgroundGroup.add(t.wireframeGroup)):(this.modelGroup.add(t.group),this.modelGroup.add(t.wireframeGroup)),t.pickable&&this.pickingGroup.add(t.pickingGroup),this.rotationGroup.updateMatrixWorld(),kr&&this.updateHelper()},addBuffer:function(t,e){var i=t.getMesh();i.userData.buffer=t,e&&(i.applyMatrix(e.matrix),i.userData.instance=e),t.group.add(i);var r=t.getWireframeMesh();if(r.userData.buffer=t,e&&(r.matrix.copy(i.matrix),r.position.copy(i.position),r.quaternion.copy(i.quaternion),r.scale.copy(i.scale),r.userData.instance=e),t.wireframeGroup.add(r),t.pickable){var n=t.getPickingMesh();n.userData.buffer=t,e&&(n.matrix.copy(i.matrix),n.position.copy(i.position),n.quaternion.copy(i.quaternion),n.scale.copy(i.scale),n.userData.instance=e),t.pickingGroup.add(n)}e?this.updateBoundingBox(t.geometry,e.matrix):this.updateBoundingBox(t.geometry)},remove:function(t){this.rotationGroup.children.forEach(function(e){e.remove(t.group),e.remove(t.wireframeGroup)}),t.pickable&&this.pickingGroup.remove(t.pickingGroup),this.updateBoundingBox(),kr&&this.updateHelper()},updateBoundingBox:function(t,e){function i(t,e){0!==t.attributes.position.count&&(t.boundingBox||t.computeBoundingBox(),e?(n=t.boundingBox.clone(),n.applyMatrix4(e)):n=t.boundingBox,n.min.equals(n.max)&&n.expandByScalar(5),o.expandByPoint(n.min),o.expandByPoint(n.max))}function r(t){if(void 0!==t.geometry){var e;t.userData.instance&&(e=t.userData.instance.matrix),i(t.geometry,e)}}var n,o=this.boundingBox;t?i(t,e):(o.makeEmpty(),this.modelGroup.traverse(r),this.backgroundGroup.traverse(r)),this.controls.maxDistance=10*o.size().length()},getImage:function(){var t=this.renderer;return new Promise(function(e,i){t.domElement.toBlob(e,"image/png")})},makeImage:function(t){return At(this,t)},setLight:function(t,e,i,r){var n=this.params;void 0!==t&&n.lightColor.set(t),void 0!==e&&(n.lightIntensity=e),void 0!==i&&n.ambientColor.set(i),void 0!==r&&(n.ambientIntensity=r),this.requestRender()},setFog:function(t,e,i){var r=this.params;void 0!==t&&r.fogColor.set(t),void 0!==e&&(r.fogNear=e),void 0!==i&&(r.fogFar=i),this.requestRender()},setBackground:function(t){var e=this.params;t&&e.backgroundColor.set(t),this.setFog(e.backgroundColor),this.renderer.setClearColor(e.backgroundColor,0),this.renderer.domElement.style.backgroundColor=e.backgroundColor.getStyle(),this.requestRender()},setSampling:function(t){void 0!==t&&(this.params.sampleLevel=t,this.sampleLevel=t),this.requestRender()},setCamera:function(t,e){var i=this.params;t&&(i.cameraType=t),e&&(i.cameraFov=e),"orthographic"===i.cameraType?this.camera!==this.orthographicCamera&&(this.camera=this.orthographicCamera,this.camera.position.copy(this.perspectiveCamera.position),this.camera.up.copy(this.perspectiveCamera.up),this.__updateZoom()):this.camera!==this.perspectiveCamera&&(this.camera=this.perspectiveCamera,this.camera.position.copy(this.orthographicCamera.position),this.camera.up.copy(this.orthographicCamera.up)),this.perspectiveCamera.fov=i.cameraFov,this.controls.object=this.camera,this.camera.lookAt(this.controls.target),this.camera.updateProjectionMatrix(),this.requestRender()},setClip:function(t,e,i){var r=this.params;void 0!==t&&(r.clipNear=t),void 0!==e&&(r.clipFar=e),void 0!==i&&(r.clipDist=i),this.requestRender()},setSpin:function(t,e){var i=this.params;void 0!==t&&(i.spinAxis=t),void 0!==e&&(i.spinAngle=e)},setSize:function(t,e){this.width=t,this.height=e,this.perspectiveCamera.aspect=this.width/this.height,this.orthographicCamera.left=-this.width/2,this.orthographicCamera.right=this.width/2,this.orthographicCamera.top=this.height/2,this.orthographicCamera.bottom=-this.height/2,this.camera.updateProjectionMatrix(),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.pickingTarget.setSize(this.width*window.devicePixelRatio,this.height*window.devicePixelRatio),this.sampleTarget.setSize(this.width*window.devicePixelRatio,this.height*window.devicePixelRatio),this.holdTarget.setSize(this.width*window.devicePixelRatio,this.height*window.devicePixelRatio),this.controls.handleResize(),this.requestRender()},handleResize:function(){if(this.container===document)this.setSize(window.innerWidth,window.innerHeight);else{var t=this.container.getBoundingClientRect();this.setSize(t.width,t.height)}},updateInfo:function(t){var e=this.info,i=e.memory,r=e.render;if(t)i.programs=0,i.geometries=0,i.textures=0,r.calls=0,r.vertices=0,r.faces=0,r.points=0;else{var n=this.renderer.info,o=n.memory,s=n.render;i.programs=o.programs,i.geometries=o.geometries,i.textures=o.textures,r.calls+=s.calls,r.vertices+=s.vertices,r.faces+=s.faces,r.points+=s.points}},rotate:function(){var t=new THREE.Vector3,e=new THREE.Quaternion,i=new THREE.Vector3,r=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3;return function(s,a){t.copy(this.camera.position).sub(this.controls.target),i.copy(t).normalize(),r.copy(this.camera.up).normalize(),n.crossVectors(r,i).normalize(),i.setLength(s.z),r.setLength(s.y),n.setLength(s.x),o.copy(n.sub(r).add(i)),e.setFromAxisAngle(o.normalize(),a),t.applyQuaternion(e),this.camera.up.applyQuaternion(e),this.camera.position.addVectors(this.controls.target,t),this.camera.lookAt(this.controls.target)}}(),zoom:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i){t.copy(this.camera.position).sub(this.controls.target),e.copy(t).normalize(),e.setLength(i),t.add(e),this.camera.position.addVectors(this.controls.target,t),this.camera.lookAt(this.controls.target),this.__updateZoom()}}(),animate:function(){this.controls.update();var t=performance.now()-this.stats.startTime;if(t>500&&!this.still&&this.sampleLevel<3&&-1!==this.sampleLevel){var e=this.sampleLevel;this.sampleLevel=3,this._renderPending=!0,this.render(),this.still=!0,this.sampleLevel=e,kr&&Ir.log("rendered still frame")}var i=this.params;i.spinAxis&&i.spinAngle&&(this.rotate(i.spinAxis,i.spinAngle*this.stats.lastDuration/16),this.requestRender()),requestAnimationFrame(this._animate)},pick:function(){var t=new Float32Array(4),e=new Uint8Array(4);return function(i,r){i*=window.devicePixelRatio,r*=window.devicePixelRatio;var n,o,s,a=this.supportsReadPixelsFloat?t:e;if(this.render(!0),this.renderer.readRenderTargetPixels(this.pickingTarget,i,r,1,1,a),n=this.supportsReadPixelsFloat?Math.round(255*a[0])<<16&16711680|Math.round(255*a[1])<<8&65280|255&Math.round(255*a[2]):a[0]<<16|a[1]<<8|a[2],o=this.pickingGroup.getObjectById(Math.round(a[3])),o&&o.userData.instance&&(s=o.userData.instance),kr){var c=Array.apply([],a);Ir.log(a),Ir.log("picked color",[c[0].toPrecision(2),c[1].toPrecision(2),c[2].toPrecision(2),c[3].toPrecision(2)]),Ir.log("picked gid",n),Ir.log("picked instance",s),Ir.log("picked position",i,r),Ir.log("devicePixelRatio",window.devicePixelRatio)}return{gid:n,instance:s}}}(),requestRender:function(){this._renderPending||this.holdRendering||(performance.now()-this.stats.startTime>22&&(this.stats.begin(),this.still=!1),this._renderPending=!0,requestAnimationFrame(function(){this.render(),this.stats.update()}.bind(this)))},__updateClipping:function(){var t=this.params,e=this.camera,i=this.distVector.copy(e.position).sub(this.controls.target).length();i||(e.position.set(0,0,t.cameraZ),i=Math.abs(t.cameraZ)),this.cDist=i;var r=Math.max(10,.5*this.boundingBox.size(this.distVector).length());r+=this.boundingBox.center(this.distVector).add(this.rotationGroup.position).length(),(r===1/0||r===-(1/0)||isNaN(r))&&(r=50),this.bRadius=r;var n=(50-t.clipNear)/50,o=-(50-t.clipFar)/50;e.near=Math.max(.1,t.clipDist,i-r*n),e.far=Math.max(1,i+r*o);var s=(50-t.fogNear)/50,a=-(50-t.fogFar)/50,c=this.modelGroup.fog;c.color.set(t.fogColor),c.near=Math.max(.1,i-r*s),c.far=Math.max(1,i+r*a)},__updateZoom:function(){this.__updateClipping();var t=THREE.Math.degToRad(this.perspectiveCamera.fov),e=this.camera.near,i=this.camera.far,r=(e+i)/2,n=2*Math.tan(t/2)*r;this.orthographicCamera.zoom=this.height/n},__updateCamera:function(){var t=this.camera;t.updateMatrix(),t.updateMatrixWorld(!0),t.matrixWorldInverse.getInverse(t.matrixWorld),t.updateProjectionMatrix(),this.updateMaterialUniforms(this.scene,t),this.sortProjectedPosition(this.scene,t)},__updateLights:function(){var t=this.params,e=this.camera,i=this.pointLight;i.position.copy(e.position).multiplyScalar(100),i.updateMatrixWorld(),i.color.set(t.lightColor),i.intensity=t.lightIntensity;var r=this.ambientLight;r.color.set(t.ambientColor),r.intensity=t.ambientIntensity},__renderPickingGroup:function(){this.renderer.clearTarget(this.pickingTarget),this.renderer.render(this.pickingGroup,this.camera,this.pickingTarget),this.updateInfo(),this.renderer.setRenderTarget(null),kr&&(this.renderer.clear(),this.renderer.render(this.pickingGroup,this.camera),this.renderer.render(this.helperGroup,this.camera))},__renderModelGroup:function(t){t?this.renderer.clearTarget(t):this.renderer.clear(),this.renderer.render(this.backgroundGroup,this.camera,t),t?this.renderer.clearTarget(t,!1,!0,!1):this.renderer.clearDepth(),this.updateInfo(),this.renderer.render(this.modelGroup,this.camera,t),this.updateInfo(),kr&&this.renderer.render(this.helperGroup,this.camera,t)},__renderMultiSample:function(){var t=this.camera,e=vn[Math.max(0,Math.min(this.sampleLevel,5))];this.compositeUniforms.scale.value=1/e.length,this.compositeUniforms.tForeground.value=this.sampleTarget,this.compositeUniforms.tForeground.needsUpdate=!0,this.compositeMaterial.needsUpdate=!0;for(var i=this.sampleTarget.width,r=this.sampleTarget.height,n=0;n<e.length;++n){var o=e[n];t.setViewOffset(i,r,o[0],o[1],i,r),this.__updateCamera(),this.__renderModelGroup(this.sampleTarget),this.renderer.render(this.compositeScene,this.compositeCamera,this.holdTarget,0===n)}this.renderer.setRenderTarget(null),this.compositeUniforms.scale.value=1,this.compositeUniforms.tForeground.value=this.holdTarget,this.compositeUniforms.tForeground.needsUpdate=!0,this.compositeMaterial.needsUpdate=!0,this.renderer.clear(),this.renderer.render(this.compositeScene,this.compositeCamera),t.view=null},render:function(t){return this._rendering?void Ir.warn("tried to call 'render' from within 'render'"):(this._rendering=!0,this.__updateClipping(),this.__updateCamera(),this.__updateLights(),this.updateInfo(!0),t?this.__renderPickingGroup():this.sampleLevel>0?this.__renderMultiSample():this.__renderModelGroup(),this._rendering=!1,void(this._renderPending=!1))},updateMaterialUniforms:function(){var t=new THREE.Matrix4,e=new THREE.Matrix4;return function(i,r){var n=this.cDist,o=this.bRadius,s=this.height,a=this.renderer.getPixelRatio(),c="OrthographicCamera"===r.type?1:0;t.getInverse(r.projectionMatrix),e.copy(r.projectionMatrix).transpose(),i.traverse(function(i){var r=i.material;if(r){var h=i.material.uniforms;if(h){if(r.clipNear){var u=(50-r.clipNear)/50,l=n-o*u;h.nearClip.value=l}h.canvasHeight&&(h.canvasHeight.value=s),h.pixelRatio&&(h.pixelRatio.value=a),h.projectionMatrixInverse&&h.projectionMatrixInverse.value.copy(t),h.projectionMatrixTranspose&&h.projectionMatrixTranspose.value.copy(e),h.ortho&&(h.ortho.value=c)}}})}}(),sortProjectedPosition:function(){var t,e=new THREE.Vector3,i=new THREE.Matrix4,r=new THREE.Matrix4;return function(n,o){n.traverseVisible(function(n){if(n instanceof THREE.Points&&n.sortParticles){i.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld),r.multiplyMatrices(o.projectionMatrix,i);var s=n.geometry.attributes,a=s.position.count;n.userData.sortData||(n.userData.sortData={});var c=n.userData.sortData;c.__sortArray||(c.__sortArray=new Float32Array(2*a));var h=c.__sortArray;for(t=0;a>t;++t){var u=2*t;e.fromArray(s.position.array,3*t),e.applyProjection(r),h[u]=-e.z,h[u+1]=t}THREE.TypedArrayUtils.quicksortIP(h,2,0);var l,d,m,f;for(var p in s){var Y=s[p],X=Y.array,Z=Y.itemSize;for(c[p]||(c[p]=new Float32Array(Z*a)),f=c[p],c[p]=X,t=0;a>t;++t){l=h[2*t+1];for(var g=0;Z>g;++g)d=l*Z+g,m=t*Z+g,f[m]=X[d]}s[p].array=f,s[p].needsUpdate=!0}}})}}(),clear:function(){Ir.log("scene cleared"),this.scene.remove(this.rotationGroup),this.initScene(),this.renderer.clear()},centerView:function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3,r=new THREE.Vector3;return function(n,o){if(o=o||this.boundingBox.center(),this.controls.object.position.sub(this.controls.target),this.controls.target.copy(this.controls.target0),t.copy(o).multiplyScalar(-1),this.rotationGroup.position.copy(t),this.rotationGroup.updateMatrixWorld(),n){if(n===!0){this.boundingBox.size(r);var s=Math.max(r.x,r.y,r.z),a=Math.min(r.x,r.y,r.z),c=s+a/2;n=c}var h=THREE.Math.degToRad(this.perspectiveCamera.fov),u=this.width/this.height;n=n/2/u/Math.tan(h/2),n=Math.max(n,1.2*this.params.clipDist),e.copy(this.camera.position).sub(this.controls.target),i.copy(e).normalize(),i.setLength(n),e.copy(i),this.camera.position.addVectors(this.controls.target,e),this.__updateZoom()}this.requestRender(),this.signals.orientationChanged.dispatch()}}(),getOrientation:function(){return[this.camera.position.toArray(),this.camera.up.toArray(),this.rotationGroup.position.toArray(),this.controls.target.toArray()]},setOrientation:function(t){this.controls.object.position.sub(this.controls.target),this.controls.target.copy(this.controls.target0),this.controls.target.fromArray(t[3]),this.rotationGroup.position.fromArray(t[2]),this.rotationGroup.updateMatrixWorld(),this.camera.up.fromArray(t[1]),this.camera.position.fromArray(t[0]),this.requestRender(),this.signals.orientationChanged.dispatch()}};var yn=2,bn=3,xn=function(t,e){var i=new THREE.Vector3,r={position:new THREE.Vector2,down:new THREE.Vector2,moving:!1,distance:function(){return r.position.distanceTo(r.down)}};t.renderer.domElement.addEventListener("mousemove",function(t){t.preventDefault(),r.moving=!0,r.position.x=t.layerX,r.position.y=t.layerY}),t.renderer.domElement.addEventListener("mousedown",function(t){t.preventDefault(),r.moving=!1,r.down.x=t.layerX,r.down.y=t.layerY}),t.renderer.domElement.addEventListener("mouseup",function(n){if(n.preventDefault(),!(r.distance()>3||n.which===bn)){var o,s,a,c=t.renderer.domElement.getBoundingClientRect(),h=n.clientX-c.left,u=n.clientY-c.top,l=t.pick(h,c.height-u),d=l.gid,m=l.instance,f=Nr.getByGid(d);f&&"AtomProxy"===f.type?o=f:f&&"BondProxy"===f.type?s=f:f&&f&&"Volume"===f.volume.type&&(a=f),(o||s||a)&&n.which===yn&&(o?i.copy(o):s?i.set(0,0,0).addVectors(s.atom1,s.atom2).multiplyScalar(.5):a&&i.copy(a),m&&i.applyProjection(m.matrix),t.centerView(!1,i)),o?e.signals.atomPicked.dispatch(o):s?e.signals.bondPicked.dispatch(s):a?e.signals.volumePicked.dispatch(a):e.signals.nothingPicked.dispatch(),e.signals.onPicking.dispatch({atom:o,bond:s,volume:a,instance:m}),kr&&(Ir.log("picked atom",o),Ir.log("picked bond",s),Ir.log("picked volume",a))}})};Pt.prototype={constructor:Pt,type:"Surface",set:function(t,e,i,r,n){this.position=t,this.index=e,this.normal=i,this.color=r,this.atomindex=n,this.size=t.length/3},fromGeometry:function(t){kr&&Ir.time("GeometrySurface.fromGeometry");var e;t instanceof THREE.Geometry?(t.computeVertexNormals(!0),e=(new THREE.BufferGeometry).fromGeometry(t)):e=t instanceof THREE.BufferGeometry?t:t.children[0].geometry,e.boundingBox||e.computeBoundingBox(),this.center.copy(e.boundingBox.center()),this.boundingBox.copy(e.boundingBox);var i,r,n,o;if(e instanceof THREE.BufferGeometry){var s=e.attributes,a=s.normal?s.normal.array:!1;(!a||0===a[0]&&0===a[1]&&0===a[2])&&e.computeVertexNormals(),i=s.position.array,n=s.index?s.index.array:null,o=s.normal.array}this.set(i,n,o,r,void 0),kr&&Ir.timeEnd("GeometrySurface.setGeometry")},getPosition:function(){return this.position},getColor:function(t){var e,i,r,n=t||{},o=this.size;if("volume"===n.scheme){var s=new THREE.Vector3,a=this.position;for(r=Fr.getScheme(n),i=new Float32Array(3*o),e=0;o>e;++e){var c=3*e;s.set(a[c],a[c+1],a[c+2]),r.positionColorToArray(s,i,c)}}else if(this.atomindex){n.surface=this,i=new Float32Array(3*o),r=Fr.getScheme(n);var h=n.structure.getAtomProxy(),u=this.atomindex;for(e=0;o>e;++e)h.index=u[e],r.atomColorToArray(h,i,3*e)}else{var l=new THREE.Color(n.value);i=q(o,l.r,l.g,l.b)}return i},getPickingColor:function(t){var e=Object.assign(t||{});return e.scheme="picking",this.getColor(e)},getNormal:function(){return this.normal},getSize:function(t){return G(this.size,t)},getIndex:function(){return this.index},getFilteredIndex:function(t,e){if(t&&this.atomindex){for(var i=new p(t),r=e.getAtomSet(i),n=[],o=this.atomindex,s=this.index,a=s.length,c=0,h=(e.getAtomProxy(),e.getAtomProxy(),e.getAtomProxy(),0);a>h;h+=3){var u=s[h],l=s[h+1],d=s[h+2],m=o[u],f=o[l],Y=o[d];r.has(m)&&r.has(f)&&r.has(Y)&&(n[c]=u,n[c+1]=l,n[c+2]=d,c+=3)}var X=this.position.length/3>65535?Uint32Array:Uint16Array;return new X(n)}return this.index},getAtomindex:function(){return this.atomindex},toJSON:function(){var t={metadata:{version:.1,type:"Surface",generator:"SurfaceExporter"},name:this.name,path:this.path,info:this.info,position:this.position,index:this.index,normal:this.normal,color:this.color,atomindex:this.atomindex,size:this.size,center:this.center.toArray(),boundingBox:{min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}};return t},fromJSON:function(t){return this.name=t.name,this.path=t.path,this.info=t.info,this.position=t.position,this.index=t.index,this.normal=t.normal,this.color=t.color,this.atomindex=t.atomindex,this.size=t.size,this.center.fromArray(t.center),this.boundingBox.set(t.boundingBox.min,t.boundingBox.max),this},getTransferable:function(){var t=[];return this.position&&t.push(this.position.buffer),this.index&&t.push(this.index.buffer),this.normal&&t.push(this.normal.buffer),this.color&&t.push(this.color.buffer),this.atomindex&&t.push(this.atomindex.buffer),t},dispose:function(){}},Et.prototype.constructor=Et,Tt.prototype.constructor=Tt;var Sn=new Uint32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),wn=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);
Br.add("surf",function(t,e){kr&&Ir.time("WORKER surf"),void 0===self.vol&&(self.vol=new It);var i,r=self.vol,n=t.data,o=n.params;n.vol&&r.fromJSON(n.vol),o&&(i=r.getSurface(o.isolevel,o.smooth,o.center,o.size)),kr&&Ir.timeEnd("WORKER surf"),o?e(i.toJSON(),i.getTransferable()):e()}),It.prototype={constructor:It,type:"Volume",setData:function(t,e,i,r,n){this.nx=e||1,this.ny=i||1,this.nz=r||1,this.data=t||new Float32Array(1),this.__data=this.data,this.setDataAtomindex(n),delete this.mc,delete this.__isolevel,delete this.__smooth,delete this.__minValue,delete this.__maxValue,delete this.__dataPositionBuffer,delete this.__dataPosition,delete this.__dataBuffer,delete this.__dataMin,delete this.__dataMax,delete this.__dataMean,delete this.__dataRms,this.worker&&this.worker.terminate(),this.__data.length<=Math.pow(10,7)?Nr.updateObject(this,!0):(Ir.warn("Volume too large (>10^7), not adding to GidPool"),Nr.removeObject(this))},setMatrix:function(t){this.matrix.copy(t);var e=this.boundingBox,i=this.center,r=this.nx-1,n=this.ny-1,o=this.nz-1;e.makeEmpty(),e.expandByPoint(i.set(r,n,o)),e.expandByPoint(i.set(r,n,0)),e.expandByPoint(i.set(r,0,o)),e.expandByPoint(i.set(r,0,0)),e.expandByPoint(i.set(0,n,o)),e.expandByPoint(i.set(0,0,o)),e.expandByPoint(i.set(0,n,0)),e.expandByPoint(i.set(0,0,0)),e.applyMatrix4(this.matrix),e.center(this.center);var s=this.matrix.elements,a=new THREE.Vector3(s[0],s[1],s[2]),c=new THREE.Vector3(s[4],s[5],s[6]),h=new THREE.Vector3(s[8],s[9],s[10]),u=new THREE.Vector3,l=this.normalMatrix.elements;u.crossVectors(c,h),l[0]=u.x,l[1]=u.y,l[2]=u.z,u.crossVectors(h,a),l[3]=u.x,l[4]=u.y,l[5]=u.z,u.crossVectors(a,c),l[6]=u.x,l[7]=u.y,l[8]=u.z,this.inverseMatrix.getInverse(this.matrix)},setDataAtomindex:function(t){this.dataAtomindex=t,this.__dataAtomindex=this.dataAtomindex,delete this.__dataAtomindexBuffer},getBox:function(t,e,i){return i||(i=new THREE.Box3),i.set(t,t),i.expandByScalar(e),i.applyMatrix4(this.inverseMatrix),i.min.round(),i.max.round(),i},getSurface:function(t,e,i,r){t=isNaN(t)?this.getValueForSigma(2):t,e=e||0,i=i,r=r,void 0===this.mc&&(this.mc=new Ot(this.__data,this.nx,this.ny,this.nz,this.__dataAtomindex));var n;i&&r&&(this.__box||(this.__box=new THREE.Box3),n=this.__box,this.getBox(i,r,n));var o;if(e){o=this.mc.triangulate(t,!0,n),Rt(o.position,o.index,e,!0);var s=new THREE.BufferGeometry;s.addAttribute("position",new THREE.BufferAttribute(o.position,3)),s.setIndex(new THREE.BufferAttribute(o.index,1)),s.computeVertexNormals(),o.normal=s.attributes.normal.array,s.dispose()}else o=this.mc.triangulate(t,!1,n);this.matrix.applyToVector3Array(o.position),o.normal&&this.normalMatrix.applyToVector3Array(o.normal);var a=new Pt("","",o);return a.info.isolevel=t,a.info.smooth=e,a},getSurfaceWorker:function(t,e,i,r,n){if(t=isNaN(t)?this.getValueForSigma(2):t,e=e||0,"undefined"!=typeof Worker&&"function"!=typeof importScripts){void 0===this.workerPool&&(this.workerPool=new Tt("surf",2));var o=this.workerPool.getNextWorker();o.post({vol:0===o.postCount?this.toJSON():null,params:{isolevel:t,smooth:e,center:i,size:r}},void 0,function(t){var e=a(t.data);n(e)},function(o){console.warn("Volume.generateSurfaceWorker error - trying without worker",o);var s=this.getSurface(t,e,i,r);n(s)}.bind(this))}else{var s=this.getSurface(t,e,i,r);n(s)}},getValueForSigma:function(t){return t=void 0!==t?t:2,this.getDataMean()+t*this.getDataRms()},getSigmaForValue:function(t){return t=void 0!==t?t:0,(t-this.getDataMean())/this.getDataRms()},filterData:function(t,e,i){isNaN(t)&&this.header&&(t=this.header.DMEAN+2*this.header.ARMS),t=void 0===t||isNaN(t)?-(1/0):t,e=void 0!==e?e:1/0,i=i||!1,this.dataPosition||this.makeDataPosition();var r=this.__dataPosition,n=this.__data;if(t!==this.__minValue||e!=this.__maxValue||i!==this.__outside){if(t===-(1/0)&&e===1/0)this.dataPosition=r,this.data=n;else{var o=n.length;this.__dataBuffer||(this.__dataPositionBuffer=new ArrayBuffer(3*o*4),this.__dataBuffer=new ArrayBuffer(4*o));for(var s=new Float32Array(this.__dataPositionBuffer),a=new Float32Array(this.__dataBuffer),c=0,h=0;o>h;++h){var u=3*h,l=n[h];if(!i&&l>=t&&e>=l||i&&(t>l||l>e)){var d=3*c;s[d+0]=r[u+0],s[d+1]=r[u+1],s[d+2]=r[u+2],a[c]=l,c+=1}}this.dataPosition=new Float32Array(this.__dataPositionBuffer,0,3*c),this.data=new Float32Array(this.__dataBuffer,0,c)}this.__minValue=t,this.__maxValue=e,this.__outside=i}},makeDataPosition:function(){for(var t=this.nz,e=this.ny,i=this.nx,r=new Float32Array(i*e*t*3),n=0,o=0;t>o;++o)for(var s=0;e>s;++s)for(var a=0;i>a;++a)r[n+0]=a,r[n+1]=s,r[n+2]=o,n+=3;this.matrix.applyToVector3Array(r),this.dataPosition=r,this.__dataPosition=r},getDataAtomindex:function(){return this.dataAtomindex},getDataPosition:function(){return this.dataPosition},getDataColor:function(t){var e=t||{};e.volume=this,e.scale=e.scale||"Spectral",e.domain=e.domain||[this.getDataMin(),this.getDataMax()];for(var i=Fr.getScheme(e),r=this.dataPosition.length/3,n=new Float32Array(3*r),o=0;r>o;++o)i.volumeColorToArray(o,n,3*o);return n},getPickingDataColor:function(t){var e=Object.assign(t||{});return e.scheme="picking",this.getDataColor(e)},getDataSize:function(t,e){var i,r,n=this.dataPosition.length/3;switch(t){case"value":r=new Float32Array(this.data);break;case"abs-value":for(r=new Float32Array(this.data),i=0;n>i;++i)r[i]=Math.abs(r[i]);break;case"value-min":r=new Float32Array(this.data);var o=this.getDataMin();for(i=0;n>i;++i)r[i]-=o;break;case"deviation":r=new Float32Array(this.data);break;default:r=G(n,t)}if(1!==e)for(i=0;n>i;++i)r[i]*=e;return r},getDataMin:function(){if(void 0===this.__dataMin){for(var t=this.__data,e=t.length,i=1/0,r=0;e>r;++r)i=Math.min(i,t[r]);this.__dataMin=i}return this.__dataMin},getDataMax:function(){if(void 0===this.__dataMax){for(var t=this.__data,e=t.length,i=-(1/0),r=0;e>r;++r)i=Math.max(i,t[r]);this.__dataMax=i}return this.__dataMax},getDataMean:function(){if(void 0===this.__dataMean){for(var t=this.__data,e=t.length,i=0,r=0;e>r;++r)i+=t[r];this.__dataMean=i/e}return this.__dataMean},getDataRms:function(){if(void 0===this.__dataRms){var t,e,i=this.__data,r=i.length,n=0;for(e=0;r>e;++e)t=i[e],n+=t*t;this.__dataRms=Math.sqrt(n/r)}return this.__dataRms},clone:function(){var t=new It(this.name,this.path,this.__data,this.nx,this.ny,this.nz,this.__dataAtomindex);return t.matrix.copy(this.matrix),this.header&&(t.header=Object.assign({},this.header)),t},toJSON:function(){var t={metadata:{version:.1,type:"Volume",generator:"VolumeExporter"},name:this.name,path:this.path,data:this.__data,nx:this.nx,ny:this.ny,nz:this.nz,dataAtomindex:this.__dataAtomindex,matrix:this.matrix.toArray(),normalMatrix:this.normalMatrix.toArray(),inverseMatrix:this.inverseMatrix.toArray(),center:this.center.toArray(),boundingBox:{min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}};return this.header&&(t.header=Object.assign({},this.header)),t},fromJSON:function(t){return this.name=t.name,this.path=t.path,this.setData(t.data,t.nx,t.ny,t.nz,t.dataAtomindex),this.matrix.fromArray(t.matrix),this.normalMatrix.fromArray(t.normalMatrix),this.inverseMatrix.fromArray(t.inverseMatrix),t.header&&(this.header=Object.assign({},t.header)),this.center.fromArray(t.center),this.boundingBox.set(t.boundingBox.min,t.boundingBox.max),this},getTransferable:function(){var t=[this.__data.buffer];return this.__dataAtomindex&&t.push(this.__dataAtomindex.buffer),t},dispose:function(){this.workerPool&&this.workerPool.terminate(),Nr.removeObject(this)}};var An={};An[THREE.FrontSide]="front",An[THREE.BackSide]="back",An[THREE.DoubleSide]="double",Nt.prototype={constructor:Nt,type:"",parameters:{clipNear:{type:"range",step:1,max:100,min:0,buffer:!0},flatShaded:{type:"boolean",buffer:!0},opacity:{type:"range",step:.01,max:1,min:0,buffer:!0},side:{type:"select",options:An,buffer:!0,"int":!0},wireframe:{type:"boolean",buffer:!0},linewidth:{type:"integer",max:50,min:1,buffer:!0},colorScheme:{type:"select",update:"color",options:Fr.getTypes()},colorScale:{type:"select",update:"color",options:Fr.getScales()},colorValue:{type:"color",update:"color"},colorDomain:{type:"hidden",update:"color"},colorMode:{type:"select",update:"color",options:Fr.getModes()},roughness:{type:"range",step:.01,max:1,min:0,buffer:!0},metalness:{type:"range",step:.01,max:1,min:0,buffer:!0},diffuse:{type:"color",buffer:!0}},init:function(t){var e=t||{};this.clipNear=void 0!==e.clipNear?e.clipNear:0,this.flatShaded=e.flatShaded||!1,this.side=void 0!==e.side?e.side:THREE.DoubleSide,this.opacity=void 0!==e.opacity?e.opacity:1,this.wireframe=e.wireframe||!1,this.linewidth=e.linewidth||2,this.setColor(e.color,e),this.colorScheme=e.colorScheme||"uniform",this.colorScale=e.colorScale||"",this.colorValue=e.colorValue||9474192,this.colorDomain=e.colorDomain||"",this.colorMode=e.colorMode||"hcl",this.visible=void 0!==e.visible?e.visible:!0,this.quality=e.quality,this.roughness=void 0!==e.roughness?e.roughness:.4,this.metalness=void 0!==e.metalness?e.metalness:0,this.diffuse=void 0!==e.diffuse?e.diffuse:16777215},getColorParams:function(){return{scheme:this.colorScheme,scale:this.colorScale,value:this.colorValue,domain:this.colorDomain,mode:this.colorMode}},getBufferParams:function(t){return Object.assign({clipNear:this.clipNear,flatShaded:this.flatShaded,opacity:this.opacity,side:this.side,wireframe:this.wireframe,linewidth:this.linewidth,roughness:this.roughness,metalness:this.metalness,diffuse:this.diffuse},t)},setColor:function(t,e){var i=Object.keys(Fr.getTypes());return-1!==i.indexOf(t)?e?e.colorScheme=t:this.setParameters({colorScheme:t}):void 0!==t&&(t=new THREE.Color(t).getHex(),e?(e.colorScheme="uniform",e.colorValue=t):this.setParameters({colorScheme:"uniform",colorValue:t})),this},prepare:!1,create:function(){},update:function(){this.build()},build:function(t){return this.prepare?(this.queue.length()>0?(this.tasks.change(1-this.queue.length()),this.queue.kill()):this.tasks.increment(),t||(t=this.getParameters(),delete t.quality),void this.queue.push(t)):(t||(t=this.getParameters(),delete t.quality),this.tasks.increment(),void this.make(t,function(){}))},make:function(t,e){kr&&Ir.time("Representation.make "+this.type),t&&!t.__update&&this.init(t);var i=function(){t.__update?(this.update(t.__update),this.viewer.requestRender(),this.tasks.decrement(),e()):(this.clear(),this.create(),this.manualAttach||this.disposed||(kr&&Ir.time("Representation.attach "+this.type),this.attach(function(){kr&&Ir.timeEnd("Representation.attach "+this.type),this.tasks.decrement(),e()}.bind(this)))),kr&&Ir.timeEnd("Representation.make "+this.type)}.bind(this);this.prepare?this.prepare(i):i()},attach:function(t){this.setVisibility(this.visible),t()},setVisibility:function(t,e){return this.visible=t,this.bufferList.forEach(function(e){e.setVisibility(t)}),e||this.viewer.requestRender(),this},setParameters:function(t,e,i){var r=t||{},n=this.parameters;e=e||{},i=i||!1;var o={};for(var s in r)void 0!==r[s]&&void 0!==n[s]&&(n[s]["int"]&&(r[s]=parseInt(r[s])),n[s]["float"]&&(r[s]=parseFloat(r[s])),r[s]!==this[s]&&(this[s]=r[s],n[s].buffer&&(n[s].buffer===!0?o[s]=r[s]:o[n[s].buffer]=r[s]),n[s].update&&(e[n[s].update]=!0),!n[s].rebuild||"impostor"===n[s].rebuild&&Rr&&!this.disableImpostor||(i=!0)));return i?this.build():(this.bufferList.forEach(function(t){t.setParameters(o)}),Object.keys(e).length&&this.update(e),this.viewer.requestRender()),this},getParameters:function(){var t={visible:this.visible,quality:this.quality};return Object.keys(this.parameters).forEach(function(e){t[e]=this[e]},this),t},clear:function(){this.bufferList.forEach(function(t){this.viewer.remove(t),t.dispose()},this),this.bufferList.length=0,this.viewer.requestRender()},dispose:function(){this.disposed=!0,this.queue.kill(),this.tasks.dispose(),this.clear()}},Mt.prototype=Object.assign(Object.create(Nt.prototype),{constructor:Mt,type:"buffer",parameters:Object.assign({},Nt.prototype.parameters,{colorScheme:null,colorScale:null,colorValue:null,colorDomain:null,colorMode:null}),create:function(){this.bufferList.push(this.buffer)},attach:function(t){this.bufferList.forEach(function(t){this.viewer.add(t)},this),this.setVisibility(this.visible),t()}}),Lt.prototype={constructor:Lt,parameters:{opaqueBack:{updateShader:!0},dullInterior:{updateShader:!0},side:{updateShader:!0,property:!0},opacity:{uniform:!0},clipNear:{updateShader:!0,property:!0},flatShaded:{updateShader:!0},background:{updateShader:!0},linewidth:{property:!0},wireframe:{updateVisibility:!0},roughness:{uniform:!0},metalness:{uniform:!0},diffuse:{uniform:!0}},get transparent(){return this.opacity<1||this.forceTransparent},makeMaterial:function(){this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:"",fragmentShader:"",depthTest:!0,transparent:this.transparent,depthWrite:!0,lights:!0,fog:!0,side:this.side,linewidth:this.linewidth}),this.material.vertexColors=THREE.VertexColors,this.material.extensions.derivatives=this.flatShaded,this.material.extensions.fragDepth=this.impostor,this.material.clipNear=this.clipNear,this.wireframeMaterial=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:"Line.vert",fragmentShader:"Line.frag",depthTest:!0,transparent:this.transparent,depthWrite:!0,lights:!1,fog:!0,side:this.side,linewidth:this.linewidth}),this.wireframeMaterial.vertexColors=THREE.VertexColors,this.wireframeMaterial.clipNear=this.clipNear,this.pickingMaterial=new THREE.ShaderMaterial({uniforms:this.pickingUniforms,vertexShader:"",fragmentShader:"",depthTest:!0,transparent:!1,depthWrite:!0,lights:!1,fog:!1,side:this.side,linewidth:this.linewidth}),this.pickingMaterial.vertexColors=THREE.VertexColors,this.pickingMaterial.extensions.fragDepth=this.impostor,this.pickingMaterial.clipNear=this.clipNear,this.updateShader()},makeWireframeGeometry:function(){this.makeWireframeIndex();var t=this.geometry,e=this.wireframeIndex,i=new THREE.BufferGeometry;i.attributes=t.attributes,e&&(i.setIndex(new THREE.BufferAttribute(e,1).setDynamic(this.dynamic)),i.setDrawRange(0,this.wireframeIndexCount)),this.wireframeGeometry=i},makeWireframeIndex:function(){function t(t,i){if(t>i){var r=t;t=i,i=r}var n=e[t];return void 0===n?(e[t]=[i],!0):-1===n.indexOf(i)?(n.push(i),!0):!1}var e=[];return function(){var i=this.geometry.index;if(this.wireframe){if(i){var r=i.array,n=r.length;this.geometry.drawRange.count!==1/0&&(n=this.geometry.drawRange.count);var o;if(this.wireframeIndex&&this.wireframeIndex.length>2*n)o=this.wireframeIndex;else{var s=this.geometry.attributes.position.count,a=s>65535?Uint32Array:Uint16Array;o=new a(2*n)}var c=0;e.length=0;for(var h=0;n>h;h+=3){var u=r[h+0],l=r[h+1],d=r[h+2];t(u,l)&&(o[c+0]=u,o[c+1]=l,c+=2),t(l,d)&&(o[c+0]=l,o[c+1]=d,c+=2),t(d,u)&&(o[c+0]=d,o[c+1]=u,c+=2)}this.wireframeIndex=o,this.wireframeIndexCount=c,this.wireframeIndexVersion=this.indexVersion}}else this.wireframeIndex=new Uint16Array(0),this.wireframeIndexCount=0}}(),updateWireframeIndex:function(){if(this.wireframeGeometry.setDrawRange(0,1/0),this.wireframeIndexVersion<this.indexVersion&&this.makeWireframeIndex(),this.wireframeIndex.length>this.wireframeGeometry.index.array.length)this.wireframeGeometry.setIndex(new THREE.BufferAttribute(this.wireframeIndex,1).setDynamic(this.dynamic));else{var t=this.wireframeGeometry.getIndex();t.set(this.wireframeIndex),t.needsUpdate=this.wireframeIndexCount>0,t.updateRange.count=this.wireframeIndexCount}this.wireframeGeometry.setDrawRange(0,this.wireframeIndexCount)},getRenderOrder:function(){var t=0;return"text"===this.type?t=1:this.transparent&&(t="surface"===this.type?3:2),t},getMesh:function(){var t;return this.material||this.makeMaterial(),this.line?t=new THREE.LineSegments(this.geometry,this.material):this.point?(t=new THREE.Points(this.geometry,this.material),this.sortParticles&&(t.sortParticles=!0)):t=new THREE.Mesh(this.geometry,this.material),t.frustumCulled=!1,t.renderOrder=this.getRenderOrder(),t},getWireframeMesh:function(){var t;return this.material||this.makeMaterial(),this.wireframeGeometry||this.makeWireframeGeometry(),t=new THREE.LineSegments(this.wireframeGeometry,this.wireframeMaterial),t.frustumCulled=!1,t.renderOrder=this.getRenderOrder(),t},getPickingMesh:function(){var t;return this.material||this.makeMaterial(),t=new THREE.Mesh(this.geometry,this.pickingMaterial),t.frustumCulled=!1,t.renderOrder=this.getRenderOrder(),t},getShader:function(t,e){return St(t,this.getDefines(e))},getVertexShader:function(t){return this.getShader(this.vertexShader,t)},getFragmentShader:function(t){return this.getShader(this.fragmentShader,t)},getDefines:function(t){var e={};return this.clipNear&&(e.NEAR_CLIP=1),"picking"===t?e.PICKING=1:(("background"===t||this.background)&&(e.NOLIGHT=1),this.flatShaded&&(e.FLAT_SHADED=1),this.opaqueBack&&(e.OPAQUE_BACK=1),this.dullInterior&&(e.DULL_INTERIOR=1)),e},getParameters:function(){var t={};for(var e in this.parameters)t[e]=this[e];return t},addUniforms:function(t){this.uniforms=THREE.UniformsUtils.merge([this.uniforms,t]),this.pickingUniforms=THREE.UniformsUtils.merge([this.pickingUniforms,t])},addAttributes:function(t){var e={f:1,v2:2,v3:3,c:3};for(var i in t){var r,n=t[i];n.value?(this.attributeSize*e[n.type]!==n.value.length&&Ir.error("attribute value has wrong length",i),r=n.value):r=new Float32Array(this.attributeSize*e[n.type]),this.geometry.addAttribute(i,new THREE.BufferAttribute(r,e[n.type]).setDynamic(this.dynamic))}},updateRenderOrder:function(){function t(t){t.renderOrder=e}var e=this.getRenderOrder();this.group.children.forEach(t),this.pickingGroup&&this.pickingGroup.children.forEach(t)},updateShader:function(){var t=this.material,e=this.wireframeMaterial,i=this.pickingMaterial;t.vertexShader=this.getVertexShader(),t.fragmentShader=this.getFragmentShader(),t.needsUpdate=!0,e.vertexShader=this.getShader("Line.vert"),e.fragmentShader=this.getShader("Line.frag"),e.needsUpdate=!0,i.vertexShader=this.getVertexShader("picking"),i.fragmentShader=this.getFragmentShader("picking"),i.needsUpdate=!0},setParameters:function(t){if(t){var e=t,i=this.parameters,r={},n={},o=!1,s=!1;for(var a in e)void 0!==e[a]&&void 0!==i[a]&&(this[a]=e[a],i[a].property&&(i[a].property!==!0?r[i[a].property]=e[a]:r[a]=e[a]),i[a].uniform&&(i[a].uniform!==!0?n[i[a].uniform]=e[a]:n[a]=e[a]),i[a].updateShader&&(o=!0),i[a].updateVisibility&&(s=!0),this.dynamic&&"wireframe"===a&&e[a]===!0&&this.updateWireframeIndex(),"flatShaded"===a&&(this.material.extensions.derivatives=this.flatShaded),"forceTransparent"===a&&(r.transparent=this.transparent));this.setProperties(r),this.setUniforms(n),o&&this.updateShader(),s&&this.setVisibility(this.visible)}},setAttributes:function(t){var e=this.geometry,i=e.attributes;for(var r in t){var n=t[r],o=n.length;if("index"===r){var s=e.getIndex();e.setDrawRange(0,1/0),o>s.array.length?e.setIndex(new THREE.BufferAttribute(n,1).setDynamic(this.dynamic)):(s.set(n),s.needsUpdate=o>0,s.updateRange.count=o,e.setDrawRange(0,o)),this.indexVersion++,this.wireframe&&this.updateWireframeIndex()}else{var a=i[r];o>a.array.length?e.addAttribute(r,new THREE.BufferAttribute(n,a.itemSize).setDynamic(this.dynamic)):(i[r].set(n),i[r].needsUpdate=o>0,i[r].updateRange.count=o)}}},setUniforms:function(t){if(t){var e=this.material.uniforms,i=this.wireframeMaterial.uniforms,r=this.pickingMaterial.uniforms;for(var n in t)"opacity"===n&&this.setProperties({transparent:this.transparent}),void 0!==e[n]&&(e[n].value.set?e[n].value.set(t[n]):e[n].value=t[n]),void 0!==i[n]&&(i[n].value.set?i[n].value.set(t[n]):i[n].value=t[n]),void 0!==r[n]&&(r[n].value.set?r[n].value.set(t[n]):r[n].value=t[n])}},setProperties:function(t){if(t){var e=this.material,i=this.wireframeMaterial,r=this.pickingMaterial;for(var n in t)"transparent"===n&&this.updateRenderOrder(),void 0!==e[n]&&(e[n]=t[n]),void 0!==i[n]&&(i[n]=t[n]),void 0!==r[n]&&(r[n]=t[n]);e.needsUpdate=!0,i.needsUpdate=!0,r.needsUpdate=!0}},setVisibility:function(t){this.visible=t,this.wireframe?(this.group.visible=!1,this.wireframeGroup.visible=t,this.pickable&&(this.pickingGroup.visible=!1)):(this.group.visible=t,this.wireframeGroup.visible=!1,this.pickable&&(this.pickingGroup.visible=t))},dispose:function(){this.material&&this.material.dispose(),this.wireframeMaterial&&this.wireframeMaterial.dispose(),this.pickingMaterial&&this.pickingMaterial.dispose(),this.geometry.dispose(),this.wireframeGeometry&&this.wireframeGeometry.dispose()}},Bt.prototype=Object.assign(Object.create(Lt.prototype),{constructor:Bt}),Ft.prototype=Object.assign(Object.create(Bt.prototype),{constructor:Ft,type:"surface"}),Dt.prototype.constructor=Dt,jt.prototype=Object.assign(Object.create(Nt.prototype),{constructor:jt,type:"surface",parameters:Object.assign({isolevelType:{type:"select",options:{value:"value",sigma:"sigma"}},isolevel:{type:"number",precision:2,max:1e3,min:-1e3},smooth:{type:"integer",precision:1,max:10,min:0},background:{type:"boolean",rebuild:!0},opaqueBack:{type:"boolean",buffer:!0},boxSize:{type:"integer",precision:1,max:100,min:0},useWorker:{type:"boolean",rebuild:!0}},Nt.prototype.parameters),init:function(t){var e=t||{};e.colorScheme=e.colorScheme||"uniform",e.colorValue=void 0!==e.colorValue?e.colorValue:14540253,this.isolevelType=void 0!==e.isolevelType?e.isolevelType:"sigma",this.isolevel=void 0!==e.isolevel?e.isolevel:2,this.smooth=void 0!==e.smooth?e.smooth:0,this.background=e.background||!1,this.opaqueBack=void 0!==e.opaqueBack?e.opaqueBack:!0,this.boxSize=void 0!==e.boxSize?e.boxSize:0,this.useWorker=void 0!==e.useWorker?e.useWorker:!0,Nt.prototype.init.call(this,e)},attach:function(t){this.bufferList.forEach(function(t){this.viewer.add(t)},this),this.setVisibility(this.visible),t()},prepare:function(t){if(this.volume){var e;if(e="sigma"===this.isolevelType?this.volume.getValueForSigma(this.isolevel):this.isolevel,!this.surface||this.__isolevel!==e||this.__smooth!==this.smooth||this.__boxSize!==this.boxSize||this.boxSize>0&&!this.__boxCenter.equals(this.boxCenter)){this.__isolevel=e,this.__smooth=this.smooth,this.__boxSize=this.boxSize,this.__boxCenter.copy(this.boxCenter),this.__box.copy(this.box);var i=function(e){this.surface=e,t()}.bind(this);this.useWorker?this.volume.getSurfaceWorker(e,this.smooth,this.boxCenter,this.boxSize,i):i(this.volume.getSurface(e,this.smooth,this.boxCenter,this.boxSize))}else t()}else t()},create:function(){var t=new Ft(this.surface.getPosition(),this.surface.getColor(this.getColorParams()),this.surface.getIndex(),this.surface.getNormal(),void 0,this.getBufferParams({background:this.background,opaqueBack:this.opaqueBack,dullInterior:!1})),e=new Dt(t);this.bufferList.push(e)},update:function(t){if(0!==this.bufferList.length){t=t||{};var e={};t.position&&(e.position=this.surface.getPosition()),t.color&&(e.color=this.surface.getColor(this.getColorParams())),t.index&&(e.index=this.surface.getIndex()),t.normal&&(e.normal=this.surface.getNormal()),this.bufferList.forEach(function(t){t.setAttributes(e)})}},setParameters:function(t,e,i){return t&&void 0!==t.isolevelType&&this.volume&&("value"===this.isolevelType&&"sigma"===t.isolevelType?this.isolevel=this.volume.getSigmaForValue(this.isolevel):"sigma"===this.isolevelType&&"value"===t.isolevelType&&(this.isolevel=this.volume.getValueForSigma(this.isolevel)),this.isolevelType=t.isolevelType),t&&t.boxCenter&&(this.boxCenter.copy(t.boxCenter),delete t.boxCenter),Nt.prototype.setParameters.call(this,t,e,i),this.volume&&this.volume.getBox(this.boxCenter,this.boxSize,this.box),this.surface&&(void 0!==t.isolevel||void 0!==t.smooth||void 0!==t.boxSize||this.boxSize>0&&!this.__box.equals(this.box))&&this.build({__update:{position:!0,color:!0,index:!0,normal:!0}}),this},dispose:function(){this.viewer.signals.orientationChanged.remove(this.setBox),Nt.prototype.dispose.call(this)}}),Ut.prototype=Object.assign(Object.create(Bt.prototype),{constructor:Ut,applyPositionTransform:function(){},setAttributes:function(){var t=new THREE.Matrix4,e=new THREE.Matrix3;return function(i){var r,n,o,s,a,c,h,u,l,d,m,f=this.geometry.attributes;i.position&&(r=i.position,s=this.geoPosition,u=this.meshPosition,c=this.transformedGeoPosition,f.position.needsUpdate=!0),i.color&&(n=i.color,l=this.meshColor,f.color.needsUpdate=!0),i.pickingColor&&(o=i.pickingColor,d=this.meshPickingColor,f.pickingColor.needsUpdate=!0);var p=!(!this.updateNormals||!r),Y=!(!this.initNormals||!r);(p||Y)&&(a=this.geoNormal,m=this.meshNormal,h=this.transformedGeoNormal,f.normal.needsUpdate=!0);for(var X=this.positionCount,Z=this.geo.vertices.length,g=0;X>g;++g){var v=g*Z*3,y=3*g;if(r&&(c.set(s),t.makeTranslation(r[y],r[y+1],r[y+2]),this.applyPositionTransform(t,g,y),t.applyToVector3Array(c),u.set(c,v)),p?(h.set(a),e.getNormalMatrix(t),e.applyToVector3Array(h),m.set(h,v)):Y&&m.set(a,v),n)for(var b=0;Z>b;++b){var x=v+3*b;l[x]=n[y],l[x+1]=n[y+1],l[x+2]=n[y+2]}if(o)for(var b=0;Z>b;++b){var x=v+3*b;d[x]=o[y],d[x+1]=o[y+1],d[x+2]=o[y+2]}}}}(),makeIndex:function(){var t,e,i,r,n=this.geoIndex,o=this.meshIndex,s=this.positionCount,a=this.geo.vertices.length,c=this.geo.faces.length,h=3*c;for(e=0;s>e;++e)for(i=e*h,r=i+h,o.set(n,i),t=i;r>t;++t)o[t]+=e*a}}),Gt.prototype=Object.assign(Object.create(Ut.prototype),{constructor:Gt,setPositionTransform:function(t){var e,i=new THREE.Vector3;this.applyPositionTransform=function(r,n){e=t[n],i.set(e,e,e),r.scale(i)}},setAttributes:function(t){t.radius&&this.setPositionTransform(t.radius),Ut.prototype.setAttributes.call(this,t)}}),qt.prototype=Object.assign(Object.create(Lt.prototype),{constructor:qt,setAttributes:function(t){var e,i,r,n,o,s,a,c=this.count,h=this.mappingSize,u=this.geometry.attributes;for(var l in t){i=t[l],e=u[l],r=e.itemSize,n=e.array;for(var d=0;c>d;++d){o=d*r,s=o*h;for(var m=0;h>m;++m){a=s+r*m;for(var f=0;r>f;++f)n[a+f]=i[o+f]}}e.needsUpdate=!0}},makeMapping:function(){for(var t=this.count,e=this.mapping,i=this.mappingSize,r=this.mappingItemSize,n=this.geometry.attributes.mapping.array,o=0;t>o;o++)n.set(e,o*r*i)},makeIndex:function(){for(var t,e,i,r=this.count,n=this.mappingSize,o=this.mappingIndices,s=this.mappingIndicesSize,a=this.mappingItemSize,c=this.index,h=0;r>h;h++){t=h*a*n,e=h*s,i=h*n,c.set(o,e);for(var u=0;s>u;++u)c[e+u]+=i}}}),Wt.prototype=Object.assign(Object.create(qt.prototype),{constructor:Wt}),Jt.prototype=Object.assign(Object.create(Wt.prototype),{constructor:Jt}),$t.prototype=Object.assign(Object.create(Lt.prototype),{constructor:$t,parameters:Object.assign({pointSize:{uniform:"size"},sizeAttenuation:{updateShader:!0},sortParticles:{},alphaTest:{updateShader:!0},useTexture:{updateShader:!0},forceTransparent:{},edgeBleach:{uniform:!0}},Lt.prototype.parameters),makeMaterial:function(){Lt.prototype.makeMaterial.call(this),this.makeTexture(),this.material.uniforms.map.value=this.tex,this.material.blending=THREE.NormalBlending,this.material.needsUpdate=!0},makeTexture:function(){this.tex&&this.tex.dispose(),this.tex=Qt({delta:this.edgeBleach})},getDefines:function(t){var e=Lt.prototype.getDefines.call(this,t);return this.sizeAttenuation&&(e.USE_SIZEATTENUATION=1),this.useTexture&&(e.USE_MAP=1),this.alphaTest>0&&this.alphaTest<=1&&(e.ALPHATEST=this.alphaTest.toPrecision(2)),e},setUniforms:function(t){t&&void 0!==t.edgeBleach&&(this.makeTexture(),t.map=this.tex),Lt.prototype.setUniforms.call(this,t)},dispose:function(){Lt.prototype.dispose.call(this),this.tex&&this.tex.dispose()}}),te.prototype=Object.assign(Object.create(Nt.prototype),{constructor:te,type:"dot",parameters:Object.assign({thresholdType:{type:"select",rebuild:!0,options:{value:"value",sigma:"sigma"}},thresholdMin:{type:"number",precision:3,max:1/0,min:-(1/0),rebuild:!0},thresholdMax:{type:"number",precision:3,max:1/0,min:-(1/0),rebuild:!0},thresholdOut:{type:"boolean",rebuild:!0},dotType:{type:"select",rebuild:!0,options:{"":"",sphere:"sphere",point:"point"}},radiusType:{type:"select",options:{"":"",value:"value","abs-value":"abs-value","value-min":"value-min",deviation:"deviation",size:"size"}},radius:{type:"number",precision:3,max:10,min:.001,property:"size"},scale:{type:"number",precision:3,max:10,min:.001},sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"},disableImpostor:{type:"boolean",rebuild:!0},pointSize:{type:"number",precision:1,max:100,min:0,buffer:!0},sizeAttenuation:{type:"boolean",buffer:!0},sortParticles:{type:"boolean",rebuild:!0},useTexture:{type:"boolean",buffer:!0},alphaTest:{type:"range",step:.001,max:1,min:0,buffer:!0},forceTransparent:{type:"boolean",buffer:!0},edgeBleach:{type:"range",step:.001,max:1,min:0,buffer:!0}},Nt.prototype.parameters,{colorScheme:{type:"select",update:"color",options:{"":"",value:"value",uniform:"uniform"}}}),defaultSize:.1,init:function(t){var e=t||{};e.colorScheme=e.colorScheme||"uniform",e.colorValue=e.colorValue||14540253,"low"===e.quality?this.sphereDetail=0:"medium"===e.quality?this.sphereDetail=1:"high"===e.quality?this.sphereDetail=2:this.sphereDetail=e.sphereDetail||1,this.disableImpostor=e.disableImpostor||!1,this.thresholdType=void 0!==e.thresholdType?e.thresholdType:"sigma",this.thresholdMin=void 0!==e.thresholdMin?e.thresholdMin:2,this.thresholdMax=void 0!==e.thresholdMax?e.thresholdMax:1/0,this.thresholdOut=void 0!==e.thresholdOut?e.thresholdOut:!1,this.dotType=void 0!==e.dotType?e.dotType:"point",this.radius=void 0!==e.radius?e.radius:.1,this.scale=void 0!==e.scale?e.scale:1,this.pointSize=e.pointSize||1,this.sizeAttenuation=void 0!==e.sizeAttenuation?e.sizeAttenuation:!0,this.sortParticles=void 0!==e.sortParticles?e.sortParticles:!1,this.useTexture=void 0!==e.useTexture?e.useTexture:!1,this.alphaTest=void 0!==e.alphaTest?e.alphaTest:.5,this.forceTransparent=void 0!==e.forceTransparent?e.forceTransparent:!1,this.edgeBleach=void 0!==e.edgeBleach?e.edgeBleach:0,Nt.prototype.init.call(this,e)},attach:function(t){this.bufferList.forEach(function(t){this.viewer.add(t)},this),this.setVisibility(this.visible),t()},create:function(){var t,e,i,r;if(this.volume){var n,o;"sigma"===this.thresholdType?(n=this.volume.getValueForSigma(this.thresholdMin),o=this.volume.getValueForSigma(this.thresholdMax)):(n=this.thresholdMin,o=this.thresholdMax),this.volume.filterData(n,o,this.thresholdOut),t=this.volume.getDataPosition(),e=this.volume.getDataColor(this.getColorParams()),i=this.volume.getDataSize(this.radius,this.scale),r=this.volume.getPickingDataColor(this.getColorParams())}else t=this.surface.getPosition(),e=this.surface.getColor(this.getColorParams()),i=this.surface.getSize(this.radius,this.scale),r=this.surface.getPickingColor(this.getColorParams());"sphere"===this.dotType?this.dotBuffer=new Kt(t,e,i,r,this.getBufferParams({sphereDetail:this.sphereDetail,disableImpostor:this.disableImpostor,dullInterior:!1})):this.dotBuffer=new $t(t,e,this.getBufferParams({pointSize:this.pointSize,sizeAttenuation:this.sizeAttenuation,sortParticles:this.sortParticles,useTexture:this.useTexture,alphaTest:this.alphaTest,forceTransparent:this.forceTransparent,edgeBleach:this.edgeBleach})),this.bufferList.push(this.dotBuffer)},update:function(t){if(0!==this.bufferList.length){t=t||{};var e={};t.color&&(this.volume?e.color=this.volume.getDataColor(this.getColorParams()):e.color=this.surface.getColor(this.getColorParams())),"sphere"===this.dotType&&(t.radius||t.scale)&&(this.volume?e.radius=this.volume.getDataSize(this.radius,this.scale):e.radius=this.surface.getSize(this.radius,this.scale)),this.dotBuffer.setAttributes(e)}},setParameters:function(t,e,i){return e=e||{},t&&void 0!==t.thresholdType&&this.volume instanceof It&&("value"===this.thresholdType&&"sigma"===t.thresholdType?(this.thresholdMin=this.volume.getSigmaForValue(this.thresholdMin),this.thresholdMax=this.volume.getSigmaForValue(this.thresholdMax)):"sigma"===this.thresholdType&&"value"===t.thresholdType&&(this.thresholdMin=this.volume.getValueForSigma(this.thresholdMin),this.thresholdMax=this.volume.getValueForSigma(this.thresholdMax)),this.thresholdType=t.thresholdType),t&&void 0!==t.radiusType&&("radius"===t.radiusType?this.radius=this.defaultSize:this.radius=t.radiusType,e.radius=!0,"sphere"!==this.dotType||Rr&&!this.disableImpostor||(i=!0)),
t&&void 0!==t.radius&&(e.radius=!0,"sphere"!==this.dotType||Rr&&!this.disableImpostor||(i=!0)),t&&void 0!==t.scale&&(e.scale=!0,"sphere"!==this.dotType||Rr&&!this.disableImpostor||(i=!0)),Nt.prototype.setParameters.call(this,t,e,i),this}}),ee.prototype=Object.assign(Object.create(Nt.prototype),{constructor:ee,type:"structure",parameters:Object.assign({radiusType:{type:"select",options:k.types},radius:{type:"number",precision:3,max:10,min:.001},scale:{type:"number",precision:3,max:10,min:.001},assembly:null},Nt.prototype.parameters),defaultScale:{vdw:1,covalent:1,bfactor:.01,sstruc:1},defaultSize:1,init:function(t){var e=t||{};e.colorScheme=e.colorScheme||"element",this.radius=e.radius||"vdw",this.scale=e.scale||1,this.assembly=void 0===e.assembly?"default":e.assembly,this.defaultAssembly=e.defaultAssembly||"",Nt.prototype.init.call(this,e)},create:function(){if(0!==this.structureView.atomCount){var t="default"===this.assembly?this.defaultAssembly:this.assembly,e=this.structure.biomolDict[t];if(e)e.partList.forEach(function(t,e){var i=t.getView(this.structureView);if(0!==i.atomCount){var r=this.createData(i,e);r&&(r.sview=i,r.instanceList=t.getInstanceList(),this.dataList.push(r))}},this);else{var i=this.createData(this.structureView,0);i&&(i.sview=this.structureView,this.dataList.push(i))}}},createData:function(t){console.error("createData not implemented")},update:function(t){this.dataList.forEach(function(e){e.bufferList.length>0&&this.updateData(t,e)},this)},updateData:function(t,e){console.error("updateData not implemented")},getColorParams:function(){var t=Nt.prototype.getColorParams.call(this);return t.structure=this.structure,t},getAtomParams:function(t,e){return Object.assign({what:t,colorParams:this.getColorParams(),radiusParams:{radius:this.radius,scale:this.scale}},e)},getBondParams:function(t,e){return Object.assign({what:t,colorParams:this.getColorParams(),radiusParams:{radius:this.radius,scale:this.scale}},e)},setSelection:function(t,e){return this.selection.setString(t,e),this},setParameters:function(t,e,i){return e=e||{},t&&void 0!==t.radiusType&&("size"===t.radiusType?this.radius=this.defaultSize:this.radius=t.radiusType,e.radius=!0,Rr&&!this.disableImpostor||(i=!0)),t&&void 0!==t.radius&&(e.radius=!0,Rr&&!this.disableImpostor||(i=!0)),t&&void 0!==t.scale&&(e.radius=!0,Rr&&!this.disableImpostor||(i=!0)),Nt.prototype.setParameters.call(this,t,e,i),this},getParameters:function(){var t=Object.assign(Nt.prototype.getParameters.call(this),{sele:this.selection?this.selection.string:void 0,defaultAssembly:this.defaultAssembly});return t},attach:function(t){var e=this.viewer,i=this.bufferList;this.dataList.forEach(function(t){t.bufferList.forEach(function(r){i.push(r),e.add(r,t.instanceList)})}),this.setVisibility(this.visible),t()},clear:function(){this.dataList.length=0,Nt.prototype.clear.call(this)},dispose:function(){this.structureView.dispose(),delete this.structure,delete this.structureView,Nt.prototype.dispose.call(this)}}),ie.prototype=Object.assign(Object.create(Ut.prototype),{constructor:ie,setPositionTransform:function(t,e,i){var r,n=new THREE.Vector3,o=new THREE.Vector3,s=new THREE.Vector3,a=new THREE.Vector3(0,1,0);this.applyPositionTransform=function(c,h,u){o.fromArray(t,u),s.fromArray(e,u),c.lookAt(o,s,a),r=i[h],n.set(r,r,o.distanceTo(s)),c.scale(n)}},setAttributes:function(t){var e=this._position.length/2,i=this._radius.length/2,r={};t.position1&&t.position2&&(U(t.position1,t.position2,this.__center),U(t.position1,this.__center,this._position),U(this.__center,t.position2,this._position,e),this._from.set(t.position1),this._from.set(this.__center,e),this._to.set(this.__center),this._to.set(t.position2,e),r.position=this._position),t.color&&t.color2&&(this._color.set(t.color),this._color.set(t.color2,e),r.color=this._color),t.pickingColor&&t.pickingColor2&&(this._pickingColor.set(t.pickingColor),this._pickingColor.set(t.pickingColor2,e),r.pickingColor=this._pickingColor),t.radius&&(this._radius.set(t.radius),this._radius.set(t.radius,i)),(t.position1&&t.position2||t.radius)&&this.setPositionTransform(this._from,this._to,this._radius),Ut.prototype.setAttributes.call(this,r)}}),re.prototype=Object.assign(Object.create(qt.prototype),{constructor:re}),ne.prototype=Object.assign(Object.create(re.prototype),{constructor:ne,getMaterial:function(t){var e=Lt.prototype.getMaterial.call(this,t);return this.cap&&(e.defines.CAP=1),e}}),se.prototype=Object.assign(Object.create(Lt.prototype),{constructor:se,setAttributes:function(t){var e,i,r,n,o,s,a=this.geometry.attributes;t.from&&t.to&&(e=t.from,i=t.to,o=a.position.array,a.position.needsUpdate=!0),t.color&&t.color2&&(r=t.color,n=t.color2,s=a.color.array,a.color.needsUpdate=!0);for(var c,h,u,l,d,m,f,p,Y,X,Z,g,v=this.size,y=6*v,b=0;v>b;b++)h=3*b,c=2*b*3,u=c+y,e&&i&&(f=e[h],p=e[h+1],Y=e[h+2],X=i[h],Z=i[h+1],g=i[h+2],l=(f+X)/2,d=(p+Z)/2,m=(Y+g)/2,o[c]=f,o[c+1]=p,o[c+2]=Y,o[c+3]=l,o[c+4]=d,o[c+5]=m,o[u]=l,o[u+1]=d,o[u+2]=m,o[u+3]=X,o[u+4]=Z,o[u+5]=g),r&&n&&(s[c]=s[c+3]=r[h],s[c+1]=s[c+4]=r[h+1],s[c+2]=s[c+5]=r[h+2],s[u]=s[u+3]=n[h],s[u+1]=s[u+4]=n[h+1],s[u+2]=s[u+5]=n[h+2])}}),ae.prototype=Object.assign(Object.create(ee.prototype),{constructor:ae,type:"",parameters:Object.assign({drawLine:{type:"boolean",rebuild:!0},drawCylinder:{type:"boolean",rebuild:!0},drawPoint:{type:"boolean",rebuild:!0},drawSphere:{type:"boolean",rebuild:!0},linewidth:{type:"integer",max:20,min:1,rebuild:!0},pointSize:{type:"integer",max:20,min:1,rebuild:!0},sizeAttenuation:{type:"boolean",rebuild:!0},sort:{type:"boolean",rebuild:!0}},Nt.prototype.parameters),init:function(t){var e=t||{};e.colorScheme=e.colorScheme||"uniform",e.colorValue=e.colorValue||14540253,this.drawLine=e.drawLine||!0,this.drawCylinder=e.drawCylinder||!1,this.drawPoint=e.drawPoint||!1,this.drawSphere=e.drawSphere||!1,this.pointSize=e.pointSize||1,this.sizeAttenuation=void 0!==e.sizeAttenuation?e.sizeAttenuation:!1,this.sort=void 0!==e.sort?e.sort:!0,ee.prototype.init.call(this,e)},attach:function(t){this.bufferList.forEach(function(t){this.viewer.add(t)},this),this.setVisibility(this.visible),t()},prepare:function(t){t()},create:function(){if(0!==this.atomSet.atomCount){var t=this,e=this.atomSet.atoms[0].index;this.trajectory.getPath(e,function(e){var i=e.length/3,r=new THREE.Color(t.colorValue);if(t.drawSphere){var n=new Kt(e,q(i,r.r,r.g,r.b),G(i,.2),q(i,r.r,r.g,r.b),t.getBufferParams({sphereDetail:t.sphereDetail,dullInterior:!0,disableImpostor:t.disableImpostor}));t.bufferList.push(n)}if(t.drawCylinder){var o=new oe(e.subarray(0,-3),e.subarray(3),q(i-1,r.r,r.g,r.b),q(i-1,r.r,r.g,r.b),G(i,.05),q(i-1,r.r,r.g,r.b),q(i-1,r.r,r.g,r.b),t.getBufferParams({shift:0,cap:!0,radiusSegments:t.radiusSegments,disableImpostor:t.disableImpostor,dullInterior:!0}));t.bufferList.push(o)}if(t.drawPoint){var s=new $t(e,q(i,r.r,r.g,r.b),t.getBufferParams({pointSize:t.pointSize,sizeAttenuation:t.sizeAttenuation,sort:t.sort}));t.bufferList.push(s)}if(t.drawLine){var a=new se(e.subarray(0,-3),e.subarray(3),q(i-1,r.r,r.g,r.b),q(i-1,r.r,r.g,r.b),t.getBufferParams());t.bufferList.push(a)}t.attach()})}}}),he.prototype=Object.assign(Object.create(ue.prototype),{constructor:he,type:"representation",signals:Object.assign({parametersChanged:null},ue.prototype.signals),getType:function(){return this.repr.type},setRepresentation:function(t){this.repr&&this.repr.dispose(),this.repr=t,this.stage.tasks.listen(this.repr.tasks),this.updateVisibility()},addRepresentation:function(t){},removeRepresentation:function(t){},dispose:function(){this.parent&&this.parent.removeRepresentation(this),this.repr.dispose(),this.signals.disposed.dispatch()},setVisibility:function(t){return this.visible=t,this.updateVisibility(),this.signals.visibilityChanged.dispatch(this.visible),this},updateVisibility:function(){this.parent?this.repr.setVisibility(this.parent.visible&&this.visible):this.repr.setVisibility(this.visible)},update:function(t){return this.repr.update(t),this},build:function(t){return this.repr.build(t),this},setSelection:function(t){return this.repr.setSelection(t),this},setParameters:function(t){return this.repr.setParameters(t),this.signals.parametersChanged.dispatch(this.repr.getParameters()),this},getParameters:function(){return this.repr.getParameters()},setColor:function(t){return this.repr.setColor(t),this},getCenter:function(){}});var Cn=0;ue.prototype={constructor:ue,type:"component",signals:{representationAdded:null,representationRemoved:null,visibilityChanged:null,statusChanged:null,nameChanged:null,disposed:null},addRepresentation:function(t,e,i){var n=i||{},o=this.stage.getParameters();n.quality=n.quality||o.quality,n.disableImpostor=r(n.disableImpostor,!o.impostor),n.visible=r(n.visible,!0);var s=Object.assign({},n,{visible:this.visible&&n.visible}),a=ce(t,e,this.viewer,s),c=new he(this.stage,a,n,this);return this.reprList.push(c),this.signals.representationAdded.dispatch(c),c},addBufferRepresentation:function(t,e){return ue.prototype.addRepresentation.call(this,"buffer",t,e)},removeRepresentation:function(t){var e=this.reprList.indexOf(t);-1!==e&&this.reprList.splice(e,1),this.signals.representationRemoved.dispatch(t)},updateRepresentations:function(t){this.reprList.forEach(function(e){e.update(t)}),this.stage.viewer.requestRender()},clearRepresentations:function(){this.reprList.slice().forEach(function(t){t.dispose()})},dispose:function(){this.clearRepresentations(),delete this.reprList,this.signals.disposed.dispatch()},setVisibility:function(t){return this.visible=t,this.eachRepresentation(function(t){t.updateVisibility()}),this.signals.visibilityChanged.dispatch(t),this},setStatus:function(t){return this.status=t,this.signals.statusChanged.dispatch(t),this},setName:function(t){return this.name=t,this.signals.nameChanged.dispatch(t),this},getCenter:function(){},eachRepresentation:function(t){this.reprList.forEach(t)}},le.prototype={constructor:le,_remove:function(t){var e=this.list.indexOf(t);-1!==e&&this.list.splice(e,1)},_invoke:function(t,e){for(var i=this.list.length,r=0;i>r;++r){var n=this.list[r],o=n[t];"function"==typeof o&&o.apply(n,e)}return this},setVisibility:function(t){return this._invoke("setVisibility",[t])},setSelection:function(t){return this._invoke("setSelection",[t])},dispose:function(){return this._invoke("dispose")}},de.prototype=Object.assign(Object.create(le.prototype),{constructor:de,addRepresentation:function(t,e){return this._invoke("addRepresentation",[t,e])},centerView:function(t,e){return this._invoke("centerView",[t,e])}}),me.prototype=Object.assign(Object.create(le.prototype),{constructor:me,setParameters:function(t){return this._invoke("setParameters",[t])},setColor:function(t){return this._invoke("setColor",[t])}}),fe.prototype=Object.assign(Object.create(ue.prototype),{constructor:fe,type:"trajectory",signals:Object.assign({frameChanged:null,playerChanged:null,gotNumframes:null,parametersChanged:null},ue.prototype.signals),addRepresentation:function(t,e){return ue.prototype.addRepresentation.call(this,t,this.trajectory,e)},setFrame:function(t){this.trajectory.setFrame(t)},setParameters:function(t){return this.trajectory.setParameters(t),this.signals.parametersChanged.dispatch(t),this},dispose:function(){this.trajectory.dispose(),ue.prototype.dispose.call(this)},getCenter:function(){}}),Ye.prototype={constructor:Ye,_superpose:function(t,e){this.mean1=jsfeat.matmath.mean_rows(t),this.mean2=jsfeat.matmath.mean_rows(e),jsfeat.matmath.sub_rows(t,this.mean1),jsfeat.matmath.sub_rows(e,this.mean2),jsfeat.matmath.transpose(this.coords1t,t),jsfeat.matmath.transpose(this.coords2t,e),jsfeat.matmath.multiply_ABt(this.A,this.coords2t,this.coords1t);jsfeat.linalg.svd_decompose(this.A,this.W,this.U,this.V);jsfeat.matmath.invert_3x3(this.V,this.VH),jsfeat.matmath.multiply_3x3(this.R,this.U,this.VH),jsfeat.matmath.mat3x3_determinant(this.R)<0&&(Ir.log("R not a right handed system"),jsfeat.matmath.multiply_3x3(this.tmp,this.c,this.VH),jsfeat.matmath.multiply_3x3(this.R,this.U,this.tmp))},prepCoords:function(t,e){var i=0,r=e.data;"function"==typeof t.eachSelectedAtom?t.eachSelectedAtom(function(t){r[i+0]=t.x,r[i+1]=t.y,r[i+2]=t.z,i+=3}):t instanceof Float32Array?r.set(t):Ir.warn("prepCoords: input type unknown")},transform:function(t){var e;"function"==typeof t.eachSelectedAtom?e=t.atomCount:t instanceof Float32Array&&(e=t.length/3);var i=new pe(3,e),r=new pe(e,3);this.prepCoords(t,i),jsfeat.matmath.sub_rows(i,this.mean1),jsfeat.matmath.multiply_ABt(r,this.R,i),jsfeat.matmath.transpose(i,r),jsfeat.matmath.add_rows(i,this.mean2);var n=0,o=i.data;"function"==typeof t.eachSelectedAtom?t.eachSelectedAtom(function(t){t.x=o[n+0],t.y=o[n+1],t.z=o[n+2],n+=3}):t instanceof Float32Array?t.set(o.subarray(0,3*e)):Ir.warn("transform: input type unknown")}},Xe.prototype={constructor:Xe,setStructure:function(t){this.structure=t,this.atomCount=t.atomCount,this.makeAtomIndices(),this.saveInitialStructure(),this.backboneIndices=this.structure.atomIndex(new p("backbone and not hydrogen")),this.makeIndices(),this.frameCache=[],this.boxCache=[],this.pathCache=[],this.frameCacheSize=0,this.currentFrame=-1},saveInitialStructure:function(){var t=0,e=new Float32Array(3*this.atomCount);this.structure.eachSelectedAtom(function(i){e[t+0]=i.x,e[t+1]=i.y,e[t+2]=i.z,t+=3}),this.initialStructure=e},setSelection:function(t){return this.selection.setString(t),this},makeIndices:function(){this.indices=this.structure.atomIndex(this.selection);var t,e,i=3*this.indices.length;this.coords1=new Float32Array(i),this.coords2=new Float32Array(i);var r=this.initialStructure,n=this.coords2;for(t=0;i>t;t+=3)e=3*this.indices[t/3],n[t+0]=r[e+0],n[t+1]=r[e+1],n[t+2]=r[e+2]},makeAtomIndices:function(){Ir.error("Trajectory.makeAtomIndices not implemented")},getNumframes:function(){Ir.error("Trajectory.loadFrame not implemented")},resetCache:function(){return this.frameCache=[],this.boxCache=[],this.pathCache=[],this.frameCacheSize=0,this.setFrame(this.currentFrame),this},setParameters:function(t){var e=t,i=this.params,r=!1;void 0!==e.centerPbc&&e.centerPbc!==i.centerPbc&&(i.centerPbc=e.centerPbc,r=!0),void 0!==e.removePbc&&e.removePbc!==i.removePbc&&(i.removePbc=e.removePbc,r=!0),void 0!==e.superpose&&e.superpose!==i.superpose&&(i.superpose=e.superpose,r=!0),r&&this.resetCache()},setFrame:function(t,e){return void 0===t?this:(this.inProgress=!0,t=parseInt(t),-1===t||this.frameCache[t]?this.updateStructure(t,e):this.loadFrame(t,function(){this.updateStructure(t,e)}.bind(this)),this)},interpolate:function(){var t=function(t,e,i,r,n,o){var s=(i-t)*o,a=(r-e)*o,c=n*n,h=n*c;return(2*e-2*i+s+a)*h+(-3*e+3*i-2*s-a)*c+s*n+e},e=function(t,e,i){return t+(e-t)*i};return function(i,r,n,o,s,a,c){var h,u=this.frameCache,l=u[i],d=u[r],m=u[n],f=u[o],p=l.length,Y=new Float32Array(p);if("spline"===a)for(h=0;p>h;h+=3)Y[h+0]=t(f[h+0],m[h+0],d[h+0],l[h+0],s,1),Y[h+1]=t(f[h+1],m[h+1],d[h+1],l[h+1],s,1),Y[h+2]=t(f[h+2],m[h+2],d[h+2],l[h+2],s,1);else for(h=0;p>h;h+=3)Y[h+0]=e(d[h+0],l[h+0],s),Y[h+1]=e(d[h+1],l[h+1],s),Y[h+2]=e(d[h+2],l[h+2],s);this.structure.updatePosition(Y),this.currentFrame=i,this.signals.frameChanged.dispatch(i),"function"==typeof c&&c()}}(),setFrameInterpolated:function(t,e,i,r,n,o,s){if(void 0===t)return this;var a=this.frameCache,c=[];return a[r]||c.push(r),a[i]||c.push(i),a[e]||c.push(e),a[t]||c.push(t),c.length?this.loadFrame(c,function(){this.interpolate(t,e,i,r,n,o,s)}.bind(this)):this.interpolate(t,e,i,r,n,o,s),this},loadFrame:function(t,e){if(Array.isArray(t)){var i,r=function(t,r){this._loadFrame(t,r),0===i.length()&&"function"==typeof e&&e()}.bind(this);i=new kt(r,t)}else this._loadFrame(t,e)},_loadFrame:function(t,e){Ir.error("Trajectory._loadFrame not implemented")},updateStructure:function(t,e){this._disposed||(-1===t?this.structure.updatePosition(this.initialStructure):this.structure.updatePosition(this.frameCache[t]),this.structure.trajectory={name:this.trajPath,frame:t},"function"==typeof e&&e(),this.currentFrame=t,this.inProgress=!1,this.signals.frameChanged.dispatch(t))},getCircularMean:function(t,e,i){var r=[V(e,i[0],3,0,t),V(e,i[1],3,1,t),V(e,i[2],3,2,t)];return r},centerPbc:function(t,e,i){if(0!==i[0]&&0!==i[8]&&0!==i[4]){var r,n=t.length,o=i[0],s=i[1],a=i[2],c=e[0],h=e[1],u=e[2],l=-c+o+o/2,d=-h+s+s/2,m=-u+a+a/2;for(r=0;n>r;r+=3)t[r+0]=(t[r+0]+l)%o,t[r+1]=(t[r+1]+d)%s,t[r+2]=(t[r+2]+m)%a}},removePbc:function(t,e){if(0!==e[0]&&0!==e[8]&&0!==e[4]){var i,r,n,o,s=t.length;for(i=3;s>i;i+=3)for(r=0;3>r;++r)if(o=t[i+r]-t[i-3+r],Math.abs(o)>.9*e[3*r+r])if(o>0)for(n=0;3>n;++n)t[i+n]-=e[3*r+n];else for(n=0;3>n;++n)t[i+n]+=e[3*r+n];return t}},superpose:function(t){var e,i,r=3*this.indices.length,n=this.coords1,o=this.coords2;for(e=0;r>e;e+=3)i=3*this.indices[e/3],n[e+0]=t[i+0],n[e+1]=t[i+1],n[e+2]=t[i+2];var s=new Ye(n,o);s.transform(t)},process:function(t,e,i,r){if(this.setNumframes(r),e){if(this.backboneIndices.length>0&&this.params.centerPbc){var n=[e[0],e[4],e[8]],o=this.getCircularMean(this.backboneIndices,i,n);this.centerPbc(i,o,n)}this.params.removePbc&&this.removePbc(i,e)}this.indices.length>0&&this.params.superpose&&this.superpose(i),this.frameCache[t]=i,this.boxCache[t]=e,this.frameCacheSize+=1},setNumframes:function(t){t!==this.numframes&&(this.numframes=t,this.signals.gotNumframes.dispatch(t))},dispose:function(){this.frameCache=[],this._disposed=!0,this.player&&this.player.stop()},setPlayer:function(t){this.player=t,this.signals.playerChanged.dispatch(t)},getPath:function(t,e){Ir.error("Trajectory.getPath not implemented")}},Ze.prototype=Object.assign(Object.create(Xe.prototype),{constructor:Ze,type:"frames",setFrames:function(t){this.name=t.name,this.path=t.path,this.frames=t.coordinates,this.boxes=t.boxes},makeAtomIndices:function(){var t=this.structure;"StructureView"===t.type?this.atomIndices=t.structure.atomIndex(t.selection):this.atomIndices=null},_loadFrame:function(t,e){var i,r=(this.structure,this.frames[t]);if(this.atomIndices){var n=this.atomIndices,o=n.length;i=new Float32Array(3*o);for(var s=0;o>s;++s){var a=3*s,c=3*n[s];i[a+0]=r[c+0],i[a+1]=r[c+1],i[a+2]=r[c+2]}}else i=new Float32Array(r);var h=this.boxes[t],u=this.frames.length;this.process(t,h,i,u),"function"==typeof e&&e()},getNumframes:function(){this.frames&&this.setNumframes(this.frames.length)},getPath:function(t,e){var i,r,n,o=this.numframes,s=3*t,a=new Float32Array(3*o);for(i=0;o>i;++i)r=3*i,n=this.frames[i],a[r+0]=n[s+0],a[r+1]=n[s+1],a[r+2]=n[s+2];e(a)}}),ge.prototype=Object.assign(Object.create(Xe.prototype),{constructor:ge,type:"structure",makeAtomIndices:function(){var t=this.structure,e=t.atomSet,i=e.size();if(i<t.atomStore.count){var r=new Int32Array(i);e.forEach(function(t,e){r[e]=t}),this.atomIndices=r}else this.atomIndices=null},_loadFrame:function(t,e){var i,r=(this.structure,this.structure.frames[t]);if(this.atomIndices){var n=this.atomIndices,o=n.length;i=new Float32Array(3*o);for(var s=0;o>s;++s){var a=3*s,c=3*n[s];i[a+0]=r[c+0],i[a+1]=r[c+1],i[a+2]=r[c+2]}}else i=new Float32Array(r);var h=this.structure.boxes[t],u=this.structure.frames.length;this.process(t,h,i,u),"function"==typeof e&&e()},getNumframes:function(){this.setNumframes(this.structure.frames.length)},getPath:function(t,e){var i,r,n,o=this.numframes,s=3*t,a=new Float32Array(3*o);for(i=0;o>i;++i)r=3*i,n=this.structure.frames[i],a[r+0]=n[s+0],a[r+1]=n[s+1],a[r+2]=n[s+2];e(a)}}),ve.prototype=Object.assign(Object.create(Xe.prototype),{constructor:ve,type:"remote",makeAtomIndices:function(){var t=(this.structure,[]);t.push([0,this.atomCount]),this.atomIndices=t},_loadFrame:function(t,e){var i=new XMLHttpRequest,r=Dr.trajectory,n=r.getFrameUrl(this.trajPath,t),o=r.getFrameParams(this.trajPath,this.atomIndices);i.open("POST",n,!0),i.responseType="arraybuffer",i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.addEventListener("load",function(r){var o=i.response;if(!o)return void Ir.error("empty arrayBuffer for '"+n+"'");var s=new Int32Array(o,0,1)[0],a=(new Float32Array(o,4,1)[0],new Float32Array(o,8,9)),c=new Float32Array(o,44);this.process(t,a,c,s),"function"==typeof e&&e()}.bind(this),!1),i.send(o)},getNumframes:function(){var t=new THREE.XHRLoader,e=Dr.trajectory,i=e.getNumframesUrl(this.trajPath);t.load(i,function(t){this.setNumframes(parseInt(t))}.bind(this))},getPath:function(t,e){if(this.pathCache[t])return void e(this.pathCache[t]);Ir.time("loadPath");var i=new XMLHttpRequest,r=Dr.trajectory,n=r.getPathUrl(this.trajPath,t),o="";i.open("POST",n,!0),i.responseType="arraybuffer",i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.addEventListener("load",function(r){Ir.timeEnd("loadPath");var o=i.response;if(!o)return void Ir.error("empty arrayBuffer for '"+n+"'");var s=new Float32Array(o);this.pathCache[t]=s,e(s)}.bind(this),!1),i.send(o)}});var _n={PROTEIN:1,NUCLEIC:2,RNA:3,DNA:4,POLYMER:5,WATER:6,HELIX:7,SHEET:8,BACKBONE:9,SIDECHAIN:10,ALL:11,HETERO:12,ION:13};be.prototype={constructor:be,setString:function(t,e){if(void 0===t&&(t=this.string||""),t!==this.string){try{this.parse(t)}catch(i){this.selection={error:i.message}}this.string=t,this.test=this.makeAtomTest(),this.residueTest=this.makeResidueTest(),this.chainTest=this.makeChainTest(),this.modelTest=this.makeModelTest(),this.atomOnlyTest=this.makeAtomTest(!0),this.residueOnlyTest=this.makeResidueTest(!0),this.chainOnlyTest=this.makeChainTest(!0),this.modelOnlyTest=this.makeModelTest(!0),e||this.signals.stringChanged.dispatch(this.string)}},parse:function(t){if(this.selection={operator:void 0,rules:[]},t){var e,i,r=this,n=this.selection,o=[];t=t.replace(/\(/g," ( ").replace(/\)/g," ) ").trim(),"("===t.charAt(0)&&")"===t.substr(-1)&&(t=t.slice(1,-1).trim());var s,a,c,h,u,l,d,m,f,p,Y=t.split(/\s+/),X=["*","","ALL"],Z=0,g=function(t){e={operator:t,rules:[]},void 0===n?(n=e,r.selection=e):(n.rules.push(e),o.push(n),n=e),Z=0},v=function(t){i=n,n=o.pop(),void 0===n?(g(t),y(i)):Z=n.rules.length},y=function(t){n.rules.push(t),Z+=1};for(c=0;c<Y.length;++c)if(s=Y[c],"("!==s)if(")"!==s){if(h>0)if("NOT"===s.toUpperCase())h=1;else if(1===h)h=2;else{if(2!==h)throw new Error("something went wrong with 'not'");h=!1,v()}if("AND"!==s.toUpperCase())if("OR"!==s.toUpperCase())if("NOT"!==s.toUpperCase())if(a={},"HETERO"!==s.toUpperCase())if("WATER"!==s.toUpperCase())if("PROTEIN"!==s.toUpperCase())if("NUCLEIC"!==s.toUpperCase())if("RNA"!==s.toUpperCase())if("DNA"!==s.toUpperCase())if("POLYMER"!==s.toUpperCase())if("ION"!==s.toUpperCase())if("HYDROGEN"!==s.toUpperCase())if("SMALL"!==s.toUpperCase())if("NUCLEOPHILIC"!==s.toUpperCase())if("HYDROPHOBIC"!==s.toUpperCase())if("AROMATIC"!==s.toUpperCase())if("AMIDE"!==s.toUpperCase())if("ACIDIC"!==s.toUpperCase())if("BASIC"!==s.toUpperCase())if("CHARGED"!==s.toUpperCase())if("POLAR"!==s.toUpperCase())if("NONPOLAR"!==s.toUpperCase())if("HELIX"!==s.toUpperCase())if("SHEET"!==s.toUpperCase())if("TURN"!==s.toUpperCase())if("BACKBONE"!==s.toUpperCase())if("SIDECHAIN"!==s.toUpperCase())if("SIDECHAINATTACHED"!==s.toUpperCase())if(-1===X.indexOf(s.toUpperCase()))if("@"!==s.charAt(0))if("#"!==s.charAt(0))if("["!==s[0]||"]"!==s[s.length-1])if(s.length>=1&&s.length<=4&&"^"!==s[0]&&":"!==s[0]&&"."!==s[0]&&"%"!==s[0]&&"/"!==s[0]&&isNaN(parseInt(s)))a.resname=s.toUpperCase(),y(a);else{if(a={operator:"AND",rules:[]},d=s.split("/"),d.length>1&&d[1]){if(isNaN(parseInt(d[1])))throw new Error("model must be an integer");a.rules.push({model:parseInt(d[1])})}if(f=d[0].split("%"),f.length>1&&a.rules.push({altloc:f[1]}),u=f[0].split("."),u.length>1&&u[1]){if(u[1].length>4)throw new Error("atomname must be one to four characters");a.rules.push({atomname:u[1].substring(0,4).toUpperCase()})}if(l=u[0].split(":"),l.length>1&&l[1]&&a.rules.push({chainname:l[1]}),p=l[0].split("^"),p.length>1&&a.rules.push({inscode:p[1]}),p[0])if(m=p[0].split("-"),1===m.length){if(m=parseInt(m[0]),isNaN(m))throw new Error("resi must be an integer");a.rules.push({resno:m})}else{if(2!==m.length)throw new Error("resi range must contain one '-'");a.rules.push({resno:[parseInt(m[0]),parseInt(m[1])]})}if(1===a.rules.length)y(a.rules[0]);else{if(!(a.rules.length>1))throw new Error("empty selection chunk");y(a)}}else a.resname=s.substr(1,s.length-2).toUpperCase(),y(a);else a.element=s.substr(1).toUpperCase(),y(a);else{for(var b=s.substr(1).split(","),x=0,S=b.length;S>x;++x)b[x]=parseInt(b[x]);b.sort(function(t,e){return t-e}),a.atomindex=b,y(a)}else a.keyword=_n.ALL,y(a);else a={operator:"OR",rules:[{keyword:_n.SIDECHAIN},{operator:"AND",negate:!1,rules:[{keyword:_n.PROTEIN},{operator:"OR",negate:!1,rules:[{atomname:"CA"},{atomname:"BB"}]}]},{operator:"AND",negate:!1,rules:[{resname:"PRO"},{atomname:"N"}]},{operator:"AND",negate:!1,rules:[{keyword:_n.NUCLEIC},{operator:"OR",negate:!0,rules:[{atomname:"P"},{atomname:"OP1"},{atomname:"OP2"},{atomname:"O3'"},{atomname:"O3*"},{atomname:"O5'"},{atomname:"O5*"},{atomname:"C5'"},{atomname:"C5*"}]}]}]},y(a);else a.keyword=_n.SIDECHAIN,y(a);else a.keyword=_n.BACKBONE,y(a);else a={operator:"AND",rules:[{operator:"OR",negate:!0,rules:[{keyword:_n.HELIX},{keyword:_n.SHEET}]},{operator:"OR",rules:[{keyword:_n.PROTEIN},{sstruc:"s"},{sstruc:"t"},{sstruc:"l"}]}]},y(a);else a.keyword=_n.SHEET,y(a);else a.keyword=_n.HELIX,y(a);else a={operator:"OR",rules:[{resname:"ALA"},{resname:"CYS"},{resname:"GLY"},{resname:"ILE"},{resname:"LEU"},{resname:"MET"},{resname:"PHE"},{resname:"PRO"},{resname:"VAL"},{resname:"TRP"}]},y(a);else a={operator:"OR",rules:[{resname:"ASP"},{resname:"GLU"},{resname:"HIS"},{resname:"LYS"},{resname:"ARG"},{resname:"ASN"},{resname:"GLN"},{resname:"SER"},{resname:"THR"},{resname:"TYR"}]},y(a);else a={operator:"OR",rules:[{resname:"ASP"},{resname:"GLU"},{resname:"HIS"},{resname:"LYS"},{resname:"ARG"}]},y(a);else a={operator:"OR",rules:[{resname:"HIS"},{resname:"LYS"},{resname:"ARG"}]},y(a);else a={operator:"OR",rules:[{resname:"ASP"},{resname:"GLU"}]},y(a);else a={operator:"OR",rules:[{resname:"ASN"},{resname:"GLN"}]},y(a);else a={operator:"OR",rules:[{resname:"PHE"},{resname:"TYR"},{resname:"TRP"}]},y(a);else a={operator:"OR",rules:[{resname:"VAL"},{resname:"LEU"},{resname:"ILE"},{resname:"MET"},{resname:"PRO"}]},y(a);else a={operator:"OR",rules:[{resname:"SER"},{resname:"THR"},{resname:"CYS"}]},y(a);else a={operator:"OR",rules:[{resname:"GLY"},{resname:"ALA"}]},y(a);else a.element="H",y(a);else a.keyword=_n.ION,y(a);else a.keyword=_n.POLYMER,y(a);else a.keyword=_n.DNA,y(a);else a.keyword=_n.RNA,y(a);else a.keyword=_n.NUCLEIC,y(a);else a.keyword=_n.PROTEIN,y(a);else a.keyword=_n.WATER,y(a);else a.keyword=_n.HETERO,y(a);else h=1,g(),n.negate=!0;else"AND"===n.operator?v("OR"):n.operator="OR";else if("OR"===n.operator){var w=n.rules.pop();g("AND"),y(w)}else n.operator="AND"}else v(),n.negate&&v();else h=!1,g();void 0===this.selection.operator&&1===this.selection.rules.length&&this.selection.rules[0].hasOwnProperty("operator")&&(this.selection=this.selection.rules[0])}},_makeTest:function(t,e){if(void 0===e&&(e=this.selection),null===e)return!1;if(e.error)return!1;var i=e.rules.length;if(0===i)return!1;for(var r,n,o,s,a=!e.negate,c=!!e.negate,h=[],u=0;i>u;++u)r=e.rules[u],r.hasOwnProperty("operator")&&(h[u]=this._makeTest(t,r));return function(u){n="AND"===e.operator,s=!1;for(var l=0;i>l;++l)if(r=e.rules[l],r.hasOwnProperty("operator")){if(o=h[l]?h[l](u):-1,-1===o){s=!0;continue}if(o===!0){if(n)continue;return a}if(n)return c}else{if(r.keyword===_n.ALL){if(n)continue;return a}if(o=t(u,r),-1!==o){if(o===!0){if(n)continue;return a}if(n)return c}else s=!0}return s?-1:n?a:c}},_filter:function(t,e){if(void 0===e&&(e=this.selection),e.error)return e;var i=e.rules.length;if(0===i)return e;var r={operator:e.operator,rules:[]};e.hasOwnProperty("negate")&&(r.negate=e.negate);for(var n=0;i>n;++n){var o=e.rules[n];if(o.hasOwnProperty("operator")){var s=this._filter(t,o);null!==s&&r.rules.push(s)}else t(o)||r.rules.push(o)}return r.rules.length>0?e:null},makeAtomTest:function(t){var e,i=["h","g","i"],r=["e","b"];e=t?this._filter(function(t){return void 0!==t.keyword&&t.keyword!==_n.BACKBONE&&t.keyword!==_n.SIDECHAIN?!0:void 0!==t.model?!0:void 0!==t.chainname?!0:void 0!==t.resname?!0:void 0!==t.resno?!0:void 0!==t.sstruc}):this.selection;var n=function(t,e){if(void 0===e.atomname&&void 0===e.element&&void 0===e.altloc&&void 0===e.atomindex&&void 0===e.keyword&&void 0===e.inscode&&void 0===e.resname&&void 0===e.sstruc&&void 0===e.resno&&void 0===e.chainname&&void 0===e.model)return-1;if(void 0!==e.keyword){if(e.keyword===_n.BACKBONE&&!t.isBackbone())return!1;if(e.keyword===_n.SIDECHAIN&&!t.isSidechain())return!1;if(e.keyword===_n.HETERO&&!t.isHetero())return!1;if(e.keyword===_n.PROTEIN&&!t.isProtein())return!1;if(e.keyword===_n.NUCLEIC&&!t.isNucleic())return!1;if(e.keyword===_n.RNA&&!t.isRna())return!1;if(e.keyword===_n.DNA&&!t.isDna())return!1;if(e.keyword===_n.POLYMER&&!t.isPolymer())return!1;if(e.keyword===_n.WATER&&!t.isWater())return!1;if(e.keyword===_n.HELIX&&-1===i.indexOf(t.sstruc))return!1;if(e.keyword===_n.SHEET&&-1===r.indexOf(t.sstruc))return!1;if(e.keyword===_n.ION&&!t.isIon())return!1}if(void 0!==e.atomname&&e.atomname!==t.atomname)return!1;if(void 0!==e.element&&e.element!==t.element)return!1;if(void 0!==e.altloc&&e.altloc!==t.altloc)return!1;if(void 0!==e.atomindex&&Gi(e.atomindex,t.index)<0)return!1;if(void 0!==e.resname&&e.resname!==t.resname)return!1;if(void 0!==e.sstruc&&e.sstruc!==t.sstruc)return!1;if(void 0!==e.resno)if(Array.isArray(e.resno)&&2===e.resno.length){if(e.resno[0]>t.resno||e.resno[1]<t.resno)return!1}else if(e.resno!==t.resno)return!1;return void 0!==e.inscode&&e.inscode!==t.inscode?!1:void 0!==e.chainname&&e.chainname!==t.chainname?!1:void 0===e.model||e.model===t.modelIndex};return this._makeTest(n,e)},makeResidueTest:function(t){var e,i=["h","g","i"],r=["e","b"];e=t?this._filter(function(t){return t.keyword===_n.BACKBONE||t.keyword===_n.SIDECHAIN?!0:void 0!==t.model?!0:void 0!==t.chainname?!0:void 0!==t.atomname?!0:void 0!==t.element?!0:void 0!==t.altloc?!0:void 0!==t.atomindex}):this.selection;var n=function(t,e){if(void 0===e.resname&&void 0===e.resno&&void 0===e.inscode&&void 0===e.sstruc&&void 0===e.model&&void 0===e.chainname&&(void 0===e.keyword||e.keyword===_n.BACKBONE||e.keyword===_n.SIDECHAIN))return-1;if(void 0!==e.keyword){if(e.keyword===_n.HETERO&&!t.isHetero())return!1;if(e.keyword===_n.PROTEIN&&!t.isProtein())return!1;if(e.keyword===_n.NUCLEIC&&!t.isNucleic())return!1;if(e.keyword===_n.RNA&&!t.isRna())return!1;if(e.keyword===_n.DNA&&!t.isDna())return!1;if(e.keyword===_n.POLYMER&&!t.isPolymer())return!1;if(e.keyword===_n.WATER&&!t.isWater())return!1;if(e.keyword===_n.HELIX&&-1===i.indexOf(t.sstruc))return!1;if(e.keyword===_n.SHEET&&-1===r.indexOf(t.sstruc))return!1;if(e.keyword===_n.ION&&!t.isIon())return!1}if(void 0!==e.resname&&e.resname!==t.resname)return!1;if(void 0!==e.sstruc&&e.sstruc!==t.sstruc)return!1;if(void 0!==e.resno)if(Array.isArray(e.resno)&&2===e.resno.length){if(e.resno[0]>t.resno||e.resno[1]<t.resno)return!1}else if(e.resno!==t.resno)return!1;return void 0!==e.inscode&&e.inscode!==t.inscode?!1:void 0!==e.chainname&&e.chainname!==t.chainname?!1:void 0===e.model||e.model===t.modelIndex};return this._makeTest(n,e)},makeChainTest:function(t){var e;e=t?this._filter(function(t){return void 0!==t.keyword?!0:void 0!==t.resname?!0:void 0!==t.resno?!0:void 0!==t.atomname?!0:void 0!==t.element?!0:void 0!==t.altloc?!0:void 0!==t.sstruc?!0:void 0!==t.inscode?!0:void 0!==t.atomindex}):this.selection;var i=function(t,e){return void 0===e.chainname&&void 0===e.model?-1:void 0!==e.chainname&&e.chainname!==t.chainname?!1:void 0===e.model||e.model===t.modelIndex};return this._makeTest(i,e)},makeModelTest:function(t){var e;e=t?this._filter(function(t){return void 0!==t.keyword?!0:void 0!==t.chainname?!0:void 0!==t.resname?!0:void 0!==t.resno?!0:void 0!==t.atomname?!0:void 0!==t.element?!0:void 0!==t.altloc?!0:void 0!==t.sstruc?!0:void 0!==t.inscode?!0:void 0!==t.atomindex}):this.selection;var i=function(t,e){return void 0===e.model?-1:void 0===e.model||e.model===t.index;
};return this._makeTest(i,e)}};var Pn=function(){function t(t,e){var i,r=0,n={};return e.forEach(function(e){i=0;var o={};e.forEach(function(e){o[t[i++]]=e}),n[t[r++]]=o}),n}var e=[[4,0,-2,-1,-2,0,-2,-1,-1,-1,-1,-2,-1,-1,-1,1,0,0,-3,-2],[0,9,-3,-4,-2,-3,-3,-1,-3,-1,-1,-3,-3,-3,-3,-1,-1,-1,-2,-2],[-2,-3,6,2,-3,-1,-1,-3,-1,-4,-3,1,-1,0,-2,0,-1,-3,-4,-3],[-1,-4,2,5,-3,-2,0,-3,1,-3,-2,0,-1,2,0,0,-1,-2,-3,-2],[-2,-2,-3,-3,6,-3,-1,0,-3,0,0,-3,-4,-3,-3,-2,-2,-1,1,3],[0,-3,-1,-2,-3,6,-2,-4,-2,-4,-3,0,-2,-2,-2,0,-2,-3,-2,-3],[-2,-3,-1,0,-1,-2,8,-3,-1,-3,-2,1,-2,0,0,-1,-2,-3,-2,2],[-1,-1,-3,-3,0,-4,-3,4,-3,2,1,-3,-3,-3,-3,-2,-1,3,-3,-1],[-1,-3,-1,1,-3,-2,-1,-3,5,-2,-1,0,-1,1,2,0,-1,-2,-3,-2],[-1,-1,-4,-3,0,-4,-3,2,-2,4,2,-3,-3,-2,-2,-2,-1,1,-2,-1],[-1,-1,-3,-2,0,-3,-2,1,-1,2,5,-2,-2,0,-1,-1,-1,1,-1,-1],[-2,-3,1,0,-3,0,1,-3,0,-3,-2,6,-2,0,0,1,0,-3,-4,-2],[-1,-3,-1,-1,-4,-2,-2,-3,-1,-3,-2,-2,7,-1,-2,-1,-1,-2,-4,-3],[-1,-3,0,2,-3,-2,0,-3,1,-2,0,0,-1,5,1,0,-1,-2,-2,-1],[-1,-3,-2,0,-3,-2,0,-3,2,-2,-1,0,-2,1,5,-1,-1,-3,-3,-2],[1,-1,0,0,-2,0,-1,-2,0,-2,-1,1,-1,0,-1,4,1,-2,-3,-2],[0,-1,-1,-1,-2,-2,-2,-1,-1,-1,-1,0,-1,-1,-1,1,5,0,-2,-2],[0,-1,-3,-2,-1,-3,-3,3,-2,1,1,-3,-2,-2,-3,-2,0,4,-3,-1],[-3,-2,-4,-3,1,-2,-2,-3,-3,-2,-1,-4,-4,-2,-3,-3,-2,-3,11,2],[-2,-2,-3,-2,3,-3,2,-1,-2,-1,-1,-2,-3,-1,-2,-2,-2,-1,2,7]],i=[[4,-1,-2,-2,0,-1,-1,0,-2,-1,-1,-1,-1,-2,-1,1,0,-3,-2,0,-2,-1,0],[-1,5,0,-2,-3,1,0,-2,0,-3,-2,2,-1,-3,-2,-1,-1,-3,-2,-3,-1,0,-1],[-2,0,6,1,-3,0,0,0,1,-3,-3,0,-2,-3,-2,1,0,-4,-2,-3,3,0,-1],[-2,-2,1,6,-3,0,2,-1,-1,-3,-4,-1,-3,-3,-1,0,-1,-4,-3,-3,4,1,-1],[0,-3,-3,-3,9,-3,-4,-3,-3,-1,-1,-3,-1,-2,-3,-1,-1,-2,-2,-1,-3,-3,-2],[-1,1,0,0,-3,5,2,-2,0,-3,-2,1,0,-3,-1,0,-1,-2,-1,-2,0,3,-1],[-1,0,0,2,-4,2,5,-2,0,-3,-3,1,-2,-3,-1,0,-1,-3,-2,-2,1,4,-1],[0,-2,0,-1,-3,-2,-2,6,-2,-4,-4,-2,-3,-3,-2,0,-2,-2,-3,-3,-1,-2,-1],[-2,0,1,-1,-3,0,0,-2,8,-3,-3,-1,-2,-1,-2,-1,-2,-2,2,-3,0,0,-1],[-1,-3,-3,-3,-1,-3,-3,-4,-3,4,2,-3,1,0,-3,-2,-1,-3,-1,3,-3,-3,-1],[-1,-2,-3,-4,-1,-2,-3,-4,-3,2,4,-2,2,0,-3,-2,-1,-2,-1,1,-4,-3,-1],[-1,2,0,-1,-3,1,1,-2,-1,-3,-2,5,-1,-3,-1,0,-1,-3,-2,-2,0,1,-1],[-1,-1,-2,-3,-1,0,-2,-3,-2,1,2,-1,5,0,-2,-1,-1,-1,-1,1,-3,-1,-1],[-2,-3,-3,-3,-2,-3,-3,-3,-1,0,0,-3,0,6,-4,-2,-2,1,3,-1,-3,-3,-1],[-1,-2,-2,-1,-3,-1,-1,-2,-2,-3,-3,-1,-2,-4,7,-1,-1,-4,-3,-2,-2,-1,-2],[1,-1,1,0,-1,0,0,0,-1,-2,-2,0,-1,-2,-1,4,1,-3,-2,-2,0,0,0],[0,-1,0,-1,-1,-1,-1,-2,-2,-1,-1,-1,-1,-2,-1,1,5,-2,-2,0,-1,-1,0],[-3,-3,-4,-4,-2,-2,-3,-2,-2,-3,-2,-3,-1,1,-4,-3,-2,11,2,-3,-4,-3,-2],[-2,-2,-2,-3,-2,-1,-2,-3,2,-1,-1,-2,-1,3,-3,-2,-2,2,7,-1,-3,-2,-1],[0,-3,-3,-3,-1,-2,-2,-3,-3,3,1,-2,1,-1,-2,-2,0,-3,-1,4,-3,-2,-1],[-2,-1,3,4,-3,0,1,-1,0,-3,-4,0,-3,-3,-2,0,-1,-4,-3,-3,4,1,-1],[-1,0,0,1,-3,3,4,-2,0,-3,-3,1,-1,-3,-1,0,-1,-3,-2,-2,1,4,-1],[0,-1,-1,-1,-2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-2,0,0,-2,-1,-1,-1,-1,-1]],r="ACDEFGHIKLMNPQRSTVWY",n="ARNDCQEGHILKMFPSTWYVBZ?";return{blosum62:t(n,i),blosum62x:t(r,e)}}();xe.prototype={constructor:xe,initMatrices:function(){this.n=this.seq1.length,this.m=this.seq2.length,this.score=void 0,this.ali="",this.S=[],this.V=[],this.H=[];for(var t=0;t<=this.n;++t){this.S[t]=[],this.V[t]=[],this.H[t]=[];for(var e=0;e<=this.m;++e)this.S[t][e]=0,this.V[t][e]=0,this.H[t][e]=0}for(var t=0;t<=this.n;++t)this.S[t][0]=this.gap(0),this.H[t][0]=-(1/0);for(var e=0;e<=this.m;++e)this.S[0][e]=this.gap(0),this.V[0][e]=-(1/0);this.S[0][0]=0},gap:function(t){return this.gapPenalty+t*this.gapExtensionPenalty},makeScoreFn:function(){var t,e,i=this.seq1,r=this.seq2,n=this.substMatrix;return n?function(o,s){t=i[o],e=r[s];try{return n[t][e]}catch(a){return-4}}:(Ir.warn("Alignment: no subst matrix"),function(n,o){return t=i[n],e=r[o],t===e?5:-3})},calc:function(){Ir.time("Alignment.calc"),this.initMatrices();var t,e,i,r,n,o,s,a=this.gap(0),c=this.makeScoreFn(),h=this.gapExtensionPenalty,u=this.V,l=this.H,d=this.S,m=this.n,f=this.m;for(o=1;m>=o;++o)for(e=d[o-1],t=u[o-1],i=u[o],r=l[o],n=d[o],s=1;f>=s;++s)i[s]=Math.max(e[s]+a,t[s]+h),r[s]=Math.max(n[s-1]+a,r[s-1]+h),n[s]=Math.max(e[s-1]+c(o-1,s-1),i[s],r[s]);Ir.timeEnd("Alignment.calc")},trace:function(){this.ali1="",this.ali2="";var t=this.makeScoreFn(),e=this.n,i=this.m,r="S";for(this.S[e][i]>=this.V[e][i]&&this.S[e][i]>=this.V[e][i]?(r="S",this.score=this.S[e][i]):this.V[e][i]>=this.H[e][i]?(r="V",this.score=this.V[e][i]):(r="H",this.score=this.H[e][i]);e>0&&i>0;)"S"==r?this.S[e][i]==this.S[e-1][i-1]+t(e-1,i-1)?(this.ali1=this.seq1[e-1]+this.ali1,this.ali2=this.seq2[i-1]+this.ali2,--e,--i,r="S"):this.S[e][i]==this.V[e][i]?r="V":this.S[e][i]==this.H[e][i]?r="H":(Ir.error("Alignment: S"),--e,--i):"V"==r?this.V[e][i]==this.V[e-1][i]+this.gapExtensionPenalty?(this.ali1=this.seq1[e-1]+this.ali1,this.ali2="-"+this.ali2,--e,r="V"):this.V[e][i]==this.S[e-1][i]+this.gap(0)?(this.ali1=this.seq1[e-1]+this.ali1,this.ali2="-"+this.ali2,--e,r="S"):(Ir.error("Alignment: V"),--e):"H"==r?this.H[e][i]==this.H[e][i-1]+this.gapExtensionPenalty?(this.ali1="-"+this.ali1,this.ali2=this.seq2[i-1]+this.ali2,--i,r="H"):this.H[e][i]==this.S[e][i-1]+this.gap(0)?(this.ali1="-"+this.ali1,this.ali2=this.seq2[i-1]+this.ali2,--i,r="S"):(Ir.error("Alignment: H"),--i):Ir.error("Alignment: no matrix");for(;e>0;)this.ali1=this.seq1[e-1]+this.ali1,this.ali2="-"+this.ali2,--e;for(;i>0;)this.ali1="-"+this.ali1,this.ali2=this.seq2[i-1]+this.ali2,--i}},we.prototype=Object.assign(Object.create(ue.prototype),{constructor:we,type:"structure",signals:Object.assign({trajectoryAdded:null,trajectoryRemoved:null,defaultAssemblyChanged:null},ue.prototype.signals),initSelection:function(t){this.selection=new p(t),this.selection.signals.stringChanged.add(function(t){this.applySelection(),this.rebuildRepresentations(),this.rebuildTrajectories()},this),this.applySelection()},applySelection:function(){this.structure.setSelection(this.selection)},setSelection:function(t){return this.selection.setString(t),this},setDefaultAssembly:function(t){this.defaultAssembly=t,this.rebuildRepresentations(),this.signals.defaultAssemblyChanged.dispatch(t)},rebuildRepresentations:function(){this.reprList.forEach(function(t){var e=t.getParameters();e.defaultAssembly=this.defaultAssembly,t.build(e)},this)},rebuildTrajectories:function(){this.trajList.slice(0).forEach(function(t){t.trajectory.setStructure(this.structure)},this)},addRepresentation:function(t,e){var i=e||{};return i.defaultAssembly=this.defaultAssembly,ue.prototype.addRepresentation.call(this,t,this.structure,i)},addTrajectory:function(t,e,i){var r={i:i},n=ye(t,this.structure,e);n.signals.frameChanged.add(function(t){this.updateRepresentations({position:!0})},this);var o=new fe(this.stage,n,r,this);return this.trajList.push(o),this.signals.trajectoryAdded.dispatch(o),o},removeTrajectory:function(t){var e=this.trajList.indexOf(t);-1!==e&&this.trajList.splice(e,1),t.dispose(),this.signals.trajectoryRemoved.dispatch(t)},dispose:function(){this.trajList.slice().forEach(function(t){t.dispose()}),this.trajList=[],this.structure.dispose(),ue.prototype.dispose.call(this)},centerView:function(t,e){t=void 0!==t?t:!0;var i;if(e){var r=new p(e);if(i=this.structure.atomCenter(r),t){var n=this.structure.getBoundingBox(r);t=n.size().length()}}else i=this.structure.center,t&&(t=this.structure.boundingBox.size().length());return this.viewer.centerView(t,i),this},getCenter:function(){return this.structure.center},superpose:function(t,e,i,r,n,o){return Se(this.structure,t.structure,e,i,r,n,o),this.updateRepresentations({position:!0}),this},setVisibility:function(t){return ue.prototype.setVisibility.call(this,t),this.trajList.forEach(function(e){e.setVisibility(t)}),this}}),Ae.prototype=Object.assign(Object.create(ue.prototype),{constructor:Ae,type:"surface",addRepresentation:function(t,e){return ue.prototype.addRepresentation.call(this,t,this.surface,e)},dispose:function(){this.surface.dispose(),ue.prototype.dispose.call(this)},centerView:function(t){var e=this.surface.center;t&&(t=this.surface.boundingBox.size().length()),this.viewer.centerView(t,e)}}),Ce.prototype=Object.assign(Object.create(ue.prototype),{constructor:Ce,type:"script",addRepresentation:function(t){},removeRepresentation:function(t){},run:function(){var t=this;this.setStatus("running"),this.script.call(this.stage,function(){t.setStatus("finished")}),this.setStatus("called")},dispose:function(){this.signals.disposed.dispatch()},setVisibility:function(t){},getCenter:function(){}}),Pe.prototype={constructor:Pe,type:"",__srcName:void 0,onload:function(){},onprogress:function(){},onerror:function(){},read:function(t){this._read(function(e){this.compressed?this.data=l(e):(this.binary&&e instanceof ArrayBuffer&&(e=new Uint8Array(e)),this.data=e),"function"==typeof this.onload&&this.onload(this.data),t()}.bind(this))},_read:function(t){t(this.src)},_chunk:function(t,e){return e=Math.min(this.data.length,e),0===t&&this.data.length===e?this.data:this.binary||this.compressed?this.data.subarray(t,e):this.data.substring(t,e)},chunk:function(t){var e=t+this.chunkSize;return this._chunk(t,e)},peekLines:function(t){var e,i=this.data,r=i.length,n=this.binary||this.compressed?this.newline.charCodeAt(0):this.newline,o=0;for(e=0;r>e&&(i[e]===n&&++o,o!==t);++e);var s=this._chunk(0,e+1),a=this.chunkToLines(s,"",e>r);return a.lines},lineCount:function(){console.warn("lineCount - deprecated");for(var t=this.data,e=t.length,i=this.binary||this.compressed?this.newline.charCodeAt(0):this.newline,r=0,n=0;e>n;++n)t[n]===i&&++r;return t[e-1]!==i&&++r,r},chunkCount:function(){return Math.floor(this.data.length/this.chunkSize)+1},asText:function(){return this.binary||this.compressed?h(this.data):this.data},chunkToLines:function(t,e,i){var r=this.newline;if(!this.binary&&!this.compressed&&t.length===this.data.length)return{lines:t.split(r),partialLine:""};var n=this.binary||this.compressed?h(t):t,o=[],s=n.lastIndexOf(r);if(-1===s)e+=n;else{var a=e+n.substr(0,s);o=o.concat(a.split(r)),e=s===n.length-r.length?"":n.substr(s+r.length)}return i&&""!==e&&o.push(e),{lines:o,partialLine:e}},nextChunk:function(){var t=this.__pointer;if(!(t>this.data.length))return this.__pointer+=this.chunkSize,this.chunk(t)},nextChunkOfLines:function(){var t=this.nextChunk();if(void 0!==t){var e=this.__pointer>this.data.length,i=this.chunkToLines(t,this.__partialLine,e);return this.__partialLine=i.partialLine,i.lines}},eachChunk:function(t){for(var e=this.chunkSize,i=this.data.length,r=this.chunkCount(),n=0;i>n;n+=e){var o=this.chunk(n),s=Math.round(n/e);t(o,s,r)}},eachChunkOfLines:function(t){this.newline;this.eachChunk(function(e,i,r){var n=i===r+1,o=this.chunkToLines(e,this.__partialLine,n);this.__partialLine=o.partialLine,t(o.lines,i,r)}.bind(this))},toJSON:function(){var t=this.type.substr(0,1).toUpperCase()+this.type.substr(1),e={metadata:{version:.1,type:t+"Streamer",generator:t+"StreamerExporter"},src:this.src,compressed:this.compressed,binary:this.binary,chunkSize:this.chunkSize,newline:this.newline};return this.__srcName&&(e[this.__srcName]=this[this.__srcName]),e},fromJSON:function(t){return this.src=t.src,this.compressed=t.compressed,this.binary=t.binary,this.chunkSize=t.chunkSize,this.newline=t.newline,this.__srcName&&(this[this.__srcName]=t[this.__srcName]),this},getTransferable:function(){var t=[];return t},dispose:function(){delete this.src,this.__srcName&&delete this[this.__srcName]}},Ee.prototype=Object.assign(Object.create(Pe.prototype),{constructor:Ee,type:"file",__srcName:"file",_read:function(t){var e;if("function"==typeof importScripts){e=new FileReaderSync;var i;i=this.binary||this.compressed?e.readAsArrayBuffer(this.file):e.readAsText(this.file),t(i)}else e=new FileReader,e.onload=function(e){t(e.target.result)}.bind(this),"function"==typeof this.onprogress&&(e.onprogress=function(t){this.onprogress(t)}.bind(this)),"function"==typeof this.onerror&&(e.onerror=function(t){this.onerror(t)}.bind(this)),this.binary||this.compressed?e.readAsArrayBuffer(this.file):e.readAsText(this.file)}}),Te.prototype=Object.assign(Object.create(Pe.prototype),{constructor:Te,type:"network",__srcName:"url",_read:function(t){var e=this.src;"function"==typeof importScripts&&"../"===e.substr(0,3)&&(e="../"+e);var i=new XMLHttpRequest;i.open("GET",e,!0),i.addEventListener("load",function(e){if(200!==i.status&&304!==i.status&&0!==i.status)throw"function"==typeof this.onerror&&this.onerror(i.status),"NGL.NetworkStreamer._read: status code "+i.status;t(i.response)}.bind(this),!1),"function"==typeof this.onerror&&i.addEventListener("error",function(t){this.onerror(t)}.bind(this),!1),this.compressed||this.binary?i.responseType="arraybuffer":this.json&&(i.responseType="json"),i.send(null)}}),Oe.prototype={constructor:Oe,load:function(){return new Promise(function(t,e){this.streamer.onerror=e;try{this._load(t,e)}catch(i){e(i)}}.bind(this))},_load:function(t,e){e("not implemented")}},Br.add("parse",function(t,e){kr&&Ir.time("WORKER parse");var i=a(t.data);i.parse(function(){kr&&Ir.timeEnd("WORKER parse"),i.streamer.dispose(),e(i.toJSON(),i.getTransferable())})}),Re.prototype={constructor:Re,type:"",__objName:"",parse:function(t){var e=this;return this.streamer.read(function(){e._beforeParse(),e._parse(function(){e._afterParse(),t(e[e.__objName])})}),this[this.__objName]},parseWorker:function(t){if("undefined"!=typeof Et&&"function"!=typeof importScripts)var e=new Et("parse").post(this.toJSON(),this.getTransferable(),function(i){e.terminate(),this.fromJSON(i.data),this._afterWorker(t)}.bind(this),function(i){Ir.warn("Parser.parseWorker error - trying without worker",i),e.terminate(),this.parse(t)}.bind(this));else this.parse(t);return this[this.__objName]},_parse:function(t){Ir.warn("Parser._parse not implemented"),t()},_beforeParse:function(){},_afterParse:function(){kr&&Ir.log(this[this.__objName])},_afterWorker:function(t){kr&&Ir.log(this[this.__objName]),t(this[this.__objName])},toJSON:function(){var t=this.type.substr(0,1).toUpperCase()+this.type.substr(1),e={metadata:{version:.1,type:t+"Parser",generator:t+"ParserExporter"},streamer:this.streamer.toJSON(),name:this.name,path:this.path};return"function"==typeof this[this.__objName].toJSON?e[this.__objName]=this[this.__objName].toJSON():e[this.__objName]=this[this.__objName],e},fromJSON:function(t){return this.streamer=a(t.streamer),this.name=t.name,this.path=t.path,"function"==typeof this[this.__objName].toJSON?this[this.__objName].fromJSON(t[this.__objName]):this[this.__objName]=t[this.__objName],this},getTransferable:function(){var t=[];return t=t.concat(this.streamer.getTransferable()),"function"==typeof this[this.__objName].toJSON&&(t=t.concat(this[this.__objName].getTransferable())),t}},ke.prototype=Object.assign(Object.create(Re.prototype),{constructor:ke,type:"structure",__objName:"structure",_afterParse:function(){kr&&Ir.time("StructureParser._afterParse");var t=this.structure;t.refresh(),this.reorderAtoms&&it(t),nt(t),this.dontAutoBond?this.autoBondBetween&&ct(t):ot(t),this.doAutoSS&&0===t.helices.length&&0===t.sheets.length&&Ur(t),(t.helices.length>0||t.sheets.length>0)&&rt(t),this._postProcess(),t.unitcell&&ht(t),kr&&Ir.timeEnd("StructureParser._afterParse"),kr&&Ir.log(this[this.__objName])},_postProcess:function(){},toJSON:function(){var t=Re.prototype.toJSON.call(this);return t.firstModelOnly=this.firstModelOnly,t.asTrajectory=this.asTrajectory,t.cAlphaOnly=this.cAlphaOnly,t.reorderAtoms=this.reorderAtoms,t.dontAutoBond=this.dontAutoBond,t.doAutoSS=this.doAutoSS,t},fromJSON:function(t){return Re.prototype.fromJSON.call(this,t),this.firstModelOnly=t.firstModelOnly,this.asTrajectory=t.asTrajectory,this.cAlphaOnly=t.cAlphaOnly,this.reorderAtoms=t.reorderAtoms,this.dontAutoBond=t.dontAutoBond,this.doAutoSS=t.doAutoSS,this}}),Ne.prototype=Object.assign(Object.create(ke.prototype),{constructor:Ne,type:"gro",_parse:function(t){function e(t,e,n){for(var l=t;e>l;++l){++C;var Y=C-1,_=n[l];if(_)if(Y%b===0)a&&(i=new Float32Array(3*y),h.push(i),r=0);else if(Y%b===1);else if(Y%b===b-1){var P=_.trim().split(/\s+/),E=new Float32Array(9);if(E[0]=10*parseFloat(P[0]),E[4]=10*parseFloat(P[1]),E[8]=10*parseFloat(P[2]),u.push(E),s)return!0;A+=1}else{if(d=_.substr(10,5).trim(),c&&"CA"!==d)continue;var T=10*parseFloat(_.substr(Z,X)),O=10*parseFloat(_.substr(g,X)),R=10*parseFloat(_.substr(v,X));if(a){var I=3*r;if(i[I+0]=T,i[I+1]=O,i[I+2]=R,r+=1,Y>b)continue}m=_.substr(5,5).trim(),f=parseInt(_.substr(0,5)),p=parseInt(_.substr(15,5)),S.growIfFull(),S.atomTypeId[w]=x.add(d),S.x[w]=T,S.y[w]=O,S.z[w]=R,S.serial[w]=p,o.addAtom(A,"",m,f,0,"l"),w+=1}}}kr&&Ir.time("GroParser._parse "+this.name);var i,r,n=this.structure,o=this.structureBuilder,s=this.firstModelOnly,a=this.asTrajectory,c=this.cAlphaOnly,h=n.frames,u=n.boxes,l=this.streamer.peekLines(3);n.title=l[0].trim();var d,m,f,p,Y=l[2].length-l[2].lastIndexOf(".")-1,X=5+Y,Z=20,g=20+X,v=20+2*X,y=parseInt(l[1]),b=y+3,x=n.atomMap,S=n.atomStore;S.resize(y);var w=0,A=0,C=0;this.streamer.eachChunkOfLines(function(t,i,r){e(0,t.length,t)}),o.finalize(),n.unitcell=new N(u[0][0],u[0][4],u[0][8],90,90,90,"P 1"),kr&&Ir.timeEnd("GroParser._parse "+this.name),t()}});var En={1:"h",2:"h",3:"i",4:"h",5:"g",6:"h",7:"h",8:"h",9:"h",10:"h","":"h"};Me.prototype=Object.assign(Object.create(ke.prototype),{constructor:Me,type:"pdb",_parse:function(t){function e(t,e,N){for(var V=t;e>V;++V)if(a=N[V],c=a.substr(0,6),"ATOM  "===c||"HETATM"===c){if(H&&(S?(_?(i=new Float32Array(3*B.count),A.push(i)):i=[],r=0):x||(I={})),H=!1,x&&z>0)continue;if(g){var U=a.split(v),G=10===U.length?1:0;if(p=U[2],w&&"CA"!==p)continue;var q=parseFloat(U[6-G]),W=parseFloat(U[7-G]),J=parseFloat(U[8-G])}else{if(p=a.substr(12,4).trim(),w&&"CA"!==p)continue;var q=parseFloat(a.substr(30,8)),W=parseFloat(a.substr(38,8)),J=parseFloat(a.substr(46,8))}if(S){var K=3*r;if(i[K+0]=q,i[K+1]=W,i[K+2]=J,r+=1,_)continue}var Q;g?(h=parseInt(U[1]),Q="",Y="H"===a[0]?1:0,u=G?"":U[4],l=parseInt(U[5-G]),f="",d=U[3],X=parseFloat(U[9-G]),Z="",m=0):(h=parseInt(a.substr(6,5)),Q=a.substr(76,2).trim(),Y="H"===a[0]?1:0,u=a[21].trim(),l=parseInt(a.substr(22,4)),f=a[26].trim(),d=a.substr(17,4).trim(),X=parseFloat(a.substr(60,6)),Z=a[16].trim(),m=parseFloat(a.substr(54,6))),B.growIfFull(),B.atomTypeId[j]=L.add(p,Q),B.x[j]=q,B.y[j]=W,B.z[j]=J,B.serial[j]=h,B.bfactor[j]=isNaN(X)?0:X,B.altloc[j]=Z.charCodeAt(0),B.occupancy[j]=isNaN(m)?0:m,b.addAtom(z,u,d,l,Y,void 0,f),I[h]=j,j+=1}else if("CONECT"===c){var $=I[parseInt(a.substr(6,5))],tt=[11,16,21,26];if(void 0===$)continue;for(var K=0;4>K;++K){var et=parseInt(a.substr(tt[K],5));Number.isNaN(et)||(et=I[et],void 0!==et&&(F.index=$,D.index=et,y.bondStore.addBond(F,D)))}y.hasConnect=!0}else if("HELIX "===c){var it=a[19].trim(),rt=parseInt(a.substr(21,4)),nt=a[25].trim(),ot=a[31].trim(),st=parseInt(a.substr(33,4)),at=a[37].trim(),ct=parseInt(a.substr(39,1));ct=(En[ct]||En[""]).charCodeAt(0),T.push([it,rt,nt,ot,st,at,ct])}else if("SHEET "===c){var it=a[21].trim(),rt=parseInt(a.substr(22,4)),nt=a[26].trim(),ot=a[32].trim(),st=parseInt(a.substr(33,4)),at=a[37].trim();O.push([it,rt,nt,ot,st,at])}else if("REMARK"===c&&"350"===a.substr(7,3))if("BIOMOLECULE:"===a.substr(11,12)){var ht=a.substr(23).trim();/^(0|[1-9][0-9]*)$/.test(ht)&&(ht="BU"+ht),n=new M(ht),R[ht]=n}else if("BIOMT"===a.substr(13,5)){var U=a.split(/\s+/),ut=parseInt(a[18])-1,lt=U[3].trim();0===ut&&(s=new THREE.Matrix4,o.matrixList.push(s));var dt=s.elements;dt[0+ut]=parseFloat(U[4]),dt[4+ut]=parseFloat(U[5]),dt[8+ut]=parseFloat(U[6]),dt[12+ut]=parseFloat(U[7])}else"APPLY THE FOLLOWING TO CHAINS:"!==a.substr(11,30)&&"                   AND CHAINS:"!==a.substr(11,30)||("APPLY"===a.substr(11,5)&&(o=n.addPart()),a.substr(41,30).split(",").forEach(function(t){var e=t.trim();e&&o.chainList.push(e)}));else if("HEADER"===c)P=a.substr(62,4);else if("TITLE "===c)E+=a.substr(10,70)+"\n";else if("MODEL "===c)H=!0;else if("ENDMDL"===c||"END"===a.substr(0,3)){if(H)continue;S&&!_&&(A.push(new Float32Array(i)),_=!0),z+=1,H=!0}else if("MTRIX "===c){var U=a.split(/\s+/),lt=U[1].trim();if("1"===a[5]&&"1"===lt){var ht="NCS";n=new M(ht),R[ht]=n,o=n.addPart()}var ut=parseInt(a[5])-1;0===ut&&(s=new THREE.Matrix4,o.matrixList.push(s));var dt=s.elements;dt[0+ut]=parseFloat(U[2]),dt[4+ut]=parseFloat(U[3]),dt[8+ut]=parseFloat(U[4]),dt[12+ut]=parseFloat(U[5])}else if("ORIGX"===a.substr(0,5)){k.origx||(k.origx=new THREE.Matrix4);var U=a.split(/\s+/),ut=parseInt(a[5])-1,dt=k.origx.elements;dt[0+ut]=parseFloat(U[1]),dt[4+ut]=parseFloat(U[2]),dt[8+ut]=parseFloat(U[3]),dt[12+ut]=parseFloat(U[4])}else if("SCALE"===a.substr(0,5)){k.scale||(k.scale=new THREE.Matrix4);var U=a.split(/\s+/),ut=parseInt(a[5])-1,dt=k.scale.elements;dt[0+ut]=parseFloat(U[1]),dt[4+ut]=parseFloat(U[2]),dt[8+ut]=parseFloat(U[3]),dt[12+ut]=parseFloat(U[4])}else if("CRYST1"===c){var mt=parseFloat(a.substr(6,9)),ft=parseFloat(a.substr(15,9)),pt=parseFloat(a.substr(24,9)),Yt=parseFloat(a.substr(33,7)),Xt=parseFloat(a.substr(40,7)),Zt=parseFloat(a.substr(47,7)),gt=a.substr(55,11).trim(),J=parseInt(a.substr(66,4)),vt=new Float32Array(9);vt[0]=mt,vt[4]=ft,vt[8]=pt,C.push(vt),0===z&&(k.a=mt,k.b=ft,k.c=pt,k.alpha=Yt,k.beta=Xt,k.gamma=Zt,k.spacegroup=gt)}}kr&&Ir.time("PdbParser._parse "+this.name);var i,r,n,o,s,a,c,h,u,l,d,m,f,p,Y,X,Z,g="pqr"===this.type,v=/\s+/,y=this.structure,b=this.structureBuilder,x=this.firstModelOnly,S=this.asTrajectory,w=this.cAlphaOnly,A=y.frames,C=y.boxes,_=!1,P=y.id,E=y.title,T=(y.atoms,y.bondSet,y.helices),O=y.sheets,R=y.biomolDict,I={},k={};y.hasConnect=!1;var L=y.atomMap,B=y.atomStore;B.resize(Math.round(this.streamer.data.length/80));var F=y.getAtomProxy(),D=y.getAtomProxy(),j=0,z=0,H=!0;this.streamer.eachChunkOfLines(function(t,i,r){e(0,t.length,t)}),b.finalize(),void 0!==k.a?y.unitcell=new N(k.a,k.b,k.c,k.alpha,k.beta,k.gamma,k.spacegroup,k.scale):y.unitcell=void 0,kr&&Ir.timeEnd("PdbParser._parse "+this.name),t()}}),Le.prototype=Object.assign(Object.create(Me.prototype),{constructor:Le,type:"pqr"}),Be.prototype=Object.assign(Object.create(ke.prototype),{constructor:Be,type:"cif",_parse:function(t){function e(t,e,i){for(var s=t;e>s;++s)if(o=i[s].trim(),(o||O||k)&&"#"!==o[0])if("data_"===o.substring(0,5)){o.substring(5)}else if(";"===o[0])O?(k?(M===N.length&&(M=0),N[M].push(R),M+=1):p[L][B]=R,O=!1,R=null):(O=!0,R=o.substring(1));else if("loop_"===o)k=!0,N.length=0,D.length=0,M=0;else if("_"===o[0])if(k){var q=o.split("."),W=q[0].substring(1),J=q[1];1===q.length?(J=!1,p[W]||(p[W]=[]),N.push(p[W])):(p[W]||(p[W]={}),p[W][J]?Ir.warn(W,J,"already exists"):(p[W][J]=[],N.push(p[W][J]),D.push(J))),L=W,B=J,F=!0}else{var K=o.match(m),Q=K[0],$=K[1],q=Q.split("."),W=q[0].substring(1),J=q[1];1===q.length?(J=!1,p[W]||(p[W]=[]),p[W]=$):(p[W]||(p[W]={}),p[W][J]?Ir.warn(W,J,"already exists"):p[W][J]=$),$||(I=!0),L=W,B=J}else if(O)R+=" "+o;else if(k){if(!o)continue;if("atom_site"===L){var tt=D.length,K=o.split(d);if(F){Y=D.indexOf("auth_asym_id"),X=D.indexOf("auth_seq_id"),Z=D.indexOf("label_atom_id"),g=D.indexOf("label_comp_id"),v=D.indexOf("label_asym_id"),y=D.indexOf("label_alt_id"),C=D.indexOf("Cartn_x"),_=D.indexOf("Cartn_y"),P=D.indexOf("Cartn_z"),x=D.indexOf("id"),S=D.indexOf("type_symbol"),b=D.indexOf("group_PDB"),E=D.indexOf("B_iso_or_equiv"),w=D.indexOf("pdbx_PDB_model_num"),A=D.indexOf("pdbx_PDB_ins_code"),T=D.indexOf("occupancy"),F=!1,V=parseInt(K[w]),h&&(r=[],n=0)}var et=parseInt(K[w]);if(V!==et&&(h&&(0===G&&l.push(new Float32Array(r)),r=new Float32Array(3*H.count),l.push(r),n=0),G+=1),V=et,c&&G>0)continue;var it=K[Z].replace(f,"");if(u&&"CA"!==it)continue;var rt=parseFloat(K[C]),nt=parseFloat(K[_]),ot=parseFloat(K[P]);if(h){var st=3*n;if(r[st+0]=rt,r[st+1]=nt,r[st+2]=ot,n+=1,G>0)continue}var at=K[g],ct=parseInt(K[X]),ht=K[A];ht="?"===ht?"":ht;var ut=K[Y],lt="H"===K[b][0]?1:0,dt=K[S],mt=parseFloat(K[E]),ft=parseFloat(K[T]),pt=K[y];if(pt="."===pt?"":pt,H.growIfFull(),H.atomTypeId[U]=z.add(it,dt),H.x[U]=rt,H.y[U]=nt,H.z[U]=ot,H.serial[U]=parseInt(K[x]),H.bfactor[U]=isNaN(mt)?0:mt,H.occupancy[U]=isNaN(ft)?0:ft,H.altloc[U]=pt.charCodeAt(0),a.addAtom(G,ut,at,ct,lt,void 0,ht),kr){var Yt=j[K[v]];void 0!==Yt&&Yt!==ut&&Ir.warn(Yt,ut)}j[K[v]]=ut,U+=1}else{var K=o.match(m),tt=K.length;M===N.length&&(M=0);for(var st=0;tt>st;++st)N[M+st].push(K[st]);M+=tt}}else if("'"===o[0]&&"'"===o.substring(o.length-1)){var Xt=o.substring(1,o.length-2);B===!1?p[L]=Xt:p[L][B]=Xt}else I?B===!1?p[L]=o.trim():p[L][B]=o.trim():kr&&Ir.log("CifParser._parse: unknown state",o);else O=!1,k=!1,I=!1,N.length=0,M=null,L=null,B=null,F=null,D.length=0}function i(){function t(t,e){Array.isArray(t[e])||Object.keys(t).forEach(function(e){t[e]=[t[e]]})}var e=p.struct_conf;if(e){var i=s.helices;t(e,"id");for(var r=0,n=e.beg_auth_seq_id.length;n>r;++r){var o=parseInt(e.pdbx_PDB_helix_class[r]);if(!Number.isNaN(o)){var a=e.pdbx_beg_PDB_ins_code[r],c=e.pdbx_end_PDB_ins_code[r];i.push([j[e.beg_label_asym_id[r]],parseInt(e.beg_auth_seq_id[r]),"?"===a?"":a,j[e.end_label_asym_id[r]],parseInt(e.end_auth_seq_id[r]),"?"===c?"":c,(En[o]||En[""]).charCodeAt(0)])}}}var h=p.struct_sheet_range;if(h){var u=s.sheets;t(h,"id");for(var r=0,n=h.beg_auth_seq_id.length;n>r;++r){var a=h.pdbx_beg_PDB_ins_code[r],c=h.pdbx_end_PDB_ins_code[r];u.push([j[h.beg_label_asym_id[r]],parseInt(h.beg_auth_seq_id[r]),"?"===a?"":a,j[h.end_label_asym_id[r]],parseInt(h.end_auth_seq_id[r]),"?"===c?"":c])}}}Ir.time("CifParser._parse "+this.name);var r,n,o,s=this.structure,a=this.structureBuilder,c=this.firstModelOnly,h=this.asTrajectory,u=this.cAlphaOnly,l=s.frames;s.boxes,s.title,s.atoms,s.bondSet;s.hasConnect=!1;var d=/\s+/,m=/'((?:(?!'\s).)*)'|"((?:(?!"\s).)*)"|(\S+)/g,f=/"/g,p={};this.cif=p;var Y,X,Z,g,v,y,b,x,S,w,A,C,_,P,E,T,O=!1,R=null,I=!1,k=!1,N=[],M=null,L=null,B=null,F=null,D=[],j={};this.asymIdDict=j;var z=s.atomMap,H=s.atomStore;H.resize(this.streamer.data.length/100);var V,U=0,G=0;this.streamer.eachChunkOfLines(function(t,i,r){e(0,t.length,t)}),a.finalize(),p.struct&&p.struct.title&&(s.title=p.struct.title.trim().replace(/^['"]+|['"]+$/g,"")),i(),kr&&Ir.timeEnd("CifParser._parse "+this.name),t()},_postProcess:function(){function t(t,e){Array.isArray(t[e])||Object.keys(t).forEach(function(e){t[e]=[t[e]]})}kr&&Ir.time("CifParser._postProcess");var e=this.structure,i=this.structure,r=this.cif,n=this.asymIdDict,o={},s=e.biomolDict;if(r.pdbx_struct_oper_list){var a=r.pdbx_struct_oper_list;t(a,"id"),a.id.forEach(function(t,e){var i=new THREE.Matrix4,r=i.elements;r[0]=parseFloat(a["matrix[1][1]"][e]),r[1]=parseFloat(a["matrix[1][2]"][e]),r[2]=parseFloat(a["matrix[1][3]"][e]),r[4]=parseFloat(a["matrix[2][1]"][e]),r[5]=parseFloat(a["matrix[2][2]"][e]),r[6]=parseFloat(a["matrix[2][3]"][e]),r[8]=parseFloat(a["matrix[3][1]"][e]),r[9]=parseFloat(a["matrix[3][2]"][e]),r[10]=parseFloat(a["matrix[3][3]"][e]),r[3]=parseFloat(a["vector[1]"][e]),r[7]=parseFloat(a["vector[2]"][e]),r[11]=parseFloat(a["vector[3]"][e]),i.transpose(),o[t]=i})}if(r.pdbx_struct_assembly_gen){var c=r.pdbx_struct_assembly_gen;t(c,"assembly_id");var h=function(t){var e={},i=t.replace(/[\(\)']/g,"").split(",");return i.forEach(function(t){if(-1!==t.indexOf("-"))for(var i=t.split("-"),r=parseInt(i[0]),n=parseInt(i[1]);n>=r;++r)e[r]=o[r];else e[t]=o[t]}),e};c.assembly_id.forEach(function(t,e){var i={},r=c.oper_expression[e];if(-1!==r.indexOf(")(")){r=r.split(")(");var o=h(r[0]),a=h(r[1]);Object.keys(o).forEach(function(t){Object.keys(a).forEach(function(e){var r=new THREE.Matrix4;r.multiplyMatrices(o[t],a[e]),i[t+"x"+e]=r})})}else i=h(r);var u=[];for(var l in i)u.push(i[l]);var d=t;/^(0|[1-9][0-9]*)$/.test(d)&&(d="BU"+d);for(var m=c.asym_id_list[e].split(","),f=0,p=m.length;p>f;++f)m[f]=n[m[f]];void 0===s[d]&&(s[d]=new M(d)),s[d].addPart(u,m)})}if(r.struct_ncs_oper){var a=r.struct_ncs_oper;t(a,"id");var u="NCS";s[u]=new M(u);var l=s[u].addPart();a.id.forEach(function(t,e){var i=new THREE.Matrix4,r=i.elements;r[0]=parseFloat(a["matrix[1][1]"][e]),r[1]=parseFloat(a["matrix[1][2]"][e]),r[2]=parseFloat(a["matrix[1][3]"][e]),r[4]=parseFloat(a["matrix[2][1]"][e]),r[5]=parseFloat(a["matrix[2][2]"][e]),r[6]=parseFloat(a["matrix[2][3]"][e]),r[8]=parseFloat(a["matrix[3][1]"][e]),r[9]=parseFloat(a["matrix[3][2]"][e]),r[10]=parseFloat(a["matrix[3][3]"][e]),r[3]=parseFloat(a["vector[1]"][e]),r[7]=parseFloat(a["vector[2]"][e]),r[11]=parseFloat(a["vector[3]"][e]),i.transpose(),l.matrixList.push(i)})}var d={};if(r.cell){var m=r.cell,f=parseFloat(m.length_a),Y=parseFloat(m.length_b),X=parseFloat(m.length_c),Z=new Float32Array(9);Z[0]=f,Z[4]=Y,Z[8]=X,i.boxes.push(Z),d.a=f,d.b=Y,d.c=X,d.alpha=parseFloat(m.angle_alpha),d.beta=parseFloat(m.angle_beta),d.gamma=parseFloat(m.angle_gamma)}if(r.symmetry){var g=r.symmetry,v=g["space_group_name_H-M"];v[0]!==v[v.length-1]||"'"!==v[0]&&'"'!==v[0]||(v=v.substring(1,v.length-1)),d.spacegroup=v}var y=new THREE.Matrix4;if(r.database_PDB_matrix){var b=r.database_PDB_matrix,x=y.elements;x[0]=parseFloat(b["origx[1][1]"]),x[1]=parseFloat(b["origx[1][2]"]),x[2]=parseFloat(b["origx[1][3]"]),x[4]=parseFloat(b["origx[2][1]"]),x[5]=parseFloat(b["origx[2][2]"]),x[6]=parseFloat(b["origx[2][3]"]),x[8]=parseFloat(b["origx[3][1]"]),x[9]=parseFloat(b["origx[3][2]"]),x[10]=parseFloat(b["origx[3][3]"]),x[3]=parseFloat(b["origx_vector[1]"]),x[7]=parseFloat(b["origx_vector[2]"]),x[11]=parseFloat(b["origx_vector[3]"]),y.transpose(),d.origx=y}var S=new THREE.Matrix4;if(r.atom_sites){var b=r.atom_sites,x=S.elements;x[0]=parseFloat(b["fract_transf_matrix[1][1]"]),x[1]=parseFloat(b["fract_transf_matrix[1][2]"]),x[2]=parseFloat(b["fract_transf_matrix[1][3]"]),x[4]=parseFloat(b["fract_transf_matrix[2][1]"]),x[5]=parseFloat(b["fract_transf_matrix[2][2]"]),x[6]=parseFloat(b["fract_transf_matrix[2][3]"]),x[8]=parseFloat(b["fract_transf_matrix[3][1]"]),x[9]=parseFloat(b["fract_transf_matrix[3][2]"]),x[10]=parseFloat(b["fract_transf_matrix[3][3]"]),x[3]=parseFloat(b["fract_transf_vector[1]"]),x[7]=parseFloat(b["fract_transf_vector[2]"]),x[11]=parseFloat(b["fract_transf_vector[3]"]),S.transpose(),d.scale=S}void 0!==d.a?e.unitcell=new N(d.a,d.b,d.c,d.alpha,d.beta,d.gamma,d.spacegroup,d.scale):e.unitcell=void 0;var w=r.struct_conn;if(w){t(w,"id");for(var A=/"/g,C=e.getAtomProxy(),_=e.getAtomProxy(),P={},E=0,T=w.id.length;T>E;++E){var O=w.conn_type_id[E];if("hydrog"!==O&&"mismat"!==O&&"saltbr"!==O&&"1_555"===w.ptnr1_symmetry[E]&&"1_555"===w.ptnr2_symmetry[E]){var R=w.pdbx_ptnr1_PDB_ins_code[E],I=w.pdbx_ptnr1_label_alt_id[E],k=w.ptnr1_auth_seq_id[E]+("?"===R?"":"^"+R)+":"+n[w.ptnr1_label_asym_id[E]]+"."+w.ptnr1_label_atom_id[E].replace(A,"")+("?"===I?"":"%"+I),L=P[k];if(!L){var B=new p(k);if(B.selection.error){Ir.warn("invalid selection for connection",k);continue}L=e.getAtomIndices(B),P[k]=L}var F=w.pdbx_ptnr2_PDB_ins_code[E],D=w.pdbx_ptnr2_label_alt_id[E],j=w.ptnr2_auth_seq_id[E]+("?"===F?"":"^"+F)+":"+n[w.ptnr2_label_asym_id[E]]+"."+w.ptnr2_label_atom_id[E].replace(A,"")+("?"===D?"":"%"+D),z=P[j];if(!z){var H=new p(j);if(H.selection.error){Ir.warn("invalid selection for connection",j);continue}z=e.getAtomIndices(H),P[j]=z}var V=L.length,U=z.length;if(V>U){var G=V;V=U,U=G;var q=L;L=z,z=q}if(0!==V&&0!==U)for(var W=0;U>W;++W)C.index=L[W%V],_.index=z[W],C&&_?e.bondStore.addBond(C,_):Ir.log("atoms for connection not found");else Ir.warn("no atoms found for",k,j)}}}kr&&Ir.timeEnd("CifParser._postProcess")}}),Fe.prototype=Object.assign(Object.create(ke.prototype),{constructor:Fe,type:"sdf",_parse:function(t){function e(t,e,s){for(var w=t;e>w;++w){var A=s[w];if("$$$$"===A.substr(0,4)&&(b=-1,++x,S=d.count),3===b&&(m=parseInt(A.substr(0,3)),f=parseInt(A.substr(3,3)),p=4,Y=p+m,X=Y,Z=X+f,o&&(c=0,a=new Float32Array(3*m),h.push(a),x>0&&(u=!0))),b>=p&&Y>b){if(n&&x>0)continue;var C=parseFloat(A.substr(0,10)),_=parseFloat(A.substr(10,10)),P=parseFloat(A.substr(20,10));if(o){var E=3*c;if(a[E+0]=C,a[E+1]=_,a[E+2]=P,c+=1,u)continue}var T=A.substr(31,3).trim(),O=T+(y+1);d.growIfFull(),d.atomTypeId[y]=l.add(O,T),d.x[y]=C,d.y[y]=_,d.z[y]=P,d.serial[y]=y,r.addAtom(x,"","HET",1,1),y+=1}if(b>=X&&Z>b){if(n&&x>0)continue;if(o&&x>0)continue;g.index=parseInt(A.substr(0,3))-1+S,v.index=parseInt(A.substr(3,3))-1+S;var R=parseInt(A.substr(6,3));
i.bondStore.addBond(g,v,R)}++b}}kr&&Ir.time("SdfParser._parse "+this.name);var i=this.structure,r=this.structureBuilder,n=this.firstModelOnly,o=this.asTrajectory,s=this.streamer.peekLines(2);i.id=s[0].trim(),i.title=s[1].trim();var a,c,h=i.frames,u=(i.boxes,!1),l=i.atomMap,d=i.atomStore;d.resize(Math.round(this.streamer.data.length/50));var m,f,p,Y,X,Z,g=i.getAtomProxy(),v=i.getAtomProxy(),y=0,b=0,x=0,S=0;this.streamer.eachChunkOfLines(function(t,i,r){e(0,t.length,t)}),r.finalize(),i._dontAutoBond=!0,i.unitcell=void 0,kr&&Ir.timeEnd("SdfParser._parse "+this.name),t()}}),De.prototype=Object.assign(Object.create(ke.prototype),{constructor:De,type:"mol2",_parse:function(t){function e(t,e,w){for(var A,C=t;e>C;++C){var _=w[C].trim();if(""!==_&&"#"!==_[0])if("@"===_[0])"@<TRIPOS>MOLECULE"===_?(Z=g,f=0,++Y):"@<TRIPOS>ATOM"===_?(Z=v,p=d.count,c&&(r=0,i=new Float32Array(3*X),h.push(i),Y>0&&(u=!0))):Z="@<TRIPOS>BOND"===_?y:0;else if(Z===g){if(0===f)o.title=_,o.id=_;else if(1===f)A=_.split(n),X=parseInt(A[0]);else if(2===f);else if(3===f);else if(4===f);else if(5===f);++f}else if(Z===v){if(A=_.split(n),a&&Y>0)continue;var P=parseFloat(A[2]),E=parseFloat(A[3]),T=parseFloat(A[4]);if(c){var O=3*r;if(i[O+0]=P,i[O+1]=E,i[O+2]=T,r+=1,u)continue}var R=A[0],I=A[1],k=A[5].split(".")[0],N=A[6]?parseInt(A[6]):1,M=A[7]?A[7]:"",L=A[8]?parseFloat(A[8]):0;d.growIfFull(),d.atomTypeId[m]=l.add(I,k),d.x[m]=P,d.y[m]=E,d.z[m]=T,d.serial[m]=R,d.bfactor[m]=L,s.addAtom(Y,"",M,N,1),m+=1}else if(Z===y){if(a&&Y>0)continue;if(c&&Y>0)continue;A=_.split(n),b.index=parseInt(A[1])-1+p,x.index=parseInt(A[2])-1+p;var B=S[A[3]];o.bondStore.addBond(b,x,B)}}}kr&&Ir.time("Mol2Parser._parse "+this.name);var i,r,n=/\s+/,o=this.structure,s=this.structureBuilder,a=this.firstModelOnly,c=this.asTrajectory,h=o.frames,u=(o.boxes,!1),l=o.atomMap,d=o.atomStore;d.resize(Math.round(this.streamer.data.length/60));var m=0,f=0,p=0,Y=-1,X=0,Z=0,g=1,v=2,y=3,b=o.getAtomProxy(),x=o.getAtomProxy(),S={1:1,2:2,3:3,am:1,ar:1,du:1,un:1,nc:0};this.streamer.eachChunkOfLines(function(t,i,r){e(0,t.length,t)}),s.finalize(),o._dontAutoBond=!0,o.unitcell=void 0,kr&&Ir.timeEnd("Mol2Parser._parse "+this.name),t()}}),je.prototype=Object.assign(Object.create(ke.prototype),{constructor:je,type:"mmtf",_parse:function(t){kr&&Ir.time("MmtfParser._parse "+this.name);var e,i,r,n,o,s,a,c,h,u,l=this.structure,d=decodeMmtf(decodeMsgpack(this.streamer.data));if(this.firstModelOnly||this.asTrajectory){for(h=1,c=d.chainsPerModel[0],a=0,e=0,i=c;i>e;++e)a+=d.groupsPerChain[e];for(s=0,e=0,i=a;i>e;++e)n=d.groupList[d.groupTypeList[e]],s+=n.atomNameList.length;o=d.numBonds,u=[c]}else o=d.numBonds,s=d.numAtoms,a=d.numGroups,c=d.numChains,h=d.numModels,u=d.chainsPerModel;if(o+=a,this.asTrajectory)for(e=0,i=d.numModels;i>e;++e){var m=new Float32Array(3*s),f=s*e;for(r=0;s>r;++r){var p=3*r,Y=r+f;m[p]=d.xCoordList[Y],m[p+1]=d.yCoordList[Y],m[p+2]=d.zCoordList[Y]}l.frames.push(m)}var X=new Uint32Array(o),Z=new Uint32Array(o),g=new Uint8Array(o),v=new Uint32Array(s),y=new Uint32Array(a),b=new Uint32Array(a),x=new Uint16Array(a),S=new Uint16Array(c),w=new Uint32Array(c),A=new Uint32Array(c),C=new Uint32Array(h),_=new Uint32Array(h),P=0;for(e=0,i=h;i>e;++e){var E=u[e];for(C[e]=P,_[e]=E,r=0;E>r;++r)S[r+P]=e;P+=E}var T=d.groupsPerChain,O=0;for(e=0,i=c;i>e;++e){var R=T[e];for(w[e]=O,A[e]=R,r=0;R>r;++r)y[r+O]=e;O+=R}var I=0,k=0;for(e=0,i=a;i>e;++e){n=d.groupList[d.groupTypeList[e]];var L=n.atomNameList.length,B=n.bondAtomList,F=n.bondOrderList;for(r=0,jl=bondOrderList.length;r<jl;++r)X[k]=I+B[2*r],Z[k]=I+B[2*r+1],g[k]=F[r],k+=1;for(b[e]=I,x[e]=L,r=0;L>r;++r)v[I]=e,I+=1}var D=d.bondAtomList;if(D)for(d.bondOrderList&&g.set(d.bondOrderList,k),e=0,i=D.length;i>e;e+=2){var j=D[e],z=D[e+1];s>j&&s>z&&(X[k]=j,Z[k]=z,k+=1)}l.bondStore.length=g.length,l.bondStore.count=k,l.bondStore.atomIndex1=X,l.bondStore.atomIndex2=Z,l.bondStore.bondOrder=g,l.atomStore.length=s,l.atomStore.count=s,l.atomStore.residueIndex=v,l.atomStore.atomTypeId=new Uint16Array(s),l.atomStore.x=d.xCoordList.subarray(0,s),l.atomStore.y=d.yCoordList.subarray(0,s),l.atomStore.z=d.zCoordList.subarray(0,s),l.atomStore.serial=d.atomIdList.subarray(0,s),l.atomStore.bfactor=d.bFactorList.subarray(0,s),l.atomStore.altloc=d.altLocList.subarray(0,s),l.atomStore.occupancy=d.occupancyList.subarray(0,s),l.residueStore.length=a,l.residueStore.count=a,l.residueStore.chainIndex=y,l.residueStore.residueTypeId=d.groupTypeList,l.residueStore.atomOffset=b,l.residueStore.atomCount=x,l.residueStore.resno=d.groupIdList.subarray(0,a),l.residueStore.sstruc=d.secStructList.subarray(0,a),l.residueStore.inscode=d.insCodeList.subarray(0,a),l.chainStore.length=c,l.chainStore.count=c,l.chainStore.modelIndex=S,l.chainStore.residueOffset=w,l.chainStore.residueCount=A,l.chainStore.chainname=d.chainNameList.subarray(0,4*c),l.modelStore.length=h,l.modelStore.count=h,l.modelStore.chainOffset=C,l.modelStore.chainCount=_;var H={0:"i".charCodeAt(0),1:"s".charCodeAt(0),2:"h".charCodeAt(0),3:"e".charCodeAt(0),4:"g".charCodeAt(0),5:"b".charCodeAt(0),6:"t".charCodeAt(0),7:"l".charCodeAt(0),"-1":"".charCodeAt(0)},V=["non-polymer","other","saccharide","l-saccharide","d-saccharide","l-saccharide 1,4 and 1,4 linking","l-saccharide 1,4 and 1,6 linking","d-saccharide 1,4 and 1,4 linking","d-saccharide 1,4 and 1,6 linking"],U={};for(e=0,i=d.groupList.length;i>e;++e){var G=d.groupList[e],q=[];for(r=0,jl=G.atomNameList.length;r<jl;++r){var W=G.elementList[r].toUpperCase(),J=G.atomNameList[r];q.push(l.atomMap.add(J,W))}var K=-1!==V.indexOf(G.chemCompType.toLowerCase());U[e]=l.residueMap.add(G.groupName,q,K)}for(e=0,i=a;i>e;++e)l.residueStore.residueTypeId[e]=U[l.residueStore.residueTypeId[e]];for(e=0,i=l.atomStore.count;i>e;++e){var Q=l.atomStore.residueIndex[e],$=l.residueMap.list[l.residueStore.residueTypeId[Q]],tt=l.residueStore.atomOffset[Q];l.atomStore.atomTypeId[e]=$.atomTypeIdList[e-tt]}if(d.secStructList){var et=d.secStructList.length;for(e=0,i=l.residueStore.count;i>e;++e){var it=H[l.residueStore.sstruc[e%et]];void 0!==it&&(l.residueStore.sstruc[e]=it)}}d.bioAssemblyList&&d.bioAssemblyList.forEach(function(t,e){var i=e+1,r=new M(i);l.biomolDict["BU"+i]=r;var n={};t.transformList.forEach(function(t){var e=(new THREE.Matrix4).fromArray(t.matrix).transpose(),i=t.chainIndexList.map(function(t){for(var e="",i=0;4>i;++i){var r=d.chainNameList[4*t+i];if(!r)break;e+=String.fromCharCode(r)}return e}),o=n[i];o?o.matrixList.push(e):n[i]=r.addPart([e],i)})}),d.unitCell&&Array.isArray(d.unitCell)&&d.unitCell[0]?l.unitcell=new N(d.unitCell[0],d.unitCell[1],d.unitCell[2],d.unitCell[3],d.unitCell[4],d.unitCell[5],d.spaceGroup):l.unitcell=void 0,kr&&Ir.timeEnd("MmtfParser._parse "+this.name),ct(l,!0),at(l,!0),t()}}),ze.prototype={constructor:ze,toJSON:function(){var t={metadata:{version:.1,type:"Frames",generator:"FramesExporter"},name:this.name,path:this.path,coordinates:this.coordinates,boxes:this.boxes};return t},fromJSON:function(t){this.name=t.name,this.path=t.path,this.coordinates=t.coordinates,this.boxes=t.boxes},getTransferable:function(){for(var t=[],e=this.coordinates,i=e.length,r=0;i>r;++r)t.push(e[r].buffer);return t}},He.prototype=Object.assign(Object.create(Re.prototype),{constructor:He,type:"trajectory",__objName:"frames"}),Ve.prototype=Object.assign(Object.create(He.prototype),{constructor:Ve,type:"dcd",_parse:function(t){kr&&Ir.time("DcdParser._parse "+this.name);var e=this.streamer.data;e instanceof Uint8Array&&(e=e.buffer);var i=new DataView(e),r=this.frames,n=r.coordinates,o=r.boxes,s={},a=0,c=new Int32Array(e,0,23),u=c[0]!==i.getInt32(0);if(84!==c[0])for(var l=e.byteLength,d=0;l>d;d+=4)i.setFloat32(d,i.getFloat32(d),!0);84!==c[0]&&Ir.error("dcd bad format, header block start");var m=String.fromCharCode(i.getUint8(4),i.getUint8(5),i.getUint8(6),i.getUint8(7));"CORD"!==m&&Ir.error("dcd bad format, format string");var f=!1,p=!1,Y=!1;0!==c[22]&&(f=!0,0!==c[12]&&(p=!0),1===c[13]&&(Y=!0)),s.NSET=c[2],s.ISTART=c[3],s.NSAVC=c[4],s.NAMNF=c[10],f?s.DELTA=i.getFloat32(44,u):s.DELTA=i.getFloat64(44,u),84!==c[22]&&Ir.error("dcd bad format, header block end"),a=a+84+8;var X=i.getInt32(a,u),Z=a+1;if((X-4)%80!==0&&Ir.error("dcd bad format, title block start"),s.TITLE=h(new Uint8Array(e,Z,X)),i.getInt32(Z+X+4-1,u)!==X&&Ir.error("dcd bad format, title block end"),a=a+X+8,4!==i.getInt32(a,u)&&Ir.error("dcd bad format, natom block start"),s.NATOM=i.getInt32(a+4,u),4!==i.getInt32(a+8,u)&&Ir.error("dcd bad format, natom block end"),a=a+4+8,s.NAMNF>0)return Ir.error("dcd format with fixed atoms unsupported, aborting"),void t();for(var g=s.NATOM,v=4*g,d=0,l=s.NSET;l>d;++d){if(p){a+=4;var y=new Float32Array(9);y[0]=i.getFloat64(a,u),y[4]=i.getFloat64(a+16,u),y[8]=i.getFloat64(a+40,u),o.push(y),a+=48,a+=4}for(var b=new Float32Array(3*g),x=0;3>x;++x){i.getInt32(a,u)!==v&&Ir.error("dcd bad format, coord block start",d,x),a+=4;for(var S=new Float32Array(e,a,g),w=0;g>w;++w)b[3*w+x]=S[w];a+=v,i.getInt32(a,u)!==v&&Ir.error("dcd bad format, coord block end",d,x),a+=4}if(n.push(b),Y){var A=i.getInt32(a,u);a+=4+A+4}}kr&&Ir.timeEnd("DcdParser._parse "+this.name),t()}}),Ue.prototype=Object.assign(Object.create(Re.prototype),{constructor:Ue,type:"mrc",_parse:function(t){kr&&Ir.time("MrcParser._parse "+this.name);var e=this.streamer.data;e instanceof Uint8Array&&(e=e.buffer);var i=this.volume,r={},n=new Int32Array(e,0,56),o=new Float32Array(e,0,56),s=new DataView(e);if(r.MAP=String.fromCharCode(s.getUint8(208),s.getUint8(209),s.getUint8(210),s.getUint8(211)),r.MACHST=[s.getUint8(212),s.getUint8(213)],17===r.MACHST[0]&&17===r.MACHST[1])for(var a=e.byteLength,c=0;a>c;c+=4)s.setFloat32(c,s.getFloat32(c),!0);r.NX=n[0],r.NY=n[1],r.NZ=n[2],r.MODE=n[3],r.NXSTART=n[4],r.NYSTART=n[5],r.NZSTART=n[6],r.MX=n[7],r.MY=n[8],r.MZ=n[9],r.xlen=o[10],r.ylen=o[11],r.zlen=o[12],r.alpha=o[13],r.beta=o[14],r.gamma=o[15],r.MAPC=n[16],r.MAPR=n[17],r.MAPS=n[18],r.DMIN=o[19],r.DMAX=o[20],r.DMEAN=o[21],r.ISPG=n[22],r.NSYMBT=n[23],r.LSKFLG=n[24],r.originX=o[49],r.originY=o[50],r.originZ=o[51],r.ARMS=o[54],i.header=r;var h=new Float32Array(e,1024+r.NSYMBT,r.NX*r.NY*r.NZ);i.setData(h,r.NX,r.NY,r.NZ),kr&&Ir.timeEnd("MrcParser._parse "+this.name),t()},getMatrix:function(){var t=this.volume.header,e=[t.xlen,0,0],i=[t.ylen*Math.cos(Math.PI/180*t.gamma),t.ylen*Math.sin(Math.PI/180*t.gamma),0],r=[t.zlen*Math.cos(Math.PI/180*t.beta),t.zlen*(Math.cos(Math.PI/180*t.alpha)-Math.cos(Math.PI/180*t.gamma)*Math.cos(Math.PI/180*t.beta))/Math.sin(Math.PI/180*t.gamma),0];r[2]=Math.sqrt(t.zlen*t.zlen*Math.sin(Math.PI/180*t.beta)*Math.sin(Math.PI/180*t.beta)-r[1]*r[1]);var n=[0,e,i,r],o=[0,t.MX,t.MY,t.MZ],s=[0,t.MAPC,t.MAPR,t.MAPS],a=new THREE.Matrix4;return a.set(n[s[1]][0]/o[s[1]],n[s[2]][0]/o[s[2]],n[s[3]][0]/o[s[3]],0,n[s[1]][1]/o[s[1]],n[s[2]][1]/o[s[2]],n[s[3]][1]/o[s[3]],0,n[s[1]][2]/o[s[1]],n[s[2]][2]/o[s[2]],n[s[3]][2]/o[s[3]],0,0,0,0,1),a.setPosition(new THREE.Vector3(t.originX,t.originY,t.originZ)),a.multiply((new THREE.Matrix4).makeTranslation(t.NXSTART,t.NYSTART,t.NZSTART)),a}}),Ge.prototype=Object.assign(Object.create(Re.prototype),{constructor:Ge,type:"cube",_parse:function(t){function e(t,e){var i=n[t].trim().split(s)[e];return parseFloat(i)}function i(t,e,i){for(var r=t;e>r;++r){var n=i[r].trim();if(""!==n&&u>=o.atomCount+6){n=n.split(s);for(var a=0,l=n.length;l>a;++a)1!==n.length&&(c[h]=parseFloat(n[a]),++h)}++u}}kr&&Ir.time("CubeParser._parse "+this.name);var r=this.volume,n=this.streamer.peekLines(6),o={},s=/\s+/,a=.529177210859;o.atomCount=Math.abs(e(2,0)),o.originX=e(2,1)*a,o.originY=e(2,2)*a,o.originZ=e(2,3)*a,o.NVX=e(3,0),o.NVY=e(4,0),o.NVZ=e(5,0),o.AVX=e(3,1)*a,o.AVY=e(4,2)*a,o.AVZ=e(5,3)*a;var c=new Float32Array(o.NVX*o.NVY*o.NVZ),h=0,u=0;this.streamer.eachChunkOfLines(function(t,e,r){i(0,t.length,t)}),r.header=o,r.setData(c,o.NVZ,o.NVY,o.NVX),kr&&Ir.timeEnd("CubeParser._parse "+this.name),t()},getMatrix:function(){var t=this.volume.header,e=new THREE.Matrix4;return e.multiply((new THREE.Matrix4).makeRotationY(THREE.Math.degToRad(90))),e.multiply((new THREE.Matrix4).makeTranslation(-t.originZ,t.originY,t.originX)),e.multiply((new THREE.Matrix4).makeScale(-t.AVZ,t.AVY,t.AVX)),e}}),qe.prototype=Object.assign(Object.create(Re.prototype),{constructor:qe,type:"dx",_parse:function(t){function e(t,e,i){for(var r=t;e>r;++r){if(c>u&&l>s){var n=i[r].trim();if(""!==n)for(var o=n.split(a),d=0,m=o.length;m>d;++d)h[u]=parseFloat(o[d]),++u}++l}}kr&&Ir.time("DxParser._parse "+this.name);var i=this.volume,r=this.streamer.peekLines(30),n=this.parseHeaderLines(r),o=this.volume.header,s=n.dataLineStart,a=/\s+/,c=o.nx*o.ny*o.nz,h=new Float32Array(c),u=0,l=0;this.streamer.eachChunkOfLines(function(t,i,r){e(0,t.length,t)}),i.setData(h,o.nz,o.ny,o.nx),kr&&Ir.timeEnd("DxParser._parse "+this.name),t()},parseHeaderLines:function(t){for(var e={},i=/\s+/,r=t.length,n=0,o=0,s=0,a=0;r>a;++a){var c=t[a];if(c.startsWith("object 1")){var h=c.split(i);e.nx=parseInt(h[5]),e.ny=parseInt(h[6]),e.nz=parseInt(h[7])}else if(c.startsWith("origin")){var h=c.split(i);e.xmin=parseFloat(h[1]),e.ymin=parseFloat(h[2]),e.zmin=parseFloat(h[3])}else if(c.startsWith("delta")){var h=c.split(i);0===s?e.hx=parseFloat(h[1]):1===s?e.hy=parseFloat(h[2]):2===s&&(e.hz=parseFloat(h[3])),s+=1}else if(c.startsWith("object 3")){n=a,o+=c.length+1;break}o+=c.length+1}return this.volume.header=e,{dataLineStart:n,headerByteCount:o}},getMatrix:function(){var t=this.volume.header,e=new THREE.Matrix4;return e.multiply((new THREE.Matrix4).makeRotationY(THREE.Math.degToRad(90))),e.multiply((new THREE.Matrix4).makeTranslation(-t.zmin,t.ymin,t.xmin)),e.multiply((new THREE.Matrix4).makeScale(-t.hz,t.hy,t.hx)),e}}),We.prototype=Object.assign(Object.create(qe.prototype),{constructor:We,type:"dxbin",_parse:function(t){kr&&Ir.time("DxbinParser._parse "+this.name);var e=this.streamer.data;e instanceof Uint8Array&&(e=e.buffer);for(var i=u(new Uint8Array(e,0,1e3)),r=this.parseHeaderLines(i),n=this.volume.header,o=r.headerByteCount,s=n.nx*n.ny*n.nz,a=new DataView(e),c=new Float32Array(s),h=0;s>h;++h)c[h]=a.getFloat64(8*h+o,!0);this.volume.setData(c,n.nz,n.ny,n.nx),kr&&Ir.timeEnd("DxbinParser._parse "+this.name),t()}}),Je.prototype=Object.assign(Object.create(Re.prototype),{constructor:Je,type:"surface",__objName:"surface",_parse:function(t){var e=this.loader.parse(this.streamer.asText());this.surface.fromGeometry(e),t()}}),Ke.prototype=Object.assign(Object.create(Je.prototype),{constructor:Ke,type:"ply"}),Qe.prototype=Object.assign(Object.create(Je.prototype),{constructor:Qe,type:"obj"}),$e.prototype=Object.assign(Object.create(Re.prototype),{constructor:$e,type:"text",__objName:"text",_parse:function(t){this.text.data=this.streamer.asText(),t()}}),ti.prototype=Object.assign(Object.create(Re.prototype),{constructor:ti,type:"csv",__objName:"table",_parse:function(t){var e=this.table.data,i=/\s*,\s*/;this.streamer.eachChunkOfLines(function(t,r,n){for(var o=t.length,s=0;o>s;++s){var a=t[s].trim(),c=a.split(i);0===r&&0===s?this.table.colNames=c:a&&e.push(c)}}.bind(this)),t()}}),ei.prototype=Object.assign(Object.create(Re.prototype),{constructor:ei,type:"json",__objName:"json",_parse:function(t){this.streamer.compressed||this.streamer.binary?this.json.data=JSON.parse(this.streamer.asText()):this.json.data=this.streamer.data,t()}}),ii.prototype=Object.assign(Object.create(Re.prototype),{constructor:ii,type:"xml",__objName:"xml",_parse:function(t){function e(t){function e(){return{declaration:i(),root:r()}}function i(){var t=a(/^<\?xml\s*/);if(t){for(var e={attributes:{}};!c()&&!h("?>");){var i=o();if(!i)return e;e.attributes[i.name]=i.value}return a(/\?>\s*/),e}}function r(){var t=a(/^<([\w-:.]+)\s*/);if(t){for(var e={name:t[1],attributes:{},children:[]};!(c()||h(">")||h("?>")||h("/>"));){var i=o();if(!i)return e;e.attributes[i.name]=i.value}if(a(/^\s*\/>\s*/))return e;a(/\??>\s*/),e.content=n();for(var s;s=r();)e.children.push(s);return a(/^<\/[\w-:.]+>\s*/),e}}function n(){var t=a(/^([^<]*)/);return t?t[1]:""}function o(){var t=a(/([\w:-]+)\s*=\s*("[^"]*"|'[^']*'|\w+)\s*/);if(t)return{name:t[1],value:s(t[2])}}function s(t){return t.replace(/^['"]|['"]$/g,"")}function a(e){var i=t.match(e);if(i)return t=t.slice(i[0].length),i}function c(){return 0===t.length}function h(e){return 0===t.indexOf(e)}return t=t.trim(),t=t.replace(/<!--[\s\S]*?-->/g,""),e()}this.xml.data=e(this.streamer.asText()),t()}}),ri.prototype=Object.assign(Object.create(Oe.prototype),{constructor:ri,_load:function(t,e){var i={gro:Ne,pdb:Me,pdb1:Me,ent:Me,pqr:Le,cif:Be,mcif:Be,mmcif:Be,sdf:Fe,mol2:De,mmtf:je,dcd:Ve,mrc:Ue,ccp4:Ue,map:Ue,cube:Ge,dx:qe,dxbin:We,ply:Ke,obj:Qe,txt:$e,text:$e,csv:ti,json:ei,xml:ii},r=new i[this.ext](this.streamer,this.params);this.useWorker?r.parseWorker(t):r.parse(t)}}),ni.prototype={constructor:ni,call:function(t,e){var i={add:function(t){this.signals.elementAdded.dispatch(arguments)}.bind(this),remove:function(t){this.signals.elementRemoved.dispatch(arguments)}.bind(this),setName:function(t){this.signals.nameChanged.dispatch(t)}.bind(this)};if(this.fn){var r=[t,i,this.name,this.path,this.dir];try{this.fn.apply(null,r)}catch(n){Ir.error("Script.fn",n)}}else Ir.log("Script.call no function available")}},oi.prototype=Object.assign(Object.create(Oe.prototype),{constructor:oi,_load:function(t,e){this.streamer.read(function(){var e=this.streamer.asText(),i=new ni(e,this.name,this.path);t(i)}.bind(this))}}),si.prototype=Object.assign(Object.create(Oe.prototype),{constructor:si,_load:function(t,e){var i;i=this.protocol?this.protocol+"://"+this.dir:this.dir,this.streamer.read(function(){var e=JSON.parse(this.streamer.asText()),r=[];e.files.map(function(t){r.push(ci(i+t,{ext:"text",useWorker:!1}))}),Promise.all(r).then(function(i){var r=i.reduce(function(t,e){return t+"\n\n"+e.data},"");r+=e.source||"";var n=new ni(r,this.name,this.path);t(n)}.bind(this))}.bind(this))}});var Tn={gro:ri,pdb:ri,pdb1:ri,ent:ri,pqr:ri,cif:ri,mcif:ri,mmcif:ri,sdf:ri,mol2:ri,mmtf:ri,dcd:ri,mrc:ri,ccp4:ri,map:ri,cube:ri,dx:ri,dxbin:ri,obj:ri,ply:ri,txt:ri,text:ri,csv:ri,json:ri,xml:ri,ngl:oi,plugin:si};hi.prototype={constructor:hi,parameters:{backgroundColor:{type:"color"},quality:{type:"select",options:{low:"low",medium:"medium",high:"high"}},sampleLevel:{type:"range",step:1,max:5,min:-1},impostor:{type:"boolean"},rotateSpeed:{type:"number",precision:1,max:10,min:0},zoomSpeed:{type:"number",precision:1,max:10,min:0},panSpeed:{type:"number",precision:1,max:10,min:0},clipNear:{type:"range",step:1,max:100,min:0},clipFar:{type:"range",step:1,max:100,min:0},clipDist:{type:"number",precision:0,max:200,min:0},fogNear:{type:"range",step:1,max:100,min:0},fogFar:{type:"range",step:1,max:100,min:0},cameraType:{type:"select",options:{perspective:"perspective",orthographic:"orthographic"}},cameraFov:{type:"range",step:1,max:120,min:15},lightColor:{type:"color"},lightIntensity:{type:"number",precision:2,max:10,min:0},ambientColor:{type:"color"},ambientIntensity:{type:"number",precision:2,max:10,min:0}},setParameters:function(t){var e=Object.assign({},t),i=this.parameters,r=this.viewer,n=r.controls;for(var o in e)void 0!==e[o]&&i[o]&&(i[o]["int"]&&(e[o]=parseInt(e[o])),i[o]["float"]&&(e[o]=parseFloat(e[o])),i[o].value=e[o]);return void 0!==e.quality&&this.setQuality(e.quality),void 0!==e.impostor&&this.setImpostor(e.impostor),void 0!==e.rotateSpeed&&(n.rotateSpeed=e.rotateSpeed),void 0!==e.zoomSpeed&&(n.zoomSpeed=e.zoomSpeed),void 0!==e.panSpeed&&(n.panSpeed=e.panSpeed),r.setClip(e.clipNear,e.clipFar,e.clipDist),r.setFog(void 0,e.fogNear,e.fogFar),r.setCamera(e.cameraType,e.cameraFov),r.setSampling(e.sampleLevel),r.setBackground(e.backgroundColor),r.setLight(e.lightColor,e.lightIntensity,e.ambientColor,e.ambientIntensity),this.signals.parametersChanged.dispatch(this.getParameters()),this},getParameters:function(){var t={};for(var e in this.parameters)t[e]=this.parameters[e].value;return t},defaultFileRepresentation:function(t){if("structure"===t.type){t.setSelection("/0");var e,i,r=t.structure;if(r.biomolDict.BU1){var n=r.biomolDict.BU1;e=n.getAtomCount(r),i=n.getInstanceCount(),t.setDefaultAssembly("BU1")}else e=r.getModelProxy(0).atomCount,i=1;if("undefined"!=typeof window.orientation&&(e*=4),kr&&console.log(e,i),i>5&&e>15e3){var o=Math.min(1.5,Math.max(.1,2e3/(e/i)));t.addRepresentation("surface",{sele:"polymer",surfaceType:"sas",probeRadius:.1,scaleFactor:o,colorScheme:"atomindex",colorScale:"RdYlBu",useWorker:!1})}else if(e>25e4)t.addRepresentation("backbone",{lineOnly:!0,colorScheme:"atomindex",colorScale:"RdYlBu"});else if(e>1e5)t.addRepresentation("backbone",{quality:"low",disableImpostor:!0,colorScheme:"atomindex",colorScale:"RdYlBu",scale:2});else if(e>8e4)t.addRepresentation("backbone",{colorScheme:"atomindex",colorScale:"RdYlBu",scale:2});else{var s=15e3>e?"high":"medium";t.addRepresentation("cartoon",{color:"atomindex",colorScale:"RdYlBu",scale:.7,aspectRatio:5,quality:s}),5e4>e&&t.addRepresentation("base",{color:"atomindex",colorScale:"RdYlBu",quality:s}),t.addRepresentation("ball+stick",{sele:"hetero and not ( water or ion )",colorScheme:"element",scale:2,aspectRatio:1.5,quality:s})}this.centerView(),t.structure.frames.length&&t.addTrajectory()}else"surface"!==t.type&&"volume"!==opject.type||(t.addRepresentation("surface"),this.centerView())},loadFile:function(t,e){var i=Object.assign({},this.defaultFileParams,e),r=new ue(this,i);r.name=s(t).name,this.addComponent(r);var n=function(t){return this.removeComponent(r),r=this.addComponentFromObject(t,i),"script"===r.type&&r.run(),i.defaultRepresentation&&this.defaultFileRepresentation(r),r}.bind(this),o=function(t){throw r.setStatus(t),t};return ci(t,i).then(n,o)},addComponent:function(t){return t?(this.compList.push(t),void this.signals.componentAdded.dispatch(t)):void Ir.warn("Stage.addComponent: no component given")},addComponentFromObject:function(t,e){var i=_e(this,t,e);return this.addComponent(i),i},removeComponent:function(t){var e=this.compList.indexOf(t);-1!==e&&this.compList.splice(e,1),t.dispose(),this.signals.componentRemoved.dispatch(t)},removeAllComponents:function(t){this.compList.slice().forEach(function(e,i){t&&e.type!==t||this.removeComponent(e)},this)},handleResize:function(){this.viewer.handleResize()},toggleFullscreen:function(t){function e(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function i(){if(!e()&&r.lastFullscreenElement){var t=r.lastFullscreenElement;t.style.width=t.dataset.normalWidth,t.style.height=t.dataset.normalHeight,document.removeEventListener("fullscreenchange",i),document.removeEventListener("mozfullscreenchange",i),document.removeEventListener("webkitfullscreenchange",i),document.removeEventListener("msfullscreenchange",i),r.handleResize(),r.signals.fullscreenChanged.dispatch(!1)}}if(!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled))return void Ir.log("fullscreen mode (currently) not possible");var r=this;t=t||this.viewer.container,this.lastFullscreenElement=t,e()?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():(t.dataset.normalWidth=t.style.width,t.dataset.normalHeight=t.style.height,t.style.width=screen.width+"px",t.style.height=screen.height+"px",t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen(),document.addEventListener("fullscreenchange",i),document.addEventListener("mozfullscreenchange",i),document.addEventListener("webkitfullscreenchange",i),document.addEventListener("msfullscreenchange",i),this.handleResize(),this.signals.fullscreenChanged.dispatch(!0),setTimeout(function(){r.handleResize()},100))},centerView:function(){if(this.tasks.count>0){var t=function(e,i){0===i&&this.tasks.signals.countChanged.remove(t,this),this.viewer.centerView(!0)};this.tasks.signals.countChanged.add(t,this)}this.viewer.centerView(!0)},setSpin:function(t,e){Array.isArray(t)&&(t=(new THREE.Vector3).fromArray(t)),this.viewer.setSpin(t,e)},setOrientation:function(t){this.tasks.onZeroOnce(function(){this.viewer.setOrientation(t)},this)},getOrientation:function(){return this.viewer.getOrientation()},makeImage:function(t){var e=this.viewer,i=this.tasks;return new Promise(function(r,n){function o(){i.increment(),e.makeImage(t).then(function(t){i.decrement(),r(t)})["catch"](function(t){i.decrement(),n(t)})}i.onZeroOnce(o)})},setImpostor:function(t){this.parameters.impostor.value=t;var e=["spacefill","ball+stick","licorice","hyperball","backbone","rocket","helixorient","contact","distance","dot"];this.eachRepresentation(function(i){if("script"!==i.type&&-1!==e.indexOf(i.getType())){var r=i.getParameters();r.disableImpostor=!t,i.build(r)}})},setQuality:function(t){this.parameters.quality.value=t;var e=["tube","cartoon","ribbon","trace","rope"],i=["spacefill","ball+stick","licorice","hyperball","backbone","rocket","helixorient","contact","distance","dot"];this.eachRepresentation(function(r){if("script"!==r.type){var n=r.getParameters();if(-1===e.indexOf(r.getType())){if(-1===i.indexOf(r.getType()))return;if(!n.disableImpostor)return void(r.repr.quality=t)}n.quality=t,r.build(n)}})},eachComponent:function(t,e){this.compList.forEach(function(i,r){e&&i.type!==e||t(i,r)})},eachRepresentation:function(t,e){this.eachComponent(function(e){e.reprList.forEach(function(i){t(i,e)})},e)},getComponentsByName:function(t,e){var i=[];return this.eachComponent(function(e){void 0!==t&&null===e.name.match(t)||i.push(e)},e),new de(i)},getRepresentationsByName:function(t,e){var i,r;"object"!=typeof t?(i=void 0,r=t):(i=t.comp,r=t.repr);var n=[];return this.eachRepresentation(function(t,e){void 0!==i&&null===e.name.match(i)||void 0!==r&&null===t.name.match(r)||n.push(t)},e),new me(n)},getAnythingByName:function(t){var e=this.getComponentsByName(t).list,i=this.getRepresentationsByName(t).list;return new le(e.concat(i))},dispose:function(){this.tasks.dispose()}},ui.prototype=Object.assign(Object.create(ee.prototype),{constructor:ui,type:"ball+stick",defaultSize:.15,parameters:Object.assign({sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"},disableImpostor:{type:"boolean",rebuild:!0},aspectRatio:{type:"number",precision:1,max:10,min:1},lineOnly:{type:"boolean",rebuild:!0},cylinderOnly:{type:"boolean",rebuild:!0}},ee.prototype.parameters),init:function(t){var e=t||{};e.radius=e.radius||this.defaultSize,"low"===e.quality?(this.sphereDetail=0,this.radiusSegments=5):"medium"===e.quality?(this.sphereDetail=1,this.radiusSegments=10):"high"===e.quality?(this.sphereDetail=2,this.radiusSegments=20):(this.sphereDetail=void 0!==e.sphereDetail?e.sphereDetail:1,this.radiusSegments=void 0!==e.radiusSegments?e.radiusSegments:10),this.disableImpostor=e.disableImpostor||!1,this.aspectRatio=e.aspectRatio||2,this.lineOnly=e.lineOnly||!1,this.cylinderOnly=e.cylinderOnly||!1,ee.prototype.init.call(this,e)},getAtomParams:function(t,e){return e=Object.assign({radiusParams:{radius:this.radius,scale:this.scale*this.aspectRatio}},e),ee.prototype.getAtomParams.call(this,t,e)},getAtomData:function(t,e,i){return t.getAtomData(this.getAtomParams(e,i))},getBondData:function(t,e,i){return t.getBondData(this.getBondParams(e,i))},createData:function(t){var e=this.getBondData(t),i=[];if(this.lineOnly)this.lineBuffer=new se(e.position1,e.position2,e.color1,e.color2,this.getBufferParams()),i.push(this.lineBuffer);else{if(!this.cylinderOnly){var r=this.getAtomData(t),n=new Kt(r.position,r.color,r.radius,r.pickingColor,this.getBufferParams({sphereDetail:this.sphereDetail,disableImpostor:this.disableImpostor,dullInterior:!0}));i.push(n)}var o=new oe(e.position1,e.position2,e.color1,e.color2,e.radius,e.pickingColor1,e.pickingColor2,this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,disableImpostor:this.disableImpostor,dullInterior:!0}));i.push(o)}return{bufferList:i}},updateData:function(t,e){var i=this.getBondData(e.sview,t);if(this.lineOnly){var r={};t&&!t.position||(r.from=i.position1,r.to=i.position2),t&&!t.color||(r.color=i.color1,r.color2=i.color2),e.bufferList[0].setAttributes(r)}else{var n=this.getAtomData(e.sview,t),o={},s={};t&&!t.position||(o.position=n.position,s.position=U(i.position1,i.position2),s.position1=i.position1,s.position2=i.position2),t&&!t.color||(o.color=n.color,s.color=i.color1,s.color2=i.color2),t&&!t.radius||(o.radius=n.radius,s.radius=i.radius),e.bufferList[0].setAttributes(o),e.bufferList[1].setAttributes(s)}},setParameters:function(t){var e=!1,i={};return t&&t.aspectRatio&&(i.radius=!0,Rr&&!this.disableImpostor||(e=!0)),ee.prototype.setParameters.call(this,t,i,e),this}}),li.prototype=Object.assign(Object.create(ui.prototype),{constructor:li,type:"backbone",defaultSize:.25,parameters:Object.assign({},ui.prototype.parameters),init:function(t){var e=t||{};e.aspectRatio=e.aspectRatio||1,ui.prototype.init.call(this,e)},getAtomData:function(t,e,i){return t.getBackboneAtomData(this.getAtomParams(e,i))},getBondData:function(t,e,i){var r=this.getBondParams(e,i);return r.colorParams.backbone=!0,t.getBackboneBondData(r)}}),di.prototype=Object.assign(Object.create(ui.prototype),{constructor:di,type:"base",defaultSize:.3,parameters:Object.assign({},ui.prototype.parameters),init:function(t){var e=t||{};e.aspectRatio=e.aspectRatio||1,ui.prototype.init.call(this,e)},getAtomData:function(t,e,i){return t.getRungAtomData(this.getAtomParams(e,i))},getBondData:function(t,e,i){var r=this.getBondParams(e,i);return r.colorParams.rung=!0,t.getRungBondData(r)}}),fi.prototype={constructor:fi,getAtomIterator:function(t,e){function i(){var t=this.get(h);return h+=1,t}function r(i){var r=u[c%4];if(r.index=o.getAtomIndexByType(i,t),e&&i>0&&a>i&&"e"===r.sstruc){var n=l[c%4];return d.index=o.getAtomIndexByType(i+1,t),m.index=o.getAtomIndexByType(i-1,t),n.addVectors(d,m).add(r).add(r).multiplyScalar(.25),c+=1,n}return c+=1,r}function n(){c=0,h=-1}var o=this.polymer,s=o.structure,a=o.residueCount,c=0,h=-1,u=[s.getAtomProxy(),s.getAtomProxy(),s.getAtomProxy(),s.getAtomProxy()],l=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],d=s.getAtomProxy(),m=s.getAtomProxy();return{size:a,next:i,get:r,reset:n}},getSubdividedColor:function(t){function e(t,e,i){d.atomColorToArray(t,e,i)}function i(t,e,i){m.atomColorToArray(t,e,i)}var r=this.subdiv,n=this.polymer,o=n.residueCount,s=o-1,a=s*r*3+3;n.isCyclic&&(a+=3*r);var c=new Float32Array(a),h=new Float32Array(a),u=this.getAtomIterator("trace"),l=t||{};l.structure=n.structure;var d=Fr.getScheme(l),m=Fr.getPickingScheme(l);return this.interpolator.getColor(u,e,i,c,h,0,n.isCyclic),{color:c,pickingColor:h}},getSubdividedPosition:function(){var t=this.getPosition();return{position:t}},getSubdividedOrientation:function(){var t=this.getTangent(),e=this.getNormals(t);return{tangent:t,normal:e.normal,binormal:e.binormal}},getSubdividedSize:function(t,e){function i(t){return u.atomRadius(t)}var r=this.subdiv,n=this.polymer,o=n.residueCount,s=o-1,a=s*r+1;n.isCyclic&&(a+=r);var c=new Float32Array(a),h=this.getAtomIterator("trace"),u=new k(t,e);return this.interpolator.getSize(h,i,c,0,n.isCyclic),{size:c}},getPosition:function(){var t=this.subdiv,e=this.polymer,i=e.residueCount,r=i-1,n=r*t*3+3;e.isCyclic&&(n+=3*t);var o=new Float32Array(n),s=this.positionIterator||this.getAtomIterator("trace",this.smoothSheet);return this.interpolator.getPosition(s,o,0,e.isCyclic),o},getTangent:function(){var t=this.subdiv,e=this.polymer,i=this.size,r=i-1,n=r*t*3+3;e.isCyclic&&(n+=3*t);var o=new Float32Array(n),s=this.positionIterator||this.getAtomIterator("trace",this.smoothSheet);return this.interpolator.getTangent(s,o,0,e.isCyclic),o},getNormals:function(t){var e=this.subdiv,i=this.polymer,r=i.isProtein(),n=this.size,o=n-1,s=o*e*3+3;
i.isCyclic&&(s+=3*e);var a=new Float32Array(s),c=new Float32Array(s);if(this.directional&&!this.polymer.isCg()){var h=this.getAtomIterator("direction1"),u=this.getAtomIterator("direction2");this.interpolator.getNormalDir(h,u,t,a,c,0,i.isCyclic,r)}else this.interpolator.getNormal(n,t,a,c,0,i.isCyclic,r);return{normal:a,binormal:c}}},pi.prototype=Object.assign(Object.create(Lt.prototype),{constructor:pi,setAttributes:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i){var r,n,o,s,a,c,h,u,l,d,m,f=this.aspectRatio,p=this.size2,Y=p-1,X=(this.capVertices,this.radialSegments),Z=this.geometry.attributes;i.position&&(r=i.position,n=i.normal,o=i.binormal,s=i.tangent,c=i.size,u=Z.position.array,d=Z.normal.array,Z.position.needsUpdate=!0,Z.normal.needsUpdate=!0),i.color&&(a=i.color,l=Z.color.array,Z.color.needsUpdate=!0),i.pickingColor&&(h=i.pickingColor,m=Z.pickingColor.array,Z.pickingColor.needsUpdate=!0);var g,v,y,b,x,S,w,A,C,_,P,E,T,O,R,I,k,N,M,L,B,F,D,j=[],z=[],H=[],V=[],U=[],G=[];if(r)for(v=0;X>v;++v)w=v/X*2*Math.PI,j[v]=f*Math.cos(w),z[v]=Math.sin(w),H[v]=f*Math.cos(w-.01),V[v]=Math.sin(w-.01),U[v]=f*Math.cos(w+.01),G[v]=Math.sin(w+.01);for(g=0;p>g;++g)for(y=3*g,b=y*X,r&&(t.set(s[y],s[y+1],s[y+2]),R=n[y],I=n[y+1],k=n[y+2],N=o[y],M=o[y+1],L=o[y+2],B=r[y],F=r[y+1],D=r[y+2],O=c[g]),v=0;X>v;++v)x=b+3*v,r&&(A=-O*j[v],C=O*z[v],_=-O*H[v],P=O*V[v],E=-O*U[v],T=O*G[v],u[x]=B+A*R+C*N,u[x+1]=F+A*I+C*M,u[x+2]=D+A*k+C*L,e.set(E*R+T*N-(_*R+P*N),E*I+T*M-(_*I+P*M),E*k+T*L-(_*k+P*L)).cross(t),d[x]=e.x,d[x+1]=e.y,d[x+2]=e.z),a&&(l[x]=a[y],l[x+1]=a[y+1],l[x+2]=a[y+2]),h&&(m[x]=h[y],m[x+1]=h[y+1],m[x+2]=h[y+2]);for(y=0,b=3*p*X,v=0;X>v;++v)x=y+3*v,S=b+3*v,r&&(u[S]=u[x],u[S+1]=u[x+1],u[S+2]=u[x+2],d[S]=s[y],d[S+1]=s[y+1],d[S+2]=s[y+2]),a&&(l[S]=l[x],l[S+1]=l[x+1],l[S+2]=l[x+2]),h&&(m[S]=m[x],m[S+1]=m[x+1],m[S+2]=m[x+2]);for(y=3*(p-1)*X,b=3*(p+1)*X,v=0;X>v;++v)x=y+3*v,S=b+3*v,r&&(u[S]=u[x],u[S+1]=u[x+1],u[S+2]=u[x+2],d[S]=s[3*Y],d[S+1]=s[3*Y+1],d[S+2]=s[3*Y+2]),a&&(l[S]=l[x],l[S+1]=l[x+1],l[S+2]=l[x+2]),h&&(m[S]=m[x],m[S+1]=m[x+1],m[S+2]=m[x+2])}}(),makeIndex:function(){var t,e,i,r,n,o,s=this.meshIndex,a=this.size2,c=a-1,h=this.capTriangles,u=this.radialSegments,l=this.radialSegments+1;for(t=0;c>t;++t)for(e=t*u*3*2,i=t*u,r=(t+1)*u,o=0;u>o;++o)n=e+3*o*2,s[n]=i+o,s[n+1]=i+(o+1)%u,s[n+2]=r+o,s[n+3]=r+o,s[n+4]=i+(o+1)%u,s[n+5]=r+(o+1)%u;var d=[0];for(o=1;l/2>o;++o)d.push(o),u-o!==o&&d.push(u-o);for(n=c*u*3*2,e=a*u,o=0;o<d.length-2;++o)o%2===0?(s[n+3*o+0]=e+d[o+0],s[n+3*o+1]=e+d[o+1],s[n+3*o+2]=e+d[o+2]):(s[n+3*o+0]=e+d[o+2],s[n+3*o+1]=e+d[o+1],s[n+3*o+2]=e+d[o+0]);for(n=c*u*3*2+3*h,e=a*u+u,o=0;o<d.length-2;++o)o%2===0?(s[n+3*o+0]=e+d[o+0],s[n+3*o+1]=e+d[o+1],s[n+3*o+2]=e+d[o+2]):(s[n+3*o+0]=e+d[o+2],s[n+3*o+1]=e+d[o+1],s[n+3*o+2]=e+d[o+0])}}),Yi.prototype=Object.assign(Object.create(ee.prototype),{constructor:Yi,type:"cartoon",parameters:Object.assign({aspectRatio:{type:"number",precision:1,max:10,min:1},subdiv:{type:"integer",max:50,min:1,rebuild:!0},radialSegments:{type:"integer",max:50,min:1,rebuild:!0},tension:{type:"number",precision:1,max:1,min:.1},capped:{type:"boolean",rebuild:!0},smoothSheet:{type:"boolean",rebuild:!0}},ee.prototype.parameters),init:function(t){var e=t||{};e.colorScheme=e.colorScheme||"atomindex",e.colorScale=e.colorScale||"RdYlBu",e.radius=e.radius||"sstruc",e.scale=e.scale||.7,"low"===e.quality?(this.subdiv=3,this.radialSegments=6):"medium"===e.quality?(this.subdiv=6,this.radialSegments=10):"high"===e.quality?(this.subdiv=12,this.radialSegments=20):(this.subdiv=e.subdiv||6,this.radialSegments=e.radialSegments||10),this.aspectRatio=e.aspectRatio||5,this.tension=e.tension||NaN,this.capped=void 0===e.capped?!0:e.capped,this.smoothSheet=e.smoothSheet||!1,ee.prototype.init.call(this,e)},getSplineParams:function(t){return Object.assign({subdiv:this.subdiv,tension:this.tension,directional:1!==this.aspectRatio,smoothSheet:this.smoothSheet},t)},getSpline:function(t){return new fi(t,this.getSplineParams())},getScale:function(t){return t.isCg()?this.scale*this.aspectRatio:this.scale},getAspectRatio:function(t){return t.isCg()?1:this.aspectRatio},createData:function(t){var e=[],i=[];return this.structure.eachPolymer(function(t){if(!(t.residueCount<4)){i.push(t);var r=this.getSpline(t),n=r.getSubdividedPosition(),o=r.getSubdividedOrientation(),s=r.getSubdividedColor(this.getColorParams()),a=r.getSubdividedSize(this.radius,this.getScale(t));e.push(new pi(n.position,o.normal,o.binormal,o.tangent,s.color,a.size,s.pickingColor,this.getBufferParams({radialSegments:this.radialSegments,aspectRatio:this.getAspectRatio(t),capped:this.capped,dullInterior:!0})))}}.bind(this),t.getSelection()),{bufferList:e,polymerList:i}},updateData:function(t,e){kr&&Ir.time(this.type+" repr update"),t=t||{};for(var i=0,r=e.polymerList.length;r>i;++i){var n={},o=e.polymerList[i],s=this.getSpline(o);if(e.bufferList[i].aspectRatio=this.getAspectRatio(o),t.position||t.radius){var a=s.getSubdividedPosition(),c=s.getSubdividedOrientation(),h=s.getSubdividedSize(this.radius,this.getScale(o));n.position=a.position,n.normal=c.normal,n.binormal=c.binormal,n.tangent=c.tangent,n.size=h.size}if(t.color){var u=s.getSubdividedColor(this.getColorParams());n.color=u.color,n.pickingColor=u.pickingColor}e.bufferList[i].setAttributes(n)}kr&&Ir.timeEnd(this.type+" repr update")},setParameters:function(t){var e=!1,i={};return t&&t.aspectRatio&&(i.radius=!0),t&&t.tension&&(i.position=!0),ee.prototype.setParameters.call(this,t,i,e),this}}),jr.add("cartoon",Yi),Xi.prototype={within:function(t,e){Ir.time("Contact within");var i=this.kdtree2,r=this.sview1.getAtomProxy(),n=this.sview1.getAtomSet(!1),o=new F;this.sview1.eachSelectedAtom(function(s){for(var a=!1,c=i.nearest(s,1/0,t),h=0,u=c.length;u>h;++h){var l=c[h];r.index=l.index,s.residueIndex!==r.residueIndex&&(!e||l.distance>e)&&(a=!0,n.add_unsafe(r.index),o.addBond(s,r,1))}a&&n.add_unsafe(s.index)});var s=new TypedFastBitSet(o.count);return s.set_all(!0),Ir.timeEnd("Contact within"),{atomSet:n,bondSet:s,bondStore:o}}},vi.prototype=Object.assign(Object.create(ee.prototype),{constructor:vi,type:"contact",defaultSize:.25,parameters:Object.assign({contactType:{type:"select",rebuild:!0,options:{polar:"polar",polarBackbone:"polar backbone"}},maxDistance:{type:"number",precision:1,max:10,min:.1,rebuild:!0},maxAngle:{type:"integer",max:180,min:0,rebuild:!0},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"},disableImpostor:{type:"boolean",rebuild:!0}},ee.prototype.parameters),init:function(t){var e=t||{};e.radius=e.radius||this.defaultSize,"low"===e.quality?this.radiusSegments=5:"medium"===e.quality?this.radiusSegments=10:"high"===e.quality?this.radiusSegments=20:this.radiusSegments=void 0!==e.radiusSegments?e.radiusSegments:10,this.disableImpostor=e.disableImpostor||!1,this.contactType=e.contactType||"polarBackbone",this.maxDistance=e.maxDistance||3.5,this.maxAngle=e.maxAngle||40,ee.prototype.init.call(this,e)},getContactData:function(t){var e={polar:Zi,polarBackbone:gi},i=e[this.contactType](t,this.maxDistance,this.maxAngle);return i},getBondData:function(t,e,i){return t.getBondData(this.getBondParams(e,i))},createData:function(t){var e=this.getContactData(t),i={bondSet:e.bondSet,bondStore:e.bondStore},r=this.getBondData(t,void 0,i),n=new oe(r.position1,r.position2,r.color1,r.color2,r.radius,r.pickingColor1,r.pickingColor2,this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,disableImpostor:this.disableImpostor,dullInterior:!0}));return{bufferList:[n],bondSet:e.bondSet,bondStore:e.bondStore}},updateData:function(t,e){if(!t||t.position){var i=this.getContactData(e.sview);e.bondSet=i.bondSet,e.bondStore=i.bondStore}var r={bondSet:e.bondSet,bondStore:e.bondStore},n=this.getBondData(e.sview,t,r),o={};t&&!t.position||(o.position=U(n.position1,n.position2),o.position1=n.position1,o.position2=n.position2),t&&!t.color||(o.color=n.color1,o.color2=n.color2),t&&!t.radius||(o.radius=n.radius),e.bufferList[0].setAttributes(o)}}),yi.prototype={constructor:yi,build:function(t){var e=this.size+2*this.outline+Math.round(this.size/4),i=this.width/4,r=document.createElement("canvas");r.width=i,r.height=e;var n=function(t){return'"'+t.replace(/(['"\\])/g,"\\$1")+'"'},o=(this.font.map(n).join(", "),r.getContext("2d"));o.font=this.style+" "+this.variant+" "+this.weight+" "+this.size+"px "+this.font,o.fillStyle="#FF0000",o.textAlign="left",o.textBaseline="bottom",o.lineJoin="round";for(var s=[],a=3*this.outline,c=0;a>c;++c){var h=Math.max(0,8*-c+128-8*!c),u=("00"+h.toString(16)).slice(-2);s.push("#"+u+u+u)}var l=new Uint8Array(i*e*2);this.canvas=r,this.context=o,this.lineHeight=e,this.maxWidth=i,this.colors=s,this.scratch=l,this.data=new Uint8Array(this.width*this.height*4),this.canvas2=document.createElement("canvas"),this.canvas2.width=this.width,this.canvas2.height=this.height,this.context2=this.canvas2.getContext("2d")},map:function(t){return void 0===this.mapped[t]&&(this.draw(t),this.currentX+this.scratchW>this.width&&(this.currentX=0,this.currentY+=this.scratchH),this.currentY+this.scratchH>this.height&&console.warn("canvas to small"),this.mapped[t]={x:this.currentX,y:this.currentY,w:this.scratchW,h:this.scratchH},this.context2.drawImage(this.canvas,0,0,this.scratchW,this.scratchH,this.currentX,this.currentY,this.scratchW,this.scratchH),this.currentX+=this.scratchW),this.mapped[t]},draw:function(t){var e=this.lineHeight,i=this.outline,r=this.context,n=this.scratch,o=this.maxWidth,s=this.colors,a=i,c=e-this.outline,h=r.measureText(t),u=Math.min(o,Math.ceil(h.width+2*a+1));if(r.clearRect(0,0,u,e),0===this.outline){r.fillText(t,a,c);for(var l=r.getImageData(0,0,u,e),d=l.data,m=3,f=0,p=d.length/4;p>f;++f)n[f]=d[m],m+=4}else{r.globalCompositeOperation="source-over";for(var f=i+1;f>0;--f){var m=f>1?2*f-2:f;r.strokeStyle=s[m-1],r.lineWidth=m,r.strokeText(t,a,c)}r.globalCompositeOperation="multiply",r.fillStyle="#FF00FF",r.fillText(t,a,c);for(var l=r.getImageData(0,0,u,e),d=l.data,m=0,Y=this.gamma,f=0,p=d.length/4;p>f;++f){var X=d[m],Z=X?d[m+1]/X:1;.5===Y&&(Z=Math.sqrt(Z)),Z=Math.min(1,Math.max(0,Z));var g=256-X,v=g+(X-g)*Z;n[f]=Math.max(0,Math.min(255,v+2)),d[m+3]=n[f],m+=4}}r.putImageData(l,0,0),this.scratchW=u,this.scratchH=e},dispose:function(){}},bi.prototype=Object.assign(Object.create(Wt.prototype),{constructor:bi,type:"text",parameters:Object.assign({fontFamily:{uniform:!0},fontStyle:{uniform:!0},fontWeight:{uniform:!0},fontSize:{uniform:!0},sdf:{updateShader:!0,uniform:!0},xOffset:{uniform:!0},yOffset:{uniform:!0},zOffset:{uniform:!0}},Lt.prototype.parameters),makeMaterial:function(){Lt.prototype.makeMaterial.call(this),this.material.extensions.derivatives=!0,this.material.lights=!1,this.material.uniforms.fontTexture.value=this.tex,this.material.needsUpdate=!0},setAttributes:function(t){var e,i,r,n,o,s,a=this.text,c=this.geometry.attributes;t.position&&(e=t.position,n=c.position.array,c.position.needsUpdate=!0),t.size&&(i=t.size,o=c.inputSize.array,c.inputSize.needsUpdate=!0),t.color&&(r=t.color,s=c.color.array,c.color.needsUpdate=!0);for(var h,u,l,d,m,f,p=this.positionCount,Y=0,X=0;p>X;X++)for(l=3*X,d=a[X],f=d.length,m=0;f>m;m++,Y++){h=2*Y*4;for(var Z=0;4>Z;Z++)u=4*Y*3+3*Z,e&&(n[u]=e[l],n[u+1]=e[l+1],n[u+2]=e[l+2]),i&&(o[4*Y+Z]=i[X]),r&&(s[u]=r[l],s[u+1]=r[l+1],s[u+2]=r[l+2])}},makeTexture:function(){this.tex&&this.tex.dispose(),this.ta&&this.ta.dispose();for(var t=new yi({font:[this.fontFamily],style:this.fontStyle,weight:this.fontWeight,size:this.fontSize,outline:this.sdf?5:0}),e=0;256>e;++e)t.map(String.fromCharCode(e));this.ta=t,this.tex=new THREE.CanvasTexture(t.canvas2),this.tex.flipY=!1,this.tex.needsUpdate=!0},makeMapping:function(){for(var t,e,i,r,n,o,s,a=this.ta,c=this.text,h=this.geometry.attributes.inputTexCoord.array,u=this.geometry.attributes.mapping.array,l=this.positionCount,d=0,m=0;l>m;m++)for(i=3*m,r=c[m],n=0,s=r.length,o=0;s>o;o++,d++){t=a.mapped[r[o]],e=2*d*4,u[e+0]=n-a.outline,u[e+1]=t.h-a.outline,u[e+2]=n-a.outline,u[e+3]=0-a.outline,u[e+4]=n+t.w-a.outline,u[e+5]=t.h-a.outline,u[e+6]=n+t.w-a.outline,u[e+7]=0-a.outline;var f=a.width,p=a.height,Y=[t.x/f,t.y/p,t.x/f,(t.y+t.h)/p,(t.x+t.w)/f,t.y/p,(t.x+t.w)/f,(t.y+t.h)/p];h.set(Y,e),n+=t.w-2*a.outline}this.geometry.attributes.inputTexCoord.needsUpdate=!0,this.geometry.attributes.mapping.needsUpdate=!0},getDefines:function(t){var e=Lt.prototype.getDefines.call(this,t);return this.sdf&&(e.SDF=1),e},setUniforms:function(t){!t||void 0===t.fontFamily&&void 0===t.fontStyle&&void 0===t.fontWeight&&void 0===t.fontSize&&void 0===t.sdf||(this.makeTexture(),this.makeMapping(),t.fontTexture=this.tex),Lt.prototype.setUniforms.call(this,t)},dispose:function(){Lt.prototype.dispose.call(this),this.tex&&this.tex.dispose(),this.ta&&this.ta.dispose()}}),xi.prototype=Object.assign(Object.create(ee.prototype),{constructor:xi,type:"distance",defaultSize:.15,parameters:Object.assign({labelSize:{type:"number",precision:3,max:10,min:.001},labelColor:{type:"color"},labelVisible:{type:"boolean"},atomPair:{type:"hidden",rebuild:!0},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"},disableImpostor:{type:"boolean",rebuild:!0}},ee.prototype.parameters,{flatShaded:null,assembly:null}),init:function(t){var e=t||{};e.radius=e.radius||this.defaultSize,"low"===e.quality?this.radiusSegments=5:"medium"===e.quality?this.radiusSegments=10:"high"===e.quality?this.radiusSegments=20:this.radiusSegments=void 0!==e.radiusSegments?e.radiusSegments:10,this.disableImpostor=e.disableImpostor||!1,this.fontFamily=e.fontFamily||"sans-serif",this.fontStyle=e.fontStyle||"normal",this.fontWeight=e.fontWeight||"bold",this.sdf=void 0!==e.sdf?e.sdf:"Firefox"!==Tr,this.labelSize=e.labelSize||2,this.labelColor=e.labelColor||16777215,this.labelVisible=void 0!==e.labelVisible?e.labelVisible:!0,this.atomPair=e.atomPair||[],ee.prototype.init.call(this,e)},getDistanceData:function(t,e){var i=e.length,r=new Array(i),n=new Float32Array(3*i),o=new p,s=new p,a=new F,c=t.getAtomProxy(),h=t.getAtomProxy(),u=0;e.forEach(function(e,i){i-=u;var l=3*i;o.setString(e[0]),s.setString(e[1]);var d=t.getAtomIndices(o),m=t.getAtomIndices(s);d.length&&m.length?(c.index=d[0],h.index=m[0],a.addBond(c,h,1),r[i]=c.distanceTo(h).toFixed(2),n[l+0]=(c.x+h.x)/2,n[l+1]=(c.y+h.y)/2,n[l+2]=(c.z+h.z)/2):u+=1},this),u>0&&(i-=u,n=n.subarray(0,3*i));var l=new TypedFastBitSet(a.count);return l.set_all(!0),{text:r,position:n,bondSet:l,bondStore:a}},getBondData:function(t,e,i){return t.getBondData(this.getBondParams(e,i))},create:function(){if(0!==this.structureView.atomCount){var t=this.atomPair.length;if(0!==t){var e=this.getDistanceData(this.structureView,this.atomPair),i=new THREE.Color(this.labelColor);this.textBuffer=new bi(e.position,G(t,this.labelSize),q(t,i.r,i.g,i.b),e.text,this.getBufferParams({fontFamily:this.fontFamily,fontStyle:this.fontStyle,fontWeight:this.fontWeight,sdf:this.sdf,opacity:1,visible:this.labelVisible}));var r={bondSet:e.bondSet,bondStore:e.bondStore},n=this.getBondData(this.structureView,void 0,r);this.cylinderBuffer=new oe(n.position1,n.position2,n.color1,n.color2,n.radius,n.pickingColor1,n.pickingColor2,this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,disableImpostor:this.disableImpostor,dullInterior:!0})),this.dataList.push({sview:this.structureView,bondSet:e.bondSet,bondStore:e.bondStore,position:e.position,bufferList:[this.textBuffer,this.cylinderBuffer]})}}},updateData:function(t,e){if(!t||t.position){var i=this.getDistanceData(e.sview,this.atomPair);e.bondSet=i.bondSet,e.bondStore=i.bondStore,e.position=i.position}var r={bondSet:e.bondSet,bondStore:e.bondStore},n=this.getBondData(e.sview,t,r),o={},s={},a=this.atomPair.length;if(t.position&&(s.position=e.position,o.position=U(n.position1,n.position2),o.position1=n.position1,o.position2=n.position2),t.labelSize&&(s.size=G(a,this.labelSize)),t.labelColor){var c=new THREE.Color(this.labelColor);s.color=q(a,c.r,c.g,c.b)}t.color&&(o.color=n.color1,o.color2=n.color2),(t.radius||t.scale)&&(o.radius=n.radius),this.textBuffer.setAttributes(s),this.cylinderBuffer.setAttributes(o)},setVisibility:function(t,e){return ee.prototype.setVisibility.call(this,t,!0),this.textBuffer&&this.textBuffer.setVisibility(this.labelVisible&&this.visible),e||this.viewer.requestRender(),this},setParameters:function(t){var e=!1,i={};return t&&t.labelSize&&(i.labelSize=!0),t&&t.labelColor&&(i.labelColor=!0),ee.prototype.setParameters.call(this,t,i,e),t&&void 0!==t.labelVisible&&this.setVisibility(this.visible),this}}),Si.prototype=Object.assign(Object.create(Lt.prototype),{constructor:Si,setAttributes:function(t){var e,i,r,n=this.geometry.attributes;t.position&&t.vector&&(e=t.position,i=t.vector,r=n.position.array,n.position.needsUpdate=!0);var o,s,a=this.size,c=this.scale;if(t.position&&t.vector)for(var h=0;a>h;h++)o=2*h*3,s=3*h,r[o+0]=e[s+0],r[o+1]=e[s+1],r[o+2]=e[s+2],r[o+3]=e[s+0]+i[s+0]*c,r[o+4]=e[s+1]+i[s+1]*c,r[o+5]=e[s+2]+i[s+2]*c}}),wi.prototype=Object.assign(Object.create(ee.prototype),{constructor:wi,type:"helixorient",parameters:Object.assign({sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"},disableImpostor:{type:"boolean",rebuild:!0}},ee.prototype.parameters),init:function(t){var e=t||{};e.colorScheme=e.colorScheme||"sstruc",e.radius=e.radius||.15,e.scale=e.scale||1,"low"===e.quality?this.sphereDetail=0:"medium"===e.quality?this.sphereDetail=1:"high"===e.quality?this.sphereDetail=2:this.sphereDetail=void 0!==e.sphereDetail?e.sphereDetail:1,this.disableImpostor=e.disableImpostor||!1,ee.prototype.init.call(this,e)},createData:function(t){var e=[],i=[];return this.structure.eachPolymer(function(t){if(!(t.residueCount<4)){i.push(t);var r=new Q(t),n=r.getPosition(),o=r.getColor(this.getColorParams()),s=r.getSize(this.radius,this.scale);e.push(new Kt(n.center,o.color,s.size,o.pickingColor,this.getBufferParams({sphereDetail:this.sphereDetail,disableImpostor:this.disableImpostor,dullInterior:!0})),new Si(n.center,n.axis,this.getBufferParams({color:"skyblue",scale:1})),new Si(n.center,n.resdir,this.getBufferParams({color:"lightgreen",scale:1})))}}.bind(this),t.getSelection()),{bufferList:e,polymerList:i}},updateData:function(t,e){kr&&Ir.time(this.type+" repr update"),t=t||{};for(var i=0,r=e.polymerList.length;r>i;++i){var n=3*i,o={},s=e.polymerList[i],a=new Q(s);if(t.position){var c=a.getPosition();o.position=c.center,e.bufferList[n+1].setAttributes({position:c.center,vector:c.axis}),e.bufferList[n+2].setAttributes({position:c.center,vector:c.resdir})}e.bufferList[n].setAttributes(o)}kr&&Ir.timeEnd(this.type+" repr update")}}),Ai.prototype=Object.assign(Object.create(ui.prototype),{constructor:Ai,type:"licorice",parameters:Object.assign({},ui.prototype.parameters,{aspectRatio:null}),init:function(t){var e=t||{};e.aspectRatio=1,ui.prototype.init.call(this,e)}}),_i.prototype=Object.assign(Object.create(Ai.prototype),{constructor:_i,type:"hyperball",defaultSize:1,parameters:Object.assign({shrink:{type:"number",precision:3,max:1,min:.001,buffer:!0}},Ai.prototype.parameters),init:function(t){var e=t||{};e.scale=e.scale||.2,e.radius=e.radius||"vdw",this.shrink=e.shrink||.12,Ai.prototype.init.call(this,e)},getBondParams:function(t,e){return t&&!t.radius||(e=Object.assign({radius2:!0},e)),Ai.prototype.getBondParams.call(this,t,e)},createData:function(t){var e=t.getAtomData(this.getAtomParams()),i=t.getBondData(this.getBondParams()),r=new Kt(e.position,e.color,e.radius,e.pickingColor,this.getBufferParams({sphereDetail:this.sphereDetail,disableImpostor:this.disableImpostor,dullInterior:!0}));this.__center=new Float32Array(3*t.bondCount);var n=new Ci(i.position1,i.position2,i.color1,i.color2,i.radius1,i.radius2,i.pickingColor1,i.pickingColor2,this.getBufferParams({shrink:this.shrink,radiusSegments:this.radiusSegments,dullInterior:!0}),this.disableImpostor);return{bufferList:[r,n]}},updateData:function(t,e){var i=e.sview.getAtomData(this.getAtomParams()),r=e.sview.getBondData(this.getBondParams()),n={},o={};if(!t||t.position){n.position=i.position;var s=r.position1,a=r.position2;o.position=U(s,a,this.__center),o.position1=s,o.position2=a}t&&!t.color||(n.color=i.color,o.color=r.color1,o.color2=r.color2),t&&!t.radius||(n.radius=i.radius,o.radius=r.radius1,o.radius2=r.radius2),e.bufferList[0].setAttributes(n),e.bufferList[1].setAttributes(o)}}),Pi.prototype={constructor:Pi,atomLabel:function(t){var e,i=this.type;switch(i){case"atomname":e=t.atomname;break;case"atomindex":e=""+t.index;break;case"atom":e=t.atomname+"|"+t.index;break;case"resname":e=t.resname;break;case"resno":e=""+t.resno;break;case"res":e=(fr[t.resname.toUpperCase()]||"")+t.resno;break;case"text":e=this.text[t.index];break;default:e=t.qualifiedName()}return void 0===e?"":e}},Pi.types={"":"",atomname:"atom name",atomindex:"atom index",atom:"atom name + index",resname:"residue name",resno:"residue no",res:"residue name + no",text:"text"},Ei.prototype=Object.assign(Object.create(ee.prototype),{constructor:Ei,type:"label",parameters:Object.assign({labelType:{type:"select",options:Pi.types,rebuild:!0},fontFamily:{type:"select",options:{"sans-serif":"sans-serif",monospace:"monospace",serif:"serif"},buffer:!0},fontStyle:{type:"select",options:{normal:"normal",italic:"italic"},buffer:!0},fontWeight:{type:"select",options:{normal:"normal",bold:"bold"},buffer:!0},sdf:{type:"boolean",buffer:!0},xOffset:{type:"number",precision:1,max:20,min:-20,buffer:!0},yOffset:{type:"number",precision:1,max:20,min:-20,buffer:!0},zOffset:{type:"number",precision:1,max:20,min:-20,buffer:!0}},ee.prototype.parameters,{side:null,flatShaded:null,wireframe:null,linewidth:null,roughness:null,metalness:null,diffuse:null}),init:function(t){var e=t||{};this.labelType=e.labelType||"res",this.labelText=e.labelText||{},this.fontFamily=e.fontFamily||"sans-serif",this.fontStyle=e.fontStyle||"normal",this.fontWeight=e.fontWeight||"bold",this.sdf=void 0!==e.sdf?e.sdf:"Firefox"!==Tr,this.xOffset=void 0!==e.xOffset?e.xOffset:0,this.yOffset=void 0!==e.yOffset?e.yOffset:0,this.zOffset=void 0!==e.zOffset?e.zOffset:.5,ee.prototype.init.call(this,e)},createData:function(t){var e={position:!0,color:!0,radius:!0},i=t.getAtomData(this.getAtomParams(e)),r=[],n=new Pi(this.labelType,this.labelText);t.eachSelectedAtom(function(t){r.push(n.atomLabel(t))});var o=new bi(i.position,i.radius,i.color,r,this.getBufferParams({fontFamily:this.fontFamily,fontStyle:this.fontStyle,fontWeight:this.fontWeight,sdf:this.sdf,xOffset:this.xOffset,yOffset:this.yOffset,zOffset:this.zOffset}));return{bufferList:[o]}},updateData:function(t,e){var i=e.sview.getAtomData(this.getAtomParams(t)),r={};t&&!t.position||(r.position=i.position),t&&!t.radius||(r.size=i.radius),t&&!t.color||(r.color=i.color),e.bufferList[0].setAttributes(r)}}),Ti.prototype=Object.assign(Object.create(ee.prototype),{constructor:Ti,type:"line",parameters:Object.assign({},Nt.prototype.parameters,{flatShaded:null,side:null,wireframe:null,roughness:null,metalness:null,diffuse:null}),init:function(t){var e=t||{};ee.prototype.init.call(this,e)},createData:function(t){var e={position:!0,color:!0},i=t.getBondData(this.getBondParams(e)),r=new se(i.position1,i.position2,i.color1,i.color2,this.getBufferParams());return{bufferList:[r]}},updateData:function(t,e){var i=e.sview.getBondData(this.getBondParams(t)),r={};t&&!t.position||(r.from=i.position1,r.to=i.position2),t&&!t.color||(r.color=i.color1,r.color2=i.color2),e.bufferList[0].setAttributes(r)}}),Br.add("molsurf",function(t,e){kr&&Ir.time("WORKER molsurf");var i=t.data,r=i.params;i.structure&&("Structure"===i.structure.metadata.type?self.molsurf=new ki((new vt).fromJSON(i.structure)):"StructureView"===i.structure.metadata.type?self.molsurf=new ki((new yt).fromJSON(i.structure)):console.error("wrong type"));var n=self.molsurf,o=n.getSurface(r);kr&&Ir.timeEnd("WORKER molsurf"),e(o.toJSON(),o.getTransferable())}),ki.prototype={getSurface:function(t){var e=t||{},i=new Ii(this.structure),r=i.getVolume(e.type,e.probeRadius,e.scaleFactor,e.lowRes,e.cutoff),n=r.getSurface(1,e.smooth);return n.info.type=e.type,n.info.probeRadius=e.probeRadius,n.info.scaleFactor=e.scaleFactor,n.info.smooth=e.smooth,n.info.lowRes=e.lowRes,n.info.cutoff=e.cutoff,r.dispose(),n},getSurfaceWorker:function(t,e){var i=Object.assign({},t);if("undefined"!=typeof Et&&"function"!=typeof importScripts){var r;void 0===this.worker&&(r=this.structure.toJSON(),this.worker=new Et("molsurf")),this.worker.post({structure:r,params:i},void 0,function(t){var i=a(t.data);e(i)}.bind(this),function(t){console.warn("MolecularSurface.generateSurfaceWorker error - trying without worker",t),this.worker.terminate(),this.worker=void 0;var r=this.getSurface(i);e(r)}.bind(this))}else{var n=this.getSurface(i);e(n)}},dispose:function(){this.worker&&this.worker.terminate()}},Ni.prototype=Object.assign(Object.create(ee.prototype),{constructor:Ni,type:"surface",parameters:Object.assign({surfaceType:{type:"select",rebuild:!0,options:{vws:"vws",sas:"sas",ms:"ms",ses:"ses"}},probeRadius:{type:"number",precision:1,max:20,min:0,rebuild:!0},smooth:{type:"integer",precision:1,max:10,min:0,rebuild:!0},scaleFactor:{type:"number",precision:1,max:5,min:0,rebuild:!0},cutoff:{type:"number",precision:2,max:50,min:0,rebuild:!0},background:{type:"boolean",rebuild:!0},opaqueBack:{type:"boolean",buffer:!0},lowResolution:{type:"boolean",rebuild:!0},filterSele:{type:"text"},volume:{type:"hidden"},useWorker:{type:"boolean",rebuild:!0}},ee.prototype.parameters,{radiusType:null,radius:null,scale:null}),init:function(t){var e=t||{};e.colorScheme=e.colorScheme||"uniform",e.colorValue=void 0!==e.colorValue?e.colorValue:14540253,this.surfaceType=void 0!==e.surfaceType?e.surfaceType:"ms",this.probeRadius=void 0!==e.probeRadius?e.probeRadius:1.4,this.smooth=void 0!==e.smooth?e.smooth:2,this.scaleFactor=void 0!==e.scaleFactor?e.scaleFactor:2,this.cutoff=e.cutoff||0,this.background=e.background||!1,this.opaqueBack=void 0!==e.opaqueBack?e.opaqueBack:!0,this.lowResolution=void 0!==e.lowResolution?e.lowResolution:!1,this.filterSele=void 0!==e.filterSele?e.filterSele:"",this.volume=e.volume||void 0,this.useWorker=void 0!==e.useWorker?e.useWorker:!0,ee.prototype.init.call(this,t)},prepareData:function(t,e,i){var r=this.__infoList[e];if(r||(r={},this.__infoList[e]=r),r.molsurf&&r.sele===t.selection.string)i(e);else{r.sele=t.selection.string,r.molsurf=new ki(t);var n=this.getSurfaceParams(),o=function(t){r.surface=t,i(e)};this.useWorker?r.molsurf.getSurfaceWorker(n,o):o(r.molsurf.getSurface(n))}},prepare:function(t){if((this.__forceNewMolsurf||this.__sele!==this.selection.string||this.__surfaceParams!==JSON.stringify(this.getSurfaceParams()))&&(this.__infoList.forEach(function(t,e){t.molsurf.dispose()}.bind(this)),this.__infoList.length=0),0===this.structureView.atomCount)return void t();var e=function(){this.__sele=this.selection.string,this.__surfaceParams=JSON.stringify(this.getSurfaceParams()),this.__forceNewMolsurf=!1,t()}.bind(this),i="default"===this.assembly?this.defaultAssembly:this.assembly,r=this.structure.biomolDict[i];r?r.partList.forEach(function(t,i){var n=t.getView(this.structureView);this.prepareData(n,i,function(t){t===r.partList.length-1&&e()}.bind(this))},this):this.prepareData(this.structureView,0,e)},createData:function(t,e){var i=this.__infoList[e],r=new Ft(i.surface.getPosition(),i.surface.getColor(this.getColorParams()),i.surface.getFilteredIndex(this.filterSele,t),i.surface.getNormal(),i.surface.getPickingColor(this.getColorParams()),this.getBufferParams({background:this.background,opaqueBack:this.opaqueBack,dullInterior:!1})),n=new Dt(r);return{bufferList:[n],info:i}},updateData:function(t,e){var i={};return t.position?(this.__forceNewMolsurf=!0,void this.build()):(t.color&&(i.color=e.info.surface.getColor(this.getColorParams())),t.index&&(i.index=e.info.surface.getFilteredIndex(this.filterSele,e.sview)),void e.bufferList[0].setAttributes(i))},setParameters:function(t,e,i){return e=e||{},t&&t.filterSele&&(e.index=!0),t&&void 0!==t.volume&&(e.color=!0),ee.prototype.setParameters.call(this,t,e,i),this},getSurfaceParams:function(t){var e=Object.assign({type:this.surfaceType,probeRadius:this.probeRadius,scaleFactor:this.scaleFactor,smooth:this.smooth,lowRes:this.lowResolution,cutoff:this.cutoff,useWorker:this.useWorker},t);return e},getColorParams:function(){var t=ee.prototype.getColorParams.call(this);return t.volume=this.volume,t},clear:function(){ee.prototype.clear.call(this)},dispose:function(){this.__infoList.forEach(function(t,e){t.molsurf.dispose()}.bind(this)),this.__infoList.length=0,ee.prototype.dispose.call(this)}}),Mi.prototype=Object.assign(Object.create(ee.prototype),{constructor:Mi,type:"point",parameters:Object.assign({pointSize:{type:"number",precision:1,max:100,min:0,buffer:!0},sizeAttenuation:{type:"boolean",buffer:!0},sortParticles:{type:"boolean",rebuild:!0},useTexture:{type:"boolean",buffer:!0},alphaTest:{type:"range",step:.001,max:1,min:0,buffer:!0},forceTransparent:{type:"boolean",buffer:!0},edgeBleach:{type:"range",step:.001,max:1,min:0,buffer:!0}},Nt.prototype.parameters,{flatShaded:null,wireframe:null,linewidth:null,roughness:null,metalness:null}),init:function(t){var e=t||{};this.pointSize=e.pointSize||1,this.sizeAttenuation=void 0!==e.sizeAttenuation?e.sizeAttenuation:!0,this.sortParticles=void 0!==e.sortParticles?e.sortParticles:!1,this.useTexture=void 0!==e.useTexture?e.useTexture:!1,this.alphaTest=void 0!==e.alphaTest?e.alphaTest:.5,this.forceTransparent=void 0!==e.forceTransparent?e.forceTransparent:!1,this.edgeBleach=void 0!==e.edgeBleach?e.edgeBleach:0,ee.prototype.init.call(this,e)},createData:function(t){var e={position:!0,color:!0},i=t.getAtomData(this.getAtomParams(e)),r=new $t(i.position,i.color,this.getBufferParams({pointSize:this.pointSize,sizeAttenuation:this.sizeAttenuation,sortParticles:this.sortParticles,useTexture:this.useTexture,alphaTest:this.alphaTest,forceTransparent:this.forceTransparent,edgeBleach:this.edgeBleach}));return{bufferList:[r]}},updateData:function(t,e){var i=e.sview.getAtomData(this.getAtomParams(t)),r={};t&&!t.position||(r.position=i.position),t&&!t.color||(r.color=i.color),e.bufferList[0].setAttributes(r)}}),Li.prototype=Object.assign(Object.create(Lt.prototype),{constructor:Li,setAttributes:function(t){var e,i,r,n,o,s,a,c,h,u,l,d,m=this.size,f=m/4,p=this.geometry.attributes;t.position&&(e=t.position,a=p.position.array,p.position.needsUpdate=!0),t.normal&&(i=t.normal,c=p.normal.array,p.normal.needsUpdate=!0),t.size&&(r=t.size,h=p.size.array,p.size.needsUpdate=!0),t.dir&&(n=t.dir,u=p.dir.array,p.dir.needsUpdate=!0),t.color&&(o=t.color,l=p.color.array,p.color.needsUpdate=!0),t.pickingColor&&(s=t.pickingColor,d=p.pickingColor.array,p.pickingColor.needsUpdate=!0);var Y,X,Z,g,v,y,b,x=r?r[0]:null;for(Y=0;f>Y;++Y){for(y=3*Y,Z=3*Y*4,v=4*Y,e&&(a[Z]=a[Z+3]=e[y],a[Z+1]=a[Z+4]=e[y+1],a[Z+2]=a[Z+5]=e[y+2],a[Z+6]=a[Z+9]=e[y+3],a[Z+7]=a[Z+10]=e[y+4],a[Z+8]=a[Z+11]=e[y+5]),i&&(c[Z]=c[Z+3]=-i[y],c[Z+1]=c[Z+4]=-i[y+1],c[Z+2]=c[Z+5]=-i[y+2],c[Z+6]=c[Z+9]=-i[y+3],c[Z+7]=c[Z+10]=-i[y+4],c[Z+8]=c[Z+11]=-i[y+5]),X=0;4>X;++X)g=Z+3*X,o&&(l[g]=o[y],l[g+1]=o[y+1],l[g+2]=o[y+2]),s&&(d[g]=s[y],d[g+1]=s[y+1],d[g+2]=s[y+2]);r&&(b=r[Y],x!==r[Y]?(h[v]=x,h[v+1]=x,h[v+2]=b,h[v+3]=b):(h[v]=b,h[v+1]=b,h[v+2]=b,h[v+3]=b),x=b),n&&(u[Z]=n[y],u[Z+1]=n[y+1],u[Z+2]=n[y+2],u[Z+3]=-n[y],u[Z+4]=-n[y+1],u[Z+5]=-n[y+2],u[Z+6]=n[y+3],u[Z+7]=n[y+4],u[Z+8]=n[y+5],u[Z+9]=-n[y+3],u[Z+10]=-n[y+4],u[Z+11]=-n[y+5])}},makeIndex:function(){var t,e,i,r,n=this.meshIndex,o=n.length/4/3,s=new Uint16Array([0,1,2,1,3,2]);for(e=0;o>e;++e)for(i=6*e,r=4*e,n.set(s,i),t=0;6>t;++t)n[i+t]+=r}}),Bi.prototype=Object.assign(Object.create(ee.prototype),{constructor:Bi,type:"ribbon",parameters:Object.assign({subdiv:{type:"integer",max:50,min:1,rebuild:!0},tension:{type:"number",precision:1,max:1,min:.1},smoothSheet:{type:"boolean",rebuild:!0}},ee.prototype.parameters,{side:null,wireframe:null,linewidth:null}),init:function(t){var e=t||{};e.colorScheme=e.colorScheme||"atomindex",e.colorScale=e.colorScale||"RdYlBu",
e.radius=e.radius||"sstruc",e.scale=e.scale||4,"low"===e.quality?this.subdiv=3:"medium"===e.quality?this.subdiv=6:"high"===e.quality?this.subdiv=12:this.subdiv=e.subdiv||6,this.tension=e.tension||NaN,this.smoothSheet=e.smoothSheet||!1,ee.prototype.init.call(this,e)},getSplineParams:function(t){return Object.assign({subdiv:this.subdiv,tension:this.tension,directional:!0,smoothSheet:this.smoothSheet},t)},createData:function(t){var e=[],i=[];return this.structure.eachPolymer(function(t){if(!(t.residueCount<4)){i.push(t);var r=new fi(t,this.getSplineParams()),n=r.getSubdividedPosition(),o=r.getSubdividedOrientation(),s=r.getSubdividedColor(this.getColorParams()),a=r.getSubdividedSize(this.radius,this.scale);e.push(new Li(n.position,o.binormal,o.normal,s.color,a.size,s.pickingColor,this.getBufferParams()))}}.bind(this),t.getSelection()),{bufferList:e,polymerList:i}},updateData:function(t,e){t=t||{};var i=0,r=e.polymerList.length;for(i=0;r>i;++i){var n={},o=new fi(e.polymerList[i],this.getSplineParams());if(t.position){var s=o.getSubdividedPosition(),a=o.getSubdividedOrientation();n.position=s.position,n.normal=a.binormal,n.dir=a.normal}if(t.radius||t.scale){var c=o.getSubdividedSize(this.radius,this.scale);n.size=c.size}if(t.color){var h=o.getSubdividedColor(this.getColorParams());n.color=h.color}e.bufferList[i].setAttributes(n)}},setParameters:function(t){var e=!1,i={};return t&&t.tension&&(i.position=!0),ee.prototype.setParameters.call(this,t,i,e),this}}),Fi.prototype=Object.assign(Object.create(ee.prototype),{constructor:Fi,type:"rocket",parameters:Object.assign({localAngle:{type:"integer",max:180,min:0,rebuild:!0},centerDist:{type:"number",precision:1,max:10,min:0,rebuild:!0},ssBorder:{type:"boolean",rebuild:!0},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"},disableImpostor:{type:"boolean",rebuild:!0}},ee.prototype.parameters),init:function(t){var e=t||{};e.colorScheme=e.colorScheme||"sstruc",e.radius=e.radius||1.5,e.scale=e.scale||1,"low"===e.quality?this.radiusSegments=5:"medium"===e.quality?this.radiusSegments=10:"high"===e.quality?this.radiusSegments=20:this.radiusSegments=void 0!==e.radiusSegments?e.radiusSegments:10,this.disableImpostor=e.disableImpostor||!1,this.localAngle=e.localAngle||30,this.centerDist=e.centerDist||2.5,this.ssBorder=void 0===e.ssBorder?!1:e.ssBorder,ee.prototype.init.call(this,e)},createData:function(t){var e=0,i=[],r=[];this.structure.eachPolymer(function(t){if(!(t.residueCount<4||t.isNucleic())){var n=new $(t),o=n.getAxis(this.localAngle,this.centerDist,this.ssBorder,this.getColorParams(),this.radius,this.scale);e+=o.size.length,i.push(o),r.push(n)}}.bind(this),t.getSelection());var n={begin:new Float32Array(3*e),end:new Float32Array(3*e),size:new Float32Array(e),color:new Float32Array(3*e),pickingColor:new Float32Array(3*e)},o=0;i.forEach(function(t){n.begin.set(t.begin,3*o),n.end.set(t.end,3*o),n.size.set(t.size,o),n.color.set(t.color,3*o),n.pickingColor.set(t.pickingColor,3*o),o+=t.size.length});var s=new oe(n.begin,n.end,n.color,n.color,n.size,n.pickingColor,n.pickingColor,this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,disableImpostor:this.disableImpostor,dullInterior:!0}));return{bufferList:[s],axisList:i,helixbundleList:r,axisData:n}},updateData:function(t,e){if(t=t||{},t.position)return void this.build();var i={};if(t.color||t.radius){var r=0;e.helixbundleList.forEach(function(i){var n=i.getAxis(this.localAngle,this.centerDist,this.ssBorder,this.getColorParams(),this.radius,this.scale);t.color&&e.axisData.color.set(n.color,3*r),(t.radius||t.scale)&&e.axisData.size.set(n.size,r),r+=n.size.length}.bind(this)),t.color&&(i.color=e.axisData.color,i.color2=e.axisData.color),(t.radius||t.scale)&&(i.radius=e.axisData.size)}e.bufferList[0].setAttributes(i)}}),Di.prototype=Object.assign(Object.create(Yi.prototype),{constructor:Di,type:"rope",parameters:Object.assign({smooth:{type:"integer",max:15,min:0,rebuild:!0}},Yi.prototype.parameters,{aspectRatio:null,smoothSheet:null}),init:function(t){var e=t||{};e.aspectRatio=1,e.tension=e.tension||.5,e.scale=e.scale||5,e.smoothSheet=!1,this.smooth=void 0===e.smooth?2:e.smooth,Yi.prototype.init.call(this,e)},getSpline:function(t){var e=new Q(t);return new fi(t,this.getSplineParams({directional:!1,positionIterator:e.getCenterIterator(this.smooth)}))}}),ji.prototype=Object.assign(Object.create(ee.prototype),{constructor:ji,type:"spacefill",parameters:Object.assign({sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"},disableImpostor:{type:"boolean",rebuild:!0}},ee.prototype.parameters),init:function(t){var e=t||{};"low"===e.quality?this.sphereDetail=0:"medium"===e.quality?this.sphereDetail=1:"high"===e.quality?this.sphereDetail=2:this.sphereDetail=void 0!==e.sphereDetail?e.sphereDetail:1,this.disableImpostor=e.disableImpostor||!1,ee.prototype.init.call(this,e)},createData:function(t){var e=t.getAtomData(this.getAtomParams()),i=new Kt(e.position,e.color,e.radius,e.pickingColor,this.getBufferParams({sphereDetail:this.sphereDetail,dullInterior:!0,disableImpostor:this.disableImpostor}));return{bufferList:[i]}},updateData:function(t,e){var i=e.sview.getAtomData(this.getAtomParams(t)),r={};t&&!t.position||(r.position=i.position),t&&!t.color||(r.color=i.color),t&&!t.radius||(r.radius=i.radius),e.bufferList[0].setAttributes(r)}}),zi.prototype=Object.assign(Object.create(Lt.prototype),{constructor:zi,setAttributes:function(t){var e,i,r,n,o=this.geometry.attributes;if(t.position&&(e=t.position,r=o.position.array,o.position.needsUpdate=!0),t.color&&(i=t.color,n=o.color.array,o.color.needsUpdate=!0),!e&&!i)return void Ir.warn("TraceBuffer.prototype.setAttributes no data");for(var s,a,c=this.size,h=c-1,u=0;h>u;++u)s=3*u,a=3*u*2,e&&(r[a]=e[s],r[a+1]=e[s+1],r[a+2]=e[s+2],r[a+3]=e[s+3],r[a+4]=e[s+4],r[a+5]=e[s+5]),i&&(n[a]=i[s],n[a+1]=i[s+1],n[a+2]=i[s+2],n[a+3]=i[s+3],n[a+4]=i[s+4],n[a+5]=i[s+5])}}),Hi.prototype=Object.assign(Object.create(ee.prototype),{constructor:Hi,type:"trace",parameters:Object.assign({subdiv:{type:"integer",max:50,min:1,rebuild:!0},tension:{type:"number",precision:1,max:1,min:.1},smoothSheet:{type:"boolean",rebuild:!0}},Nt.prototype.parameters,{flatShaded:null,side:null,wireframe:null}),init:function(t){var e=t||{};e.colorScheme=e.colorScheme||"atomindex",e.colorScale=e.colorScale||"RdYlBu","low"===e.quality?this.subdiv=3:"medium"===e.quality?this.subdiv=6:"high"===e.quality?this.subdiv=12:this.subdiv=e.subdiv||6,this.tension=e.tension||NaN,this.smoothSheet=e.smoothSheet||!1,ee.prototype.init.call(this,e)},getSplineParams:function(t){return Object.assign({subdiv:this.subdiv,tension:this.tension,directional:!1,smoothSheet:this.smoothSheet},t)},createData:function(t){var e=[],i=[];return this.structure.eachPolymer(function(t){if(!(t.residueCount<4)){i.push(t);var r=new fi(t,this.getSplineParams()),n=r.getSubdividedPosition(),o=r.getSubdividedColor(this.getColorParams());e.push(new zi(n.position,o.color,this.getBufferParams()))}}.bind(this),t.getSelection()),{bufferList:e,polymerList:i}},updateData:function(t,e){t=t||{};var i=0,r=e.polymerList.length;for(i=0;r>i;++i){var n={},o=new fi(e.polymerList[i],this.getSplineParams());if(t.position){var s=o.getSubdividedPosition();n.position=s.position}if(t.color){var a=o.getSubdividedColor(this.getColorParams());n.color=a.color}e.bufferList[i].setAttributes(n)}},setParameters:function(t){var e=!1,i={};return t&&t.tension&&(i.position=!0),ee.prototype.setParameters.call(this,t,i,e),this}}),Vi.prototype=Object.assign(Object.create(Yi.prototype),{constructor:Vi,type:"tube",parameters:Object.assign({},Yi.prototype.parameters,{aspectRatio:null}),init:function(t){var e=t||{};e.aspectRatio=1,e.scale=e.scale||2,Yi.prototype.init.call(this,e)},getSplineParams:function(t){return Yi.prototype.getSplineParams.call(this,{directional:!1})}}),Ui.prototype=Object.assign(Object.create(ee.prototype),{constructor:Ui,type:"unitcell",parameters:Object.assign({radius:{type:"number",precision:3,max:10,min:.001},sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"},disableImpostor:{type:"boolean",rebuild:!0}},Nt.prototype.parameters,{assembly:null}),init:function(t){var e=t||{};e.radius=void 0===e.radius?.5:e.radius,e.colorValue=void 0===e.colorValue?"orange":e.colorValue,"low"===e.quality?(this.sphereDetail=0,this.radiusSegments=5):"medium"===e.quality?(this.sphereDetail=1,this.radiusSegments=10):"high"===e.quality?(this.sphereDetail=2,this.radiusSegments=20):(this.sphereDetail=void 0!==e.sphereDetail?e.sphereDetail:1,this.radiusSegments=void 0!==e.radiusSegments?e.radiusSegments:10),this.disableImpostor=e.disableImpostor||!1,ee.prototype.init.call(this,e)},getUnitcellData:function(t){function e(t,e,i){m.set(t,e,i).multiply(d).applyMatrix4(l.fracToCart).toArray(n,f),f+=3}function i(t,e){m.fromArray(n,3*t).toArray(a,p),m.fromArray(n,3*e).toArray(c,p),p+=3}var r=new THREE.Color(this.colorValue),n=new Float32Array(24),o=q(8,r.r,r.g,r.b),s=G(8,this.radius),a=new Float32Array(36),c=new Float32Array(36),h=q(12,r.r,r.g,r.b),u=G(12,this.radius),l=t.unitcell,d=t.center.clone().applyMatrix4(l.cartToFrac).floor().multiplyScalar(2).addScalar(1),m=new THREE.Vector3,f=0;e(0,0,0),e(1,0,0),e(0,1,0),e(0,0,1),e(1,1,0),e(1,0,1),e(0,1,1),e(1,1,1);var p=0;return i(0,1),i(0,2),i(0,3),i(1,4),i(1,5),i(2,6),i(3,5),i(4,7),i(5,7),i(2,4),i(7,6),i(3,6),{vertexPosition:n,vertexColor:o,vertexRadius:s,edgePosition1:a,edgePosition2:c,edgeColor:h,edgeRadius:u}},create:function(){var t=this.structureView.getStructure();if(t.unitcell){var e=this.getUnitcellData(t);this.sphereBuffer=new Kt(e.vertexPosition,e.vertexColor,e.vertexRadius,void 0,this.getBufferParams({sphereDetail:this.sphereDetail,disableImpostor:this.disableImpostor,dullInterior:!0})),this.cylinderBuffer=new oe(e.edgePosition1,e.edgePosition2,e.edgeColor,e.edgeColor,e.edgeRadius,void 0,void 0,this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,disableImpostor:this.disableImpostor,dullInterior:!0})),this.dataList.push({sview:this.structureView,bufferList:[this.sphereBuffer,this.cylinderBuffer]})}},updateData:function(t,e){var i=e.sview.getStructure(),r=this.getUnitcellData(i),n={},o={};t&&!t.position||(n.position=r.vertexPosition,o.position=U(r.position1,r.position2),o.position1=r.edgePosition1,o.position2=r.edgePosition2),t&&!t.color||(n.color=r.vertexColor,o.color=r.edgeColor,o.color2=r.edgeColor),t&&!t.radius||(n.radius=r.vertexRadius,o.radius=r.edgeRadius),this.sphereBuffer.setAttributes(n),this.cylinderBuffer.setAttributes(o)}}),jr.add("backbone",li),jr.add("ball+stick",ui),jr.add("base",di),jr.add("contact",vi),jr.add("distance",xi),jr.add("helixorient",wi),jr.add("hyperball",_i),jr.add("label",Ei),jr.add("licorice",Ai),jr.add("line",Ti),jr.add("surface",Ni),jr.add("point",Mi),jr.add("ribbon",Bi),jr.add("rocket",Fi),jr.add("rope",Di),jr.add("spacefill",ji),jr.add("trace",Hi),jr.add("tube",Vi),jr.add("unitcell",Ui);var On="v0.8.0dev";t.version=On,t.Stage=hi});