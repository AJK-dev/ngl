<!DOCTYPE html>
<html lang="en">

    <head>

        <title>NGL - embedded</title>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

    </head>

    <body>

        <script>

            var blob, stage;
            var url = "http://mmtf.rcsb.org/v0/full/3sn6";
            var xhr = new XMLHttpRequest();
            xhr.open( "GET", url, true );
            xhr.addEventListener( 'load', function( event ){
                blob = new Blob( [ xhr.response ], { type: 'application/octet-binary'} );
                if( stage ){
                    stage.loadFile( blob, { ext: "mmtf", defaultRepresentation: true } );
                }
            } );
            xhr.responseType = "arraybuffer";
            xhr.send( null );

        </script>

        <!-- THREE -->
        <script src="../lib/three/three.js"></script>
        <script src="../lib/three/TypedArrayUtils.js"></script>
        <script src="../lib/three/TrackballControls.js"></script>
        <script src="../lib/three/OBJLoader.js"></script>
        <script src="../lib/three/PLYLoader.js"></script>

        <!-- LIB -->
        <script src="../lib/promise.min.js"></script>
        <script src="../lib/sprintf.min.js"></script>
        <script src="../lib/pako_inflate.min.js"></script>
        <script src="../lib/chroma.min.js"></script>
        <script src="../lib/signals.min.js"></script>
        <script src="../lib/msgpack-decode.js"></script>
        <script src="../lib/mmtf-decode.js"></script>

        <!-- NGL -->
        <script src="../src/shims.js"></script>
        <script src="../build/js/ngl.js"></script>

        <script>

            document.addEventListener( "DOMContentLoaded", function(){
                stage = new NGL.Stage( "viewport" );
                stage.viewer.container.addEventListener( "dblclick", function(){
                    stage.toggleFullscreen();
                } );
                // stage.loadFile( "rcsb://1crn.mmtf", { defaultRepresentation: true } );
                if( blob ){
                    stage.loadFile( blob, { ext: "mmtf", defaultRepresentation: true } );
                }
            } );

        </script>

        <div id="viewport" style="width:800px; height:800px;"></div>

    </body>

</html>
