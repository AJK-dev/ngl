var jsfeat=jsfeat||{REVISION:"ALPHA"};
(function(g){var u=256,b=512,e=1024,a=new Int32Array([-1,1,4,-1,4,-1,-1,-1,8,-1,-1,-1,-1,-1,-1,-1,8]),c=function(){return function(a){return a&65280}}(),h=function(){return function(a){return a&255}}(),m=function(){return function(b){return a[(b&65280)>>8]}}(),k=function(){return function(a,b){this.size=(a+7|0)&-8;"undefined"===typeof b?this.buffer=new ArrayBuffer(this.size):(this.buffer=b,this.size=b.length);this.u8=new Uint8Array(this.buffer);this.i32=new Int32Array(this.buffer);this.f32=new Float32Array(this.buffer);
this.f64=new Float64Array(this.buffer)}}(),n=function(){function a(f,m,k,n){this.type=c(k)|0;this.channel=h(k)|0;this.cols=f|0;this.rows=m|0;"undefined"===typeof n?this.allocate():(this.buffer=n,this.data=this.type&u?this.buffer.u8:this.type&b?this.buffer.i32:this.type&e?this.buffer.f32:this.buffer.f64)}a.prototype.allocate=function(){delete this.data;delete this.buffer;this.buffer=new k(this.cols*m(this.type)*this.channel*this.rows);this.data=this.type&u?this.buffer.u8:this.type&b?this.buffer.i32:
this.type&e?this.buffer.f32:this.buffer.f64};a.prototype.copy_to=function(a){a=a.data;for(var b=this.data,c=0,h=this.cols*this.rows*this.channel|0;c<h-4;c+=4)a[c]=b[c],a[c+1]=b[c+1],a[c+2]=b[c+2],a[c+3]=b[c+3];for(;c<h;++c)a[c]=b[c]};a.prototype.resize=function(a,c,b){"undefined"===typeof b&&(b=this.channel);a*b*c>this.rows*this.cols*this.channel?(this.cols=a,this.rows=c,this.channel=b,this.allocate()):(this.cols=a,this.rows=c,this.channel=b)};return a}();g.U8_t=u;g.S32_t=b;g.F32_t=e;g.S64_t=2048;
g.F64_t=4096;g.C1_t=1;g.C2_t=2;g.C3_t=3;g.C4_t=4;g.U8C1_t=u|1;g.U8C3_t=u|3;g.U8C4_t=u|4;g.F32C1_t=e|1;g.F32C2_t=e|2;g.S32C1_t=b|1;g.S32C2_t=b|2;g.EPSILON=1.192092896E-7;g.FLT_MIN=1E-37;g.BOX_BLUR_NOSCALE=1;g.SVD_U_T=1;g.SVD_V_T=2;g.get_data_type=c;g.get_channel=h;g.get_data_type_size=m;g.data_t=k;g.matrix_t=n})(jsfeat);
(function(g){var u=function(){return{transpose:function(b,e){for(var a=0,c=0,h=e.rows,m=e.cols,k=0,n=0,f=0,g=e.data,z=b.data;a<h;n+=1,k+=m,a++)for(f=n,c=0;c<m;f+=h,c++)z[f]=g[k+c]},multiply:function(b,e,a){var c=0,h=0,m=0,k=0,n=0,f=0,g=0,z=0,q=e.cols,r=e.rows,t=a.cols;e=e.data;a=a.data;b=b.data;for(var A=0;c<r;k+=q,c++)for(h=g=0;h<t;z++,g++,h++){f=g;n=k;for(m=A=0;m<q;n++,f+=t,m++)A+=e[n]*a[f];b[z]=A}},multiply_ABt:function(b,e,a){var c=0,h=0,m=0,k=0,n=0,f=0,g=0,z=e.cols,q=e.rows,r=a.rows;e=e.data;
a=a.data;b=b.data;for(var t=0;c<q;k+=z,c++)for(h=f=0;h<r;g++,h++){n=k;for(m=t=0;m<z;n++,f++,m++)t+=e[n]*a[f];b[g]=t}},multiply_AtB:function(b,e,a){var c=0,h=0,m=0,k=0,n=0,f=0,g=0,z=0,q=e.cols,r=e.rows,t=a.cols;e=e.data;a=a.data;b=b.data;for(var A=0;c<q;k++,c++)for(h=g=0;h<t;z++,g++,h++){f=g;n=k;for(m=A=0;m<r;n+=q,f+=t,m++)A+=e[n]*a[f];b[z]=A}},invert_3x3:function(b,e){var a=b.data,c=e.data,h=a[4],m=a[8],k=a[5],n=a[7],f=a[0],g=f*h,z=f*k,q=a[3],r=a[1],t=q*r,A=a[2],u=q*A,a=a[6],M=a*r,F=a*A,E=1/(g*m-
z*n-t*m+u*n+M*k-F*h);c[0]=(h*m-k*n)*E;c[1]=-(r*m-A*n)*E;c[2]=-(-r*k+A*h)*E;c[3]=-(q*m-k*a)*E;c[4]=(f*m-F)*E;c[5]=-(z-u)*E;c[6]=-(-q*n+h*a)*E;c[7]=-(f*n-M)*E;c[8]=(g-t)*E},mat3x3_determinant:function(b){b=b.data;return b[0]*b[4]*b[8]-b[0]*b[5]*b[7]-b[3]*b[1]*b[8]+b[3]*b[2]*b[7]+b[6]*b[1]*b[5]-b[6]*b[2]*b[4]},multiply_3x3:function(b,e,a){b=b.data;var c=e.data,h=a.data;a=c[0];e=c[1];var m=c[2],k=c[3],n=c[4],f=c[5],g=c[6],z=c[7],c=c[8],q=h[0],r=h[1],t=h[2],A=h[3],u=h[4],M=h[5],F=h[6],E=h[7],h=h[8];b[0]=
a*q+e*A+m*F;b[1]=a*r+e*u+m*E;b[2]=a*t+e*M+m*h;b[3]=k*q+n*A+f*F;b[4]=k*r+n*u+f*E;b[5]=k*t+n*M+f*h;b[6]=g*q+z*A+c*F;b[7]=g*r+z*u+c*E;b[8]=g*t+z*M+c*h},mean_rows:function(b){var e,a=0,c=b.rows,h=b.cols,m=b.data,k=Array(h);for(e=0;e<h;++e)k[e]=0;for(b=0;b<c;++b)for(e=0;e<h;++e,++a)k[e]+=m[a];for(e=0;e<h;++e)k[e]/=c;return k},mean_cols:function(b){var e,a=0,c=b.rows,h=b.cols,m=b.data,k=Array(c);for(e=0;e<c;++e)k[e]=0;for(b=0;b<h;++b)for(e=0;e<c;++e,++a)k[e]+=m[a];for(e=0;e<c;++e)k[e]/=h;return k},sub_rows:function(b,
e){var a,c,h=0,m=b.rows,k=b.cols,g=b.data;for(a=0;a<m;++a)for(c=0;c<k;++c,++h)g[h]-=e[c]},sub_cols:function(b,e){var a,c,h=0,m=b.rows,k=b.cols,g=b.data;for(a=0;a<k;++a)for(c=0;c<m;++c,++h)g[h]-=e[c]},add_rows:function(b,e){var a,c,h=0,m=b.rows,k=b.cols,g=b.data;for(a=0;a<m;++a)for(c=0;c<k;++c,++h)g[h]+=e[c]},add_cols:function(b,e){var a,c,h=0,m=b.rows,k=b.cols,g=b.data;for(a=0;a<k;++a)for(c=0;c<m;++c,++h)g[h]+=e[c]}}}();g.matmath=u})(jsfeat);
(function(g){var u=function(){var b=function(){function a(c){this.next=null;this.data=new jsfeat.data_t(c);this.size=this.data.size;this.buffer=this.data.buffer;this.u8=this.data.u8;this.i32=this.data.i32;this.f32=this.data.f32;this.f64=this.data.f64}a.prototype.resize=function(a){delete this.data;this.data=new jsfeat.data_t(a);this.size=this.data.size;this.buffer=this.data.buffer;this.u8=this.data.u8;this.i32=this.data.i32;this.f32=this.data.f32;this.f64=this.data.f64};return a}(),e,a,c=0;return{allocate:function(h,
g){e=a=new b(g);for(var k=0;k<h;++k){var n=new b(g);a=a.next=n;c++}},get_buffer:function(a){var b=e;e=e.next;c--;a>b.size&&b.resize(a);return b},put_buffer:function(b){a=a.next=b;c++}}}();g.cache=u;u.allocate(30,2560)})(jsfeat);
(function(g){var u=function(){var b=function(a,b,e,g){g=a[b];a[b]=a[e];a[e]=g},e=function(a,b){a=Math.abs(a);b=Math.abs(b);return a>b?(b/=a,a*Math.sqrt(1+b*b)):0<b?(a/=b,b*Math.sqrt(1+a*a)):0};return{svd_decompose:function(a,c,h,g,k){"undefined"===typeof k&&(k=0);var n=0,f=0,u=a.rows,z=a.cols,q=u,r=z,t=a.type|jsfeat.C1_t;q<r&&(n=1,f=q,q=r,r=f);var A=jsfeat.cache.get_buffer(q*q<<3),R=jsfeat.cache.get_buffer(r<<3),M=jsfeat.cache.get_buffer(r*r<<3),F=new jsfeat.matrix_t(q,q,t,A.data),E=new jsfeat.matrix_t(1,
r,t,R.data),t=new jsfeat.matrix_t(r,r,t,M.data);if(0==n)jsfeat.matmath.transpose(F,a);else{for(f=0;f<z*u;f++)F.data[f]=a.data[f];for(;f<r*q;f++)F.data[f]=0}a=F.data;for(var f=q,u=E.data,v=t.data,N=r,H=q,I=r,T=q,U=2*jsfeat.EPSILON,V=jsfeat.FLT_MIN,l=0,y=0,d=0,O=0,W=Math.max(H,30),p=0,w=0,P=w=p=0,x=0,D=0,G=0,s=0,C=0,B=0,J=x=d=x=0,K=s=0,Q=4660,p=p=y=0,S=jsfeat.cache.get_buffer(I<<3),L=S.f64;l<I;l++){for(B=d=0;d<H;d++)G=a[l*f+d],B+=G*G;L[l]=B;if(v){for(d=0;d<I;d++)v[l*N+d]=0;v[l*N+l]=1}}for(;O<W;O++){for(l=
P=0;l<I-1;l++)for(y=l+1;y<I;y++){p=l*f|0;w=y*f|0;J=L[l];s=0;K=L[y];d=2;s+=a[p]*a[w];for(s+=a[p+1]*a[w+1];d<H;d++)s+=a[p+d]*a[w+d];if(!(Math.abs(s)<=U*Math.sqrt(J*K))){s*=2;x=J-K;d=e(s,x);0>x?(x=0.5*(d-x),D=Math.sqrt(x/d),x=s/(d*D*2)):(x=Math.sqrt((d+x)/(2*d)),D=s/(d*x*2));K=J=0;d=2;s=x*a[p]+D*a[w];C=-D*a[p]+x*a[w];a[p]=s;a[w]=C;J+=s*s;K+=C*C;s=x*a[p+1]+D*a[w+1];C=-D*a[p+1]+x*a[w+1];a[p+1]=s;a[w+1]=C;J+=s*s;for(K+=C*C;d<H;d++)s=x*a[p+d]+D*a[w+d],C=-D*a[p+d]+x*a[w+d],a[p+d]=s,a[w+d]=C,J+=s*s,K+=C*C;
L[l]=J;L[y]=K;P=1;if(v)for(p=l*N|0,w=y*N|0,d=2,s=x*v[p]+D*v[w],C=-D*v[p]+x*v[w],v[p]=s,v[w]=C,s=x*v[p+1]+D*v[w+1],C=-D*v[p+1]+x*v[w+1],v[p+1]=s,v[w+1]=C;d<I;d++)s=x*v[p+d]+D*v[w+d],C=-D*v[p+d]+x*v[w+d],v[p+d]=s,v[w+d]=C}}if(0==P)break}for(l=0;l<I;l++){for(B=d=0;d<H;d++)G=a[l*f+d],B+=G*G;L[l]=Math.sqrt(B)}for(l=0;l<I-1;l++){y=l;for(d=l+1;d<I;d++)L[y]<L[d]&&(y=d);if(l!=y&&(b(L,l,y,B),v)){for(d=0;d<H;d++)b(a,l*f+d,y*f+d,G);for(d=0;d<I;d++)b(v,l*N+d,y*N+d,G)}}for(l=0;l<I;l++)u[l]=L[l];if(v)for(l=0;l<
T;l++){for(B=l<I?L[l]:0;B<=V;){p=1/H;for(d=0;d<H;d++)Q=214013*Q+2531011,y=0!=(Q>>16&256)?p:-p,a[l*f+d]=y;for(O=0;2>O;O++)for(y=0;y<l;y++){for(d=B=0;d<H;d++)B+=a[l*f+d]*a[y*f+d];for(d=p=0;d<H;d++)G=a[l*f+d]-B*a[y*f+d],a[l*f+d]=G,p+=Math.abs(G);p=p?1/p:0;for(d=0;d<H;d++)a[l*f+d]*=p}for(d=B=0;d<H;d++)G=a[l*f+d],B+=G*G;B=Math.sqrt(B)}D=1/B;for(d=0;d<H;d++)a[l*f+d]*=D}jsfeat.cache.put_buffer(S);if(c){for(f=0;f<r;f++)c.data[f]=E.data[f];for(;f<z;f++)c.data[f]=0}if(0==n){if(h&&k&jsfeat.SVD_U_T)for(f=q*q;0<=
--f;)h.data[f]=F.data[f];else h&&jsfeat.matmath.transpose(h,F);if(g&&k&jsfeat.SVD_V_T)for(f=r*r;0<=--f;)g.data[f]=t.data[f];else g&&jsfeat.matmath.transpose(g,t)}else{if(h&&k&jsfeat.SVD_U_T)for(f=r*r;0<=--f;)h.data[f]=t.data[f];else h&&jsfeat.matmath.transpose(h,t);if(g&&k&jsfeat.SVD_V_T)for(f=q*q;0<=--f;)g.data[f]=F.data[f];else g&&jsfeat.matmath.transpose(g,F)}jsfeat.cache.put_buffer(A);jsfeat.cache.put_buffer(R);jsfeat.cache.put_buffer(M)}}}();g.linalg=u})(jsfeat);
